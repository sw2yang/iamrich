<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="TradeLog">
<meta name="theme-color" content="#0a0c10">
<title>TradeLog â€” ë§¤ë§¤ì¼ì§€</title>
<link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
/* â”€â”€ ë”¥ ë„¤ì´ë¹„ ë¯¸ë‹ˆë©€ íŒ”ë ˆíŠ¸ â”€â”€ */
:root{
  --bg:      #f2f4f7;   /* ì—°ê·¸ë ˆì´ ë°°ê²½ */
  --surface: #ffffff;   /* ì¹´ë“œ/íŒ¨ë„ í°ìƒ‰ ìœ ì§€ */
  --s2:      #e8ebf0;   /* ë‚´ë¶€ ë°•ìŠ¤ */
  --border:  #c8cdd6;   /* í…Œë‘ë¦¬ */
  --accent:  #1d6ff2;   /* í¬ì¸íŠ¸ â€” ë¸”ë£¨ */
  --a2:      #4090ff;   /* ë³´ì¡° í•˜ì´ë¼ì´íŠ¸ */
  --danger:  #1d6ff2;   /* ì†ì‹¤ â€” íŒŒë€ìƒ‰ (í•œêµ­ ì¦ê¶Œ) */
  --warn:    #d97706;   /* ê²½ê³  â€” ì•°ë²„ */
  --text:    #1a1f2e;   /* ë³¸ë¬¸ ì§„í•œ í…ìŠ¤íŠ¸ */
  --muted:   #8a94a6;   /* ë³´ì¡° í…ìŠ¤íŠ¸ */
  --profit:  #e03131;   /* ìˆ˜ìµ â€” ë¹¨ê°„ìƒ‰ (í•œêµ­ ì¦ê¶Œ) */
  --loss:    #1d6ff2;   /* ì†ì‹¤ â€” íŒŒë€ìƒ‰ (í•œêµ­ ì¦ê¶Œ) */
  --navy1:   #e8f0fe;   /* ê°•ì¡° ë°°ê²½ */
  --navy2:   #dce7fd;   /* ë” ì§„í•œ ê°•ì¡° */
  --gold:    #b45309;   /* í”„ë¦¬ë¯¸ì—„ ê³¨ë“œ í¬ì¸íŠ¸ */
}

*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;}

body{
  background:var(--bg);
  color:var(--text);
  line-height:1.55;
  -webkit-font-smoothing:antialiased;
  font-family:'Pretendard',sans-serif;
  min-height:100vh;
  overflow-x:hidden;
  letter-spacing:-.01em;
}

/* â”€â”€ í—¤ë” â”€â”€ */
header{
  display:flex;align-items:center;justify-content:space-between;
  padding:0 24px;height:56px;
  border-bottom:1px solid var(--border);
  background:rgba(13,17,23,.96);
  position:sticky;top:0;z-index:200;
  backdrop-filter:blur(16px);
}
.logo{
  font-family:'Pretendard',sans-serif;font-weight:700;letter-spacing:1px;
  font-size:20px;letter-spacing:2px;
  color:var(--gold);
}
.logo sub{
  font-family:'Pretendard',sans-serif;
  font-size:9px;color:var(--muted);
  font-weight:400;margin-left:7px;letter-spacing:.5px;
}
.hdr-r{display:flex;gap:6px;align-items:center;}

/* â”€â”€ íƒ­ â”€â”€ */
.tab-bar{
  display:flex;flex-direction:column;
  border-bottom:1px solid var(--border);
  background:var(--bg);
  padding:0;
  position:sticky;
  top:56px;
  z-index:900;
}
/* ê·¸ë£¹ í–‰ */
.tab-groups{
  display:flex;gap:0;padding:0 24px;
  border-bottom:1px solid var(--border);
}
.tab-group-btn{
  padding:10px 18px;
  border:none;border-bottom:2px solid transparent;
  font-size:11px;font-weight:700;letter-spacing:.6px;
  cursor:pointer;background:none;color:var(--muted);
  transition:all .18s;font-family:inherit;
  text-transform:uppercase;
}
.tab-group-btn.active{color:var(--accent);border-bottom-color:var(--accent);}
.tab-group-btn:hover:not(.active){color:var(--text);}
/* ì„œë¸Œíƒ­ í–‰ */
.tab-subs{
  display:flex;gap:0;padding:0 24px;
  background:var(--navy1);
}
.tab{
  padding:10px 16px;
  border:none;border-bottom:2px solid transparent;
  font-size:12px;font-weight:600;letter-spacing:.4px;
  cursor:pointer;background:none;color:var(--muted);
  transition:all .18s;font-family:inherit;
  text-transform:uppercase;white-space:nowrap;
}
.tab.active{color:var(--accent);border-bottom-color:var(--accent);}
.tab:hover:not(.active){color:var(--text);}

/* â”€â”€ ë°”í…€ ë„¤ë¹„ â”€â”€ */
.bnav{display:none;position:fixed;bottom:0;left:0;right:0;
  background:var(--bg);border-top:1px solid var(--border);
  z-index:200;backdrop-filter:blur(16px);}
.bnav-inner{display:flex;}
.bnav-btn{flex:1;display:flex;flex-direction:column;align-items:center;
  padding:9px 0 11px;font-size:9px;color:var(--muted);
  background:none;border:none;cursor:pointer;gap:2px;font-family:inherit;
  text-transform:uppercase;letter-spacing:.3px;}
.bnav-btn.active{color:var(--accent);}
.bnav-ico{font-size:17px;}

/* â”€â”€ FAB â”€â”€ */
.fab{position:fixed;bottom:76px;right:18px;width:48px;height:48px;
  border-radius:50%;background:var(--accent);border:none;
  font-size:22px;cursor:pointer;z-index:150;
  box-shadow:0 4px 20px rgba(79,156,249,.4);
  display:none;color:#fff;font-weight:300;line-height:48px;text-align:center;}

/* â”€â”€ ë²„íŠ¼ â”€â”€ */
.btn{
  padding:7px 14px;border-radius:6px;border:none;
  cursor:pointer;font-size:12px;font-weight:600;
  transition:all .15s;font-family:inherit;
  letter-spacing:.3px;
}
.btn-primary{background:var(--accent);color:#fff;}
.btn-primary:hover{background:var(--a2);color:#0d1117;}
.btn-outline{
  background:transparent;color:var(--text);
  border:1.5px solid var(--border);
}
.btn-outline:hover{border-color:var(--accent);color:var(--accent);}
.btn-danger{background:rgba(248,113,113,.1);color:var(--danger);border:1px solid rgba(248,113,113,.2);}
.btn-danger:hover{background:rgba(248,113,113,.18);}
.btn-warn{background:rgba(251,191,36,.1);color:var(--warn);border:1px solid rgba(251,191,36,.2);}
.btn-ai{
  background:linear-gradient(135deg,#1d4ed8,#0ea5e9);
  color:#fff;font-weight:700;
}
.btn-save{
  background:rgba(200,169,110,.12);color:var(--gold);
  border:1px solid rgba(200,169,110,.25);font-weight:600;
}
.btn-save:hover{background:rgba(200,169,110,.22);}
.btn-save.saved{background:rgba(200,169,110,.25);}
.btn-sm{padding:5px 11px;font-size:11px;}
.more-item{display:block;width:100%;text-align:left;padding:8px 12px;background:none;border:none;color:var(--text);font-size:13px;cursor:pointer;border-radius:6px;font-family:inherit;}
.more-item:hover{background:var(--s2);}
.btn-xs{padding:3px 8px;font-size:11px;}

/* â”€â”€ ë ˆì´ì•„ì›ƒ â”€â”€ */
.container{max-width:1440px;margin:0 auto;padding:20px 24px;}

/* â”€â”€ stat ì¹´ë“œ â”€â”€ */
.stats-row{display:grid;grid-template-columns:repeat(6,1fr);gap:10px;margin-bottom:16px;}
.stat-card{
  background:var(--s2);
  border:1px solid var(--border);
  border-radius:10px;
  padding:14px 16px;
  position:relative;overflow:hidden;
}
/* ì™¼ìª½ ì„¸ë¡œ ì•¡ì„¼íŠ¸ ë¼ì¸ */
.stat-card::before{
  content:'';position:absolute;top:0;left:0;bottom:0;width:3px;
  background:var(--ab,var(--accent));
  border-radius:10px 0 0 10px;
}
.stat-label{
  font-size:9px;color:var(--muted);
  text-transform:uppercase;letter-spacing:1px;
  margin-bottom:8px;font-weight:600;
}
.stat-value{font-family:'Roboto Mono',monospace;font-size:17px;font-weight:500;}
.profit{color:#e03131;}
.loss{color:#1d6ff2;}
.neutral{color:#1d6ff2;}

/* â”€â”€ í¬ì§€ì…˜ ì¹´ë“œ â”€â”€ */
.pos-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:12px;margin-bottom:18px;}


/* â”€â”€ íˆ¬ì ë°©ì‹ ë²„íŠ¼ â”€â”€ */
.invest-style-btn {
  padding:6px 14px;border-radius:20px;border:1.5px solid var(--border);
  background:var(--s2);font-size:12px;font-weight:500;cursor:pointer;
  transition:all .15s;color:var(--muted);font-family:inherit;
}
.invest-style-btn:hover { border-color:var(--accent);color:var(--text); }
.invest-style-btn.active { border-color:var(--accent);background:rgba(29,111,242,.12);color:var(--accent);font-weight:700; }
/* â”€â”€ íŠ¸ë ˆì´ë”© ì €ë„ â”€â”€ */
.mood-pick {
  width:40px;height:40px;border-radius:50%;border:2px solid var(--border);
  background:var(--s2);font-size:20px;cursor:pointer;transition:all .15s;
}
.mood-pick:hover { border-color:var(--accent);transform:scale(1.1); }
.mood-pick.active { border-color:var(--accent);background:rgba(29,111,242,.12);box-shadow:0 0 0 3px rgba(29,111,242,.15); }

.sent-pick {
  padding:5px 12px;border-radius:20px;border:1.5px solid var(--border);
  background:var(--s2);font-size:12px;cursor:pointer;transition:all .15s;color:var(--text);font-family:inherit;
}
.sent-pick:hover { border-color:var(--accent); }
.sent-pick.active { border-color:var(--accent);background:rgba(29,111,242,.12);color:var(--accent);font-weight:600; }

.strat-pick {
  padding:4px 11px;border-radius:20px;border:1.5px solid var(--border);
  background:var(--s2);font-size:12px;cursor:pointer;transition:all .15s;color:var(--muted);font-family:inherit;
}
.strat-pick:hover { border-color:var(--accent);color:var(--text); }
.strat-pick.active { border-color:var(--accent);background:rgba(29,111,242,.12);color:var(--accent);font-weight:600; }


/* â”€â”€ VCP ì²´í¬ë¦¬ìŠ¤íŠ¸ â”€â”€ */
.vcp-check-item {
  display:flex;align-items:flex-start;gap:8px;padding:7px 10px;
  background:var(--s2);border:1.5px solid var(--border);border-radius:8px;
  cursor:pointer;font-size:12px;color:var(--muted);line-height:1.5;
  transition:border-color .15s,background .15s;
}
.vcp-check-item:hover { border-color:var(--accent);color:var(--text); }
.vcp-check-item input[type=checkbox] { margin-top:2px;flex-shrink:0;accent-color:var(--accent); }
.vcp-check-item:has(input:checked) { border-color:var(--profit);background:rgba(52,211,153,.06);color:var(--text); }

.pyramid-row {
  display:grid;grid-template-columns:auto 1fr 1fr 1fr;
  gap:8px;padding:9px 12px;border-radius:8px;align-items:center;font-size:12px;
}
.pyramid-step { font-weight:700;font-size:13px;min-width:28px; }
.pyramid-val  { color:var(--text); }
.pyramid-pct  { font-weight:700;font-family:'Roboto Mono',monospace;font-size:14px; }
.pyramid-cond { color:var(--muted);font-size:11px; }

.rule-check-item {
  display:flex;align-items:center;gap:8px;padding:7px 10px;
  background:var(--s2);border:1.5px solid var(--border);border-radius:8px;cursor:pointer;transition:all .15s;
}
.rule-check-item:hover { border-color:var(--accent); }
.rule-check-item.checked { border-color:var(--profit);background:rgba(52,211,153,.06); }
.rule-check-item.failed  { border-color:var(--loss);background:rgba(248,113,113,.06); }
.rule-check-icon { font-size:14px;width:18px;text-align:center; }
.rule-check-text { font-size:12px;flex:1; }

/* ì €ë„ ì¹´ë“œ */
.journal-day-card {
  background:var(--surface);border:1.5px solid var(--border);border-radius:12px;overflow:hidden;
  transition:border-color .15s;
}
.journal-day-card:hover { border-color:var(--accent); }
.journal-day-card.has-profit { border-left:3px solid var(--profit); }
.journal-day-card.has-loss   { border-left:3px solid var(--loss); }
.jcard-header {
  display:flex;align-items:center;gap:10px;padding:12px 16px;
  border-bottom:1px solid var(--border);cursor:pointer;
}
.jcard-date { font-size:13px;font-weight:700;min-width:80px; }
.jcard-pnl  { font-family:'Roboto Mono',monospace;font-size:14px;font-weight:700; }
.jcard-mood { font-size:18px; }
.jcard-title { flex:1;font-size:13px;font-weight:600;overflow:hidden;text-overflow:ellipsis;white-space:nowrap; }
.jcard-body { padding:12px 16px; }
.jcard-section { margin-bottom:10px; }
.jcard-section:last-child { margin-bottom:0; }
.jcard-sec-label { font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;margin-bottom:5px; }
.jcard-text { font-size:13px;line-height:1.7;color:var(--text); }
.jcard-tags { display:flex;flex-wrap:wrap;gap:5px; }
.jcard-tag { font-size:11px;padding:2px 9px;border-radius:12px;background:var(--navy1);color:var(--accent); }
.jcard-strat { font-size:11px;padding:2px 9px;border-radius:12px;background:rgba(29,111,242,.08);color:var(--accent);border:1px solid rgba(29,111,242,.2); }
.jcard-trade-row { display:flex;align-items:center;gap:8px;padding:5px 0;border-bottom:1px solid var(--border); }
.jcard-trade-row:last-child { border-bottom:none; }
/* â”€â”€ ë¦¬ìŠ¤íŠ¸ ë·° í–‰ â”€â”€ */
#holding-grid tbody tr {
  border-bottom: 1px solid var(--border);
  transition: background .12s;
}
#holding-grid tbody tr:last-child { border-bottom: none; }
#holding-grid tbody tr:hover { background: var(--navy1) !important; }
.row-target td:first-child { border-left: 3px solid var(--profit); }
.row-stop   td:first-child { border-left: 3px solid var(--loss); }

.pos-card{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:12px;overflow:hidden;
  transition:border-color .2s, box-shadow .2s;
}
.pos-card:hover{border-color:var(--accent);box-shadow:0 4px 16px rgba(29,111,242,.1);}
.pos-card.c-target{border-color:var(--profit);animation:gG 2.5s infinite;}
.pos-card.c-stop{border-color:var(--danger);animation:gR 2.5s infinite;}
@keyframes gG{0%,100%{box-shadow:0 0 0 rgba(224,49,49,0)}50%{box-shadow:0 0 16px rgba(224,49,49,.2)}}
@keyframes gR{0%,100%{box-shadow:0 0 0 rgba(29,111,242,0)}50%{box-shadow:0 0 16px rgba(29,111,242,.2)}}
.card-hdr{
  padding:12px 16px;
  border-bottom:1px solid var(--border);
  display:flex;align-items:center;gap:8px;
  background:linear-gradient(90deg,#e8f0fe,#fff);
}
.card-name{font-size:14px;font-weight:700;flex:1;letter-spacing:-.01em;}
.card-body{padding:13px 16px;}
.pos-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;font-size:13px;}
.row-lbl{color:var(--muted);font-size:12px;}
.pnl-bar{height:2px;border-radius:1px;background:var(--border);margin:8px 0;overflow:hidden;}
.pnl-fill{height:100%;border-radius:1px;transition:width .6s;}
.card-actions{display:flex;gap:5px;margin-top:10px;flex-wrap:wrap;}

/* â”€â”€ ìƒíƒœ ì  â”€â”€ */
.sdot{width:6px;height:6px;border-radius:50%;flex-shrink:0;}
.dot-h{background:#e03131;box-shadow:0 0 6px rgba(224,49,49,.5);animation:pulse 2s infinite;}
.dot-c{background:var(--muted);}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}

/* â”€â”€ ê°€ê²© ë°•ìŠ¤ â”€â”€ */
.price-box{
  background:var(--s2);
  border:1px solid var(--border);
  border-radius:8px;padding:11px 13px;margin-bottom:10px;
}
.price-big{font-family:'Roboto Mono',monospace;font-size:21px;font-weight:400;letter-spacing:-.02em;}
.bdg{display:inline-flex;align-items:center;font-size:10px;padding:2px 7px;border-radius:4px;font-weight:600;letter-spacing:.3px;}
.bdg-live{background:rgba(52,211,153,.12);color:var(--profit);}
.bdg-manual{background:rgba(251,191,36,.1);color:var(--warn);}
.prog-track{height:2px;border-radius:1px;background:var(--border);overflow:hidden;margin:5px 0;}
.prog-fill{height:100%;border-radius:1px;transition:width .5s;}
.al-bdg{
  display:inline-flex;align-items:center;gap:3px;
  font-size:11px;padding:2px 8px;border-radius:4px;
  font-family:'Roboto Mono',monospace;font-weight:600;
}
.al-t{background:rgba(52,211,153,.08);color:var(--profit);border:1px solid rgba(52,211,153,.2);}
.al-s{background:rgba(248,113,113,.08);color:var(--loss);border:1px solid rgba(248,113,113,.2);}
.hold-warn{
  background:rgba(251,191,36,.08);border:1px solid rgba(251,191,36,.2);
  border-radius:5px;padding:3px 9px;font-size:11px;color:var(--warn);
  display:inline-flex;align-items:center;gap:4px;margin-bottom:8px;
}

/* â”€â”€ í…Œì´ë¸” / ì„¹ì…˜ â”€â”€ */
.section{background:var(--surface);border:1.5px solid var(--border);border-radius:12px;overflow:hidden;}
.sec-hdr{
  display:flex;align-items:center;justify-content:space-between;
  padding:13px 18px;border-bottom:1px solid var(--border);
}
.sec-title{font-size:13px;font-weight:700;letter-spacing:.2px;}
.tbl-wrap{overflow-x:auto;}
table{width:100%;border-collapse:collapse;}
th{
  padding:9px 13px;text-align:left;font-size:9px;color:var(--muted);
  text-transform:uppercase;letter-spacing:1px;font-weight:700;
  border-bottom:2px solid #a0a8b8;white-space:nowrap;
  background:var(--s2);
}
td{padding:9px 13px;font-size:13px;border-bottom:1px solid #d0d5df;white-space:nowrap;}
td:first-child{font-weight:500;}
tr:last-child td{border-bottom:none;}
tbody tr:nth-child(even) td{background:rgba(0,0,0,.018);}
tr:hover td{background:var(--navy1) !important;}
.mono{font-family:'Roboto Mono',monospace;}
.tag{display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:700;letter-spacing:.4px;}
.tag-buy{background:rgba(224,49,49,.1);color:var(--profit);}
.tag-sell{background:rgba(29,111,242,.1);color:var(--loss);}
.tag-KRX{background:rgba(79,156,249,.12);color:var(--accent);}
.tag-US{background:rgba(251,191,36,.1);color:var(--warn);}
.tag-CRYPTO{background:rgba(167,139,250,.12);color:#a78bfa;}
.tag-FUTURES{background:rgba(251,191,36,.1);color:var(--warn);}
.pc{color:var(--profit);font-family:'Roboto Mono',monospace;}
.lc{color:var(--loss);font-family:'Roboto Mono',monospace;}



/* â”€â”€ ì¢…ëª© ìë™ì™„ì„± â”€â”€ */
.stock-dropdown {
  position:absolute;z-index:9999;background:var(--surface);border:1.5px solid var(--accent);
  border-radius:8px;box-shadow:0 8px 24px rgba(0,0,0,.25);max-height:220px;overflow-y:auto;
  min-width:260px;
}
.stock-item {
  display:flex;align-items:center;gap:10px;padding:8px 12px;cursor:pointer;
  font-size:13px;border-bottom:1px solid var(--border);transition:background .1s;
}
.stock-item:last-child { border-bottom:none; }
.stock-item:hover, .stock-item.active { background:var(--navy1); }
.stock-item .code { font-family:'Roboto Mono',monospace;font-size:11px;color:var(--accent);min-width:54px; }
.stock-item .name { flex:1;font-weight:500; }
.stock-item .mkt  { font-size:10px;color:var(--muted);background:var(--s2);padding:1px 6px;border-radius:3px; }
/* â”€â”€ íƒ€ì„ë¼ì¸ â”€â”€ */
#timeline-body::before {
  content:'';position:absolute;left:8px;top:0;bottom:0;width:2px;background:var(--border);
}
/* â”€â”€ ëª¨ë‹¬ â”€â”€ */
.backdrop{
  display:none;position:fixed;top:0;right:0;bottom:0;left:0;
  background:rgba(30,40,60,.45);backdrop-filter:blur(6px);
  z-index:1000;align-items:center;justify-content:center;padding:14px;
}
.backdrop.show{display:flex;}
.modal{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:14px;
  width:100%;max-width:560px;max-height:92vh;overflow-y:auto;
  box-shadow:0 8px 40px rgba(0,0,0,.5);
}
.modal-lg{max-width:700px;}
.modal-sm{max-width:440px;}
.modal-hdr{
  padding:15px 20px;border-bottom:1px solid var(--border);
  display:flex;justify-content:space-between;align-items:center;
  position:sticky;top:0;background:var(--surface);z-index:10;
}
.modal-title{font-size:14px;font-weight:700;letter-spacing:.1px;}
.xbtn{background:none;border:none;color:var(--muted);cursor:pointer;font-size:20px;padding:0 4px;line-height:1;}
.xbtn:hover{color:var(--text);}
.modal-body{padding:18px 20px;}
.fg{display:flex;flex-direction:column;gap:5px;margin-bottom:12px;}
.fr{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.fr3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;}
.flbl{font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;font-weight:700;}
.fi{
  background:var(--s2);border:1px solid var(--border);
  color:var(--text);padding:9px 12px;border-radius:7px;
  font-size:13px;font-family:inherit;outline:none;
  transition:border-color .15s;width:100%;
}
.fi:focus{border-color:var(--accent);}
.fi::placeholder{color:var(--muted);}
textarea.fi{resize:vertical;min-height:58px;}
select.fi{cursor:pointer;}
.fi-t{border-color:rgba(224,49,49,.3);}
.fi-s{border-color:rgba(29,111,242,.3);}
.divider{border:none;border-top:1px solid var(--border);margin:12px 0;}
.hint{font-size:11px;color:var(--muted);margin-top:3px;}
.hint a{color:var(--accent);text-decoration:none;}

/* â”€â”€ ê±°ë˜ ë‚´ì—­ â”€â”€ */
.th-wrap{background:#f8f9fb;border-radius:8px;overflow:hidden;margin:11px 0;border:1px solid var(--border);}
.th-row{
  display:grid;grid-template-columns:88px 50px 100px 70px 1fr 40px;
  gap:6px;align-items:center;padding:9px 12px;
  border-bottom:1px solid var(--border);font-size:12px;
}
.th-row:last-child{border-bottom:none;}
.th-hdr{background:var(--surface);font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;font-weight:700;}

/* â”€â”€ ì´ë¯¸ì§€ â”€â”€ */
.img-preview{display:flex;gap:7px;flex-wrap:wrap;margin-top:7px;}
.img-drag-over{border-color:var(--accent) !important;background:var(--navy1) !important;box-shadow:0 0 0 3px rgba(29,111,242,.15);}
.img-thumb{width:68px;height:68px;border-radius:6px;object-fit:cover;border:1px solid var(--border);cursor:pointer;transition:border-color .15s;}
.img-thumb:hover{border-color:var(--accent);}
.img-add{
  width:68px;height:68px;border-radius:6px;
  border:1px dashed var(--border);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;font-size:18px;color:var(--muted);
  transition:all .15s;
}
.img-add:hover{border-color:var(--accent);color:var(--accent);}

/* â”€â”€ ì°¨íŠ¸ â”€â”€ */

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ì°¨íŠ¸ ë””ìì¸ ì‹œìŠ¤í…œ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* ì»¬ëŸ¬ ìƒìˆ˜: ë¹¨ê°•=ìˆ˜ìµ, íŒŒë‘=ì†ì‹¤ */
:root {
  --c-profit: #f03e3e;
  --c-profit-glow: rgba(240,62,62,.18);
  --c-profit-soft: rgba(240,62,62,.08);
  --c-loss: #1c7ed6;
  --c-loss-glow: rgba(28,126,214,.18);
  --c-loss-soft: rgba(28,126,214,.08);
  --c-neutral: rgba(148,163,184,.5);
}

.chart-sec {
  background: var(--surface);
  border: 1.5px solid var(--border);
  border-radius: 16px;
  overflow: hidden;
  margin-bottom: 14px;
  transition: border-color .2s, box-shadow .25s, transform .2s;
  position: relative;
}
.chart-sec:hover {
  border-color: rgba(29,111,242,.3);
  box-shadow: 0 8px 32px rgba(0,0,0,.28), 0 0 0 1px rgba(29,111,242,.08);
  transform: translateY(-1px);
}
.chart-sec--hero {
  border-radius: 18px;
}
.chart-sec--hero .chart-hdr {
  padding: 16px 22px;
}
.chart-hdr {
  padding: 13px 20px;
  border-bottom: 1px solid var(--border);
  font-size: 12px; font-weight: 700; letter-spacing: .4px;
  color: var(--text);
  display: flex; align-items: center; justify-content: space-between;
  gap: 10px;
  background: linear-gradient(90deg, rgba(29,111,242,.04) 0%, transparent 60%);
}
.chart-hdr > span:first-child {
  display: flex; align-items: center; gap: 7px;
}
.chart-kpi {
  font-size: 15px; font-weight: 800;
  font-family: 'Roboto Mono', monospace;
  letter-spacing: -.5px;
}
.chart-body { padding: 16px 18px; }
.chart-body--tall { padding: 0; }
canvas { display: block; width: 100%; }

/* ì°¨íŠ¸ ì„œë¸Œ ë ˆì´ë¸” */
.chart-sub {
  font-size: 11px; color: var(--muted); font-weight: 400; letter-spacing: 0;
}

.chart-grid-3 {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 14px;
  margin-bottom: 14px;
}
@media (max-width: 900px) {
  .chart-grid-3 { grid-template-columns: 1fr; }
}
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */


/* â”€â”€ íˆíŠ¸ë§µ â”€â”€ */
.hm-labels{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;margin-bottom:5px;}
.hm-lbl{font-size:9px;color:var(--muted);text-align:center;text-transform:uppercase;letter-spacing:.5px;}
.hm-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;}
.hm-cell{aspect-ratio:1;border-radius:4px;}

/* â”€â”€ ìº˜ë¦°ë” â”€â”€ */
.cal-outer{display:flex;gap:4px;align-items:flex-start;}
.cal-main{flex:1;min-width:0;}
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;}
.cal-hdr-row{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:6px;}
.cal-dhdr{font-size:9px;color:var(--muted);text-align:center;padding:4px;text-transform:uppercase;letter-spacing:.5px;}
.cal-day{
  min-height:88px;border-radius:7px;padding:6px;
  background:var(--s2);border:1px solid var(--border);
  font-size:11px;cursor:pointer;transition:border-color .15s;
  overflow:hidden;
}
.cal-day:hover{border-color:var(--accent);}
.cal-day.today{border:1.5px solid var(--accent);background:rgba(79,156,249,.06);}
.cal-day.empty{background:transparent;border-color:transparent;cursor:default;}
.cal-day.has-profit{background:rgba(240,62,62,.07);}
.cal-day.has-loss{background:rgba(29,126,214,.07);}
.cal-num{font-size:11px;font-weight:600;margin-bottom:3px;color:var(--muted);}
.cal-num.is-today{color:var(--accent);font-weight:800;}
.cal-tag{font-size:9px;padding:1px 5px;border-radius:3px;margin-bottom:1px;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.cal-tag.buy{background:rgba(240,62,62,.18);color:var(--profit);}
.cal-tag.sell{background:rgba(29,126,214,.18);color:var(--loss);}
.cal-day-pnl{font-size:10px;font-weight:700;font-family:'Roboto Mono',monospace;margin-top:3px;}
.cal-dot{display:inline-block;width:5px;height:5px;border-radius:50%;margin:1px;}
/* ì£¼ë³„ í•©ê³„ ì»¬ëŸ¼ */
.cal-week-col{display:flex;flex-direction:column;gap:4px;width:90px;flex-shrink:0;}
.cal-week-hdr{font-size:9px;color:var(--muted);text-align:center;padding:4px;letter-spacing:.5px;}
.cal-week-sum{
  min-height:88px;border-radius:7px;padding:8px 7px;
  background:rgba(255,255,255,.02);border:1px solid var(--border);
  font-size:10px;display:flex;flex-direction:column;gap:4px;justify-content:center;
}


/* â”€â”€ ë°°ì§€ â”€â”€ */
.badge{font-size:10px;padding:1px 6px;border-radius:3px;border-width:1px;border-style:solid;}
.badge-profit{background:rgba(224,49,49,.12);color:var(--profit);border-color:rgba(224,49,49,.25);}
.badge-loss{background:rgba(29,111,242,.12);color:var(--loss);border-color:rgba(29,111,242,.25);}
.badge-warn{background:rgba(251,191,36,.12);color:var(--warn);border-color:rgba(251,191,36,.25);}

/* â”€â”€ ë³µê¸° ëª¨ë‹¬ â”€â”€ */
.review-tab{
  padding:10px 16px;background:none;border:none;border-bottom:2px solid transparent;
  font-size:12px;font-weight:600;color:var(--muted);cursor:pointer;transition:all .15s;
}
.review-tab.active{color:var(--accent);border-bottom-color:var(--accent);}
.review-tab:hover{color:var(--text);}
.review-panel{}
.check-item{
  display:flex;align-items:center;gap:10px;padding:9px 12px;
  background:var(--s2);border-radius:8px;border:1px solid var(--border);
  cursor:pointer;transition:border-color .15s;
}
.check-item:hover{border-color:var(--accent);}
.check-item.checked{border-color:var(--profit);background:rgba(52,211,153,.07);}
.check-item.checked-no{border-color:var(--loss);background:rgba(239,68,68,.07);}
.check-icon{font-size:16px;width:20px;text-align:center;}
.score-ring{
  width:100px;height:100px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:28px;font-weight:800;margin:0 auto 12px;
  border:4px solid;
}
.track-row{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center;margin-bottom:8px;}
/* â”€â”€ ì•Œë¦¼ íŒì—… â”€â”€ */
.alert-popup{position:fixed;top:68px;right:16px;z-index:3000;display:flex;flex-direction:column;gap:8px;pointer-events:none;max-width:300px;}
.al-pop{
  background:var(--surface);border-radius:10px;padding:13px 16px;
  pointer-events:all;
  transform:translateX(320px);
  transition:transform .4s cubic-bezier(.175,.885,.32,1.275);
  box-shadow:0 8px 32px rgba(0,0,0,.5);position:relative;
}
.al-pop.show{transform:translateX(0);}
.al-pop.target{border:1px solid var(--profit);border-left:3px solid var(--profit);}
.al-pop.stop{border:1px solid var(--danger);border-left:3px solid var(--danger);}
.al-pop-title{font-size:13px;font-weight:700;margin-bottom:3px;}
.al-pop-body{font-size:12px;color:var(--muted);}
.al-dismiss{position:absolute;top:8px;right:10px;background:none;border:none;color:var(--muted);cursor:pointer;font-size:16px;}

/* â”€â”€ í† ìŠ¤íŠ¸ â”€â”€ */
.toast{
  position:fixed;bottom:76px;left:50%;
  transform:translateX(-50%) translateY(60px);
  background:var(--navy1);
  border:1px solid var(--border);
  color:var(--text);padding:10px 22px;border-radius:8px;
  font-size:12px;font-weight:500;
  z-index:2000;opacity:0;transition:all .3s;
  white-space:nowrap;max-width:90vw;text-align:center;
  box-shadow:0 8px 24px rgba(0,0,0,.4);
}
.toast.show{transform:translateX(-50%) translateY(0);opacity:1;}

/* â”€â”€ ë¹ˆ ìƒíƒœ â”€â”€ */
.empty{text-align:center;padding:52px;color:var(--muted);}
.empty .ico{font-size:28px;margin-bottom:10px;opacity:.5;}

/* â”€â”€ 2ë‹¨ ë ˆì´ì•„ì›ƒ â”€â”€ */
.two-col{display:grid;grid-template-columns:1fr 340px;gap:14px;}
.report-row{
  display:flex;justify-content:space-between;align-items:center;
  padding:8px 0;font-size:13px;border-bottom:1px solid var(--border);
}
.report-row:last-child{border-bottom:none;}

/* â”€â”€ íŒíŠ¸ ì¹´ë“œ â”€â”€ */
.hint-card{
  display:flex;gap:14px;align-items:flex-start;
  background:linear-gradient(135deg,rgba(79,156,249,.08),rgba(79,156,249,.03));
  border:1px solid rgba(79,156,249,.2);
  border-left:3px solid var(--accent);
  border-radius:10px;padding:14px 16px;
  margin-bottom:16px;position:relative;
  animation:slideIn .3s ease;
}
@keyframes slideIn{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}
.hint-card.hidden{display:none;}
.hint-icon{font-size:22px;flex-shrink:0;margin-top:1px;}
.hint-body{flex:1;}
.hint-title{font-size:13px;font-weight:700;color:var(--accent);margin-bottom:4px;}
.hint-text{font-size:12px;color:var(--text);line-height:1.7;margin-bottom:8px;}
.hint-tips{display:flex;flex-wrap:wrap;gap:5px;}
.hint-tip{
  font-size:11px;color:var(--muted);
  background:rgba(79,156,249,.06);
  border:1px solid rgba(79,156,249,.12);
  border-radius:5px;padding:3px 8px;
}
.hint-close{
  position:absolute;top:10px;right:12px;
  background:none;border:none;color:var(--muted);
  cursor:pointer;font-size:16px;line-height:1;
  padding:0;transition:color .15s;
}
.hint-close:hover{color:var(--text);}
/* íŠœí† ë¦¬ì–¼ ìŠ¤í… */
.tut-step{
  flex:1;height:4px;border-radius:2px;
  background:var(--border);transition:background .3s;cursor:pointer;
}
.tut-step.done{background:var(--profit);}
.tut-step.active{background:var(--accent);}
/* íŠœí† ë¦¬ì–¼ ìŠ¬ë¼ì´ë“œ */
.tut-slide{animation:fadeIn .25s ease;}
@keyframes fadeIn{from{opacity:0;transform:translateX(12px)}to{opacity:1;transform:translateX(0)}}
.tut-hero{font-size:48px;text-align:center;margin-bottom:12px;}
.tut-h{font-size:18px;font-weight:700;text-align:center;margin-bottom:6px;}
.tut-sub{font-size:13px;color:var(--muted);text-align:center;margin-bottom:20px;line-height:1.6;}
.tut-steps-list{display:flex;flex-direction:column;gap:10px;}
.tut-item{
  display:flex;align-items:flex-start;gap:12px;
  background:var(--s2);border-radius:9px;
  padding:12px 14px;border:1.5px solid var(--border);
}
.tut-num{
  width:26px;height:26px;border-radius:50%;
  background:var(--accent);color:#0d1117;
  display:flex;align-items:center;justify-content:center;
  font-size:12px;font-weight:700;flex-shrink:0;
}
.tut-item-title{font-size:13px;font-weight:600;margin-bottom:3px;}
.tut-item-desc{font-size:12px;color:var(--muted);line-height:1.5;}
.tut-kbd{
  display:inline-block;background:var(--surface);
  border:1px solid var(--border);border-radius:4px;
  padding:1px 7px;font-family:'Roboto Mono',monospace;
  font-size:11px;color:var(--accent);margin:0 2px;
}

/* â”€â”€ ë°˜ì‘í˜• â”€â”€ */
@media(max-width:900px){
  .stats-row{grid-template-columns:repeat(3,1fr);}
  .two-col{grid-template-columns:1fr;}
  .tab-bar{display:none;}
  .bnav{display:block;}
  .container{padding:12px;padding-bottom:82px;}
  .pos-grid{grid-template-columns:1fr;}
  .toast{bottom:88px;}
  .fab{display:block;}
  .hdr-r .hide-m{display:none;}
  header{padding:0 14px;}
}
@media(max-width:540px){
  .stats-row{grid-template-columns:repeat(2,1fr);}
}

/* í…Œë§ˆ ì¹© */
.theme-chip {
  font-size:11px;font-weight:600;padding:4px 10px;border-radius:20px;
  background:var(--s2);border:1.5px solid var(--border);color:var(--muted);
  cursor:pointer;transition:all .15s;
}
.theme-chip.active {
  background:var(--accent);border-color:var(--accent);color:#fff;
}
</style>
</head>
<body>

<header>
  <div class="logo">TradeLog <sub>ë§¤ë§¤ì¼ì§€</sub></div>
  <div class="hdr-r">
    <span style="font-size:11px;color:var(--muted)" id="rs-status"></span>
    <button class="btn btn-outline btn-sm" onclick="refreshAll()" title="ì‹œì„¸ ê°±ì‹ ">ğŸ”„</button>
    <button class="btn btn-outline btn-sm" onclick="openSearch()" title="ê²€ìƒ‰">ğŸ”</button>
    <!-- ë”ë³´ê¸° ë“œë¡­ë‹¤ìš´ -->
    <div style="position:relative" id="more-menu-wrap">
      <button class="btn btn-outline btn-sm" onclick="toggleMoreMenu()" title="ë”ë³´ê¸°">â‹¯</button>
      
    </div>
    <button class="btn btn-save btn-sm" id="save-btn" onclick="saveToFile()">ğŸ’¾ ì €ì¥</button>
    <button class="btn btn-ai btn-sm hide-m" onclick="runAI()">ğŸ¤– AI</button>
    <button class="btn btn-primary btn-sm" onclick="openNewPos()">+ ì¶”ê°€</button>
  </div>
</header>

<div class="tab-bar">
  <!-- ê·¸ë£¹ íƒ­ -->
  <div class="tab-groups">
    <button class="tab-group-btn active" id="tg-trade" onclick="switchGroup('trade')">ğŸ“Š ë§¤ë§¤</button>
    <button class="tab-group-btn" id="tg-analysis" onclick="switchGroup('analysis')">ğŸ“ˆ ë¶„ì„</button>
    <button class="tab-group-btn" id="tg-tools" onclick="switchGroup('tools')">ğŸ›  ë„êµ¬</button>
  </div>
  <!-- ì„œë¸Œ íƒ­ (ê·¸ë£¹ë³„) -->
  <div class="tab-subs" id="subtabs-trade">
    <button class="tab" id="tab-home" onclick="switchTab('home')">ğŸ  í™ˆ</button>
    <button class="tab active" id="tab-holding" onclick="switchTab('holding')">ğŸ“Š ë³´ìœ ì¤‘ <span id="cnt-h"></span></button>
    <button class="tab" id="tab-closed" onclick="switchTab('closed')">âœ… ì²­ì‚°ì™„ë£Œ <span id="cnt-c"></span></button>
    <button class="tab" id="tab-funds" onclick="switchTab('funds')">ğŸ’° ìê¸ˆê´€ë¦¬</button>
    <button class="tab" id="tab-calendar" onclick="switchTab('calendar')">ğŸ“… ìº˜ë¦°ë”</button>
  </div>
  <div class="tab-subs" id="subtabs-analysis" style="display:none">
    <button class="tab" id="tab-timeline" onclick="switchTab('timeline')">ğŸ• íƒ€ì„ë¼ì¸</button>
    <button class="tab" id="tab-analytics" onclick="switchTab('analytics')">ğŸ“ˆ ì°¨íŠ¸ë¶„ì„</button>
    <button class="tab" id="tab-report" onclick="switchTab('report')">ğŸ“„ ë§¤ë§¤ë¦¬í¬íŠ¸</button>
    <button class="tab" id="tab-review-report" onclick="switchTab('review-report')">ğŸ“‹ ë³µê¸°ë¦¬í¬íŠ¸</button>
    <button class="tab" id="tab-journal" onclick="switchTab('journal')">ğŸ““ ì¼ì§€</button>
    <button class="tab" id="tab-compare" onclick="switchTab('compare')">âš”ï¸ ì „ëµë¹„êµ</button>
  </div>
  <div class="tab-subs" id="subtabs-tools" style="display:none">
    <button class="tab" id="tab-risk" onclick="switchTab('risk')">âš–ï¸ ë¦¬ìŠ¤í¬</button>
    <button class="tab" id="tab-rules" onclick="switchTab('rules')">ğŸ“‹ ë§¤ë§¤ê·œì¹™</button>
    <button class="tab" id="tab-goals" onclick="switchTab('goals')">ğŸ¯ ëª©í‘œ</button>
    <button class="tab" id="tab-events" onclick="switchTab('events')">ğŸ”” ì´ë²¤íŠ¸</button>
  </div>
</div>

<nav class="bnav">
  <div class="bnav-inner">
    <button class="bnav-btn" id="bnav-holding" onclick="switchTab('holding')"><span class="bnav-ico">ğŸ“Š</span>ë³´ìœ ì¤‘</button>
    <button class="bnav-btn" id="bnav-closed" onclick="switchTab('closed')"><span class="bnav-ico">âœ…</span>ì²­ì‚°</button>
    <button class="bnav-btn" id="bnav-calendar" onclick="switchTab('calendar')"><span class="bnav-ico">ğŸ“…</span>ìº˜ë¦°ë”</button>
    <button class="bnav-btn" id="bnav-funds" onclick="switchTab('funds')"><span class="bnav-ico">ğŸ’°</span>ìê¸ˆ</button>
    <button class="bnav-btn" id="bnav-analytics" onclick="switchTab('analytics')"><span class="bnav-ico">ğŸ“ˆ</span>ì°¨íŠ¸</button>
    <button class="bnav-btn" id="bnav-stats" onclick="switchTab('stats')"><span class="bnav-ico">ğŸ†</span>í†µê³„</button>
    <button class="bnav-btn" id="bnav-report" onclick="switchTab('report')"><span class="bnav-ico">ğŸ“„</span>ë§¤ë§¤</button>
    <button class="bnav-btn" id="bnav-review-report" onclick="switchTab('review-report')"><span class="bnav-ico">ğŸ“‹</span>ë³µê¸°</button>
    <button class="bnav-btn" id="bnav-events" onclick="switchTab('events')"><span class="bnav-ico">ğŸ””</span>ì´ë²¤íŠ¸</button>
    <button class="bnav-btn" id="bnav-risk" onclick="switchTab('risk')"><span class="bnav-ico">âš–ï¸</span>ë„êµ¬</button>
  </div>
</nav>
<button class="fab" onclick="openNewPos()">+</button>

<div class="container">

<!-- â”€â”€ í™ˆ ëŒ€ì‹œë³´ë“œ â”€â”€ -->
<div id="view-home" style="display:none">
  <div id="home-dashboard"></div>
</div>

<!-- â”€â”€ íƒ€ì„ë¼ì¸ â”€â”€ -->
<div id="view-timeline" style="display:none">
  <div style="display:flex;gap:10px;margin-bottom:14px;flex-wrap:wrap;align-items:center">
    <input type="month" class="fi" id="tl-month" style="width:150px;padding:7px 10px" onchange="renderTimeline()">
    <select class="fi" id="tl-filter" style="width:110px;padding:7px 10px" onchange="renderTimeline()">
      <option value="all">ì „ì²´</option>
      <option value="buy">ë§¤ìˆ˜ë§Œ</option>
      <option value="sell">ë§¤ë„ë§Œ</option>
    </select>
    <div style="font-size:12px;color:var(--muted)" id="tl-summary-text"></div>
  </div>
  <div id="timeline-body" style="position:relative;padding-left:24px"></div>
</div>

<!-- â”€â”€ ë³´ìœ ì¤‘ â”€â”€ -->
<div id="view-holding">
  <div id="hint-holding" class="hint-card">
    <div class="hint-icon">ğŸ“Š</div>
    <div class="hint-body">
      <div class="hint-title">ë³´ìœ ì¤‘ í¬ì§€ì…˜</div>
      <div class="hint-text">ë§¤ìˆ˜í•œ ì¢…ëª©ì„ ì—¬ê¸°ì„œ ê´€ë¦¬í•´ìš”. <strong style="color:var(--accent)">+ ì¶”ê°€</strong> ë²„íŠ¼ìœ¼ë¡œ ìƒˆ í¬ì§€ì…˜ì„ ë§Œë“¤ê³ , ì¹´ë“œì—ì„œ ì¶”ê°€ ë§¤ìˆ˜Â·ë§¤ë„Â·ëª©í‘œê°€ ì„¤ì •ì´ ê°€ëŠ¥í•´ìš”.</div>
      <div class="hint-tips">
        <span class="hint-tip">ğŸ’¡ ğŸ”„ ì‹œì„¸ ë²„íŠ¼ìœ¼ë¡œ ì‹¤ì‹œê°„ ê°€ê²© ê°±ì‹ </span>
        <span class="hint-tip">ğŸ’¡ ğŸ¯ ë²„íŠ¼ìœ¼ë¡œ ëª©í‘œê°€Â·ì†ì ˆê°€ ì•Œë¦¼ ì„¤ì •</span>
        <span class="hint-tip">ğŸ’¡ 30ì¼ ì´ìƒ ë³´ìœ  ì‹œ â° ê²½ê³  ìë™ í‘œì‹œ</span>
      </div>
    </div>
    <button class="hint-close" onclick="closeHint('holding')">Ã—</button>
  </div>
  <div class="stats-row" style="grid-template-columns:repeat(6,1fr)">
    <div class="stat-card"><div class="stat-label">ë³´ìœ  í¬ì§€ì…˜</div><div class="stat-value neutral" id="h-cnt">0</div></div>
    <div class="stat-card"><div class="stat-label">ì´ ë§¤ìˆ˜ê¸ˆì•¡</div><div class="stat-value" id="h-inv">â‚©0</div></div>
    <div class="stat-card"><div class="stat-label">ë¯¸ì‹¤í˜„ ì†ìµ</div><div class="stat-value" id="h-unreal">â‚©0</div></div>
    <div class="stat-card"><div class="stat-label">í‰ê°€ ìˆ˜ìµë¥ </div><div class="stat-value" id="h-rate">0%</div></div>
    <div class="stat-card" style="--ab:var(--warn)"><div class="stat-label">ëª©í‘œê°€ ë„ë‹¬</div><div class="stat-value profit" id="h-tgt">0</div></div>
    <div class="stat-card" style="--ab:var(--danger)"><div class="stat-label">ì†ì ˆê°€ ë„ë‹¬</div><div class="stat-value loss" id="h-stp">0</div></div>
  </div>
  <div id="holding-grid" style="background:var(--surface);border:1.5px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:14px"></div>
  <div style="padding:0 0 10px;display:flex;gap:7px;flex-wrap:wrap" id="holding-controls">
    <input class="fi" style="width:140px;padding:6px 10px;font-size:12px" placeholder="ì¢…ëª© ê²€ìƒ‰..." oninput="renderHolding()" id="h-search">
    <select class="fi" style="width:110px;padding:6px 10px;font-size:12px" onchange="renderHolding()" id="h-sort">
      <option value="date">ìµœê·¼ ë§¤ìˆ˜ìˆœ</option>
      <option value="pnl">ì†ìµê¸ˆì•¡ìˆœ</option>
      <option value="rate">ìˆ˜ìµë¥ ìˆœ</option>
      <option value="days">ë³´ìœ ê¸°ê°„ìˆœ</option>
    </select>
    <select class="fi" style="width:100px;padding:6px 10px;font-size:12px" onchange="renderHolding()" id="h-filter">
      <option value="">ì „ì²´</option>
      <option value="profit">ìˆ˜ìµì¤‘</option>
      <option value="loss">ì†ì‹¤ì¤‘</option>
      <option value="target">ëª©í‘œê°€ ë„ë‹¬</option>
      <option value="stop">ì†ì ˆê°€ ë„ë‹¬</option>
    </select>
  </div>
  <div class="empty" id="holding-empty" style="display:none"><div class="ico">ğŸ“­</div><div>ë³´ìœ ì¤‘ì¸ í¬ì§€ì…˜ì´ ì—†ìŠµë‹ˆë‹¤</div><div style="font-size:12px;margin-top:5px">ìƒë‹¨ "+ ì¶”ê°€"ë¡œ ì‹œì‘í•˜ì„¸ìš”</div></div>
</div>

<!-- â”€â”€ ì²­ì‚°ì™„ë£Œ â”€â”€ -->
<div id="view-closed" style="display:none">
  <div id="hint-closed" class="hint-card">
    <div class="hint-icon">âœ…</div>
    <div class="hint-body">
      <div class="hint-title">ì²­ì‚° ì™„ë£Œ í¬ì§€ì…˜</div>
      <div class="hint-text">ë§¤ë„ ì™„ë£Œëœ ì¢…ëª©ì˜ ì‹¤í˜„ ì†ìµì„ í™•ì¸í•´ìš”. ìŠ¹ë¥ Â·í‰ê·  ìˆ˜ìµë¥ Â·ìµœëŒ€ ì†ì‹¤ ë“± í•µì‹¬ ì„±ê³¼ ì§€í‘œê°€ ìë™ìœ¼ë¡œ ê³„ì‚°ë¼ìš”.</div>
      <div class="hint-tips">
        <span class="hint-tip">ğŸ’¡ ë³´ìœ ì¤‘ íƒ­ì—ì„œ "ì²­ì‚° ì²˜ë¦¬" ë²„íŠ¼ìœ¼ë¡œ ì´ë™</span>
        <span class="hint-tip">ğŸ’¡ ê²€ìƒ‰Â·í•„í„°ë¡œ ìˆ˜ìµ/ì†ì‹¤ ì¢…ëª©ë§Œ ë³¼ ìˆ˜ ìˆì–´ìš”</span>
      </div>
    </div>
    <button class="hint-close" onclick="closeHint('closed')">Ã—</button>
  </div>
  <div class="stats-row">
    <div class="stat-card"><div class="stat-label">ì²­ì‚° íšŸìˆ˜</div><div class="stat-value neutral" id="c-cnt">0</div></div>
    <div class="stat-card"><div class="stat-label">ì´ ì‹¤í˜„ì†ìµ</div><div class="stat-value" id="c-pnl">â‚©0</div></div>
    <div class="stat-card"><div class="stat-label">ìŠ¹ë¥ </div><div class="stat-value" id="c-wr">0%</div></div>
    <div class="stat-card"><div class="stat-label">í‰ê·  ìˆ˜ìµë¥ </div><div class="stat-value" id="c-avg">0%</div></div>
    <div class="stat-card" style="--ab:var(--danger)"><div class="stat-label">ìµœëŒ€ ì†ì‹¤</div><div class="stat-value loss" id="c-mxl">0%</div></div>
    <div class="stat-card"><div class="stat-label">ìµœëŒ€ ìˆ˜ìµ</div><div class="stat-value profit" id="c-mxw">0%</div></div>
  </div>
  <div class="section">
    <div class="sec-hdr">
      <span class="sec-title">ì²­ì‚° ì™„ë£Œ í¬ì§€ì…˜</span>
      <div style="display:flex;gap:7px;flex-wrap:wrap">
        <input class="fi" style="width:130px;padding:6px 10px;font-size:12px" placeholder="ê²€ìƒ‰..." oninput="renderClosed()" id="c-search">
        <select class="fi" style="width:95px;padding:6px 10px;font-size:12px" onchange="renderClosed()" id="c-filter">
          <option value="">ì „ì²´</option><option value="profit">ìˆ˜ìµ</option><option value="loss">ì†ì‹¤</option>
        </select>
        <select class="fi" style="width:110px;padding:6px 10px;font-size:12px" onchange="renderClosed()" id="c-sort">
          <option value="date">ìµœê·¼ ì²­ì‚°ìˆœ</option>
          <option value="pnl">ì†ìµê¸ˆì•¡ìˆœ</option>
          <option value="rate">ìˆ˜ìµë¥ ìˆœ</option>
          <option value="days">ë³´ìœ ê¸°ê°„ìˆœ</option>
        </select>
      </div>
    </div>
    <div class="tbl-wrap">
      <table><thead><tr>
  <th>ì¢…ëª©</th>
  <th>ì‹œì¥</th>
  <th style="text-align:right">ë§¤ìˆ˜ì¼</th>
  <th style="text-align:right">ë§¤ë„ì¼</th>
  <th style="text-align:right">í‰ê· ë§¤ìˆ˜ê°€</th>
  <th style="text-align:right">í‰ê· ë§¤ë„ê°€</th>
  <th style="text-align:right">íˆ¬ìê¸ˆì•¡</th>
  <th style="text-align:right">ì†ìµê¸ˆì•¡</th>
  <th style="text-align:right">ìˆ˜ìµë¥ </th>
  <th style="text-align:right">ë³´ìœ ê¸°ê°„</th>
  <th style="text-align:center">ê´€ë¦¬</th>
</tr></thead>
      <tbody id="closed-tbody"></tbody></table>
      <div class="empty" id="closed-empty" style="display:none"><div class="ico">ğŸ“‹</div><div>ì²­ì‚° ì™„ë£Œ í¬ì§€ì…˜ì´ ì—†ìŠµë‹ˆë‹¤</div></div>
    <!-- ë¹ ë¥¸ ë©”ëª¨ íŒ¨ë„ -->
    <div id="quick-memo-panel" style="display:none;position:fixed;bottom:80px;left:50%;transform:translateX(-50%);z-index:400;background:var(--surface);border:1.5px solid var(--border);border-radius:12px;padding:14px 16px;width:340px;box-shadow:0 8px 32px rgba(0,0,0,.15)">
      <div style="font-size:12px;color:var(--muted);margin-bottom:8px" id="qm-title">ë¹ ë¥¸ ë©”ëª¨</div>
      <textarea id="qm-note" class="fi" style="height:70px;resize:none;font-size:13px" placeholder="ì´ ê±°ë˜ì— ëŒ€í•œ ë©”ëª¨..."></textarea>
      <div style="display:flex;gap:6px;margin-top:8px">
        <select id="qm-emotion" class="fi" style="flex:1;padding:6px 8px;font-size:12px">
          <option value="">ê°ì • ì„ íƒ</option>
          <option>ğŸ˜ ëƒ‰ì •</option><option>ğŸ˜¤ í¥ë¶„</option><option>ğŸ˜° ë¶ˆì•ˆ</option><option>ğŸ’ª í™•ì‹ </option><option>ğŸ˜± FOMO</option>
        </select>
        <select id="qm-strategy" class="fi" style="flex:1;padding:6px 8px;font-size:12px">
          <option value="">ì „ëµ ì„ íƒ</option>
          <option>ì´ë™í‰ê· ì„ </option><option>RSI</option><option>ë³¼ë¦°ì €ë°´ë“œ</option><option>MACD</option>
          <option>ì§€ì§€/ì €í•­ì„ </option><option>ë‰´ìŠ¤/ê³µì‹œ</option><option>ìˆ˜ê¸‰/ê¸°ê´€</option><option>ê°€ì¹˜íˆ¬ì</option><option>ê°/ì§ê´€</option>
        </select>
      </div>
      <div style="display:flex;gap:6px;margin-top:8px">
        <button class="btn btn-primary btn-sm" style="flex:1" onclick="saveQuickMemo()">ì €ì¥</button>
        <button class="btn btn-outline btn-sm" onclick="closeQuickMemo()">ì·¨ì†Œ</button>
      </div>
    </div>
    </div>
  </div>
</div>

<!-- â”€â”€ ë¶„ì„ â”€â”€ -->
<div id="view-analytics" style="display:none">
  <div id="hint-analytics" class="hint-card">
    <div class="hint-icon">ğŸ“ˆ</div>
    <div class="hint-body">
      <div class="hint-title">ë§¤ë§¤ ë¶„ì„ ì°¨íŠ¸</div>
      <div class="hint-text">ì²­ì‚° ì™„ë£Œ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ íŒ¨í„´ì„ ë¶„ì„í•´ìš”. ë¹¨ê°„ìƒ‰=ìˆ˜ìµ / íŒŒë€ìƒ‰=ì†ì‹¤</div>
    </div>
    <button class="hint-close" onclick="closeHint('analytics')">Ã—</button>
  </div>

  <!-- Row 0: í•µì‹¬ ì§€í‘œ + AI ë¶„ì„ -->
  <div class="two-col" style="margin-bottom:0">
    <div class="section" style="margin-bottom:0">
      <div class="sec-hdr"><span class="sec-title">ğŸ“Š í•µì‹¬ ì§€í‘œ</span></div>
      <div style="padding:14px 18px;display:grid;grid-template-columns:1fr 1fr;gap:9px" id="kpi-grid"></div>
    </div>
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:14px;overflow:hidden">
      <div style="background:linear-gradient(135deg,rgba(0,102,255,.15),rgba(0,229,160,.08));padding:13px 18px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:8px">
        <span style="width:7px;height:7px;border-radius:50%;background:var(--accent);animation:pulse 2s infinite;display:inline-block"></span>
        <span style="font-size:14px;font-weight:700">AI ë§¤ë§¤ ë¶„ì„</span>
        <span style="font-size:11px;color:var(--muted);margin-left:auto">Claude AI</span>
      </div>
      <div style="padding:16px 18px;min-height:120px;font-size:13px;line-height:1.9;color:#b0b8cc" id="ai-content">
        <div style="color:var(--muted);text-align:center;padding:20px 0">ğŸ¤– AIê°€ ë§¤ë§¤ íŒ¨í„´ì„ ë¶„ì„í•©ë‹ˆë‹¤<br><span style="font-size:12px">ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ì„¸ìš”</span></div>
      </div>
      <div style="padding:0 18px 14px"><button class="btn btn-ai" style="width:100%" onclick="runAI()">ğŸ¤– AI ì¢…í•© ë¶„ì„ ì‹¤í–‰</button></div>
    </div>
  </div>

  <!-- Row 1: ìë³¸ê¸ˆ ì„±ì¥ ê³¡ì„  (ì „ì²´ë„ˆë¹„) -->
  <div class="chart-sec chart-sec--hero">
    <div class="chart-hdr">
      <span>ğŸ“ˆ ìë³¸ê¸ˆ ì„±ì¥ ê³¡ì„ </span>
      <span id="curve-info" class="chart-kpi"></span>
    </div>
    <div class="chart-body chart-body--tall"><canvas id="cv-curve"></canvas></div>
  </div>

  <!-- Row 2: ì›”ë³„ ì†ìµ (ì „ì²´ë„ˆë¹„) -->
  <div class="chart-sec chart-sec--hero">
    <div class="chart-hdr">
      <span>ğŸ“… ì›”ë³„ ì†ìµ</span>
      <span id="monthly-info" class="chart-kpi"></span>
    </div>
    <div class="chart-body chart-body--tall"><canvas id="cv-monthly"></canvas></div>
  </div>

  <!-- Row 3: 3ì—´ -->
  <div class="chart-grid-3">
    <div class="chart-sec">
      <div class="chart-hdr">ğŸ—“ ìš”ì¼ë³„ ìˆ˜ìµ íˆíŠ¸ë§µ</div>
      <div class="chart-body">
        <div class="hm-labels" id="hm-labels"></div>
        <div class="hm-grid" id="hm-grid"></div>
        <div style="display:flex;align-items:center;gap:5px;margin-top:8px;font-size:10px;color:var(--muted)">
          <span>ì†ì‹¤</span><div id="hm-legend" style="display:flex;gap:2px"></div><span>ìˆ˜ìµ</span>
        </div>
      </div>
    </div>
    <div class="chart-sec">
      <div class="chart-hdr">ğŸ¯ ì „ëµë³„ ì„±ê³¼</div>
      <div class="chart-body" id="strategy-body"></div>
    </div>
    <div class="chart-sec">
      <div class="chart-hdr">ğŸ˜¶ ê°ì • ìƒíƒœë³„ ìˆ˜ìµë¥ </div>
      <div class="chart-body" id="emotion-body"></div>
    </div>
  </div>

  <!-- Row 4: ì‚°ì ë„ (ì „ì²´ë„ˆë¹„) -->
  <div class="chart-sec chart-sec--hero">
    <div class="chart-hdr">
      <span>â± ë³´ìœ ê¸°ê°„ vs ìˆ˜ìµë¥  ì‚°ì ë„</span>
      <span style="font-size:11px;color:var(--muted);font-weight:400">â— ìˆ˜ìµ(ë¹¨ê°•) â— ì†ì‹¤(íŒŒë‘) â€” ì› í¬ê¸° = íˆ¬ìê¸ˆ ê·œëª¨</span>
    </div>
    <div class="chart-body chart-body--tall"><canvas id="cv-scatter"></canvas></div>
  </div>

  <!-- Row 5: 2ì—´ -->
  <div class="two-col">
    <div class="chart-sec">
      <div class="chart-hdr">ğŸ… ì¢…ëª©ë³„ ëˆ„ì  ì†ìµ</div>
      <div class="chart-body" id="symbol-body"></div>
    </div>
    <div class="chart-sec">
      <div class="chart-hdr" style="display:flex;justify-content:space-between;align-items:center">
        <span>ğŸ“Š ê±°ë˜ë³„ ëˆ„ì  ì†ìµ</span>
        <select id="pnl-trail-filter" class="fi" style="width:90px;padding:4px 8px;font-size:11px" onchange="drawPnlTrail()">
          <option value="all">ì „ì²´</option>
          <option value="KRW">KRW</option>
          <option value="USD">USD</option>
        </select>
      </div>
      <div class="chart-body"><canvas id="cv-pnl-trail" height="180"></canvas></div>
    </div>
  </div>

  <!-- Row 6: 2ì—´ -->
  <div class="two-col">
    <div class="chart-sec">
      <div class="chart-hdr">ğŸ”¥ ê³ ë¹ˆë„ ê±°ë˜ ì¢…ëª©</div>
      <div class="chart-body" id="freq-body"></div>
    </div>
    <div class="chart-sec">
      <div class="chart-hdr">ğŸ¥§ ë³´ìœ  ì¢…ëª© íˆ¬ìë¹„ì¤‘</div>
      <div class="chart-body" style="display:flex;align-items:center;gap:20px;flex-wrap:wrap" id="pie-wrap">
        <canvas id="cv-pie2" width="160" height="160" style="flex-shrink:0"></canvas>
        <div id="pie-legend" style="font-size:12px;line-height:1.9;min-width:140px;max-height:160px;overflow-y:auto"></div>
      </div>
    </div>
  </div>

  <!-- Row 7: ë³´ìœ ê¸°ê°„ ì ê²€ -->
  <div class="section" style="margin-top:4px">
    <div class="sec-hdr"><span class="sec-title">â° ì¥ê¸° ë³´ìœ  ì ê²€</span></div>
    <div style="padding:12px 18px" id="hold-alert-list">
      <div style="color:var(--muted);font-size:13px">ì¥ê¸° ë³´ìœ  í¬ì§€ì…˜ ì—†ìŒ âœ…</div>
    </div>
  </div>

</div>

<!-- â”€â”€ ìº˜ë¦°ë” â”€â”€ -->
<div id="view-calendar" style="display:none">
  <div id="hint-calendar" class="hint-card">
    <div class="hint-icon">ğŸ“…</div>
    <div class="hint-body">
      <div class="hint-title">ë§¤ë§¤ ìº˜ë¦°ë”</div>
      <div class="hint-text">ë‚ ì§œë³„ë¡œ ë§¤ë§¤ ë‚´ì—­ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆì–´ìš”. ì´ˆë¡ ì ì€ ë§¤ìˆ˜, ë¹¨ê°„ ì ì€ ë§¤ë„ì˜ˆìš”. ë‚ ì§œë¥¼ í´ë¦­í•˜ë©´ ê·¸ë‚ ì˜ ìƒì„¸ ë‚´ì—­ì´ ë‚˜ì™€ìš”.</div>
      <div class="hint-tips">
        <span class="hint-tip">ğŸ’¡ â—€ â–¶ ë²„íŠ¼ìœ¼ë¡œ ì›” ì´ë™</span>
        <span class="hint-tip">ğŸ’¡ íŒŒë€ í…Œë‘ë¦¬ê°€ ì˜¤ëŠ˜ ë‚ ì§œì˜ˆìš”</span>
      </div>
    </div>
    <button class="hint-close" onclick="closeHint('calendar')">Ã—</button>
  </div>
  <div class="section">
    <div class="sec-hdr">
      <div style="display:flex;align-items:center;gap:10px">
        <button class="btn btn-outline btn-sm" onclick="calMove(-1)">â—€</button>
        <span style="font-size:15px;font-weight:700" id="cal-label"></span>
        <button class="btn btn-outline btn-sm" onclick="calMove(1)">â–¶</button>
      </div>
      <div style="font-size:12px;color:var(--muted)" id="cal-summary"></div>
    </div>
    <div style="padding:14px">
      <div class="cal-outer">
        <div class="cal-main">
          <div class="cal-hdr-row"><div class="cal-dhdr">ì¼</div><div class="cal-dhdr">ì›”</div><div class="cal-dhdr">í™”</div><div class="cal-dhdr">ìˆ˜</div><div class="cal-dhdr">ëª©</div><div class="cal-dhdr">ê¸ˆ</div><div class="cal-dhdr">í† </div></div>
          <div class="cal-grid" id="cal-grid"></div>
        </div>
        <div class="cal-week-col" id="cal-week-col">
          <div class="cal-week-hdr">ì£¼ë³„ í•©ê³„</div>
        </div>
      </div>
      <!-- ì›”ë³„ í•©ê³„ -->
      <div id="cal-month-sum" style="margin-top:12px;padding:12px 14px;background:var(--s2);border:1px solid var(--border);border-radius:10px;display:flex;gap:20px;flex-wrap:wrap;font-size:12px"></div>
    </div>
  </div>
</div>

<!-- â”€â”€ í†µê³„ â”€â”€ -->


<!-- â•â•â•â•â•â•â•â•â•â• ğŸ“„ ë¦¬í¬íŠ¸ â•â•â•â•â•â•â•â•â•â• -->
<div id="view-report" style="display:none">
  <div id="hint-report" class="hint-card">
    <div class="hint-icon">ğŸ“„</div>
    <div class="hint-body">
      <div class="hint-title">ì¼ê°„ Â· ì£¼ê°„ Â· ì›”ê°„ ë¦¬í¬íŠ¸</div>
      <div class="hint-text">ê¸°ê°„ì„ ì„ íƒí•˜ë©´ ë§¤ë§¤ ìš”ì•½, ê°ì • ë¶„ì„, ì „ëµë³„ ì„±ê³¼, ëª©í‘œ ë‹¬ì„±ë¥ ì„ ìë™ìœ¼ë¡œ ì •ë¦¬í•´ì¤˜ìš”. PDFë¡œ ì €ì¥í•´ì„œ ë³´ê´€í•  ìˆ˜ ìˆì–´ìš”.</div>
      <div class="hint-tips">
        <span class="hint-tip">ğŸ’¡ PDF ì €ì¥ì€ "PDF ì €ì¥" ë²„íŠ¼ í´ë¦­</span>
        <span class="hint-tip">ğŸ’¡ ê¸°ê°„ ì§ì ‘ ì„¤ì •ë„ ê°€ëŠ¥í•´ìš”</span>
      </div>
    </div>
    <button class="hint-close" onclick="closeHint('report')">Ã—</button>
  </div>

  <!-- ë¦¬í¬íŠ¸ ì»¨íŠ¸ë¡¤ -->
  <div class="section" style="margin-bottom:16px">
    <div class="sec-hdr">
      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <span class="sec-title">ğŸ“„ ë¦¬í¬íŠ¸ ìƒì„±</span>
        <div style="display:flex;gap:5px">
          <button class="btn btn-sm" id="rpt-btn-daily"  onclick="setReportPeriod('daily')"  style="background:var(--accent);color:#0d1117;font-weight:700">ì¼ê°„</button>
          <button class="btn btn-outline btn-sm" id="rpt-btn-weekly" onclick="setReportPeriod('weekly')">ì£¼ê°„</button>
          <button class="btn btn-outline btn-sm" id="rpt-btn-monthly" onclick="setReportPeriod('monthly')">ì›”ê°„</button>
          <button class="btn btn-outline btn-sm" id="rpt-btn-custom" onclick="setReportPeriod('custom')">ì§ì ‘ì„¤ì •</button>
        </div>
        <div id="rpt-custom-range" style="display:none;gap:6px;align-items:center">
          <input type="date" class="fi" id="rpt-from" style="width:135px;padding:5px 9px;font-size:12px">
          <span style="color:var(--muted);font-size:12px">~</span>
          <input type="date" class="fi" id="rpt-to" style="width:135px;padding:5px 9px;font-size:12px">
          <button class="btn btn-primary btn-sm" onclick="genFullReport()">ì¡°íšŒ</button>
        </div>
      </div>
      <div style="display:flex;gap:7px">
        <button class="btn btn-outline btn-sm" onclick="genFullReport()">ğŸ”„ ìƒì„±</button>
        <button class="btn btn-save btn-sm" onclick="exportReportPDF()">ğŸ“¥ PDF ì €ì¥</button>
      </div>
    </div>
  </div>

  <!-- ë¦¬í¬íŠ¸ ë³¸ë¬¸ (PDF ì¶œë ¥ ì˜ì—­) -->
  <div id="report-output">
    <div style="text-align:center;padding:52px;color:var(--muted)">
      <div style="font-size:32px;margin-bottom:10px;opacity:.4">ğŸ“„</div>
      <div style="font-size:13px">ìœ„ì—ì„œ ê¸°ê°„ì„ ì„ íƒí•˜ë©´ ë¦¬í¬íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤</div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• ğŸ“‹ ë³µê¸° ë¦¬í¬íŠ¸ â•â•â•â•â•â•â•â•â•â• -->
<div id="view-review-report" style="display:none">

  <!-- ì»¨íŠ¸ë¡¤ -->
  <div class="section" style="margin-bottom:16px">
    <div class="sec-hdr">
      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <span class="sec-title">ğŸ“‹ ë³µê¸° ë¦¬í¬íŠ¸</span>
        <div style="display:flex;gap:5px">
          <button class="btn btn-sm" id="rvr-btn-all"    onclick="genReviewReport('all')"    style="background:var(--accent);color:#0d1117;font-weight:700">ì „ì²´</button>
          <button class="btn btn-outline btn-sm" id="rvr-btn-weekly"  onclick="genReviewReport('weekly')">ì£¼ê°„</button>
          <button class="btn btn-outline btn-sm" id="rvr-btn-monthly" onclick="genReviewReport('monthly')">ì›”ê°„</button>
        </div>
      </div>
      <button class="btn btn-outline btn-sm" onclick="genReviewReport()">ğŸ”„ ìƒì„±</button>
    </div>
  </div>

  <!-- ë³¸ë¬¸ -->
  <div id="review-report-output">
    <div style="text-align:center;padding:52px;color:var(--muted)">
      <div style="font-size:32px;margin-bottom:10px;opacity:.4">ğŸ“‹</div>
      <div style="font-size:13px">ë³µê¸°ê°€ ì €ì¥ëœ ì¢…ëª©ì´ ì—†ì–´ìš”.<br>ì²­ì‚°ì™„ë£Œ íƒ­ì—ì„œ ğŸ“Š ë³µê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ ë³µê¸°ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”!</div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• ğŸ’° ìê¸ˆê´€ë¦¬ â•â•â•â•â•â•â•â•â•â• -->
<div id="view-funds" style="display:none">
  <div id="hint-funds" class="hint-card">
    <div class="hint-icon">ğŸ’°</div>
    <div class="hint-body">
      <div class="hint-title">ìê¸ˆ ê´€ë¦¬</div>
      <div class="hint-text">ê³„ì¢Œë³„ ì…ì¶œê¸ˆ, ì‹ ìš©ì´ì, ìˆ˜ìˆ˜ë£Œë¥¼ í†µí•© ê´€ë¦¬í•´ìš”. ë§¤ë§¤ ì†ìµê³¼ í•©ì‚°í•œ <strong style="color:var(--accent)">ì‹¤ì œ ìˆœìì‚°</strong>ì„ ì •í™•íˆ íŒŒì•…í•  ìˆ˜ ìˆì–´ìš”.</div>
      <div class="hint-tips">
        <span class="hint-tip">ğŸ’¡ ê³„ì¢Œë¥¼ ë¨¼ì € ë“±ë¡í•œ ë’¤ ë‚´ì—­ì„ ì¶”ê°€í•˜ì„¸ìš”</span>
        <span class="hint-tip">ğŸ’¡ ìˆ˜ìˆ˜ë£ŒëŠ” ë§¤ë§¤ ê¸°ë¡ì—ì„œ ìë™ ì§‘ê³„ë¼ìš”</span>
        <span class="hint-tip">ğŸ’¡ ìˆœìì‚° = ì…ê¸ˆ - ì¶œê¸ˆ - ì´ì - ìˆ˜ìˆ˜ë£Œ + ì‹¤í˜„ì†ìµ</span>
      </div>
    </div>
    <button class="hint-close" onclick="closeHint('funds')">Ã—</button>
  </div>

  <!-- ìˆœìì‚° ìš”ì•½ ì¹´ë“œ -->
  <div id="funds-kpi" style="display:grid;grid-template-columns:repeat(5,1fr);gap:10px;margin-bottom:16px"></div>

  <div class="two-col">
    <div>
      <!-- ê³„ì¢Œ ê´€ë¦¬ -->
      <div class="section" style="margin-bottom:14px">
        <div class="sec-hdr">
          <span class="sec-title">ğŸ¦ ê³„ì¢Œ ê´€ë¦¬</span>
          <button class="btn btn-primary btn-sm" onclick="openAddAccount()">+ ê³„ì¢Œ ì¶”ê°€</button>
        </div>
        <div style="padding:12px 16px" id="accounts-list"></div>
      </div>

      <!-- ì…ì¶œê¸ˆ ë‚´ì—­ -->
      <div class="section" style="margin-bottom:14px">
        <div class="sec-hdr">
          <span class="sec-title">ğŸ’¸ ì…ì¶œê¸ˆ ë‚´ì—­</span>
          <button class="btn btn-primary btn-sm" onclick="openAddTx()">+ ë‚´ì—­ ì¶”ê°€</button>
        </div>
        <div class="tbl-wrap">
          <table>
            <thead><tr><th>ë‚ ì§œ</th><th>ê³„ì¢Œ</th><th>ìœ í˜•</th><th>ê¸ˆì•¡</th><th>ë©”ëª¨</th><th></th></tr></thead>
            <tbody id="tx-tbody"></tbody>
          </table>
          <div class="empty" id="tx-empty" style="display:none"><div class="ico">ğŸ’¸</div><div>ì…ì¶œê¸ˆ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</div></div>
        </div>
      </div>
    </div>

    <div>
      <!-- ì‹ ìš©ì´ì -->
      <div class="section" style="margin-bottom:14px">
        <div class="sec-hdr">
          <span class="sec-title">ğŸ“‰ ì‹ ìš©ì´ì</span>
          <button class="btn btn-danger btn-sm" onclick="openAddInterest()">+ ì´ì ì¶”ê°€</button>
        </div>
        <div class="tbl-wrap">
          <table>
            <thead><tr><th>ë‚ ì§œ</th><th>ê³„ì¢Œ</th><th>ì´ì</th><th>ë©”ëª¨</th><th></th></tr></thead>
            <tbody id="interest-tbody"></tbody>
          </table>
          <div class="empty" id="interest-empty" style="display:none"><div class="ico">ğŸ“‰</div><div>ì´ì ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</div></div>
        </div>
        <div style="padding:10px 16px;border-top:1px solid var(--border);display:flex;justify-content:space-between;font-size:13px">
          <span style="color:var(--muted)">ëˆ„ì  ì´ì</span>
          <span id="total-interest" style="font-family:'Roboto Mono',monospace;color:var(--loss)">â‚©0</span>
        </div>
      </div>

      <!-- ìˆ˜ìˆ˜ë£Œ ì§‘ê³„ -->
      <div class="section">
        <div class="sec-hdr"><span class="sec-title">ğŸ§¾ ìˆ˜ìˆ˜ë£Œ ì§‘ê³„</span></div>
        <div style="padding:14px 16px" id="fee-summary"></div>
      </div>
    </div>
  </div>
</div>

<!-- ê³„ì¢Œ ì¶”ê°€ ëª¨ë‹¬ -->
<div class="backdrop" id="m-account" onclick="backdropClose(this,event)">
<div class="modal modal-sm">
  <div class="modal-hdr"><span class="modal-title">ğŸ¦ ê³„ì¢Œ ì¶”ê°€</span><button class="xbtn" onclick="cm('m-account')">Ã—</button></div>
  <div class="modal-body">
    <div class="fg"><label class="flbl">ê³„ì¢Œëª… *</label><input class="fi" id="acc-name" placeholder="í‚¤ì›€ ì£¼ì‹ê³„ì¢Œ"></div>
    <div class="fg"><label class="flbl">ì¦ê¶Œì‚¬</label><input class="fi" id="acc-broker" placeholder="í‚¤ì›€ì¦ê¶Œ"></div>
    <div class="fg"><label class="flbl">ê³„ì¢Œ ìœ í˜•</label>
      <select class="fi" id="acc-type">
        <option value="stock">ì£¼ì‹</option>
        <option value="margin">ì‹ ìš©/ë°˜ëŒ€ë§¤ë§¤</option>
        <option value="futures">ì„ ë¬¼/ì˜µì…˜</option>
        <option value="isa">ISA</option>
        <option value="pension">ì—°ê¸ˆì €ì¶•</option>
        <option value="overseas">í•´ì™¸ì£¼ì‹</option>
      </select>
    </div>
    <div class="fg"><label class="flbl">ë©”ëª¨</label><input class="fi" id="acc-memo" placeholder="ë©”ëª¨"></div>
    <div style="display:flex;gap:8px;margin-top:4px">
      <button class="btn btn-outline" style="flex:1" onclick="cm('m-account')">ì·¨ì†Œ</button>
      <button class="btn btn-primary" style="flex:1" onclick="saveAccount()">ì €ì¥</button>
    </div>
  </div>
</div>
</div>

<!-- ì…ì¶œê¸ˆ ì¶”ê°€ ëª¨ë‹¬ -->
<div class="backdrop" id="m-tx" onclick="backdropClose(this,event)">
<div class="modal modal-sm">
  <div class="modal-hdr"><span class="modal-title" id="tx-modal-title">ğŸ’¸ ì…ì¶œê¸ˆ ë‚´ì—­ ì¶”ê°€</span><button class="xbtn" onclick="cm('m-tx')">Ã—</button></div>
  <div class="modal-body">
    <div class="fr">
      <div class="fg"><label class="flbl">ë‚ ì§œ *</label><input type="date" class="fi" id="tx-date"></div>
      <div class="fg"><label class="flbl">ìœ í˜• *</label>
        <select class="fi" id="tx-type" onchange="onTxTypeChg()">
          <option value="deposit">ì…ê¸ˆ</option>
          <option value="withdraw">ì¶œê¸ˆ</option>
        </select>
      </div>
    </div>
    <div class="fg"><label class="flbl">ê³„ì¢Œ</label>
      <select class="fi" id="tx-account"></select>
    </div>
    <div class="fg"><label class="flbl">ê¸ˆì•¡ (ì›) *</label><input type="number" class="fi" id="tx-amount" placeholder="0"></div>
    <div class="fg"><label class="flbl">ë©”ëª¨</label><input class="fi" id="tx-memo" placeholder="ì›”ê¸‰ ì…ê¸ˆ, ìƒí™œë¹„ ì¶œê¸ˆ..."></div>
    <div style="display:flex;gap:8px;margin-top:4px">
      <button class="btn btn-outline" style="flex:1" onclick="cm('m-tx')">ì·¨ì†Œ</button>
      <button class="btn btn-primary" style="flex:1" onclick="saveTx()">ì €ì¥</button>
    </div>
  </div>
</div>
</div>

<!-- ì´ì ì¶”ê°€ ëª¨ë‹¬ -->
<div class="backdrop" id="m-interest" onclick="backdropClose(this,event)">
<div class="modal modal-sm">
  <div class="modal-hdr"><span class="modal-title">ğŸ“‰ ì‹ ìš©ì´ì ì¶”ê°€</span><button class="xbtn" onclick="cm('m-interest')">Ã—</button></div>
  <div class="modal-body">
    <div class="fr">
      <div class="fg"><label class="flbl">ë‚ ì§œ *</label><input type="date" class="fi" id="int-date"></div>
      <div class="fg"><label class="flbl">ê³„ì¢Œ</label>
        <select class="fi" id="int-account"></select>
      </div>
    </div>
    <div class="fg"><label class="flbl">ì´ìê¸ˆì•¡ (ì›) *</label><input type="number" class="fi" id="int-amount" placeholder="0"></div>
    <div class="fg"><label class="flbl">ì´ììœ¨ (%/ë…„)</label><input type="number" class="fi" id="int-rate" placeholder="ì—° 9.0" step="0.1"></div>
    <div class="fg"><label class="flbl">ë©”ëª¨</label><input class="fi" id="int-memo" placeholder="ë°˜ëŒ€ë§¤ë§¤ ì´ì, ì‹ ìš©ìœµì ì´ì..."></div>
    <div style="display:flex;gap:8px;margin-top:4px">
      <button class="btn btn-outline" style="flex:1" onclick="cm('m-interest')">ì·¨ì†Œ</button>
      <button class="btn btn-danger" style="flex:1" onclick="saveInterest()">ì´ì ê¸°ë¡</button>
    </div>
  </div>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• ë¦¬ìŠ¤í¬ ê´€ë¦¬ + ìì‚°ë°°ë¶„ â•â•â•â•â•â•â•â•â•â• -->
<!-- â”€â”€ ëŒ€ì‹œë³´ë“œ í™ˆ â”€â”€ -->


<!-- â”€â”€ íƒ€ì„ë¼ì¸ â”€â”€ -->
<!-- â”€â”€ ì‹œì¥ì¼ì§€ â”€â”€ -->
<div id="view-journal" style="display:none">
  <!-- ì›” ë„¤ë¹„ + ì˜¤ëŠ˜ ì“°ê¸° -->
  <div style="display:flex;gap:10px;margin-bottom:16px;flex-wrap:wrap;align-items:center;justify-content:space-between">
    <div style="display:flex;align-items:center;gap:8px">
      <button class="btn btn-outline btn-sm" onclick="jnlPrevMonth()">â€¹</button>
      <input type="month" class="fi" id="jnl-month" style="width:140px;padding:7px 10px;text-align:center" onchange="renderJournal()">
      <button class="btn btn-outline btn-sm" onclick="jnlNextMonth()">â€º</button>
    </div>
    <div style="display:flex;gap:7px;align-items:center">
      <span id="jnl-streak-badge" style="font-size:12px;color:var(--accent)"></span>
      <button class="btn btn-primary btn-sm" onclick="openJournalWrite()">âœï¸ ì˜¤ëŠ˜ ì¼ì§€ ì“°ê¸°</button>
    </div>
  </div>

  <!-- ì´ë‹¬ ìš”ì•½ KPI -->
  <div id="jnl-month-kpi" style="display:grid;grid-template-columns:repeat(5,1fr);gap:8px;margin-bottom:16px"></div>

  <!-- ë‚ ì§œë³„ ì¼ì§€ ëª©ë¡ -->
  <div id="journal-list" style="display:flex;flex-direction:column;gap:10px"></div>
</div>

<!-- â”€â”€ ì „ëµ ë¹„êµ â”€â”€ -->
<div id="view-compare" style="display:none">

  <!-- ë¹„êµ ëŒ€ìƒ ì„ íƒ -->
  <div style="display:flex;gap:10px;align-items:center;margin-bottom:16px;flex-wrap:wrap">
    <div style="font-size:13px;font-weight:700;color:var(--text)">ë¹„êµí•  ì „ëµ ì„ íƒ</div>
    <select class="fi" id="cmp-left"  style="width:160px" onchange="renderCompare()">
      <option value="minervini">âš¡ ë¯¸ë„ˆë¹„ë‹ˆ</option>
      <option value="turtle">ğŸ¢ í„°í‹€</option>
      <option value="momentum">ğŸš€ ëª¨ë©˜í…€</option>
      <option value="value">ğŸ’ ê°€ì¹˜íˆ¬ì</option>
      <option value="swing">ğŸŒŠ ìŠ¤ìœ™</option>
      <option value="scalping">âš¡ ë‹¨ê¸°ìŠ¤ìº˜í•‘</option>
      <option value="growth">ğŸŒ± ì„±ì¥ì£¼</option>
    </select>
    <div style="font-size:18px;color:var(--muted)">vs</div>
    <select class="fi" id="cmp-right" style="width:160px" onchange="renderCompare()">
      <option value="turtle" selected>ğŸ¢ í„°í‹€</option>
      <option value="minervini">âš¡ ë¯¸ë„ˆë¹„ë‹ˆ</option>
      <option value="momentum">ğŸš€ ëª¨ë©˜í…€</option>
      <option value="value">ğŸ’ ê°€ì¹˜íˆ¬ì</option>
      <option value="swing">ğŸŒŠ ìŠ¤ìœ™</option>
      <option value="scalping">âš¡ ë‹¨ê¸°ìŠ¤ìº˜í•‘</option>
      <option value="growth">ğŸŒ± ì„±ì¥ì£¼</option>
    </select>
  </div>

  <!-- ë‚˜ë€íˆ ë¹„êµ ì¹´ë“œ -->
  <div id="cmp-header" style="display:grid;grid-template-columns:200px 1fr 1fr;gap:2px;margin-bottom:2px"></div>
  <div id="cmp-body"   style="display:flex;flex-direction:column;gap:2px"></div>

  <!-- ê³µí†µ ê³„ì‚°ê¸° -->
  <div style="margin-top:16px" id="cmp-calc-section">
    <div class="sec-card">
      <div class="sec-hdr"><span class="sec-title">ğŸ§® ë™ì¼ ì¢…ëª© ë‘ ì „ëµìœ¼ë¡œ ê³„ì‚°í•´ë³´ê¸°</span></div>
      <div style="padding:12px 14px">
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:12px">
          <div class="fg">
            <label class="flbl">ì´ ìì‚° (ì›)</label>
            <input type="number" class="fi" id="cmp-capital" placeholder="10000000" oninput="renderCmpCalc()">
          </div>
          <div class="fg">
            <label class="flbl">ë§¤ìˆ˜ê°€ (ì›)</label>
            <input type="number" class="fi" id="cmp-entry" placeholder="75000" oninput="renderCmpCalc()">
          </div>
          <div class="fg">
            <label class="flbl">ì†ì ˆê°€ (ì›)</label>
            <input type="number" class="fi" id="cmp-stop" placeholder="72000" oninput="renderCmpCalc()">
          </div>
          <div class="fg">
            <label class="flbl">N / ATR (ì›, í„°í‹€ìš©)</label>
            <input type="number" class="fi" id="cmp-atr" placeholder="1500" oninput="renderCmpCalc()">
          </div>
        </div>
        <div id="cmp-calc-result" style="display:grid;grid-template-columns:1fr 1fr;gap:12px"></div>
      </div>
    </div>
  </div>

</div>


<!-- â”€â”€ ë¦¬ìŠ¤í¬ â”€â”€ -->
<div id="view-risk" style="display:none">

  <!-- íˆ¬ì ìŠ¤íƒ€ì¼ ì„ íƒ -->
  <div class="sec-card" style="margin-bottom:14px">
    <div class="sec-hdr">
      <span class="sec-title">ğŸ¯ íˆ¬ì ìŠ¤íƒ€ì¼ ì„ íƒ</span>
      <span style="font-size:11px;color:var(--muted)">ì„ íƒí•˜ë©´ ë¦¬ìŠ¤í¬ ê¸°ì¤€ì´ ìë™ ì ìš©ë¼ìš”</span>
    </div>
    <div style="padding:12px 14px">
      <div style="display:flex;gap:7px;flex-wrap:wrap;margin-bottom:14px">
        <button class="invest-style-btn" data-style="minervini" onclick="pickInvestStyle(this)">âš”ï¸ ë¯¸ë„ˆë¹„ë‹ˆ SEPA</button>
        <button class="invest-style-btn" data-style="momentum"  onclick="pickInvestStyle(this)">ğŸš€ ëª¨ë©˜í…€</button>
        <button class="invest-style-btn" data-style="value"     onclick="pickInvestStyle(this)">ğŸ’ ê°€ì¹˜íˆ¬ì</button>
        <button class="invest-style-btn" data-style="swing"     onclick="pickInvestStyle(this)">ğŸŒŠ ìŠ¤ìœ™</button>
        <button class="invest-style-btn" data-style="scalping"  onclick="pickInvestStyle(this)">âš¡ ë‹¨ê¸°ìŠ¤ìº˜í•‘</button>
        <button class="invest-style-btn" data-style="growth"    onclick="pickInvestStyle(this)">ğŸŒ± ì„±ì¥ì£¼</button>
      </div>
      <div id="invest-style-desc" style="display:flex;flex-direction:column;gap:5px;font-size:12px;color:var(--muted);line-height:1.8;padding:10px 12px;background:var(--s2);border-radius:8px;border:1px solid var(--border)">
        <span style="color:var(--accent)">â† ìœ„ì—ì„œ íˆ¬ì ìŠ¤íƒ€ì¼ì„ ì„ íƒí•˜ë©´ ë§ì¶¤ ê°€ì´ë“œì™€ ë¦¬ìŠ¤í¬ ê¸°ì¤€ì´ ìë™ìœ¼ë¡œ ì ìš©ë¼ìš”</span>
      </div>
    </div>
  </div>

  <!-- ìŠ¤íƒ€ì¼ í•µì‹¬ ê°€ì´ë“œ ì¹´ë“œ -->
  <div class="sec-card" style="margin-bottom:14px">
    <div class="sec-hdr"><span class="sec-title">ğŸ“š í•µì‹¬ ê°€ì´ë“œ</span></div>
    <div style="padding:12px 14px;display:grid;grid-template-columns:repeat(auto-fill,minmax(210px,1fr));gap:10px" id="invest-guide-grid">
      <div style="color:var(--muted);font-size:13px;padding:8px">ìŠ¤íƒ€ì¼ì„ ì„ íƒí•˜ë©´ ê°€ì´ë“œê°€ í‘œì‹œë¼ìš”</div>
    </div>
  </div>

  <!-- ë¦¬ìŠ¤í¬ ê³„ì‚°ê¸° + í¬íŠ¸í´ë¦¬ì˜¤ í˜„í™© -->
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
    <div class="sec-card">
      <div class="sec-hdr"><span class="sec-title">ğŸ§® í¬ì§€ì…˜ ë¦¬ìŠ¤í¬ ê³„ì‚°ê¸°</span></div>
      <div style="padding:12px 14px;display:flex;flex-direction:column;gap:9px">
        <div class="fg">
          <label class="flbl">ì´ ìì‚° (ì›)</label>
          <input type="number" class="fi" id="r-capital" placeholder="ì˜ˆ: 10000000" oninput="calcRisk()">
        </div>
        <div class="fr">
          <div class="fg" style="flex:2">
            <label class="flbl">ë¦¬ìŠ¤í¬ ë¹„ìœ¨ <span id="r-risk-pct-label" style="color:var(--accent);font-weight:700">2%</span></label>
            <input type="range" id="r-risk-pct" min="0.5" max="10" step="0.5" value="2"
              oninput="document.getElementById('r-risk-pct-label').textContent=this.value+'%';calcRisk()"
              style="width:100%;accent-color:var(--accent);margin-top:6px">
          </div>
          <div class="fg" style="flex:1">
            <label class="flbl">ë¶„í•  íšŸìˆ˜</label>
            <select class="fi" id="r-splits" onchange="calcRisk()">
              <option value="1">1íšŒ</option>
              <option value="2" selected>2ë¶„í• </option>
              <option value="3">3ë¶„í• </option>
              <option value="4">4ë¶„í• </option>
            </select>
          </div>
        </div>
        <div class="fr">
          <div class="fg">
            <label class="flbl">ë§¤ìˆ˜ê°€ (ì›)</label>
            <input type="number" class="fi" id="r-entry" placeholder="ì§„ì…ê°€" oninput="calcRisk()">
          </div>
          <div class="fg">
            <label class="flbl">ì†ì ˆê°€ (ì›)</label>
            <input type="number" class="fi" id="r-stop" placeholder="ì†ì ˆê°€" oninput="calcRisk()">
          </div>
        </div>
        <div class="fg">
          <label class="flbl">ëª©í‘œê°€ (ì„ íƒ)</label>
          <input type="number" class="fi" id="r-target" placeholder="ëª©í‘œê°€ ì…ë ¥ ì‹œ ì†ìµë¹„ ê³„ì‚°" oninput="calcRisk()">
        </div>
        <div id="r-result" style="background:var(--s2);border-radius:8px;padding:12px;border:1px solid var(--border);font-size:13px;color:var(--muted);text-align:center">
          ìì‚°Â·ë§¤ìˆ˜ê°€Â·ì†ì ˆê°€ë¥¼ ì…ë ¥í•˜ì„¸ìš”
        </div>
      </div>
    </div>
    <div style="display:flex;flex-direction:column;gap:14px">
      <div class="sec-card">
        <div class="sec-hdr"><span class="sec-title">ğŸ“Š í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ìŠ¤í¬ í˜„í™©</span></div>
        <div style="padding:12px 14px" id="portfolio-risk"><div style="color:var(--muted);font-size:13px">ë³´ìœ  í¬ì§€ì…˜ì´ ì—†ìŠµë‹ˆë‹¤</div></div>
      </div>
      <div class="sec-card">
        <div class="sec-hdr"><span class="sec-title">ğŸ¥§ íˆ¬ì ë¹„ì¤‘</span></div>
        <div style="padding:12px 14px;display:flex;gap:14px;align-items:flex-start;flex-wrap:wrap">
          <canvas id="cv-pie" width="160" height="160" style="flex-shrink:0"></canvas>
          <div style="flex:1;min-width:120px">
            <div id="pie-legend" style="max-height:130px;overflow-y:auto;margin-bottom:8px"></div>
            <div id="alloc-bars" style="max-height:160px;overflow-y:auto"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- í„°í‹€ íŠ¸ë ˆì´ë”© ATR ê³„ì‚°ê¸° (í„°í‹€ ì„ íƒ ì‹œì—ë§Œ í‘œì‹œ) -->
  <div id="turtle-section" style="display:none;margin-top:14px">

    <!-- ATR ê³„ì‚°ê¸° -->
    <div class="sec-card" style="margin-bottom:14px">
      <div class="sec-hdr">
        <span class="sec-title">ğŸ“ N(ATR) ê¸°ë°˜ í¬ì§€ì…˜ ê³„ì‚°ê¸°</span>
        <span style="font-size:11px;color:var(--muted)">í„°í‹€ì˜ ëª¨ë“  ê³„ì‚°ì€ Nì—ì„œ ì‹œì‘í•´ìš”</span>
      </div>
      <div style="padding:12px 14px;display:grid;grid-template-columns:1fr 1fr;gap:14px">

        <!-- ì…ë ¥ -->
        <div style="display:flex;flex-direction:column;gap:9px">
          <div class="fg">
            <label class="flbl">ì´ ê³„ì¢Œ ìì‚° (ì›)</label>
            <input type="number" class="fi" id="t-capital" placeholder="ì˜ˆ: 10000000" oninput="calcTurtle()">
          </div>
          <div class="fg">
            <label class="flbl">N (ATR, 20ì¼ í‰ê· ë³€ë™í­) (ì›)</label>
            <input type="number" class="fi" id="t-atr" placeholder="ì˜ˆ: 1500" oninput="calcTurtle()">
          </div>
          <div class="fg">
            <label class="flbl">í˜„ì¬ ì£¼ê°€ (ì›)</label>
            <input type="number" class="fi" id="t-price" placeholder="ì˜ˆ: 75000" oninput="calcTurtle()">
          </div>
          <div class="fg">
            <label class="flbl">ì§„ì… ìœ ë‹› (1~4)</label>
            <select class="fi" id="t-unit" onchange="calcTurtle()">
              <option value="1" selected>1ìœ ë‹› (ì²« ì§„ì…)</option>
              <option value="2">2ìœ ë‹› (+0.5N ì¶”ê°€)</option>
              <option value="3">3ìœ ë‹› (+1.0N ì¶”ê°€)</option>
              <option value="4">4ìœ ë‹› (+1.5N ì¶”ê°€, ìµœëŒ€)</option>
            </select>
          </div>
          <div class="fg">
            <label class="flbl">ì‹œìŠ¤í…œ ì„ íƒ</label>
            <select class="fi" id="t-system" onchange="calcTurtle()">
              <option value="20">ì‹œìŠ¤í…œ 1 â€” 20ì¼ ì‹ ê³ ê°€ ì§„ì…</option>
              <option value="55">ì‹œìŠ¤í…œ 2 â€” 55ì¼ ì‹ ê³ ê°€ ì§„ì…</option>
            </select>
          </div>
        </div>

        <!-- ê²°ê³¼ -->
        <div>
          <div id="t-result" style="display:flex;flex-direction:column;gap:7px">
            <div style="color:var(--muted);font-size:13px;padding:16px;text-align:center;background:var(--s2);border-radius:8px;border:1px solid var(--border)">ê³„ì¢ŒÂ·NÂ·ì£¼ê°€ë¥¼ ì…ë ¥í•˜ë©´<br>ìœ ë‹› ìˆ˜ëŸ‰ê³¼ ì†ì ˆê°€ê°€ ê³„ì‚°ë¼ìš”</div>
          </div>
        </div>
      </div>
    </div>

    <!-- í„°í‹€ 4ìœ ë‹› í”¼ë¼ë¯¸ë”© í”Œëœ -->
    <div class="sec-card" style="margin-bottom:14px">
      <div class="sec-hdr">
        <span class="sec-title">ğŸ”¼ 4ìœ ë‹› í”¼ë¼ë¯¸ë”© í”Œëœ</span>
        <span style="font-size:11px;color:var(--muted)">Nê³¼ ì£¼ê°€ ì…ë ¥ í›„ ìë™ ê³„ì‚°</span>
      </div>
      <div style="padding:12px 14px">
        <div style="display:grid;grid-template-columns:auto 1fr 1fr 1fr 1fr;gap:7px;font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:.5px;padding:0 4px 6px">
          <span></span><span>ì§„ì…ê°€</span><span>ìˆ˜ëŸ‰</span><span>ì†ì ˆê°€</span><span>ëˆ„ì íˆ¬ì</span>
        </div>
        <div id="t-pyramid" style="display:flex;flex-direction:column;gap:5px">
          <div style="color:var(--muted);font-size:12px;padding:8px">ê³„ì¢ŒÂ·NÂ·ì£¼ê°€ ì…ë ¥ í›„ ìë™ í‘œì‹œë¼ìš”</div>
        </div>
        <div id="t-pyramid-summary" style="margin-top:10px"></div>
      </div>
    </div>

    <!-- í„°í‹€ ì§„ì…/ì²­ì‚° ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
    <div class="sec-card">
      <div class="sec-hdr"><span class="sec-title">âœ… í„°í‹€ ì‹œìŠ¤í…œ ê·œì¹™ ì²´í¬</span></div>
      <div style="padding:12px 14px;display:grid;grid-template-columns:1fr 1fr;gap:8px">

        <div style="grid-column:1/-1;font-size:11px;font-weight:700;color:var(--accent);text-transform:uppercase;letter-spacing:.8px;padding:2px 0">ì§„ì… ì „</div>
        <label class="vcp-check-item"><input type="checkbox"> <span>ì‹œìŠ¤í…œ 1: ì˜¤ëŠ˜ ì£¼ê°€ê°€ <b>20ì¼ ì‹ ê³ ê°€</b> ëŒíŒŒ í™•ì¸</span></label>
        <label class="vcp-check-item"><input type="checkbox"> <span>ì‹œìŠ¤í…œ 1: ì§ì „ 20ì¼ ëŒíŒŒê°€ <b>ì†ì‹¤</b>ë¡œ ëë‚¬ë‹¤ë©´ â†’ ì´ë²ˆì€ íŒ¨ìŠ¤, ì‹œìŠ¤í…œ 2ë¡œ ì „í™˜</span></label>
        <label class="vcp-check-item"><input type="checkbox"> <span>ìœ ë‹› ìˆ˜ëŸ‰ ê³„ì‚° ì™„ë£Œ (ê³„ì¢Œ 1% Ã· 2N)</span></label>
        <label class="vcp-check-item"><input type="checkbox"> <span>í˜„ì¬ ë³´ìœ  ìœ ë‹› ìˆ˜ 4 ë¯¸ë§Œ í™•ì¸</span></label>
        <label class="vcp-check-item"><input type="checkbox"> <span>ë™ì¼ ì‹œì¥êµ°(ì„¹í„°)ì—ì„œ 12ìœ ë‹› ì´í•˜ í™•ì¸</span></label>
        <label class="vcp-check-item"><input type="checkbox"> <span>ì „ì²´ ê³„ì¢Œ ìµœëŒ€ ìœ ë‹› í•œë„(í†µìƒ 20ìœ ë‹›) ì´í•˜ í™•ì¸</span></label>

        <div style="grid-column:1/-1;font-size:11px;font-weight:700;color:var(--loss);text-transform:uppercase;letter-spacing:.8px;padding:8px 0 2px">ì²­ì‚° ì¡°ê±´ (ë¨¼ì € ê±¸ë¦¬ëŠ” ê²ƒ ì ìš©)</div>
        <label class="vcp-check-item"><input type="checkbox"> <span>ì†ì ˆ: ì§„ì…ê°€ <b>-2N</b> ì´íƒˆ â†’ ì¦‰ì‹œ ì „ëŸ‰ ì²­ì‚°</span></label>
        <label class="vcp-check-item"><input type="checkbox"> <span>ì‹œìŠ¤í…œ 1 ì²­ì‚°: <b>10ì¼ ì‹ ì €ê°€</b> ì´íƒˆ</span></label>
        <label class="vcp-check-item"><input type="checkbox"> <span>ì‹œìŠ¤í…œ 2 ì²­ì‚°: <b>20ì¼ ì‹ ì €ê°€</b> ì´íƒˆ</span></label>
        <label class="vcp-check-item"><input type="checkbox"> <span>í”¼ë¼ë¯¸ë”© ì‹œ ê° ìœ ë‹› ì†ì ˆê°€ +0.5Nì”© ìƒí–¥ ì¡°ì • ì™„ë£Œ</span></label>

      </div>

      <!-- í„°í‹€ ì‹œìŠ¤í…œì˜ ì² í•™ -->
      <div style="margin:0 14px 14px;padding:12px 14px;background:rgba(29,111,242,.05);border:1.5px solid rgba(29,111,242,.15);border-radius:10px">
        <div style="font-size:12px;font-weight:700;color:var(--accent);margin-bottom:8px">ğŸ¢ ë¦¬ì²˜ë“œ ë°ë‹ˆìŠ¤ì˜ í•µì‹¬ ë©”ì‹œì§€</div>
        <div style="display:flex;flex-direction:column;gap:6px;font-size:12px;color:var(--muted);line-height:1.7">
          <div>ğŸ“– <b style="color:var(--text)">"íŠ¸ë ˆì´ë”©ì€ ê°€ë¥´ì¹  ìˆ˜ ìˆë‹¤"</b> â€” ê·œì¹™ë§Œ ì§€í‚¤ë©´ ëˆ„êµ¬ë‚˜ ëˆì„ ë²Œ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì¦ëª…í•˜ê¸° ìœ„í•´ í„°í‹€ ì‹¤í—˜ì„ ì‹œì‘í–ˆì–´ìš”</div>
          <div>ğŸ¯ <b style="color:var(--text)">ì†ì ˆì€ ë¹„ìš©ì´ ì•„ë‹Œ íˆ¬ì</b> â€” -2N ì†ì ˆì´ ëŠìŠ¨í•´ ë³´ì—¬ë„, ëŒ€í˜• ì¶”ì„¸ë¥¼ ë†“ì¹˜ì§€ ì•Šê¸° ìœ„í•œ ì¥ì¹˜ì˜ˆìš”. íƒ€ì´íŠ¸í•œ ì†ì ˆ = ì¦ì€ ì†ì ˆ = ëŒ€í˜• ì¶”ì„¸ ì¡°ê¸° ì´íƒˆ</div>
          <div>ğŸ“ˆ <b style="color:var(--text)">ìˆ˜ìµì€ ë‹¬ë¦¬ê²Œ ë‘ì–´ë¼</b> â€” í„°í‹€ì˜ ìˆ˜ìµì€ 10%, 20%ì—ì„œ ë‚˜ì˜¤ì§€ ì•Šì•„ìš”. 100~300% ëŒ€í˜• ì¶”ì„¸ ëª‡ ë²ˆì´ ì—°ê°„ ì„±ê³¼ë¥¼ ë§Œë“¤ì–´ìš”. ì¡°ê¸° ìµì ˆ ê¸ˆë¬¼</div>
          <div>ğŸ¤– <b style="color:var(--text)">ì‹œìŠ¤í…œì„ ì‹ ë¢°í•˜ë¼</b> â€” ì—°ì† ì†ì ˆ 5~10ë²ˆì€ ì •ìƒì´ì—ìš”. ì‹œìŠ¤í…œ ì˜ì‹¬ â†’ ê·œì¹™ ì´íƒˆ â†’ ëŒ€í˜• ì¶”ì„¸ ë†“ì¹¨ â†’ ë³µêµ¬ ë¶ˆê°€ëŠ¥í•œ ì†ì‹¤. ê·œì¹™ì´ ì „ë¶€ì˜ˆìš”</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â”€â”€ ë§¤ë§¤ê·œì¹™ â”€â”€ -->
<div id="view-rules" style="display:none">
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px">
    <div class="sec-card">
      <div class="sec-hdr">
        <span class="sec-title">âœ… ì§„ì… ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸</span>
        <span id="entry-check-count" style="font-size:12px;color:var(--accent)"></span>
      </div>
      <div style="padding:12px" id="entry-checklist"></div>
    </div>
    <div class="sec-card">
      <div class="sec-hdr">
        <span class="sec-title">ğŸšª ì²­ì‚° ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸</span>
        <span id="exit-check-count" style="font-size:12px;color:var(--accent)"></span>
      </div>
      <div style="padding:12px" id="exit-checklist"></div>
    </div>
  </div>
  <div class="sec-card" style="margin-bottom:14px">
    <div class="sec-hdr">
      <span class="sec-title">ğŸ“‹ ë‚˜ì˜ ë§¤ë§¤ ì›ì¹™</span>
      <button class="btn btn-primary btn-sm" onclick="openAddRule()">+ ì›ì¹™ ì¶”ê°€</button>
    </div>
    <div style="padding:12px" id="rules-list"></div>
  </div>
  <div class="sec-card">
    <div class="sec-hdr"><span class="sec-title">âš ï¸ ê·œì¹™ ìœ„ë°˜ ê¸°ë¡</span></div>
    <div style="padding:12px" id="violations-list"></div>
  </div>
</div>

<!-- â”€â”€ ì´ë²¤íŠ¸ â”€â”€ -->
<div id="view-events" style="display:none">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px;flex-wrap:wrap;gap:8px">
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <button class="fi btn-xs" id="ef-all" onclick="setEvtFilter('all')" style="padding:6px 12px;font-size:12px;border-radius:20px;background:var(--accent);color:#fff;border:none;cursor:pointer">ì „ì²´</button>
      <button class="fi btn-xs" id="ef-upcoming" onclick="setEvtFilter('upcoming')" style="padding:6px 12px;font-size:12px;border-radius:20px;background:var(--s2);color:var(--text);border:1px solid var(--border);cursor:pointer">ë‹¤ê°€ì˜¤ëŠ”</button>
      <button class="fi btn-xs" id="ef-past" onclick="setEvtFilter('past')" style="padding:6px 12px;font-size:12px;border-radius:20px;background:var(--s2);color:var(--text);border:1px solid var(--border);cursor:pointer">ì§€ë‚œ</button>
    </div>
    <button class="btn btn-primary btn-sm" onclick="openEventModal()">+ ì´ë²¤íŠ¸ ì¶”ê°€</button>
  </div>
  <div id="events-list"></div>
</div>

<!-- â”€â”€ ëª©í‘œ â”€â”€ -->
<div id="view-goals" style="display:none">
  <div id="goals-roadmap" style="margin-bottom:14px"></div>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px">
    <div class="sec-card">
      <div class="sec-hdr"><span class="sec-title">ğŸ“Š ëª©í‘œ í˜„í™©</span></div>
      <div style="padding:12px" id="goals-kpi"></div>
    </div>
    <div class="sec-card">
      <div class="sec-hdr"><span class="sec-title">âš¡ ì‹¤ì‹œê°„ ì§„í–‰</span></div>
      <div style="padding:12px" id="goals-realtime"></div>
    </div>
  </div>
  <div class="sec-card" style="margin-bottom:14px">
    <div class="sec-hdr">
      <span class="sec-title">ğŸ¯ ì§„í–‰ì¤‘ì¸ ëª©í‘œ</span>
      <button class="btn btn-primary btn-sm" onclick="openAddGoal()">+ ëª©í‘œ ì¶”ê°€</button>
    </div>
    <div style="padding:12px" id="goals-active"></div>
  </div>
  <div class="sec-card">
    <div class="sec-hdr"><span class="sec-title">âœ… ë‹¬ì„± ì™„ë£Œ</span></div>
    <div style="padding:12px" id="goals-done"></div>
  </div>
  <div id="goals-summary" style="margin-top:14px"></div>
</div>



<!-- â”€â”€ ì´ë²¤íŠ¸ ì¶”ê°€/ìˆ˜ì • ëª¨ë‹¬ â”€â”€ -->
<div class="backdrop" id="m-event" onclick="backdropClose(this,event)">
  <div class="modal" style="max-width:480px">
    <div class="modal-hdr">
      <span class="modal-title" id="event-modal-title">ğŸ”” ì´ë²¤íŠ¸ ì¶”ê°€</span>
      <button class="xbtn" onclick="cm('m-event')">Ã—</button>
    </div>
    <div style="display:flex;flex-direction:column;gap:12px;padding:4px 0">
      <div class="fg">
        <label class="flbl">ì œëª© *</label>
        <input class="fi" id="ev-title" placeholder="ì‚¼ì„±ì „ì ì‹¤ì ë°œí‘œ, ëŒ€ë²•ì› íŒê²° ë“±">
      </div>
      <div class="fg">
        <label class="flbl">ë‚ ì§œ *</label>
        <input class="fi" type="date" id="ev-date">
      </div>
      <div class="fg">
        <label class="flbl">ì¹´í…Œê³ ë¦¬</label>
        <select class="fi" id="ev-category">
          <option value="earnings">ğŸ“Š ì‹¤ì ë°œí‘œ</option>
          <option value="court">âš–ï¸ ë²•ì›/ê·œì œ</option>
          <option value="disclosure">ğŸ“¢ ê³µì‹œ/ë°œí‘œ</option>
          <option value="macro">ğŸŒ ê±°ì‹œê²½ì œ</option>
          <option value="dividend">ğŸ’° ë°°ë‹¹</option>
          <option value="etc">ğŸ“Œ ê¸°íƒ€</option>
        </select>
      </div>
      <div class="fg">
        <label class="flbl">í…Œë§ˆ</label>
        <div style="display:flex;flex-wrap:wrap;gap:6px;margin-bottom:8px" id="ev-theme-chips">
          <button type="button" class="theme-chip" data-theme="AIë°˜ë„ì²´" onclick="toggleThemeChip(this)">AIë°˜ë„ì²´</button>
          <button type="button" class="theme-chip" data-theme="2ì°¨ì „ì§€" onclick="toggleThemeChip(this)">2ì°¨ì „ì§€</button>
          <button type="button" class="theme-chip" data-theme="ë°”ì´ì˜¤" onclick="toggleThemeChip(this)">ë°”ì´ì˜¤</button>
          <button type="button" class="theme-chip" data-theme="ë°©ì‚°" onclick="toggleThemeChip(this)">ë°©ì‚°</button>
          <button type="button" class="theme-chip" data-theme="ë¡œë´‡" onclick="toggleThemeChip(this)">ë¡œë´‡</button>
          <button type="button" class="theme-chip" data-theme="ì›ì „" onclick="toggleThemeChip(this)">ì›ì „</button>
          <button type="button" class="theme-chip" data-theme="ì¡°ì„ " onclick="toggleThemeChip(this)">ì¡°ì„ </button>
          <button type="button" class="theme-chip" data-theme="ë°˜ë„ì²´" onclick="toggleThemeChip(this)">ë°˜ë„ì²´</button>
          <button type="button" class="theme-chip" data-theme="ê¸ˆìœµ" onclick="toggleThemeChip(this)">ê¸ˆìœµ</button>
          <button type="button" class="theme-chip" data-theme="í—¬ìŠ¤ì¼€ì–´" onclick="toggleThemeChip(this)">í—¬ìŠ¤ì¼€ì–´</button>
          <button type="button" class="theme-chip" data-theme="ê²Œì„" onclick="toggleThemeChip(this)">ê²Œì„</button>
          <button type="button" class="theme-chip" data-theme="ë¯¸êµ­ì£¼ì‹" onclick="toggleThemeChip(this)">ë¯¸êµ­ì£¼ì‹</button>
        </div>
        <input class="fi" id="ev-theme-custom" placeholder="ì§ì ‘ì…ë ¥ (ì˜ˆ: ìˆ˜ì†Œê²½ì œ, ì „ê¸°ì°¨ ë“±)" style="font-size:12px">
      </div>
      <div class="fg">
        <label class="flbl">ê´€ë ¨ ì¢…ëª© (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
        <input class="fi" id="ev-stocks" placeholder="ì‚¼ì„±ì „ì, SKí•˜ì´ë‹‰ìŠ¤">
      </div>
      <div class="fg">
        <label class="flbl">ë©”ëª¨</label>
        <textarea class="fi" id="ev-memo" rows="3" placeholder="ì´ ë‚  ì£¼ì˜í•´ì•¼ í•  ë‚´ìš©, ì˜ˆìƒ ì‹œë‚˜ë¦¬ì˜¤ ë“±" style="resize:vertical"></textarea>
      </div>
      <div class="fg">
        <label class="flbl">ë°˜ë³µ</label>
        <select class="fi" id="ev-repeat">
          <option value="none">ë°˜ë³µ ì—†ìŒ</option>
          <option value="yearly">ë§¤ë…„ ë°˜ë³µ</option>
        </select>
      </div>
    </div>
    <div style="display:flex;gap:8px;margin-top:16px">
      <button class="btn btn-outline" style="flex:1" onclick="cm('m-event')">ì·¨ì†Œ</button>
      <button class="btn btn-primary" style="flex:2" onclick="saveEvent()">ì €ì¥</button>
    </div>
  </div>
</div>

<!-- â”€â”€ ì¢…ëª©ì½”ë“œ ì¼ê´„ì…ë ¥ ëª¨ë‹¬ â”€â”€ -->
<div class="backdrop" id="m-bulk-ticker" onclick="backdropClose(this,event)">
  <div class="modal" style="max-width:520px">
    <div class="modal-hdr">
      <span class="modal-title">ğŸ· ì¢…ëª©ì½”ë“œ ì¼ê´„ ì…ë ¥</span>
      <button class="xbtn" onclick="cm('m-bulk-ticker')">Ã—</button>
    </div>
    <div style="padding:16px 18px 6px">
      <div style="font-size:12px;color:var(--muted);margin-bottom:14px;line-height:1.6">
        ì¢…ëª©ì½”ë“œê°€ ì—†ëŠ” í¬ì§€ì…˜ ëª©ë¡ì´ì—ìš”.<br>
        <span style="color:var(--accent)">êµ­ë‚´</span>ëŠ” 6ìë¦¬ ìˆ«ì (ì˜ˆ: 005930) Â· <span style="color:var(--warn)">ë¯¸êµ­</span>ì€ í‹°ì»¤ (ì˜ˆ: AAPL)
      </div>
      <div id="bulk-ticker-list" style="display:flex;flex-direction:column;gap:8px;max-height:400px;overflow-y:auto"></div>
      <div style="margin-top:8px;font-size:11px;color:var(--muted)" id="bulk-ticker-done-msg"></div>
    </div>
    <div style="padding:12px 18px;display:flex;gap:8px;justify-content:flex-end;border-top:1px solid var(--border)">
      <button class="btn btn-outline" onclick="cm('m-bulk-ticker')">ë‹«ê¸°</button>
      <button class="btn btn-primary" onclick="saveBulkTicker()">âœ… ì €ì¥</button>
    </div>
  </div>
</div>

<!-- â”€â”€ íŠ¸ë ˆì´ë”© ì €ë„ ì‘ì„± ëª¨ë‹¬ â”€â”€ -->
<div class="backdrop" id="m-journal" onclick="backdropClose(this,event)">
  <div class="modal" style="max-width:620px;max-height:90vh;overflow-y:auto">
    <div class="modal-hdr" style="position:sticky;top:0;background:var(--surface);z-index:1;border-bottom:1px solid var(--border)">
      <span class="modal-title" id="jnl-modal-title">ğŸ““ íŠ¸ë ˆì´ë”© ì €ë„</span>
      <div style="display:flex;align-items:center;gap:8px">
        <span id="jnl-date-display" style="font-size:12px;color:var(--muted)"></span>
        <button class="xbtn" onclick="cm('m-journal')">Ã—</button>
      </div>
    </div>
    <div style="padding:16px 20px;display:flex;flex-direction:column;gap:16px">

      <!-- ë‚ ì§œ (ìˆ¨ê¹€) -->
      <input type="hidden" id="jnl-date">
      <input type="hidden" id="jnl-edit-id">

      <!-- ë‹¹ì¼ P&L + ê±°ë˜ ë‚´ì—­ (ìë™) -->
      <div id="jnl-auto-trades" style="background:var(--s2);border:1.5px solid var(--border);border-radius:10px;padding:12px 14px">
        <div style="font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">ë‹¹ì¼ ë§¤ë§¤ í˜„í™© (ìë™)</div>
        <div id="jnl-trades-list" style="display:flex;flex-direction:column;gap:4px"></div>
      </div>

      <!-- ì‹¬ë¦¬ ìƒíƒœ -->
      <div>
        <div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;margin-bottom:8px">ì˜¤ëŠ˜ì˜ ì‹¬ë¦¬ ìƒíƒœ</div>
        <div style="display:flex;gap:8px">
          <button class="mood-pick" data-mood="ğŸ˜°" onclick="pickMood(this)" title="ë¶ˆì•ˆ">ğŸ˜°</button>
          <button class="mood-pick" data-mood="ğŸ˜" onclick="pickMood(this)" title="í‰ì •">ğŸ˜</button>
          <button class="mood-pick" data-mood="ğŸ˜Œ" onclick="pickMood(this)" title="ì¹¨ì°©">ğŸ˜Œ</button>
          <button class="mood-pick" data-mood="ğŸ”¥" onclick="pickMood(this)" title="ìì‹ ê°">ğŸ”¥</button>
          <button class="mood-pick" data-mood="ğŸ¤‘" onclick="pickMood(this)" title="ê³¼ìš•">ğŸ¤‘</button>
          <button class="mood-pick" data-mood="ğŸ˜¤" onclick="pickMood(this)" title="ì–µìš¸">ğŸ˜¤</button>
        </div>
      </div>

      <!-- ì‹œì¥ ì‹œí™© -->
      <div>
        <div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;margin-bottom:8px">ì‹œì¥ ì‹œí™©</div>
        <div style="display:flex;gap:6px;flex-wrap:wrap">
          <button class="sent-pick" data-sent="ê°•ì„¸" onclick="pickSent(this)">ğŸ“ˆ ê°•ì„¸</button>
          <button class="sent-pick" data-sent="ì•½ì„¸" onclick="pickSent(this)">ğŸ“‰ ì•½ì„¸</button>
          <button class="sent-pick" data-sent="í˜¼ì¡°" onclick="pickSent(this)">ğŸ”€ í˜¼ì¡°</button>
          <button class="sent-pick" data-sent="ê´€ë§" onclick="pickSent(this)">â¸ ê´€ë§</button>
          <button class="sent-pick" data-sent="ê¸‰ë“±" onclick="pickSent(this)">ğŸš€ ê¸‰ë“±</button>
          <button class="sent-pick" data-sent="ê¸‰ë½" onclick="pickSent(this)">ğŸ’¥ ê¸‰ë½</button>
        </div>
      </div>

      <!-- ë§¤ë§¤ ì „ëµ íƒœê·¸ -->
      <div>
        <div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;margin-bottom:8px">ì˜¤ëŠ˜ ì‚¬ìš©í•œ ì „ëµ</div>
                 <div style="display:flex;gap:6px;flex-wrap:wrap" id="strategy-tags">
          <button class="strat-pick" data-strat="VCPëŒíŒŒ"   onclick="toggleStrat(this)">âš”ï¸ VCPëŒíŒŒ</button>
          <button class="strat-pick" data-strat="í”¼ë²—ì§„ì…"   onclick="toggleStrat(this)">ğŸ¯ í”¼ë²—ì§„ì…</button>
          <button class="strat-pick" data-strat="í”¼ë¼ë¯¸ë”©"   onclick="toggleStrat(this)">ğŸ“ˆ í”¼ë¼ë¯¸ë”©</button>
          <button class="strat-pick" data-strat="ì¶”ì„¸ì¶”ì¢…"   onclick="toggleStrat(this)">ì¶”ì„¸ì¶”ì¢…</button>
          <button class="strat-pick" data-strat="ëª¨ë©˜í…€"     onclick="toggleStrat(this)">ëª¨ë©˜í…€</button>
          <button class="strat-pick" data-strat="ë¶„í• ë§¤ìˆ˜"   onclick="toggleStrat(this)">ë¶„í• ë§¤ìˆ˜</button>
          <button class="strat-pick" data-strat="ë¶„í• ë§¤ë„"   onclick="toggleStrat(this)">ë¶„í• ë§¤ë„</button>
          <button class="strat-pick" data-strat="ëˆŒë¦¼ë§¤ìˆ˜"   onclick="toggleStrat(this)">ëˆŒë¦¼ë§¤ìˆ˜</button>
          <button class="strat-pick" data-strat="ê°€ì¹˜íˆ¬ì"   onclick="toggleStrat(this)">ê°€ì¹˜íˆ¬ì</button>
          <button class="strat-pick" data-strat="ë‹¨ê¸°ìŠ¤ìº˜í•‘" onclick="toggleStrat(this)">ë‹¨ê¸°ìŠ¤ìº˜í•‘</button>
          <button class="strat-pick" data-strat="ì—­ì¶”ì„¸"     onclick="toggleStrat(this)">ì—­ì¶”ì„¸</button>
        </div>
      </div>

      <!-- ì œëª© -->
      <div>
        <div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;margin-bottom:6px">ì œëª©</div>
        <input type="text" class="fi" id="jnl-title" placeholder="ì˜¤ëŠ˜ ë§¤ë§¤ì˜ í•µì‹¬ í•œ ì¤„" style="font-size:14px;font-weight:600">
      </div>

      <!-- ë§¤ë§¤ ê·¼ê±° -->
      <div>
        <div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;margin-bottom:6px">ë§¤ë§¤ ê·¼ê±° / ì§„ì… ì´ìœ </div>
        <textarea class="fi" id="jnl-reason" rows="3" placeholder="ì™œ ë§¤ìˆ˜/ë§¤ë„í–ˆë‚˜ìš”? ì–´ë–¤ ê·¼ê±°ê°€ ìˆì—ˆë‚˜ìš”?" style="resize:vertical;line-height:1.7"></textarea>
      </div>

      <!-- ë°˜ì„±/ë³µê¸° -->
      <div>
        <div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;margin-bottom:6px">ë°˜ì„± / ë³µê¸°</div>
        <textarea class="fi" id="jnl-review" rows="3" placeholder="ì˜í•œ ê²ƒ, ì•„ì‰¬ìš´ ê²ƒ, ë‹¤ìŒì— ê°œì„ í•  ì " style="resize:vertical;line-height:1.7"></textarea>
      </div>

      <!-- ë‚´ì¼ ê³„íš -->
      <div>
        <div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;margin-bottom:6px">ë‚´ì¼ ê³„íš / ê´€ì‹¬ ì¢…ëª©</div>
        <textarea class="fi" id="jnl-plan" rows="2" placeholder="ë‚´ì¼ ì£¼ëª©í•  ì¢…ëª©, ê³„íš" style="resize:vertical;line-height:1.7"></textarea>
      </div>

      <!-- ê·œì¹™ ì¤€ìˆ˜ ì²´í¬ -->
      <div id="jnl-rules-check-section">
        <div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;margin-bottom:8px">íˆ¬ì ê·œì¹™ ì¤€ìˆ˜ ì²´í¬</div>
        <div id="jnl-rules-checklist" style="display:flex;flex-direction:column;gap:6px"></div>
      </div>

      <!-- ì»¤ìŠ¤í…€ íƒœê·¸ -->
      <div>
        <div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;margin-bottom:6px">ì¶”ê°€ íƒœê·¸ <span style="font-weight:300;text-transform:none">(ì‰¼í‘œ êµ¬ë¶„)</span></div>
        <input type="text" class="fi" id="jnl-tags-input" placeholder="ì˜ˆ: ë°˜ë„ì²´, ì‹¤ì ì‹œì¦Œ, ë³€ë™ì„±í™•ëŒ€">
      </div>

    </div>
    <div style="padding:12px 20px;display:flex;gap:8px;justify-content:space-between;border-top:1px solid var(--border);position:sticky;bottom:0;background:var(--surface)">
      <button class="btn btn-danger btn-sm" id="jnl-del-btn" style="display:none" onclick="deleteJournal()">ğŸ—‘ ì‚­ì œ</button>
      <div style="display:flex;gap:8px;margin-left:auto">
        <button class="btn btn-outline" onclick="cm('m-journal')">ì·¨ì†Œ</button>
        <button class="btn btn-primary" onclick="saveJournal()">ğŸ’¾ ì €ì¥</button>
      </div>
    </div>
  </div>
</div>

<!-- â”€â”€ ëª©í‘œ ì¶”ê°€ ëª¨ë‹¬ â”€â”€ -->
<div class="backdrop" id="m-add-goal" onclick="backdropClose(this,event)">
  <div class="modal" style="max-width:420px">
    <div class="modal-hdr"><span class="modal-title">ğŸ¯ ìƒˆ ëª©í‘œ ì„¤ì •</span><button class="xbtn" onclick="cm('m-add-goal')">Ã—</button></div>
    <div class="modal-body">
      <div class="fg" style="margin-bottom:10px"><label class="flbl">ëª©í‘œ ì´ë¦„</label><input class="fi" id="g-name" placeholder="2026ë…„ 1ì–µ ë‹¬ì„±"></div>
      <div class="fr" style="margin-bottom:10px">
        <div class="fg"><label class="flbl">ìœ í˜•</label>
          <select class="fi" id="g-type" onchange="onGoalTypeChg()">
            <option value="return">ìˆ˜ìµë¥  ëª©í‘œ</option>
            <option value="amount">ê¸ˆì•¡ ëª©í‘œ</option>
            <option value="winrate">ìŠ¹ë¥  ëª©í‘œ</option>
            <option value="trades">ê±°ë˜ íšŸìˆ˜</option>
          </select>
        </div>
        <div class="fg"><label class="flbl" id="g-val-lbl">ëª©í‘œê°’ (%)</label><input type="number" class="fi" id="g-value" placeholder="20"></div>
      </div>
      <div class="fr" style="margin-bottom:10px">
        <div class="fg"><label class="flbl">ë§ˆê°ì¼</label><input type="date" class="fi" id="g-deadline"></div>
      </div>
      <div class="fg"><label class="flbl">ë©”ëª¨</label><input class="fi" id="g-memo" placeholder="êµ¬ì²´ì ì¸ ê³„íš..."></div>
    </div>
    <div style="padding:12px 18px;display:flex;gap:8px;justify-content:flex-end;border-top:1px solid var(--border)">
      <button class="btn btn-outline" onclick="cm('m-add-goal')">ì·¨ì†Œ</button>
      <button class="btn btn-primary" onclick="saveGoal()">ì €ì¥</button>
    </div>
  </div>
</div>

<!-- â•â•â• MODAL: ìƒˆ í¬ì§€ì…˜ â•â•â• -->
<div class="backdrop" id="m-newpos" onclick="backdropClose(this,event)">
<div class="modal">
  <div class="modal-hdr"><span class="modal-title">ìƒˆ í¬ì§€ì…˜ ìƒì„±</span><button class="xbtn" onclick="cm('m-newpos')">Ã—</button></div>
  <div class="modal-body">
    <div class="fr">
      <div class="fg"><label class="flbl">ì¢…ëª©ëª… *</label><input class="fi" id="np-name" placeholder="ì‚¼ì„±ì „ì, AAPL"></div>
      <div class="fg"><label class="flbl">ì‹œì¥ *</label>
        <select class="fi" id="np-market" onchange="onMktChg()">
          <option value="KRX">êµ­ë‚´ (KRX)</option><option value="US">ë¯¸êµ­ (US)</option>
          <option value="CRYPTO">ì•”í˜¸í™”í</option><option value="FUTURES">ì„ ë¬¼/ì˜µì…˜</option>
        </select>
      </div>
    </div>
    <div class="fg">
      <label class="flbl" id="tkr-lbl">ì¢…ëª©ì½”ë“œ (êµ­ë‚´ ì‹œì„¸ ìë™ì¡°íšŒ)</label>
      <input class="fi" id="np-ticker" placeholder="005930">
      <div class="hint" id="tkr-hint">6ìë¦¬ ì½”ë“œ (ì˜ˆ: 005930 ì‚¼ì„±ì „ì) â€” <a href="https://finance.naver.com" target="_blank">ë„¤ì´ë²„ ê¸ˆìœµ</a></div>
    </div>
    <div class="fr">
      <div class="fg"><label class="flbl">í†µí™”</label>
        <select class="fi" id="np-currency"><option value="KRW">ì›í™” (â‚©)</option><option value="USD">ë‹¬ëŸ¬ ($)</option></select>
      </div>
      <div class="fg"><label class="flbl">ì „ëµ</label>
        <select class="fi" id="np-strategy">
          <option value="">ì„ íƒ</option><option>ì´ë™í‰ê· ì„ </option><option>RSI</option><option>ë³¼ë¦°ì €ë°´ë“œ</option>
          <option>MACD</option><option>ì§€ì§€/ì €í•­ì„ </option><option>ë‰´ìŠ¤/ê³µì‹œ</option>
          <option>ìˆ˜ê¸‰/ê¸°ê´€</option><option>ê°€ì¹˜íˆ¬ì</option><option>ê°/ì§ê´€</option><option>ê¸°íƒ€</option>
        </select>
      </div>
    </div>
    <div class="divider"></div>
    <div style="font-size:13px;font-weight:600;margin-bottom:9px;color:var(--accent)">ğŸ“¥ ì²« ë²ˆì§¸ ë§¤ìˆ˜</div>
    <div class="fr3">
      <div class="fg"><label class="flbl">ë§¤ìˆ˜ì¼ *</label><input type="date" class="fi" id="np-date"></div>
      <div class="fg"><label class="flbl">ë§¤ìˆ˜ê°€ *</label><input type="number" class="fi" id="np-price" placeholder="0" oninput="npPreview()"></div>
      <div class="fg"><label class="flbl">ìˆ˜ëŸ‰ *</label><input type="number" class="fi" id="np-qty" placeholder="0"></div>
    </div>
    <!-- ìê¸ˆìœ í˜• -->
    <div class="fg">
      <label class="flbl">ğŸ’³ ìê¸ˆ ìœ í˜•</label>
      <div style="display:flex;gap:6px">
        <button type="button" class="btn btn-sm fund-btn active-fund" id="np-ft-cash"   onclick="setFundType('np','cash')"   style="flex:1;background:rgba(52,211,153,.15);color:var(--profit);border:1px solid rgba(52,211,153,.3)">ğŸ’µ í˜„ê¸ˆ</button>
        <button type="button" class="btn btn-sm fund-btn" id="np-ft-credit" onclick="setFundType('np','credit')" style="flex:1;background:transparent;color:var(--muted);border:1px solid var(--border)">ğŸ’³ ì‹ ìš©</button>
        <button type="button" class="btn btn-sm fund-btn" id="np-ft-margin" onclick="setFundType('np','margin')" style="flex:1;background:transparent;color:var(--muted);border:1px solid var(--border)">âš¡ ë¯¸ìˆ˜</button>
      </div>
    </div>
    <div id="np-fund-detail" style="display:none">
      <div class="fr">
        <div class="fg"><label class="flbl" id="np-rate-lbl">ì´ììœ¨ (%/ë…„)</label><input type="number" class="fi" id="np-fund-rate" placeholder="9.0" step="0.1"></div>
        <div class="fg" id="np-margin-due-wrap" style="display:none"><label class="flbl">ê²°ì œì¼ (D+2)</label><input type="date" class="fi" id="np-margin-due"></div>
      </div>
    </div>
    <div class="fr">
      <div class="fg"><label class="flbl">ìˆ˜ìˆ˜ë£Œ</label><input type="number" class="fi" id="np-fee" placeholder="0"></div>
      <div class="fg"><label class="flbl">ê°ì •</label>
        <select class="fi" id="np-emotion"><option value="">ì„ íƒ</option><option>ğŸ˜ ëƒ‰ì •</option><option>ğŸ˜¤ í¥ë¶„</option><option>ğŸ˜° ë¶ˆì•ˆ</option><option>ğŸ’ª í™•ì‹ </option><option>ğŸ˜± FOMO</option></select>
      </div>
    </div>
    <div class="divider"></div>
    <div style="font-size:13px;font-weight:600;margin-bottom:9px;color:var(--warn)">ğŸ¯ ëª©í‘œê°€ &amp; ì†ì ˆê°€</div>
    <div class="fr">
      <div class="fg">
        <label class="flbl" style="color:var(--profit)">ğŸ¯ ëª©í‘œê°€</label>
        <input type="number" class="fi fi-t" id="np-target" placeholder="ë„ë‹¬ ì‹œ ì•Œë¦¼" oninput="npPreview()">
      </div>
      <div class="fg">
        <label class="flbl" style="color:var(--loss)">ğŸ›‘ ì†ì ˆê°€</label>
        <input type="number" class="fi fi-s" id="np-stop" placeholder="ë„ë‹¬ ì‹œ ì•Œë¦¼" oninput="npPreview()">
      </div>
    </div>
    <div id="np-preview" style="font-size:12px;color:var(--muted);margin:-4px 0 9px;min-height:16px"></div>
    <div class="fg"><label class="flbl">ë©”ëª¨</label><textarea class="fi" id="np-note" placeholder="ì§„ì… ì´ìœ , ëª©í‘œ, ì „ëµ..."></textarea></div>
    <!-- ì‚¬ì „ ê³„íš ì„¹ì…˜ -->
    <div style="border:1px solid var(--border);border-radius:10px;padding:12px 14px;background:rgba(0,153,255,.04);margin-bottom:4px">
      <div style="font-size:11px;font-weight:700;color:var(--accent);margin-bottom:10px;text-transform:uppercase;letter-spacing:.6px">ğŸ“‹ ì‚¬ì „ ê³„íš (ë‚˜ì¤‘ì— ë³µê¸°ì— ì‚¬ìš©ë¼ìš”)</div>
      <div class="fr">
        <div class="fg"><label class="flbl">ë¶„í• ë§¤ìˆ˜ ê³„íš</label>
          <select class="fi" id="np-split-plan">
            <option value="">ì„ íƒ</option>
            <option value="1">1íšŒ ì¼ê´„ë§¤ìˆ˜</option>
            <option value="2">2íšŒ ë¶„í• </option>
            <option value="3">3íšŒ ë¶„í• </option>
            <option value="4">4íšŒ ì´ìƒ ë¶„í• </option>
          </select>
        </div>
        <div class="fg"><label class="flbl">ì†ìµë¹„ ëª©í‘œ</label>
          <select class="fi" id="np-rr-plan">
            <option value="">ì„ íƒ</option>
            <option value="1">1:1</option>
            <option value="2">1:2</option>
            <option value="3">1:3 ì´ìƒ</option>
          </select>
        </div>
      </div>
      <div class="fg" style="margin-top:6px"><label class="flbl">ë§¤ìˆ˜ ê·¼ê±°</label>
        <select class="fi" id="np-entry-basis">
          <option value="">ì„ íƒ</option>
          <option value="tech">ê¸°ìˆ ì  ë¶„ì„ (ì§€ì§€ì„ /íŒ¨í„´/ê±°ë˜ëŸ‰)</option>
          <option value="fund">í€ë”ë©˜í„¸ (ì‹¤ì /ë°¸ë¥˜ì—ì´ì…˜)</option>
          <option value="news">ë‰´ìŠ¤/ê³µì‹œ</option>
          <option value="momentum">ëª¨ë©˜í…€/ì¶”ì„¸ì¶”ì¢…</option>
          <option value="gut">ê°/ì§ê´€</option>
          <option value="fomo">FOMO (ê¸‰ë“± í›„ ì¶”ê²©)</option>
        </select>
      </div>
      <div class="fg" style="margin-top:6px"><label class="flbl">ì†ì ˆ ê·¼ê±°</label>
        <input type="text" class="fi" id="np-stop-reason" placeholder="ì˜ˆ: ì§€ì§€ì„  ì´íƒˆ ì‹œ, -7% ì‹œ ë“±">
      </div>
    </div>
    <div class="fg">
      <label class="flbl">ì°¨íŠ¸ ìŠ¤í¬ë¦°ìƒ· ì²¨ë¶€</label>
      <div class="img-preview" id="np-imgs"
        ondragover="event.preventDefault();this.classList.add('img-drag-over')"
        ondragleave="this.classList.remove('img-drag-over')"
        ondrop="handleImgDrop(event,'np')"
        title="ë“œë˜ê·¸í•˜ì—¬ ì´ë¯¸ì§€ ì¶”ê°€">
        <label class="img-add" for="np-img-file">+</label>
      </div>
      <div style="font-size:10px;color:var(--muted);margin-top:3px">í´ë¦­ ë˜ëŠ” ë“œë˜ê·¸ì•¤ë“œë¡­ìœ¼ë¡œ ì¶”ê°€</div>
      <input type="file" id="np-img-file" accept="image/*" multiple style="display:none" onchange="handleImg(event,'np')">
    </div>
    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:4px">
      <button class="btn btn-outline" onclick="cm('m-newpos')">ì·¨ì†Œ</button>
      <button class="btn btn-primary" onclick="saveNewPos()">í¬ì§€ì…˜ ìƒì„±</button>
    </div>
  </div>
</div>
</div>

<!-- â•â•â• MODAL: ìƒì„¸ â•â•â• -->
<div class="backdrop" id="m-detail" onclick="backdropClose(this,event)">
<div class="modal modal-lg">
  <div class="modal-hdr"><span class="modal-title" id="detail-title">í¬ì§€ì…˜ ìƒì„¸</span><button class="xbtn" onclick="cm('m-detail')">Ã—</button></div>
  <div class="modal-body" id="detail-body"></div>
</div>
</div>

<!-- â•â•â• MODAL: ë§¤ìˆ˜/ë§¤ë„ ì¶”ê°€ â•â•â• -->
<div class="backdrop" id="m-trade" onclick="backdropClose(this,event)">
<div class="modal">
  <div class="modal-hdr"><span class="modal-title" id="trade-title">ë§¤ìˆ˜/ë§¤ë„ ì¶”ê°€</span><button class="xbtn" onclick="cm('m-trade')">Ã—</button></div>
  <div class="modal-body">
    <div class="fg">
      <label class="flbl">ìœ í˜• *</label>
      <div style="display:flex;gap:8px">
        <button class="btn btn-sm" id="tt-buy" onclick="setTT('buy')" style="flex:1">ğŸ“ˆ ë§¤ìˆ˜</button>
        <button class="btn btn-sm btn-outline" id="tt-sell" onclick="setTT('sell')" style="flex:1">ğŸ“‰ ë§¤ë„</button>
      </div>
    </div>
    <div class="fr3">
      <div class="fg"><label class="flbl">ë‚ ì§œ *</label><input type="date" class="fi" id="t-date"></div>
      <div class="fg"><label class="flbl">ê°€ê²© *</label><input type="number" class="fi" id="t-price" placeholder="0"></div>
      <div class="fg"><label class="flbl">ìˆ˜ëŸ‰ *</label><input type="number" class="fi" id="t-qty" placeholder="0"></div>
    </div>
    <!-- ë§¤ìˆ˜ì¼ ë•Œë§Œ ìê¸ˆìœ í˜• í‘œì‹œ -->
    <div id="t-fund-wrap" style="margin-bottom:12px">
      <label class="flbl" style="display:block;margin-bottom:5px">ğŸ’³ ìê¸ˆ ìœ í˜•</label>
      <div style="display:flex;gap:6px">
        <button type="button" class="btn btn-sm" id="t-ft-cash"   onclick="setFundType('t','cash')"   style="flex:1;background:rgba(52,211,153,.15);color:var(--profit);border:1px solid rgba(52,211,153,.3)">ğŸ’µ í˜„ê¸ˆ</button>
        <button type="button" class="btn btn-sm" id="t-ft-credit" onclick="setFundType('t','credit')" style="flex:1;background:transparent;color:var(--muted);border:1px solid var(--border)">ğŸ’³ ì‹ ìš©</button>
        <button type="button" class="btn btn-sm" id="t-ft-margin" onclick="setFundType('t','margin')" style="flex:1;background:transparent;color:var(--muted);border:1px solid var(--border)">âš¡ ë¯¸ìˆ˜</button>
      </div>
      <div id="t-fund-detail" style="display:none;margin-top:8px">
        <div class="fr">
          <div class="fg"><label class="flbl" id="t-rate-lbl">ì´ììœ¨ (%/ë…„)</label><input type="number" class="fi" id="t-fund-rate" placeholder="9.0" step="0.1"></div>
          <div class="fg" id="t-margin-due-wrap" style="display:none"><label class="flbl">ê²°ì œì¼ (D+2)</label><input type="date" class="fi" id="t-margin-due"></div>
        </div>
      </div>
    </div>
    <div class="fr">
      <div class="fg"><label class="flbl">ìˆ˜ìˆ˜ë£Œ</label><input type="number" class="fi" id="t-fee" placeholder="0"></div>
      <div class="fg"><label class="flbl">ê°ì •</label>
        <select class="fi" id="t-emotion"><option value="">ì„ íƒ</option><option>ğŸ˜ ëƒ‰ì •</option><option>ğŸ˜¤ í¥ë¶„</option><option>ğŸ˜° ë¶ˆì•ˆ</option><option>ğŸ’ª í™•ì‹ </option><option>ğŸ˜± FOMO</option></select>
      </div>
    </div>
    <div class="fg"><label class="flbl">ë©”ëª¨</label><textarea class="fi" id="t-note" style="min-height:48px" placeholder="íŒë‹¨ ê·¼ê±°..."></textarea></div>
    <div class="fg">
      <label class="flbl">ì°¨íŠ¸ ì²¨ë¶€</label>
      <div class="img-preview" id="t-imgs"
        ondragover="event.preventDefault();this.classList.add('img-drag-over')"
        ondragleave="this.classList.remove('img-drag-over')"
        ondrop="handleImgDrop(event,'t')"
        title="ë“œë˜ê·¸í•˜ì—¬ ì´ë¯¸ì§€ ì¶”ê°€">
        <label class="img-add" for="t-img-file">+</label>
      </div>
      <input type="file" id="t-img-file" accept="image/*" multiple style="display:none" onchange="handleImg(event,'t')">
    </div>
    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:4px">
      <button class="btn btn-outline" onclick="cm('m-trade')">ì·¨ì†Œ</button>
      <button class="btn btn-primary" onclick="saveTrade()">ì¶”ê°€</button>
    </div>
  </div>
</div>
</div>

<!-- â•â•â• MODAL: í¬ì§€ì…˜ ìˆ˜ì • â•â•â• -->
<div class="backdrop" id="m-editpos" onclick="backdropClose(this,event)">
<div class="modal">
  <div class="modal-hdr"><span class="modal-title">âœï¸ í¬ì§€ì…˜ ìˆ˜ì •</span><button class="xbtn" onclick="cm('m-editpos')">Ã—</button></div>
  <div class="modal-body">
    <input type="hidden" id="ep-id">
    <div class="fr">
      <div class="fg"><label class="flbl">ì¢…ëª©ëª… *</label><input class="fi" id="ep-name" placeholder="ì‚¼ì„±ì „ì, AAPL"></div>
      <div class="fg"><label class="flbl">ì‹œì¥ *</label>
        <select class="fi" id="ep-market" onchange="onEpMktChg()">
          <option value="KRX">êµ­ë‚´ (KRX)</option><option value="US">ë¯¸êµ­ (US)</option>
          <option value="CRYPTO">ì•”í˜¸í™”í</option><option value="FUTURES">ì„ ë¬¼/ì˜µì…˜</option>
        </select>
      </div>
    </div>
    <div class="fr">
      <div class="fg"><label class="flbl">ì¢…ëª©ì½”ë“œ/í‹°ì»¤</label><input class="fi" id="ep-ticker" placeholder="005930"></div>
      <div class="fg"><label class="flbl">í†µí™”</label>
        <select class="fi" id="ep-currency"><option value="KRW">ì›í™” (â‚©)</option><option value="USD">ë‹¬ëŸ¬ ($)</option></select>
      </div>
    </div>
    <div class="fg"><label class="flbl">ì „ëµ</label>
      <select class="fi" id="ep-strategy">
        <option value="">ì„ íƒ</option><option>ì´ë™í‰ê· ì„ </option><option>RSI</option><option>ë³¼ë¦°ì €ë°´ë“œ</option>
        <option>MACD</option><option>ì§€ì§€/ì €í•­ì„ </option><option>ë‰´ìŠ¤/ê³µì‹œ</option>
        <option>ìˆ˜ê¸‰/ê¸°ê´€</option><option>ê°€ì¹˜íˆ¬ì</option><option>ê°/ì§ê´€</option><option>ê¸°íƒ€</option>
      </select>
    </div>
    <div class="fr">
      <div class="fg">
        <label class="flbl" style="color:var(--profit)">ğŸ¯ ëª©í‘œê°€</label>
        <input type="number" class="fi fi-t" id="ep-target" placeholder="ëª©í‘œ ë§¤ë„ê°€" oninput="epPreview()">
      </div>
      <div class="fg">
        <label class="flbl" style="color:var(--loss)">ğŸ›‘ ì†ì ˆê°€</label>
        <input type="number" class="fi fi-s" id="ep-stop" placeholder="ì†ì ˆ ê¸°ì¤€ê°€" oninput="epPreview()">
      </div>
    </div>
    <div id="ep-preview" style="font-size:12px;color:var(--muted);margin:-4px 0 9px;min-height:16px"></div>
    <div class="fg"><label class="flbl">ë©”ëª¨</label><textarea class="fi" id="ep-note" placeholder="ì§„ì… ì´ìœ , ëª©í‘œ, ì „ëµ..."></textarea></div>
    <div class="divider"></div>
    <div style="font-size:12px;color:var(--muted);margin-bottom:12px">ğŸ’¡ ë§¤ìˆ˜ê°€Â·ìˆ˜ëŸ‰ ìˆ˜ì •ì€ ì•„ë˜ "ê±°ë˜ ë‚´ì—­ ìˆ˜ì •"ì—ì„œ ê°œë³„ ìˆ˜ì •í•˜ì„¸ìš”</div>
    <div id="ep-trades-list"></div>
    <div style="display:flex;gap:8px;margin-top:4px">
      <button class="btn btn-outline" style="flex:1" onclick="cm('m-editpos')">ì·¨ì†Œ</button>
      <button class="btn btn-primary" style="flex:1" onclick="saveEditPos()">ì €ì¥</button>
    </div>
  </div>
</div>
</div>

<!-- â•â•â• MODAL: ê±°ë˜ ìˆ˜ì • â•â•â• -->
<div class="backdrop" id="m-edittrade" onclick="backdropClose(this,event)">
<div class="modal modal-sm">
  <div class="modal-hdr"><span class="modal-title" id="edittrade-title">ê±°ë˜ ìˆ˜ì •</span><button class="xbtn" onclick="cm('m-edittrade')">Ã—</button></div>
  <div class="modal-body">
    <input type="hidden" id="et-posid">
    <input type="hidden" id="et-tradeid">
    <div class="fr3">
      <div class="fg"><label class="flbl">ë‚ ì§œ *</label><input type="date" class="fi" id="et-date"></div>
      <div class="fg"><label class="flbl">ê°€ê²© *</label><input type="number" class="fi" id="et-price"></div>
      <div class="fg"><label class="flbl">ìˆ˜ëŸ‰ *</label><input type="number" class="fi" id="et-qty"></div>
    </div>
    <div class="fr">
      <div class="fg"><label class="flbl">ìˆ˜ìˆ˜ë£Œ</label><input type="number" class="fi" id="et-fee"></div>
      <div class="fg"><label class="flbl">ê°ì •</label>
        <select class="fi" id="et-emotion">
          <option value="">ì„ íƒ</option><option>ğŸ˜ ëƒ‰ì •</option><option>ğŸ˜¤ í¥ë¶„</option><option>ğŸ˜° ë¶ˆì•ˆ</option><option>ğŸ’ª í™•ì‹ </option><option>ğŸ˜± FOMO</option>
        </select>
      </div>
    </div>
    <div id="et-fund-wrap">
      <label class="flbl" style="display:block;margin-bottom:5px">ğŸ’³ ìê¸ˆ ìœ í˜•</label>
      <div style="display:flex;gap:6px;margin-bottom:8px">
        <button type="button" class="btn btn-sm" id="et-ft-cash"   onclick="setFundType('et','cash')"   style="flex:1">ğŸ’µ í˜„ê¸ˆ</button>
        <button type="button" class="btn btn-sm" id="et-ft-credit" onclick="setFundType('et','credit')" style="flex:1">ğŸ’³ ì‹ ìš©</button>
        <button type="button" class="btn btn-sm" id="et-ft-margin" onclick="setFundType('et','margin')" style="flex:1">âš¡ ë¯¸ìˆ˜</button>
      </div>
      <div id="et-fund-detail" style="display:none">
        <div class="fr">
          <div class="fg"><label class="flbl" id="et-rate-lbl">ì´ììœ¨ (%/ë…„)</label><input type="number" class="fi" id="et-fund-rate" step="0.1"></div>
          <div class="fg" id="et-margin-due-wrap" style="display:none"><label class="flbl">ê²°ì œì¼</label><input type="date" class="fi" id="et-margin-due"></div>
        </div>
      </div>
    </div>
    <div class="fg"><label class="flbl">ë©”ëª¨</label><textarea class="fi" id="et-note" style="min-height:48px"></textarea></div>
    <div style="display:flex;gap:8px;margin-top:4px">
      <button class="btn btn-outline" style="flex:1" onclick="cm('m-edittrade')">ì·¨ì†Œ</button>
      <button class="btn btn-primary" style="flex:1" onclick="saveEditTrade()">ì €ì¥</button>
    </div>
  </div>
</div>
</div>

<!-- â•â•â• MODAL: ì•Œë¦¼ì„¤ì • â•â•â• -->
<div class="backdrop" id="m-alert" onclick="backdropClose(this,event)">
<div class="modal modal-sm">
  <div class="modal-hdr"><span class="modal-title" id="alert-title">ëª©í‘œê°€ / ì†ì ˆê°€ ì„¤ì •</span><button class="xbtn" onclick="cm('m-alert')">Ã—</button></div>
  <div class="modal-body">
    <div id="alert-cur" style="background:var(--s2);border-radius:8px;padding:10px 12px;margin-bottom:13px;font-size:13px;color:var(--muted)"></div>
    <div class="fg">
      <label class="flbl" style="color:var(--profit)">ğŸ¯ ëª©í‘œê°€</label>
      <input type="number" class="fi fi-t" id="al-target" placeholder="ëª©í‘œ ë§¤ë„ê°€" oninput="updateAlertPreview()">
      <div id="al-trate" style="font-size:11px;color:var(--profit);margin-top:3px;min-height:14px"></div>
    </div>
    <div class="fg">
      <label class="flbl" style="color:var(--loss)">ğŸ›‘ ì†ì ˆê°€</label>
      <input type="number" class="fi fi-s" id="al-stop" placeholder="ì†ì ˆ ê¸°ì¤€ê°€" oninput="updateAlertPreview()">
      <div id="al-srate" style="font-size:11px;color:var(--loss);margin-top:3px;min-height:14px"></div>
    </div>
    <div style="background:rgba(255,179,71,.08);border:1px solid rgba(255,179,71,.2);border-radius:8px;padding:9px 12px;font-size:12px;color:var(--warn);margin-bottom:12px">ğŸ’¡ ê°€ê²© ê°±ì‹  ì‹œ ìë™ ì²´í¬ â†’ íŒì—… + ì†Œë¦¬ ì•Œë¦¼</div>
    <div style="display:flex;gap:8px;justify-content:flex-end">
      <button class="btn btn-outline" onclick="clearAlerts()">ì•Œë¦¼ í•´ì œ</button>
      <button class="btn btn-outline" onclick="cm('m-alert')">ì·¨ì†Œ</button>
      <button class="btn btn-primary" onclick="saveAlerts()">ì €ì¥</button>
    </div>
  </div>
</div>
</div>

<!-- â•â•â• MODAL: í˜„ì¬ê°€ â•â•â• -->
<div class="backdrop" id="m-price" onclick="backdropClose(this,event)">
<div class="modal modal-sm">
  <div class="modal-hdr"><span class="modal-title" id="price-title">í˜„ì¬ê°€ ì„¤ì •</span><button class="xbtn" onclick="cm('m-price')">Ã—</button></div>
  <div class="modal-body">
    <div id="price-auto" style="margin-bottom:11px"></div>
    <div id="price-loading" style="display:none;align-items:center;gap:8px;color:var(--muted);font-size:13px;margin-bottom:9px"><span>â³</span><span>ì¡°íšŒ ì¤‘...</span></div>
    <div class="fg"><label class="flbl">ì§ì ‘ ì…ë ¥</label><input type="number" class="fi" id="manual-price" placeholder="í˜„ì¬ ì‹œì„¸"></div>
    <div style="display:flex;gap:8px;justify-content:flex-end">
      <button class="btn btn-outline" onclick="cm('m-price')">ì·¨ì†Œ</button>
      <button class="btn btn-primary" onclick="saveManualPrice()">ì ìš©</button>
    </div>
  </div>
</div>
</div>

<!-- â•â•â• MODAL: í…œí”Œë¦¿ â•â•â• -->
<div class="backdrop" id="m-tmpl" onclick="backdropClose(this,event)">
<div class="modal modal-sm">
  <div class="modal-hdr"><span class="modal-title">ğŸ“‹ ë§¤ë§¤ í…œí”Œë¦¿</span><button class="xbtn" onclick="cm('m-tmpl')">Ã—</button></div>
  <div class="modal-body">
    <div id="tmpl-list" style="margin-bottom:13px"></div>
    <div class="divider"></div>
    <div style="font-size:12px;font-weight:600;color:var(--muted);margin-bottom:8px">ìƒˆ í…œí”Œë¦¿ ì €ì¥</div>
    <div class="fr">
      <div class="fg"><label class="flbl">í…œí”Œë¦¿ëª…</label><input class="fi" id="tmpl-name" placeholder="ì˜ˆ: RSI ì „ëµ"></div>
      <div class="fg"><label class="flbl">ì „ëµ</label>
        <select class="fi" id="tmpl-strategy">
          <option value="">ì„ íƒ</option><option>ì´ë™í‰ê· ì„ </option><option>RSI</option><option>ë³¼ë¦°ì €ë°´ë“œ</option>
          <option>MACD</option><option>ì§€ì§€/ì €í•­ì„ </option><option>ë‰´ìŠ¤/ê³µì‹œ</option>
          <option>ìˆ˜ê¸‰/ê¸°ê´€</option><option>ê°€ì¹˜íˆ¬ì</option><option>ê°/ì§ê´€</option>
        </select>
      </div>
    </div>
    <div class="fg"><label class="flbl">ê¸°ë³¸ ë©”ëª¨/ì²´í¬ë¦¬ìŠ¤íŠ¸</label><textarea class="fi" id="tmpl-note" placeholder="ì§„ì… ì¡°ê±´, ì²´í¬ë¦¬ìŠ¤íŠ¸..."></textarea></div>
    <div style="display:flex;gap:8px;justify-content:flex-end">
      <button class="btn btn-outline" onclick="cm('m-tmpl')">ë‹«ê¸°</button>
      <button class="btn btn-primary" onclick="saveTmpl()">í…œí”Œë¦¿ ì €ì¥</button>
    </div>
  </div>
</div>
</div>

<!-- â•â•â• MODAL: ì—‘ì…€/CSV ê°€ì ¸ì˜¤ê¸° â•â•â• -->
<div class="backdrop" id="m-json-restore" onclick="backdropClose(this,event)">
<div class="modal">
  <div class="modal-hdr">
    <span class="modal-title">ğŸ’¾ JSON ë°±ì—… ë³µì›</span>
    <button class="xbtn" onclick="cm('m-json-restore')">Ã—</button>
  </div>
  <div class="modal-body">
    <div style="background:rgba(251,191,36,.08);border:1px solid rgba(251,191,36,.2);border-radius:10px;padding:13px 16px;margin-bottom:16px">
      <div style="font-size:13px;font-weight:700;color:var(--warn);margin-bottom:4px">âš ï¸ ì£¼ì˜</div>
      <div style="font-size:12px;color:var(--muted)">ë³µì›í•˜ë©´ í˜„ì¬ ë°ì´í„°ê°€ <b>ì „ë¶€ êµì²´</b>ë©ë‹ˆë‹¤. ë¨¼ì € JSON ë°±ì—…ì„ í•´ë‘ì„¸ìš”.</div>
    </div>
    <div style="border:2px dashed var(--border);border-radius:12px;padding:28px;text-align:center;cursor:pointer;transition:border-color .18s;margin-bottom:14px"
      id="restore-drop-zone"
      onclick="document.getElementById('restore-file').click()"
      ondragover="event.preventDefault();this.style.borderColor='var(--accent)'"
      ondragleave="this.style.borderColor='var(--border)'"
      ondrop="handleRestoreDrop(event)">
      <div style="font-size:30px;margin-bottom:8px">ğŸ“‚</div>
      <div style="font-size:14px;font-weight:600;margin-bottom:4px">JSON íŒŒì¼ í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸</div>
      <div style="font-size:12px;color:var(--muted)">backupJSON()ìœ¼ë¡œ ì €ì¥í•œ .json íŒŒì¼</div>
      <input type="file" id="restore-file" accept=".json" style="display:none" onchange="handleRestoreFile(event)">
    </div>
    <div id="restore-preview" style="display:none">
      <div style="background:var(--s2);border-radius:9px;padding:12px 14px;margin-bottom:12px;font-size:12px" id="restore-info"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button class="btn btn-outline" onclick="document.getElementById('restore-preview').style.display='none'">ì·¨ì†Œ</button>
        <button class="btn" style="background:var(--warn);color:#000;font-weight:700" onclick="doRestore()">âš ï¸ ë³µì› ì‹¤í–‰</button>
      </div>
    </div>
  </div>
</div>
</div>

<div class="backdrop" id="m-trade-import" onclick="backdropClose(this,event)">
<div class="modal modal-lg">
  <div class="modal-hdr"><span class="modal-title">ğŸ“¤ ë§¤ë§¤ë‚´ì—­ ì¼ê´„ ê°€ì ¸ì˜¤ê¸°</span><button class="xbtn" onclick="cm('m-trade-import')">Ã—</button></div>
  <div class="modal-body">

    <!-- ì–‘ì‹ ë‹¤ìš´ë¡œë“œ -->
    <div style="background:rgba(0,153,255,.08);border:1px solid rgba(0,153,255,.2);border-radius:10px;padding:13px 16px;margin-bottom:16px">
      <div style="font-size:13px;font-weight:600;color:var(--a2);margin-bottom:6px">ğŸ“‹ ì‘ì„± ì–‘ì‹</div>
      <div style="font-size:12px;color:var(--muted);margin-bottom:10px">ì•„ë˜ ë²„íŠ¼ìœ¼ë¡œ ì–‘ì‹ì„ ë‹¤ìš´ë¡œë“œí•œ í›„, ì—‘ì…€/êµ¬ê¸€ì‹œíŠ¸ì—ì„œ ì‘ì„±í•´ì„œ ì˜¬ë ¤ì£¼ì„¸ìš”.</div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn btn-outline btn-sm" onclick="downloadTemplate()">ğŸ“¥ ì–‘ì‹ ë‹¤ìš´ë¡œë“œ (CSV)</button>
        <button class="btn btn-outline btn-sm" onclick="showSample()">ğŸ‘ ì˜ˆì‹œ ë³´ê¸°</button>
      </div>
    </div>

    <!-- ì»¬ëŸ¼ ì„¤ëª… -->
    <div id="import-sample" style="display:none;margin-bottom:14px">
      <div style="font-size:11px;font-weight:600;color:var(--muted);margin-bottom:7px;text-transform:uppercase;letter-spacing:.6px">ì»¬ëŸ¼ ì„¤ëª…</div>
      <div style="overflow-x:auto">
        <table style="width:100%;font-size:11px">
          <thead><tr>
            <th>ì»¬ëŸ¼</th><th>í•„ìˆ˜</th><th>í˜•ì‹</th><th>ì˜ˆì‹œ</th>
          </tr></thead>
          <tbody>
            <tr><td style="color:var(--accent)">í¬ì§€ì…˜ëª…</td><td>âœ…</td><td>í…ìŠ¤íŠ¸</td><td>ì‚¼ì„±ì „ì</td></tr>
            <tr><td>ì‹œì¥</td><td></td><td>KRX / US / CRYPTO / FUTURES</td><td>KRX</td></tr>
            <tr><td>ì¢…ëª©ì½”ë“œ</td><td></td><td>í…ìŠ¤íŠ¸</td><td>005930</td></tr>
            <tr><td>í†µí™”</td><td></td><td>KRW / USD</td><td>KRW</td></tr>
            <tr><td>ì „ëµ</td><td></td><td>í…ìŠ¤íŠ¸</td><td>RSI</td></tr>
            <tr><td style="color:var(--accent)">ìœ í˜•</td><td>âœ…</td><td>ë§¤ìˆ˜ / ë§¤ë„</td><td>ë§¤ìˆ˜</td></tr>
            <tr><td style="color:var(--accent)">ë‚ ì§œ</td><td>âœ…</td><td>YYYY-MM-DD</td><td>2024-03-15</td></tr>
            <tr><td style="color:var(--accent)">ê°€ê²©</td><td>âœ…</td><td>ìˆ«ì</td><td>75000</td></tr>
            <tr><td style="color:var(--accent)">ìˆ˜ëŸ‰</td><td>âœ…</td><td>ìˆ«ì</td><td>10</td></tr>
            <tr><td>ìˆ˜ìˆ˜ë£Œ</td><td></td><td>ìˆ«ì</td><td>150</td></tr>
            <tr><td>ê°ì •</td><td></td><td>í…ìŠ¤íŠ¸</td><td>ğŸ˜ ëƒ‰ì •</td></tr>
            <tr><td style="color:var(--warn)">ìê¸ˆìœ í˜•</td><td></td><td>í˜„ê¸ˆ / ì‹ ìš© / ë¯¸ìˆ˜</td><td>ì‹ ìš©</td></tr>
            <tr><td style="color:var(--warn)">ì´ììœ¨</td><td></td><td>ìˆ«ì (%/ë…„)</td><td>9.0</td></tr>
            <tr><td style="color:var(--warn)">ê²°ì œì¼</td><td></td><td>YYYY-MM-DD (ë¯¸ìˆ˜ë§Œ)</td><td>2024-03-17</td></tr>
            <tr><td>ëª©í‘œê°€</td><td></td><td>ìˆ«ì</td><td>85000</td></tr>
            <tr><td>ì†ì ˆê°€</td><td></td><td>ìˆ«ì</td><td>70000</td></tr>
            <tr><td>ë©”ëª¨</td><td></td><td>í…ìŠ¤íŠ¸</td><td>RSI 30 ì´í•˜ ë°˜ë“±</td></tr>
          </tbody>
        </table>
      </div>
      <div style="font-size:11px;color:var(--muted);margin-top:8px">ğŸ’¡ ê°™ì€ í¬ì§€ì…˜ëª…ì˜ ì—¬ëŸ¬ í–‰ì€ ìë™ìœ¼ë¡œ í•˜ë‚˜ì˜ í¬ì§€ì…˜ìœ¼ë¡œ ë¬¶ì…ë‹ˆë‹¤.</div>
    </div>

    <!-- íŒŒì¼ ì—…ë¡œë“œ -->
    <div style="border:2px dashed var(--border);border-radius:12px;padding:28px;text-align:center;cursor:pointer;transition:border-color .18s;margin-bottom:14px" id="drop-zone" onclick="document.getElementById('import-file').click()" ondragover="event.preventDefault();this.style.borderColor='var(--accent)'" ondragleave="this.style.borderColor='var(--border)'" ondrop="handleDrop(event)">
      <div style="font-size:30px;margin-bottom:8px">ğŸ“‚</div>
      <div style="font-size:14px;font-weight:600;margin-bottom:4px">CSV íŒŒì¼ í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸</div>
      <div style="font-size:12px;color:var(--muted)">.csv íŒŒì¼ (ì—‘ì…€ì—ì„œ CSVë¡œ ì €ì¥)</div>
      <input type="file" id="import-file" accept=".csv" style="display:none" onchange="handleImportFile(event)">
    </div>

    <!-- ë¯¸ë¦¬ë³´ê¸° -->
    <div id="import-preview" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:9px">
        <div style="font-size:13px;font-weight:600">ë¯¸ë¦¬ë³´ê¸°</div>
        <span id="import-count" style="font-size:12px;color:var(--muted)"></span>
      </div>
      <div style="overflow-x:auto;max-height:260px;overflow-y:auto;background:var(--s2);border-radius:9px;margin-bottom:12px">
        <table style="width:100%;font-size:12px" id="import-table"></table>
      </div>
      <div id="import-errors" style="margin-bottom:12px"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button class="btn btn-outline" onclick="resetImport()">ë‹¤ì‹œ ì„ íƒ</button>
        <button class="btn btn-primary" id="import-btn" onclick="doImport()">âœ… ê°€ì ¸ì˜¤ê¸°</button>
      </div>
    </div>

  </div>
</div>
</div>

<!-- â•â•â• MODAL: ì´ë¯¸ì§€ ë·°ì–´ â•â•â• -->
<div class="backdrop" id="m-img" onclick="cm('m-img')">
<div style="max-width:92vw;text-align:center">
  <img id="img-viewer" style="max-width:100%;max-height:88vh;border-radius:8px" src="">
  <div style="margin-top:10px"><button class="btn btn-outline" onclick="cm('m-img')">ë‹«ê¸°</button></div>
</div>
</div>

<!-- â•â•â• MODAL: ë©”ëª¨ ê²€ìƒ‰ â•â•â• -->
<div class="backdrop" id="m-search" onclick="backdropClose(this,event)">
<div class="modal">
  <div class="modal-hdr"><span class="modal-title">ğŸ” ë©”ëª¨ / ì¢…ëª© ê²€ìƒ‰</span><button class="xbtn" onclick="cm('m-search')">Ã—</button></div>
  <div class="modal-body">
    <div class="fg"><input class="fi" id="search-q" placeholder="í‚¤ì›Œë“œ ê²€ìƒ‰..." oninput="runSearch()"></div>
    <div id="search-results" style="display:flex;flex-direction:column;gap:7px"></div>
  </div>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• ğŸ“… ë‚ ì§œ ìƒì„¸ ëª¨ë‹¬ â•â•â•â•â•â•â•â•â•â• -->
<div class="backdrop" id="m-day-detail" onclick="backdropClose(this,event)">
<div class="modal" style="max-width:560px;max-height:88vh;overflow-y:auto">
  <div class="modal-hdr">
    <span class="modal-title" id="day-modal-title">ğŸ“… ë‚ ì§œ ìƒì„¸</span>
    <button class="xbtn" onclick="cm('m-day-detail')">Ã—</button>
  </div>
  <div class="modal-body" style="padding:0">
    <!-- ë§¤ë§¤ ë‚´ì—­ ì„¹ì…˜ -->
    <div style="padding:14px 18px;border-bottom:1px solid var(--border)">
      <div style="font-size:11px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.6px;margin-bottom:10px">ğŸ“Š ë‹¹ì¼ ë§¤ë§¤ ë‚´ì—­</div>
      <div id="day-trades-list"></div>
    </div>
    <!-- ì¼ì§€ ì„¹ì…˜ -->
    <div style="padding:14px 18px">
      <div style="font-size:11px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.6px;margin-bottom:10px">ğŸ““ ë‹¹ì¼ ì¼ì§€</div>
      <div id="day-journal-area"></div>
    </div>
  </div>
</div>
</div>


<div class="alert-popup" id="alert-popup"></div>
<div class="toast" id="toast"></div>

<!-- â•â•â• íŠœí† ë¦¬ì–¼ ëª¨ë‹¬ â•â•â• -->
<div class="backdrop" id="m-help" onclick="backdropClose(this,event)">
<div class="modal modal-lg">
  <div class="modal-hdr">
    <span class="modal-title" id="help-title">ğŸ‘‹ TradeLog ì‹œì‘í•˜ê¸°</span>
    <button class="xbtn" onclick="cm('m-help')">Ã—</button>
  </div>
  <div class="modal-body" style="padding:0">
    <!-- ìŠ¤í… ì§„í–‰ë°” -->
    <div style="padding:16px 22px 0;border-bottom:1px solid var(--border)">
      <div style="display:flex;gap:6px;margin-bottom:14px" id="help-steps"></div>
    </div>
    <!-- ìŠ¬ë¼ì´ë“œ ì½˜í…ì¸  -->
    <div id="help-content" style="padding:24px 22px;min-height:320px"></div>
    <!-- í•˜ë‹¨ ë²„íŠ¼ -->
    <div style="padding:14px 22px;border-top:1px solid var(--border);display:flex;justify-content:space-between;align-items:center">
      <button class="btn btn-outline" id="help-prev" onclick="helpNav(-1)">â† ì´ì „</button>
      <span style="font-size:12px;color:var(--muted)" id="help-page"></span>
      <button class="btn btn-primary" id="help-next" onclick="helpNav(1)">ë‹¤ìŒ â†’</button>
    </div>
  </div>
</div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STATE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let positions = (function(){
  try {
    const _ls = localStorage.getItem('tl-v4-pos');
    if (_ls) { const _d = JSON.parse(_ls); if (_d && _d.length) return _d; }
  } catch(e) {}
  // localStorage ì—†ê±°ë‚˜ ë¹„ì–´ìˆìœ¼ë©´ ìƒ˜í”Œ ë°ì´í„°
  const _u = () => Math.random().toString(36).slice(2,10);
  return [
    { id:_u(), name:'ì‚¼ì„±ì „ì', market:'KRX', ticker:'005930', currency:'KRW',
      strategy:'ì´ë™í‰ê· ì„ ', targetPrice:90000, stopPrice:66000, status:'holding',
      note:'HBM ì‚¬ì´í´ íšŒë³µ, ë°˜ë„ì²´ ì—…í„´ ê¸°ëŒ€', currentPrice:75400,
      trades:[
        {id:_u(),type:'buy',date:'2025-01-08',price:68000,qty:100,fee:3800,emotion:'ğŸ’ª í™•ì‹ ',note:'52ì£¼ ì‹ ì €ê°€ ì§€ì§€ í™•ì¸',fundType:'cash'},
        {id:_u(),type:'buy',date:'2025-02-14',price:71200,qty:50, fee:2000,emotion:'ğŸ˜ ëƒ‰ì •',note:'20ì¼ì„  ëŒíŒŒ ì¶”ê°€ë§¤ìˆ˜',fundType:'cash'},
      ]},
    { id:_u(), name:'SKí•˜ì´ë‹‰ìŠ¤', market:'KRX', ticker:'000660', currency:'KRW',
      strategy:'ë‰´ìŠ¤/ê³µì‹œ', targetPrice:260000, stopPrice:170000, status:'holding',
      note:'HBM3E ë…ì  ê³µê¸‰ ìˆ˜í˜œ', currentPrice:198000,
      trades:[
        {id:_u(),type:'buy',date:'2025-03-05',price:182000,qty:20,fee:2100,emotion:'ğŸ’ª í™•ì‹ ',note:'HBM ìˆ˜ìš” ê¸°ì‚¬ í™•ì¸',fundType:'cash'},
      ]},
    { id:_u(), name:'NVIDIA', market:'US', ticker:'NVDA', currency:'USD',
      strategy:'ì„±ì¥ì£¼', targetPrice:180, stopPrice:105, status:'holding',
      note:'AI ì¸í”„ë¼ ìˆ˜ìš” ì§€ì†', currentPrice:138,
      trades:[
        {id:_u(),type:'buy',date:'2025-01-20',price:112,qty:10,fee:0,emotion:'ğŸ’ª í™•ì‹ ',note:'ì‹¤ì  ì„œí”„ë¼ì´ì¦ˆ ëˆŒë¦¼ëª©',fundType:'cash'},
        {id:_u(),type:'buy',date:'2025-03-10',price:118,qty:5, fee:0,emotion:'ğŸ˜ ëƒ‰ì •',note:'í”¼ë¼ë¯¸ë”© ì¶”ê°€',fundType:'cash'},
      ]},
    { id:_u(), name:'ì¹´ì¹´ì˜¤', market:'KRX', ticker:'035720', currency:'KRW',
      strategy:'ê°€ì¹˜íˆ¬ì', status:'closed', note:'í”Œë«í¼ ê·œì œ ë¦¬ìŠ¤í¬ í•´ì†Œ',
      trades:[
        {id:_u(),type:'buy', date:'2024-10-15',price:38500,qty:80,fee:1800,emotion:'ğŸ’ª í™•ì‹ ',note:'PBR 0.8 ì—­ëŒ€ ì €ì ',fundType:'cash'},
        {id:_u(),type:'sell',date:'2025-01-22',price:46200,qty:80,fee:2100,emotion:'ğŸ˜ ëƒ‰ì •',note:'ëª©í‘œê°€ ë„ë‹¬ ì²­ì‚°',fundType:'cash'},
      ]},
    { id:_u(), name:'LGì—ë„ˆì§€ì†”ë£¨ì…˜', market:'KRX', ticker:'373220', currency:'KRW',
      strategy:'ì´ë™í‰ê· ì„ ', status:'closed', note:'ì „ê¸°ì°¨ ë°°í„°ë¦¬ ìˆ˜ì£¼',
      trades:[
        {id:_u(),type:'buy', date:'2024-11-04',price:285000,qty:5,fee:800,emotion:'ğŸ˜ ëƒ‰ì •',note:'200ì¼ì„  ì§€ì§€',fundType:'cash'},
        {id:_u(),type:'sell',date:'2025-02-17',price:268000,qty:5,fee:750,emotion:'ğŸ˜° ë¶ˆì•ˆ',note:'ì‹œì¥ ì•½ì„¸ ì†ì ˆ',fundType:'cash'},
      ]},
    { id:_u(), name:'Tesla', market:'US', ticker:'TSLA', currency:'USD',
      strategy:'ëª¨ë©˜í…€', status:'closed', note:'ì‹ ì°¨ ì¶œì‹œ ê¸°ëŒ€',
      trades:[
        {id:_u(),type:'buy', date:'2024-12-03',price:248,qty:8,fee:0,emotion:'ğŸ˜¤ í¥ë¶„',note:'55ì¼ ì‹ ê³ ê°€ ëŒíŒŒ',fundType:'cash'},
        {id:_u(),type:'sell',date:'2025-02-28',price:312,qty:8,fee:0,emotion:'ğŸ’ª í™•ì‹ ',note:'+25% ëª©í‘œ ë„ë‹¬',fundType:'cash'},
      ]},
  ];
})();
let templates = [];
let currentTab = 'holding';
let activePosId = null;
let activeTradeType = 'buy';
let pricePosId = null;
let alertPosId = null;
let alertAvgB = 0; // ì „ì—­ìœ¼ë¡œ ë¹¼ì„œ updateAlertPreviewì—ì„œ ì ‘ê·¼ ê°€ëŠ¥
let alertedMap = {};
let calYear = new Date().getFullYear();
let calMonth = new Date().getMonth();
let pendingImgs = { np: [], t: [] };

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STORAGE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadData() {
  // 1ìˆœìœ„: íŒŒì¼ì— ë‚´ì¥ëœ ë°ì´í„°
  const embedded = document.getElementById('__data__');
  if (embedded && embedded.textContent.trim()) {
    try {
      const d = JSON.parse(embedded.textContent);
      positions   = d.positions   || [];
      templates   = d.templates   || [];
      rules       = d.rules       || [];
      violations  = d.violations  || [];
      checkState  = d.checkState  || { entry:{}, exit:{} };
      goals       = d.goals       || [];
      accounts    = d.accounts    || [];
      txList      = d.txList      || [];
      interestList= d.interestList|| [];
      renderAll(); reqNotif(); return;
    } catch(e) {}
  }
  try { const _r = localStorage.getItem('tl-v4-pos'); if(_r){ const _p=JSON.parse(_r); if(_p&&_p.length) positions=_p; } } catch(e) {}
  try { const _r = localStorage.getItem('tl-v4-tmpl'); if(_r) templates = JSON.parse(_r); } catch(e) { templates=[]; }
  try { const _r = localStorage.getItem('tl-rules'); if(_r) { const d=JSON.parse(_r); rules=d.rules||[]; violations=d.violations||[]; checkState=d.checkState||{entry:{},exit:{}}; } } catch(e) {}
  try { const _r = localStorage.getItem('tl-goals'); if(_r) goals = JSON.parse(_r); } catch(e) { goals=[]; }
  try { const _r = localStorage.getItem('tl-events'); if(_r) events = JSON.parse(_r); } catch(e) { events=[]; }
  await loadFunds();
  loadJournals();
  // ì´ë²¤íŠ¸ ìƒ˜í”Œ ë°ì´í„° (ì²« ì‹¤í–‰ ì‹œ)
  if(!events.length && !localStorage.getItem('tl-events-sample')) {
    const _uid2 = () => Date.now().toString(36)+Math.random().toString(36).slice(2,7);
    const _addDays = (d) => { const dt=new Date(); dt.setDate(dt.getDate()+d); return dt.toISOString().slice(0,10); };
    events = [
      { id:_uid2(), title:'ì‚¼ì„±ì „ì 1ë¶„ê¸° ì‹¤ì ë°œí‘œ', date:_addDays(12), category:'earnings', stocks:'ì‚¼ì„±ì „ì', memo:'ë§¤ì¶œÂ·ì˜ì—…ì´ìµ ì»¨ì„¼ì„œìŠ¤ ëŒ€ë¹„ í™•ì¸ í•„ìš”', repeat:'none', themes:['ë°˜ë„ì²´','AIë°˜ë„ì²´'] },
      { id:_uid2(), title:'SKí•˜ì´ë‹‰ìŠ¤ ì£¼ì£¼ì´íšŒ', date:_addDays(25), category:'disclosure', stocks:'SKí•˜ì´ë‹‰ìŠ¤', memo:'ë°°ë‹¹ ê²°ì˜ ë° ì‚¬ì—…ë³´ê³ ì„œ ì£¼ëª©', repeat:'none', themes:['ë°˜ë„ì²´'] },
      { id:_uid2(), title:'ë¯¸êµ­ FOMC ê¸ˆë¦¬ê²°ì •', date:_addDays(7), category:'macro', stocks:'', memo:'ê¸ˆë¦¬ ë™ê²° ì—¬ë¶€ ë° ì ë„í‘œ í™•ì¸', repeat:'none', themes:['ë¯¸êµ­ì£¼ì‹','ê¸ˆìœµ'] },
      { id:_uid2(), title:'ì¹´ì¹´ì˜¤ ê³µì •ìœ„ ì œì¬ ê²°ê³¼', date:_addDays(33), category:'court', stocks:'ì¹´ì¹´ì˜¤', memo:'í”Œë«í¼ ë…ì  ê´€ë ¨ ê²°ê³¼ì— ë”°ë¼ ë³€ë™ì„± ì£¼ì˜', repeat:'none', themes:['ê²Œì„'] },
      { id:_uid2(), title:'ì‚¼ì„±ì „ì ë°°ë‹¹ë½ì¼', date:_addDays(60), category:'dividend', stocks:'ì‚¼ì„±ì „ì', memo:'ë§¤ë…„ 3ì›” ë°°ë‹¹ë½ â€” ë³´ìœ  ì—¬ë¶€ ê²°ì • í•„ìš”', repeat:'yearly', themes:['ë°˜ë„ì²´'] },
    ];
    saveEvents();
    localStorage.setItem('tl-events-sample','1');
  }
  // ìƒ˜í”Œ ë°ì´í„° (ì²« ì‹¤í–‰ ì‹œ)
  if(!positions.length && !localStorage.getItem('tl-no-sample')) {
    const _uid = () => Date.now().toString(36)+Math.random().toString(36).slice(2,5);
    positions = [
      { id:_uid(), name:'ì‚¼ì„±ì „ì', market:'KRX', ticker:'005930', currency:'KRW',
        strategy:'ì´ë™í‰ê· ì„ ', targetPrice:90000, stopPrice:66000, status:'holding',
        note:'HBM ì‚¬ì´í´ íšŒë³µ, ë°˜ë„ì²´ ì—…í„´ ê¸°ëŒ€', currentPrice:75400,
        trades:[
          {id:_uid(),type:'buy',date:'2025-01-08',price:68000,qty:100,fee:3800,emotion:'ğŸ’ª í™•ì‹ ',note:'52ì£¼ ì‹ ì €ê°€ ë¶€ê·¼ ì§€ì§€ í™•ì¸',fundType:'cash'},
          {id:_uid(),type:'buy',date:'2025-02-14',price:71200,qty:50,fee:2000,emotion:'ğŸ˜ ëƒ‰ì •',note:'20ì¼ì„  ëŒíŒŒ ì¬í™•ì¸',fundType:'cash'},
        ]
      },
      { id:_uid(), name:'SKí•˜ì´ë‹‰ìŠ¤', market:'KRX', ticker:'000660', currency:'KRW',
        strategy:'ë‰´ìŠ¤/ê³µì‹œ', targetPrice:260000, stopPrice:170000, status:'holding',
        note:'HBM3E ë…ì  ê³µê¸‰', currentPrice:198000,
        trades:[
          {id:_uid(),type:'buy',date:'2025-03-05',price:182000,qty:20,fee:2100,emotion:'ğŸ’ª í™•ì‹ ',note:'HBM ìˆ˜ìš” ê¸°ì‚¬ í™•ì¸',fundType:'cash'},
        ]
      },
      { id:_uid(), name:'NVIDIA', market:'US', ticker:'NVDA', currency:'USD',
        strategy:'ì„±ì¥ì£¼', targetPrice:180, stopPrice:105, status:'holding',
        note:'AI ì¸í”„ë¼ ìˆ˜ìš” ì§€ì†', currentPrice:138,
        trades:[
          {id:_uid(),type:'buy',date:'2025-01-20',price:112,qty:10,fee:0,emotion:'ğŸ’ª í™•ì‹ ',note:'ì‹¤ì  ì„œí”„ë¼ì´ì¦ˆ í›„ ëˆŒë¦¼ëª©',fundType:'cash'},
          {id:_uid(),type:'buy',date:'2025-03-10',price:118,qty:5,fee:0,emotion:'ğŸ˜ ëƒ‰ì •',note:'ì¶”ê°€ ë§¤ìˆ˜',fundType:'cash'},
        ]
      },
      { id:_uid(), name:'ì¹´ì¹´ì˜¤', market:'KRX', ticker:'035720', currency:'KRW',
        strategy:'ê°€ì¹˜íˆ¬ì', status:'closed', note:'í”Œë«í¼ ê·œì œ ë¦¬ìŠ¤í¬ í•´ì†Œ',
        trades:[
          {id:_uid(),type:'buy',date:'2024-10-15',price:38500,qty:80,fee:1800,emotion:'ğŸ’ í™•ì‹ ',note:'PBR 0.8 ì—­ëŒ€ ì €ì ',fundType:'cash'},
          {id:_uid(),type:'sell',date:'2025-01-22',price:46200,qty:80,fee:2100,emotion:'ğŸ˜ ëƒ‰ì •',note:'ëª©í‘œê°€ ë„ë‹¬',fundType:'cash'},
        ]
      },
      { id:_uid(), name:'LGì—ë„ˆì§€ì†”ë£¨ì…˜', market:'KRX', ticker:'373220', currency:'KRW',
        strategy:'ì´ë™í‰ê· ì„ ', status:'closed', note:'ì „ê¸°ì°¨ ë°°í„°ë¦¬ ìˆ˜ì£¼ ëª¨ë©˜í…€',
        trades:[
          {id:_uid(),type:'buy',date:'2024-11-04',price:285000,qty:5,fee:800,emotion:'ğŸ˜ ëƒ‰ì •',note:'200ì¼ì„  ì§€ì§€',fundType:'cash'},
          {id:_uid(),type:'sell',date:'2025-02-17',price:268000,qty:5,fee:750,emotion:'ğŸ˜° ë¶ˆì•ˆ',note:'ì†ì ˆ â€” ì‹œì¥ ì•½ì„¸',fundType:'cash'},
        ]
      },
      { id:_uid(), name:'Tesla', market:'US', ticker:'TSLA', currency:'USD',
        strategy:'ëª¨ë©˜í…€', status:'closed', note:'ì‹ ì°¨ ì¶œì‹œ ê¸°ëŒ€',
        trades:[
          {id:_uid(),type:'buy',date:'2024-12-03',price:248,qty:8,fee:0,emotion:'ğŸ˜¤ í¥ë¶„',note:'ëŒíŒŒ ë§¤ìˆ˜',fundType:'cash'},
          {id:_uid(),type:'sell',date:'2025-02-28',price:312,qty:8,fee:0,emotion:'ğŸ’ª í™•ì‹ ',note:'+25% ëª©í‘œ ë„ë‹¬',fundType:'cash'},
        ]
      },
    ];
    savePos();
  }

  renderAll();
  reqNotif();
  checkAllMarginDue(); // ë¯¸ìˆ˜ ê²°ì œì¼ ì¼ê´„ ì²´í¬
}

function checkAllMarginDue() {
  const today = td();
  let overdue = 0, urgent = 0;
  positions.filter(p=>p.status==='holding').forEach(pos=>{
    pos.trades.forEach(t=>{
      if(t.type!=='buy'||t.fundType!=='margin'||!t.marginDue) return;
      if(t.marginDue < today) overdue++;
      else if(dBetween(today, t.marginDue) <= 1) urgent++;
    });
  });
  if(overdue > 0) showToast(`ğŸš¨ ë¯¸ìˆ˜ ê²°ì œ ë¯¸ì™„ë£Œ ${overdue}ê±´ â€” ì¦‰ì‹œ í™•ì¸!`, 6000);
  else if(urgent > 0) showToast(`âš¡ ë‚´ì¼ê¹Œì§€ ë¯¸ìˆ˜ ê²°ì œ ${urgent}ê±´ ìˆìŒ`, 5000);
}


// â”€â”€ ì—†ëŠ” í•¨ìˆ˜ ìŠ¤í… (ì•± ì‹œì‘ ì˜¤ë¥˜ ë°©ì§€) â”€â”€
function reqNotif() {
  if(typeof Notification !== 'undefined' && Notification.permission === 'default') {
    Notification.requestPermission().catch(()=>{});
  }
}
async function loadFunds() {
  try {
    const _r = localStorage.getItem('tl-funds');
    if(_r) { const d=JSON.parse(_r); accounts=d.accounts||[]; txList=d.txList||[]; interestList=d.interestList||[]; }
  } catch(e) {}
}
function renderFunds() {
  const el = document.getElementById('view-funds'); if(!el) return;
}
function renderStats() {
  renderAnalytics();
}
function renderCalendar() {
  const el = document.getElementById('view-calendar'); if(!el) return;
  const hdr  = document.getElementById('cal-label');
  const grid = document.getElementById('cal-grid');
  const weekCol = document.getElementById('cal-week-col');
  const monthSumEl = document.getElementById('cal-month-sum');
  if(!hdr || !grid) return;

  const months = ['1ì›”','2ì›”','3ì›”','4ì›”','5ì›”','6ì›”','7ì›”','8ì›”','9ì›”','10ì›”','11ì›”','12ì›”'];
  hdr.textContent = calYear + 'ë…„ ' + months[calMonth];
  const ym0 = `${calYear}-${String(calMonth+1).padStart(2,'0')}`;
  const first = new Date(calYear, calMonth, 1).getDay();
  const days  = new Date(calYear, calMonth+1, 0).getDate();
  const today = td();

  // â”€â”€ ë‚ ì§œë³„ ë°ì´í„° ìˆ˜ì§‘ â”€â”€
  // dayData[dateStr] = { buys:[], sells:[], realPnL:0, unrealPnL:0, events:[] }
  const dayData = {};
  const ensureDay = d => { if(!dayData[d]) dayData[d]={buys:[],sells:[],realPnL:0,unrealPnL:0,events:[]}; return dayData[d]; };

  // ì´ë²¤íŠ¸ ìˆ˜ì§‘
  getEffectiveEvents().filter(e => e.date.slice(0,7) === ym0).forEach(e => {
    ensureDay(e.date).events.push(e);
  });

  positions.forEach(pos => {
    const c = calcPos(pos);
    pos.trades.forEach(t => {
      if(t.date.slice(0,7) !== ym0) return;
      const dd = ensureDay(t.date);
      if(t.type === 'buy') {
        dd.buys.push(pos.name);
        // ë¯¸ì‹¤í˜„ ì†ìµ (ë³´ìœ  ì¤‘ì¸ ê²½ìš° í•´ë‹¹ íŠ¸ë ˆì´ë“œ ë¹„ì¤‘ë§Œí¼)
        if(pos.status === 'holding') {
          const costHere = t.price * t.qty;
          const totalCost = c.invested;
          if(totalCost > 0) dd.unrealPnL += c.unrealPnL * (costHere / totalCost);
        }
      } else {
        dd.sells.push(pos.name);
        // ì´ ë§¤ë„ë¡œ ë°œìƒí•œ ì‹¤í˜„ì†ìµ â€” ë§¤ë„ ë¹„ì¤‘ìœ¼ë¡œ ì•ˆë¶„
        const sellAmt = t.price * t.qty;
        const totalSellAmt = pos.trades.filter(x=>x.type==='sell').reduce((s,x)=>s+x.price*x.qty,0);
        if(totalSellAmt > 0) dd.realPnL += c.realPnL * (sellAmt / totalSellAmt);
      }
    });
  });

  // â”€â”€ ë‚ ì§œ ì…€ ë Œë” â”€â”€
  let cells = '';
  for(let i=0;i<first;i++) cells += '<div class="cal-day empty"></div>';

  // ì£¼ë³„ í•©ê³„ ê³„ì‚°ìš©
  const weekSums = [];
  let curWeek = { realPnL:0, unrealPnL:0, tradeCnt:0, startDay: 1-first };

  const flushWeek = (dayNum) => {
    weekSums.push({...curWeek, endDay: dayNum});
    curWeek = { realPnL:0, unrealPnL:0, tradeCnt:0, startDay: dayNum+1 };
  };

  for(let d=1;d<=days;d++) {
    const dateStr = `${ym0}-${String(d).padStart(2,'0')}`;
    const dd = dayData[dateStr];
    const isToday = dateStr === today;
    const dow = new Date(calYear, calMonth, d).getDay();

    // í´ë˜ìŠ¤
    let cls = 'cal-day';
    if(isToday) cls += ' today';
    if(dd) {
      if(dd.realPnL > 0 || dd.unrealPnL > 0) cls += ' has-profit';
      else if(dd.realPnL < 0 || dd.unrealPnL < 0) cls += ' has-loss';
    }

    // ë‚ ì§œ ë²ˆí˜¸
    let inner = `<div class="cal-num${isToday?' is-today':''}">${d}</div>`;

    // ì¢…ëª© íƒœê·¸
    if(dd) {
      // ì¤‘ë³µ ì œê±°
      const uniqBuys  = [...new Set(dd.buys)];
      const uniqSells = [...new Set(dd.sells)];
      const maxShow = 3;
      let shown = 0;
      uniqBuys.slice(0, maxShow).forEach(n => {
        inner += `<span class="cal-tag buy">ğŸ”´ ${n}</span>`;
        shown++;
      });
      uniqSells.slice(0, maxShow - shown).forEach(n => {
        inner += `<span class="cal-tag sell">ğŸ”µ ${n}</span>`;
      });
      const totalShown = Math.min(uniqBuys.length + uniqSells.length, maxShow);
      const remaining = (uniqBuys.length + uniqSells.length) - totalShown;
      if(remaining > 0) inner += `<span style="font-size:9px;color:var(--muted)">+${remaining}ê±´ ë”</span>`;

      // ì†ìµ í‘œì‹œ
      const realPnL = dd.realPnL;
      const unrPnL  = dd.unrealPnL;
      if(Math.abs(realPnL) > 0) {
        const col = realPnL>=0?'var(--profit)':'var(--loss)';
        inner += `<div class="cal-day-pnl" style="color:${col}">${realPnL>=0?'+':''}${fmtN(Math.round(realPnL),'KRW')}</div>`;
      } else if(Math.abs(unrPnL) > 0) {
        const col = unrPnL>=0?'var(--profit)':'var(--loss)';
        inner += `<div class="cal-day-pnl" style="color:${col};opacity:.7">(${unrPnL>=0?'+':''}${fmtN(Math.round(unrPnL),'KRW')})</div>`;
      }

      // ì£¼ë³„ ëˆ„ì 
      curWeek.realPnL   += dd.realPnL;
      curWeek.unrealPnL += dd.unrealPnL;
      curWeek.tradeCnt  += dd.buys.length + dd.sells.length;
    }

    // ì´ë²¤íŠ¸ í‘œì‹œ
    if(dd && dd.events && dd.events.length) {
      const EVT_ICONS = {earnings:'ğŸ“Š',court:'âš–ï¸',disclosure:'ğŸ“¢',macro:'ğŸŒ',dividend:'ğŸ’°',etc:'ğŸ“Œ'};
      dd.events.forEach(ev => {
        const ico = EVT_ICONS[ev.category] || 'ğŸ“Œ';
        const themes = ev.themes && ev.themes.length ? ` ${ev.themes[0]}` : '';
        inner += `<div style="font-size:9px;margin-top:2px;padding:1px 4px;background:var(--accent)22;border-left:2px solid var(--accent);border-radius:0 3px 3px 0;color:var(--accent);white-space:nowrap;overflow:hidden;text-overflow:ellipsis" title="${ev.title}">${ico}${themes} ${ev.title}</div>`;
      });
    }

    cells += `<div class="${cls}" onclick="openDayDetail('${dateStr}')">${inner}</div>`;

    // í† ìš”ì¼ì´ê±°ë‚˜ ë§ˆì§€ë§‰ ë‚ ì´ë©´ ì£¼ ë§ˆë¬´ë¦¬
    if(dow === 6 || d === days) flushWeek(d);
  }

  grid.innerHTML = cells;

  // â”€â”€ ì£¼ë³„ í•©ê³„ ì»¬ëŸ¼ â”€â”€
  if(weekCol) {
    let weekHtml = '<div class="cal-week-hdr">ì£¼ë³„ í•©ê³„</div>';
    weekSums.forEach((w, i) => {
      const rCol = w.realPnL>=0?'var(--profit)':'var(--loss)';
      const uCol = w.unrealPnL>=0?'var(--profit)':'var(--loss)';
      const hasData = Math.abs(w.realPnL)>0 || Math.abs(w.unrealPnL)>0 || w.tradeCnt>0;
      weekHtml += `<div class="cal-week-sum">
        ${w.tradeCnt>0 ? `<div style="color:var(--muted)">${w.tradeCnt}ê±´</div>` : '<div style="color:var(--border)">â€”</div>'}
        ${Math.abs(w.realPnL)>0 ? `<div style="color:${rCol};font-weight:700;font-family:'Roboto Mono',monospace">${w.realPnL>=0?'+':''}${Math.round(w.realPnL/10000)}ë§Œ</div>` : ''}
        ${Math.abs(w.unrealPnL)>0 ? `<div style="color:${uCol};opacity:.7;font-size:9px">(${w.unrealPnL>=0?'+':''}${Math.round(w.unrealPnL/10000)}ë§Œ)</div>` : ''}
      </div>`;
    });
    weekCol.innerHTML = weekHtml;
  }

  // â”€â”€ ì›”ë³„ í•©ê³„ â”€â”€
  const monthReal  = Object.values(dayData).reduce((s,d)=>s+d.realPnL,0);
  const monthUnr   = Object.values(dayData).reduce((s,d)=>s+d.unrealPnL,0);
  const monthTotal = monthReal + monthUnr;
  const tradeDays  = Object.keys(dayData).length;
  const winDays    = Object.values(dayData).filter(d=>d.realPnL>0).length;
  const loseDays   = Object.values(dayData).filter(d=>d.realPnL<0).length;
  const allBuys    = Object.values(dayData).reduce((s,d)=>s+d.buys.length,0);
  const allSells   = Object.values(dayData).reduce((s,d)=>s+d.sells.length,0);

  if(monthSumEl) {
    const rCol = monthReal>=0?'var(--profit)':'var(--loss)';
    const uCol = monthUnr>=0?'var(--profit)':'var(--loss)';
    const tCol = monthTotal>=0?'var(--profit)':'var(--loss)';
    monthSumEl.innerHTML = [
      `<div><span style="color:var(--muted)">ë§¤ìˆ˜</span> <b>${allBuys}ê±´</b></div>`,
      `<div><span style="color:var(--muted)">ë§¤ë„</span> <b>${allSells}ê±´</b></div>`,
      `<div><span style="color:var(--muted)">ìˆ˜ìµì¼</span> <b style="color:var(--profit)">${winDays}ì¼</b></div>`,
      `<div><span style="color:var(--muted)">ì†ì‹¤ì¼</span> <b style="color:var(--loss)">${loseDays}ì¼</b></div>`,
      `<div>ì‹¤í˜„ <b style="color:${rCol};font-family:'Roboto Mono',monospace">${monthReal>=0?'+':''}${fmtN(Math.round(monthReal),'KRW')}</b></div>`,
      `<div>í‰ê°€ <b style="color:${uCol};font-family:'Roboto Mono',monospace;opacity:.8">(${monthUnr>=0?'+':''}${fmtN(Math.round(monthUnr),'KRW')})</b></div>`,
      `<div style="font-weight:800">ì´ <b style="color:${tCol};font-family:'Roboto Mono',monospace">${monthTotal>=0?'+':''}${fmtN(Math.round(monthTotal),'KRW')}</b></div>`,
    ].join('<span style="color:var(--border)">|</span>');
  }

  // summary í…ìŠ¤íŠ¸ (í—¤ë”)
  const sumEl = document.getElementById('cal-summary');
  if(sumEl) {
    sumEl.innerHTML = tradeDays
      ? `ê±°ë˜ì¼ <b>${tradeDays}ì¼</b> &nbsp; ì‹¤í˜„ <b style="color:${rCol};font-family:'Roboto Mono',monospace">${monthReal>=0?'+':''}${fmtN(Math.round(monthReal),'KRW')}</b>`
      : 'ì´ ë‹¬ì— ë§¤ë§¤ ì—†ìŒ';
  }
}

// â”€â”€ ë‚ ì§œ í´ë¦­ â†’ ë§¤ë§¤ ìƒì„¸ + ì¼ì§€ íŒì—… â”€â”€
function openDayDetail(dateStr) {
  document.getElementById('day-modal-title').textContent = `ğŸ“… ${dateStr}`;

  // ë§¤ë§¤ ë‚´ì—­
  const tradesEl = document.getElementById('day-trades-list');
  const ym = dateStr.slice(0,7);
  const dayTrades = [];
  positions.forEach(pos => {
    pos.trades.filter(t => t.date === dateStr).forEach(t => {
      dayTrades.push({ pos, t });
    });
  });

  if(!dayTrades.length) {
    tradesEl.innerHTML = '<div style="color:var(--muted);font-size:12px;padding:4px 0">ì´ ë‚  ë§¤ë§¤ ì—†ìŒ</div>';
  } else {
    tradesEl.innerHTML = dayTrades.map(({pos, t}) => {
      const isBuy  = t.type === 'buy';
      const col    = isBuy ? 'var(--profit)' : 'var(--loss)';
      const label  = isBuy ? 'ğŸ”´ ë§¤ìˆ˜' : 'ğŸ”µ ë§¤ë„';
      const c      = calcPos(pos);
      const pnlStr = !isBuy
        ? (() => {
            const totalSellAmt = pos.trades.filter(x=>x.type==='sell').reduce((s,x)=>s+x.price*x.qty,0);
            const thisAmt = t.price * t.qty;
            const pnl = totalSellAmt>0 ? c.realPnL*(thisAmt/totalSellAmt) : 0;
            const col2 = pnl>=0?'var(--profit)':'var(--loss)';
            return `<span style="color:${col2};font-family:'Roboto Mono',monospace;font-size:11px;font-weight:700">${pnl>=0?'+':''}${fmtN(Math.round(pnl),'KRW')}</span>`;
          })()
        : '';
      return `
      <div style="display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px solid var(--border)">
        <span style="font-size:11px;padding:2px 8px;border-radius:4px;background:${isBuy?'rgba(240,62,62,.12)':'rgba(29,126,214,.12)'};color:${col};font-weight:700;white-space:nowrap">${label}</span>
        <div style="flex:1">
          <div style="font-weight:700;font-size:13px">${pos.name}</div>
          <div style="font-size:11px;color:var(--muted)">${fmtP(t.price, pos.currency)} Ã— ${t.qty}ì£¼${t.fee?` Â· ìˆ˜ìˆ˜ë£Œ ${fmtN(t.fee,pos.currency)}`:''}</div>
          ${t.note?`<div style="font-size:11px;color:var(--muted);margin-top:1px">ğŸ’¬ ${t.note}</div>`:''}
        </div>
        ${pnlStr}
      </div>`;
    }).join('');
  }

  // ì¼ì§€ ì˜ì—­
  const journalEl = document.getElementById('day-journal-area');
  const existing = (journals||[]).find(j => j.date === dateStr);
  if(existing) {
    journalEl.innerHTML = `
      <div style="font-size:13px;line-height:1.8;white-space:pre-wrap;color:var(--text)">${existing.content||''}</div>
      <div style="margin-top:10px;display:flex;gap:8px">
        <button class="btn btn-outline btn-sm" onclick="openJournalWrite('${existing.id}','${dateStr}');cm('m-day-detail')">âœï¸ ìˆ˜ì •</button>
      </div>`;
  } else {
    journalEl.innerHTML = `
      <div style="color:var(--muted);font-size:12px;margin-bottom:10px">ì´ ë‚  ì¼ì§€ ì—†ìŒ</div>
      <button class="btn btn-primary btn-sm" onclick="openJournalWrite(null,'${dateStr}');cm('m-day-detail')">ğŸ““ ì¼ì§€ ì‘ì„±</button>`;
  }

  om('m-day-detail');
}
async function savePos() {
  try { localStorage.setItem('tl-v4-pos', JSON.stringify(positions)); } catch(e) {}
}
async function saveTmplStore() {
  try { localStorage.setItem('tl-v4-tmpl', JSON.stringify(templates)); } catch(e) {}
}
async function saveRules() {
  try { localStorage.setItem('tl-rules', JSON.stringify({rules, violations, checkState})); } catch(e) {}
}
async function saveEvents() {
  try { localStorage.setItem('tl-events', JSON.stringify(events)); } catch(e) {}
}
async function saveGoalsStore() {
  try { localStorage.setItem('tl-goals', JSON.stringify(goals)); } catch(e) {}
}
let rules = [];
let violations = [];
let goals = [];
let checkState = { entry: {}, exit: {} };
let events = []; // { id, date, title, category, stocks, memo, repeat }

const DEFAULT_ENTRY_CHECKS = [
  'ì¶”ì„¸ ë°©í–¥ì„ í™•ì¸í–ˆë‹¤ (ì¼ë´‰/ì£¼ë´‰)',
  'ì§€ì§€/ì €í•­ êµ¬ê°„ì„ íŒŒì•…í–ˆë‹¤',
  'ì†ì ˆê°€ë¥¼ ë¯¸ë¦¬ ì„¤ì •í–ˆë‹¤',
  'ëª©í‘œê°€ ëŒ€ë¹„ ì†ìµë¹„ 2:1 ì´ìƒì´ë‹¤',
  'ë‰´ìŠ¤/ê³µì‹œë¥¼ í™•ì¸í–ˆë‹¤',
  'ê±°ë˜ëŸ‰ ì´ìƒ ì—†ìŒì„ í™•ì¸í–ˆë‹¤',
  'ì „ì²´ ìì‚°ì˜ 10% ì´í•˜ ë¹„ì¤‘ì´ë‹¤',
  'ê°ì •ì  ì¶©ë™ì´ ì•„ë‹Œ ê³„íšëœ ì§„ì…ì´ë‹¤',
  // â”€â”€ ë¯¸ë„ˆë¹„ë‹ˆ SEPA ì¶”ê°€ í•­ëª© â”€â”€
  '[SEPA] í˜„ì¬ê°€ > 50ì¼ì„  > 150ì¼ì„  > 200ì¼ì„  ì •ë ¬',
  '[SEPA] 200ì¼ì„ ì´ ìš°ìƒí–¥ ì¤‘ì´ë‹¤',
  '[SEPA] 52ì£¼ ê³ ê°€ì˜ 75% ì´ë‚´ ìœ„ì¹˜',
  '[SEPA] RS(ìƒëŒ€ê°•ë„) 70 ì´ìƒ',
  '[SEPA] VCP íŒ¨í„´ ë˜ëŠ” í”¼ë²— í¬ì¸íŠ¸ í™•ì¸',
  '[SEPA] ëŒíŒŒ ê±°ë˜ëŸ‰ 50ì¼ í‰ê·  2ë°° ì´ìƒ',
  '[SEPA] ì§€ìˆ˜(ì½”ìŠ¤í”¼/ì½”ìŠ¤ë‹¥) ìƒìŠ¹ ì¶”ì„¸ í™•ì¸',
];
const DEFAULT_EXIT_CHECKS = [
  'ëª©í‘œê°€ì— ë„ë‹¬í–ˆê±°ë‚˜ ê·¸ ì´ìœ ê°€ ëª…í™•í•˜ë‹¤',
  'ì†ì ˆê°€ì— ë„ë‹¬í–ˆë‹¤ (ê·œì¹™ ì¤€ìˆ˜)',
  'ë³´ìœ  ì´ìœ ê°€ ì—¬ì „íˆ ìœ íš¨í•œê°€',
  'ë” ì¢‹ì€ ê¸°íšŒê°€ ìˆì–´ì„œ ìê¸ˆì´ í•„ìš”í•œê°€',
  'ê°ì •ì  íŒ¨ë‹‰ ë§¤ë„ê°€ ì•„ë‹Œê°€',
  // â”€â”€ ë¯¸ë„ˆë¹„ë‹ˆ SEPA ì²­ì‚° ì¡°ê±´ â”€â”€
  '[SEPA] -7~8% ì†ì ˆì„  ë„ë‹¬ â†’ ì¦‰ì‹œ ì²­ì‚°',
  '[SEPA] 50ì¼ì„  ì•„ë˜ë¡œ í•˜ë½ (ì¶”ì„¸ í›¼ì†)',
  '[SEPA] í”¼ë²— ëŒíŒŒ í›„ -3% ì´ë‚´ ë˜ëŒë¦¼ (ì‹¤íŒ¨ ëŒíŒŒ)',
  '[SEPA] ì§€ìˆ˜ ë¶„ì‚°ì¼(Distribution Day) 5ì¼ ì´ìƒ ëˆ„ì ',
  '[SEPA] +10~20% ìˆ˜ìµ êµ¬ê°„ â€” 1/3 ì´ìµì‹¤í˜„ ê³ ë ¤',
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• âš–ï¸ ë¦¬ìŠ¤í¬ ê³„ì‚°ê¸° â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ì „ëµ ë¹„êµ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const COMPARE_DATA = {
  minervini: {
    label: 'âš¡ ë¯¸ë„ˆë¹„ë‹ˆ',
    color: '#3b82f6',
    rows: {
      'ì² í•™': 'íŒ¨í„´ + í€ë”ë©˜íƒˆ ê²°í•©. ìµœì†Œ ë¦¬ìŠ¤í¬ë¡œ ìµœëŒ€ ìˆ˜ìµ íƒ€ì´ë° í¬ì°©',
      'ì°½ì‹œì': 'Mark Minervini (USIC ì±”í”¼ì–¸ì‹­ ìš°ìŠ¹)',
      'ì§„ì… ë°©ë²•': 'VCP íŒ¨í„´ ì™„ì„± í›„ í”¼ë´‡ í¬ì¸íŠ¸ ëŒíŒŒ ì¦‰ì‹œ ì§„ì…',
      'ì§„ì… ì¡°ê±´': 'ê±°ë˜ëŸ‰ 150%â†‘ + 52ì£¼ ì‹ ê³ ê°€ 25% ì´ë‚´ + SEPA ì¶©ì¡±',
      'ì†ì ˆ ê¸°ì¤€': 'í”¼ë´‡ ê¸°ì¤€ -1~3% (ë§¤ìš° íƒ€ì´íŠ¸)',
      'ì†ì ˆ ë°©ì‹': 'ê³ ì • ì†ì ˆ (ê°€ê²© ê¸°ì¤€)',
      'í¬ì§€ì…˜ í¬ê¸°': 'ê³„ì¢Œ ë¦¬ìŠ¤í¬ 1~2% ê¸°ì¤€, ì¢…ëª©ë‹¹ 10~15%',
      'í”¼ë¼ë¯¸ë”©': 'ìƒìŠ¹ í™•ì¸ í›„ ìµœëŒ€ 3íšŒ ì¶”ê°€ (50%â†’30%â†’20%)',
      'ì²­ì‚° ì‹ í˜¸': '5ì¼ì„  ì´íƒˆ, ê±°ë˜ëŸ‰ ê¸‰ê°, ìŒë´‰ 3ì¼, ì „ê³ ì  ì‹¤íŒ¨',
      'ë³´ìœ  ê¸°ê°„': 'ìˆ˜ì£¼~ìˆ˜ê°œì›” (ì¶”ì„¸ ì§€ì† ì‹œ)',
      'í€ë”ë©˜íƒˆ': 'í•„ìˆ˜ â€” EPS 25%â†‘, ROE 17%â†‘, ë§¤ì¶œ ì„±ì¥',
      'ì‹œì¥ ë°©í–¥': 'ìƒìŠ¹ì¥ì—ì„œë§Œ ì§„ì… (M í™•ì¸ í•„ìˆ˜)',
      'ìŠ¹ë¥  ëª©í‘œ': '40~50% (ì†ìµë¹„ë¡œ ë³´ì™„)',
      'ì†ìµë¹„ ëª©í‘œ': '3:1 ì´ìƒ',
      'ë‚œì´ë„': 'ë†’ìŒ â€” ì°¨íŠ¸ í•´ì„ + í€ë”ë©˜íƒˆ ë¶„ì„ ë™ì‹œ í•„ìš”',
      'ìë™í™” ê°€ëŠ¥': 'ì–´ë ¤ì›€ â€” íŒ¨í„´ íŒë‹¨ ì£¼ê´€ì ',
      'ì í•©í•œ ì„±ê²©': 'ë¶„ì„ì , ì¸ë‚´ì‹¬ ê°•, ì›ì¹™ ì¤€ìˆ˜í˜•',
    }
  },
  turtle: {
    label: 'ğŸ¢ í„°í‹€',
    color: '#10b981',
    rows: {
      'ì² í•™': 'ì‚¬ëŒì˜ íŒë‹¨ ë°°ì œ. ì‹œìŠ¤í…œ ê·œì¹™ë§Œìœ¼ë¡œ ëŒ€í˜• ì¶”ì„¸ í¬ì°©',
      'ì°½ì‹œì': 'Richard Dennis (1983ë…„ í„°í‹€ ì‹¤í—˜)',
      'ì§„ì… ë°©ë²•': 'Nì¼ ì‹ ê³ ê°€ ëŒíŒŒ ì‹œ ê¸°ê³„ì  ë§¤ìˆ˜ (íŒë‹¨ ì—†ìŒ)',
      'ì§„ì… ì¡°ê±´': 'ì‹œìŠ¤í…œ1: 20ì¼ ì‹ ê³ ê°€ / ì‹œìŠ¤í…œ2: 55ì¼ ì‹ ê³ ê°€',
      'ì†ì ˆ ê¸°ì¤€': 'ì§„ì…ê°€ ê¸°ì¤€ -2N (ATR ë³€ë™í­ ê¸°ë°˜, ìœ ì—°)',
      'ì†ì ˆ ë°©ì‹': 'ATR ê¸°ë°˜ ë™ì  ì†ì ˆ (ë³€ë™ì„±ì— ë”°ë¼ ìë™ ì¡°ì •)',
      'í¬ì§€ì…˜ í¬ê¸°': 'ê³„ì¢Œ 1% Ã· 2N = 1ìœ ë‹›. ë¦¬ìŠ¤í¬ ì™„ì „ ê³ ì •',
      'í”¼ë¼ë¯¸ë”©': '+0.5Në§ˆë‹¤ 1ìœ ë‹› ì¶”ê°€, ìµœëŒ€ 4ìœ ë‹›ê¹Œì§€ ê¸°ê³„ì  ì¶”ê°€',
      'ì²­ì‚° ì‹ í˜¸': 'ì‹œìŠ¤í…œ1: 10ì¼ ì‹ ì €ê°€ / ì‹œìŠ¤í…œ2: 20ì¼ ì‹ ì €ê°€ ì´íƒˆ',
      'ë³´ìœ  ê¸°ê°„': 'ìˆ˜ê°œì›”~1ë…„+ (ëŒ€í˜• ì¶”ì„¸ ëê¹Œì§€ ë³´ìœ )',
      'í€ë”ë©˜íƒˆ': 'ë¶ˆí•„ìš” â€” ê°€ê²©ê³¼ ê±°ë˜ëŸ‰ë§Œ ì‚¬ìš©',
      'ì‹œì¥ ë°©í–¥': 'ìƒê´€ì—†ìŒ â€” í•˜ë½ì¥ì—ë„ ê³µë§¤ë„ ì ìš© ê°€ëŠ¥',
      'ìŠ¹ë¥  ëª©í‘œ': '30~40% (ëŒ€í˜• ìˆ˜ìµ ëª‡ ë²ˆì´ ì—°ê°„ ì„±ê³¼ ê²°ì •)',
      'ì†ìµë¹„ ëª©í‘œ': '5:1 ì´ìƒ (ì¼ë¶€ í¬ì§€ì…˜ 100~300% ìˆ˜ìµ)',
      'ë‚œì´ë„': 'ë³´í†µ â€” ê·œì¹™ ë‹¨ìˆœí•˜ì§€ë§Œ ì‹¬ë¦¬ì  ì¸ë‚´ ê·¹ë„ë¡œ ì–´ë ¤ì›€',
      'ìë™í™” ê°€ëŠ¥': 'ë§¤ìš° ì‰¬ì›€ â€” ì™„ì „ ê¸°ê³„ì  ê·œì¹™',
      'ì í•©í•œ ì„±ê²©': 'ì‹œìŠ¤í…œ ì‹ ë¢°í˜•, ì¥ê¸° ë§ˆì¸ë“œ, ì—°ì† ì†ì ˆ ê²¬ë””ëŠ” ì¸ë‚´',
    }
  },
  momentum: {
    label: 'ğŸš€ ëª¨ë©˜í…€',
    color: '#f59e0b',
    rows: {
      'ì² í•™': 'ìƒìŠ¹ ì¶”ì„¸ ì˜¬ë¼íƒ€ê¸°. ì¶”ì„¸ê°€ ì‚´ì•„ìˆëŠ” í•œ ë³´ìœ ',
      'ì°½ì‹œì': 'ë‹¤ì–‘ (William O\'Neil IBD ë°©ì‹ ë“±)',
      'ì§„ì… ë°©ë²•': 'ì‹ ê³ ê°€ ëŒíŒŒ + ê±°ë˜ëŸ‰ ê¸‰ì¦ í™•ì¸ í›„ ì§„ì…',
      'ì§„ì… ì¡°ê±´': 'ê±°ë˜ëŸ‰ 150%â†‘ + ê°•ì„¸ ì‹œì¥ í™•ì¸',
      'ì†ì ˆ ê¸°ì¤€': 'ë§¤ìˆ˜ê°€ -3~5%',
      'ì†ì ˆ ë°©ì‹': 'ê³ ì • ì†ì ˆ',
      'í¬ì§€ì…˜ í¬ê¸°': 'ê³„ì¢Œ ë¦¬ìŠ¤í¬ 2% ê¸°ì¤€',
      'í”¼ë¼ë¯¸ë”©': 'ì¶”ì„¸ í™•ì¸ í›„ 2íšŒ ì¶”ê°€ (60%â†’40%)',
      'ì²­ì‚° ì‹ í˜¸': '5ì¼ì„  ì´íƒˆ, ê±°ë˜ëŸ‰ ê¸‰ê°',
      'ë³´ìœ  ê¸°ê°„': 'ìˆ˜ì¼~ìˆ˜ì£¼',
      'í€ë”ë©˜íƒˆ': 'ì°¸ê³  ìˆ˜ì¤€',
      'ì‹œì¥ ë°©í–¥': 'ê°•ì„¸ì¥ í•„ìˆ˜',
      'ìŠ¹ë¥  ëª©í‘œ': '40~50%',
      'ì†ìµë¹„ ëª©í‘œ': '2:1 ì´ìƒ',
      'ë‚œì´ë„': 'ì¤‘ê°„',
      'ìë™í™” ê°€ëŠ¥': 'ë¶€ë¶„ ê°€ëŠ¥',
      'ì í•©í•œ ì„±ê²©': 'ë¹ ë¥¸ ê²°ë‹¨, ì†ì ˆ ì£¼ì € ì—†ìŒ',
    }
  },
  value: {
    label: 'ğŸ’ ê°€ì¹˜íˆ¬ì',
    color: '#8b5cf6',
    rows: {
      'ì² í•™': 'ë‚´ì¬ê°€ì¹˜ ëŒ€ë¹„ ì €í‰ê°€ ì¢…ëª© ë°œêµ´. ì‹œì¥ ê³µí¬ê°€ ê¸°íšŒ',
      'ì°½ì‹œì': 'Benjamin Graham / Warren Buffett',
      'ì§„ì… ë°©ë²•': 'ë°¸ë¥˜ì—ì´ì…˜ ë¶„ì„ í›„ ì•ˆì „ë§ˆì§„ í™•ë³´ ì‹œ ë¶„í•  ë§¤ìˆ˜',
      'ì§„ì… ì¡°ê±´': 'PERÂ·PBR ì €í‰ê°€ + ROE 10%â†‘ + ì•ˆì „ë§ˆì§„ 30%',
      'ì†ì ˆ ê¸°ì¤€': 'Thesis í›¼ì† ì‹œë§Œ ì†ì ˆ (ê°€ê²© í•˜ë½ì€ ì‚¬ìœ  ì•„ë‹˜)',
      'ì†ì ˆ ë°©ì‹': 'ì •ì„±ì  íŒë‹¨ ê¸°ë°˜',
      'í¬ì§€ì…˜ í¬ê¸°': 'ì¢…ëª©ë‹¹ 5~20% (ì§‘ì¤‘ íˆ¬ì í—ˆìš©)',
      'í”¼ë¼ë¯¸ë”©': 'í•˜ë½ ì‹œ í‰ë‹¨ê°€ ë‚®ì¶”ëŠ” ì¶”ê°€ë§¤ìˆ˜ (4ë¶„í• )',
      'ì²­ì‚° ì‹ í˜¸': 'ëª©í‘œê°€ ë„ë‹¬ ë˜ëŠ” Thesis í›¼ì†',
      'ë³´ìœ  ê¸°ê°„': 'ìˆ˜ê°œì›”~ìˆ˜ë…„',
      'í€ë”ë©˜íƒˆ': 'í•µì‹¬ â€” ì „ë¶€ í€ë”ë©˜íƒˆ ê¸°ë°˜',
      'ì‹œì¥ ë°©í–¥': 'ë¬´ê´€ â€” í•˜ë½ì¥ì´ ë§¤ìˆ˜ ê¸°íšŒ',
      'ìŠ¹ë¥  ëª©í‘œ': '60~70% (ì‹œê°„ì´ í¸)',
      'ì†ìµë¹„ ëª©í‘œ': '3:1 ì´ìƒ',
      'ë‚œì´ë„': 'ë†’ìŒ â€” ê¸°ì—… ë¶„ì„ ê¹Šì´ í•„ìš”',
      'ìë™í™” ê°€ëŠ¥': 'ë§¤ìš° ì–´ë ¤ì›€',
      'ì í•©í•œ ì„±ê²©': 'ë¶„ì„ê°€ ê¸°ì§ˆ, ì¥ê¸° ì¸ë‚´, ì—­ë°œìƒ',
    }
  },
  swing: {
    label: 'ğŸŒŠ ìŠ¤ìœ™',
    color: '#06b6d4',
    rows: {
      'ì² í•™': 'ì§€ì§€Â·ì €í•­ êµ¬ê°„ í™œìš©, ìˆ˜ì¼~ìˆ˜ì£¼ íŒŒë™ í¬ì°©',
      'ì°½ì‹œì': 'ë‹¤ì–‘í•œ ê¸°ìˆ ì  ë¶„ì„ íŠ¸ë ˆì´ë”',
      'ì§„ì… ë°©ë²•': 'ì§€ì§€ì„  ê·¼ì²˜ ë˜ëŠ” ì €í•­ ëŒíŒŒ ì‹œ ì§„ì…',
      'ì§„ì… ì¡°ê±´': 'ì§€ì§€ì„  -1% ì´ë‚´ + ì†ìµë¹„ 2:1 ì´ìƒ',
      'ì†ì ˆ ê¸°ì¤€': 'ì§€ì§€ì„  ì´íƒˆ or ë§¤ìˆ˜ê°€ -4~6%',
      'ì†ì ˆ ë°©ì‹': 'ê³ ì • + ê¸°ìˆ ì  ì†ì ˆ ë³‘í–‰',
      'í¬ì§€ì…˜ í¬ê¸°': 'ê³„ì¢Œ ë¦¬ìŠ¤í¬ 2% ê¸°ì¤€',
      'í”¼ë¼ë¯¸ë”©': '2ë¶„í•  (70%â†’30%)',
      'ì²­ì‚° ì‹ í˜¸': 'ë‹¤ìŒ ì €í•­ì„  ë„ë‹¬ ë˜ëŠ” ì§€ì§€ ì´íƒˆ',
      'ë³´ìœ  ê¸°ê°„': '3ì¼~4ì£¼',
      'í€ë”ë©˜íƒˆ': 'ì°¸ê³  ìˆ˜ì¤€',
      'ì‹œì¥ ë°©í–¥': 'ì¤‘ë¦½~ê°•ì„¸ ì„ í˜¸',
      'ìŠ¹ë¥  ëª©í‘œ': '50~60%',
      'ì†ìµë¹„ ëª©í‘œ': '2:1 ì´ìƒ',
      'ë‚œì´ë„': 'ì¤‘ê°„',
      'ìë™í™” ê°€ëŠ¥': 'ë¶€ë¶„ ê°€ëŠ¥',
      'ì í•©í•œ ì„±ê²©': 'ì°¨íŠ¸ ë¶„ì„ ì¦ê¸°ëŠ” íƒ€ì…',
    }
  },
  scalping: {
    label: 'âš¡ ë‹¨ê¸°ìŠ¤ìº˜í•‘',
    color: '#ef4444',
    rows: {
      'ì² í•™': 'ì§§ì€ ì‹œê°„ ì†Œí­ ìˆ˜ìµ ë°˜ë³µ. ë¦¬ìŠ¤í¬ ìµœì†Œí™”',
      'ì°½ì‹œì': 'ë°ì´íŠ¸ë ˆì´ë” ë¬¸í™”',
      'ì§„ì… ë°©ë²•': 'í˜¸ê°€ì°½Â·ë¶„ë´‰ ê¸°ë°˜ ë‹¨ê¸° íŒ¨í„´ ì§„ì…',
      'ì§„ì… ì¡°ê±´': 'ë³€ë™ì„± ë†’ì€ ì¥ + ê±°ë˜ëŸ‰ ì§‘ì¤‘ êµ¬ê°„',
      'ì†ì ˆ ê¸°ì¤€': 'ë§¤ìˆ˜ê°€ -1~2%',
      'ì†ì ˆ ë°©ì‹': 'ë§¤ìš° íƒ€ì´íŠ¸í•œ ê³ ì • ì†ì ˆ',
      'í¬ì§€ì…˜ í¬ê¸°': 'ê³„ì¢Œ ë¦¬ìŠ¤í¬ 1% ê¸°ì¤€, ê³ íšŒì „',
      'í”¼ë¼ë¯¸ë”©': 'ì—†ìŒ â€” 1íšŒ ì¼ê´„ ì§„ì…Â·ì²­ì‚°',
      'ì²­ì‚° ì‹ í˜¸': 'ëª©í‘œê°€ ë„ë‹¬ ì¦‰ì‹œ (1~2%)',
      'ë³´ìœ  ê¸°ê°„': 'ìˆ˜ë¶„~ë‹¹ì¼',
      'í€ë”ë©˜íƒˆ': 'ë¶ˆí•„ìš”',
      'ì‹œì¥ ë°©í–¥': 'ë³€ë™ì„± ë†’ì€ ì¥ ì„ í˜¸',
      'ìŠ¹ë¥  ëª©í‘œ': '60~70% (ì¦ì€ ê±°ë˜ë¡œ ìŠ¹ë¥  ì¤‘ìš”)',
      'ì†ìµë¹„ ëª©í‘œ': '1.5:1 ì´ìƒ',
      'ë‚œì´ë„': 'ë§¤ìš° ë†’ìŒ â€” ì§‘ì¤‘ë ¥Â·ë°˜ì‚¬ì‹ ê²½ í•„ìš”',
      'ìë™í™” ê°€ëŠ¥': 'ê°€ëŠ¥ (ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”©)',
      'ì í•©í•œ ì„±ê²©': 'ë¹ ë¥¸ íŒë‹¨, ë†’ì€ ì§‘ì¤‘ë ¥, ê°ì • í†µì œ',
    }
  },
  growth: {
    label: 'ğŸŒ± ì„±ì¥ì£¼',
    color: '#22c55e',
    rows: {
      'ì² í•™': 'ê³ ì„±ì¥ ê¸°ì—…ì— ì¥ê¸° íˆ¬ì. ë°¸ë¥˜ë³´ë‹¤ ì„±ì¥ì„± ìš°ì„ ',
      'ì°½ì‹œì': 'Philip Fisher / Peter Lynch',
      'ì§„ì… ë°©ë²•': 'ì„±ì¥ ìŠ¤í† ë¦¬ í™•ì¸ í›„ ë¶„í•  ë§¤ìˆ˜',
      'ì§„ì… ì¡°ê±´': 'ë§¤ì¶œ 20%â†‘ + Moat í™•ì¸ + í•©ë¦¬ì  ë°¸ë¥˜',
      'ì†ì ˆ ê¸°ì¤€': 'ì„±ì¥ ìŠ¤í† ë¦¬ í›¼ì† ì‹œ (ê°€ê²© ì•„ë‹Œ ìŠ¤í† ë¦¬)',
      'ì†ì ˆ ë°©ì‹': 'ì •ì„±ì  íŒë‹¨',
      'í¬ì§€ì…˜ í¬ê¸°': 'ê³„ì¢Œ ë¦¬ìŠ¤í¬ 3% ê¸°ì¤€',
      'í”¼ë¼ë¯¸ë”©': 'ì‹¤ì  í™•ì¸ë§ˆë‹¤ ì¶”ê°€ (3ë¶„í• )',
      'ì²­ì‚° ì‹ í˜¸': 'ì„±ì¥ ë‘”í™” 2ë¶„ê¸° ì´ìƒ, ê²½ìŸ ì‹¬í™”',
      'ë³´ìœ  ê¸°ê°„': '1ë…„ ì´ìƒ (í…ë°°ê±° ë…¸ë¦¼)',
      'í€ë”ë©˜íƒˆ': 'í•µì‹¬ â€” ì„±ì¥ ì§€í‘œ ì§‘ì¤‘ ë¶„ì„',
      'ì‹œì¥ ë°©í–¥': 'ê¸ˆë¦¬ í•˜ë½ê¸° ìœ ë¦¬',
      'ìŠ¹ë¥  ëª©í‘œ': '50~60%',
      'ì†ìµë¹„ ëª©í‘œ': '5:1 ì´ìƒ',
      'ë‚œì´ë„': 'ë†’ìŒ â€” ì‚°ì—… + ê¸°ì—… ë¶„ì„ í•„ìš”',
      'ìë™í™” ê°€ëŠ¥': 'ì–´ë ¤ì›€',
      'ì í•©í•œ ì„±ê²©': 'ì¥ê¸° ë§ˆì¸ë“œ, ë¯¸ë˜ ë¹„ì „ ë¶„ì„',
    }
  }
};

// í•­ëª©ë³„ ì–´ëŠ ì „ëµì´ ìœ ë¦¬í•œì§€ ì•„ì´ì½˜
const CMP_WINNER = {
  'ì†ì ˆ ê¸°ì¤€':     { minervini:'âœ… íƒ€ì´íŠ¸ (ë¦¬ìŠ¤í¬ â†“)', turtle:'âš ï¸ ë„“ìŒ (ATR ê¸°ë°˜)' },
  'ìë™í™” ê°€ëŠ¥':   { minervini:'âŒ ì–´ë ¤ì›€', turtle:'âœ… ë§¤ìš° ì‰¬ì›€' },
  'í€ë”ë©˜íƒˆ':      { minervini:'âœ… í•„ìˆ˜ í™•ì¸', turtle:'â– ë¶ˆí•„ìš”' },
  'ë³´ìœ  ê¸°ê°„':     { minervini:'ë‹¨ê¸°~ì¤‘ê¸°', turtle:'ì¤‘ì¥ê¸°~ì´ˆì¥ê¸°' },
};

function renderCompare() {
  const L = COMPARE_DATA[document.getElementById('cmp-left').value];
  const R = COMPARE_DATA[document.getElementById('cmp-right').value];
  if (!L || !R) return;

  const ROWS = Object.keys(L.rows);

  // í—¤ë”
  document.getElementById('cmp-header').innerHTML = `
    <div style="background:var(--s2);border-radius:8px 0 0 8px;padding:12px 14px;font-size:11px;color:var(--muted);font-weight:700;text-transform:uppercase;letter-spacing:.5px;display:flex;align-items:center">í•­ëª©</div>
    <div style="background:${L.color}18;border:2px solid ${L.color}40;padding:14px;text-align:center;font-size:15px;font-weight:800;color:${L.color}">${L.label}</div>
    <div style="background:${R.color}18;border:2px solid ${R.color}40;padding:14px;text-align:center;font-size:15px;font-weight:800;color:${R.color};border-radius:0 8px 8px 0">${R.label}</div>`;

  document.getElementById('cmp-body').innerHTML = ROWS.map((row, i) => `
    <div style="display:grid;grid-template-columns:200px 1fr 1fr;gap:2px">
      <div style="background:var(--s2);padding:11px 14px;font-size:11px;font-weight:700;color:var(--muted);display:flex;align-items:center;${i===ROWS.length-1?'border-radius:0 0 0 8px':''}">${row}</div>
      <div style="background:${L.color}08;border-left:2px solid ${L.color}30;padding:11px 14px;font-size:12px;color:var(--text);line-height:1.6">${L.rows[row]||'-'}</div>
      <div style="background:${R.color}08;border-right:2px solid ${R.color}30;padding:11px 14px;font-size:12px;color:var(--text);line-height:1.6;${i===ROWS.length-1?'border-radius:0 0 8px 0':''}">${R.rows[row]||'-'}</div>
    </div>`).join('');

  renderCmpCalc();
}

function renderCmpCalc() {
  const capital = parseFloat(document.getElementById('cmp-capital').value) || 0;
  const entry   = parseFloat(document.getElementById('cmp-entry').value) || 0;
  const stop    = parseFloat(document.getElementById('cmp-stop').value) || 0;
  const atr     = parseFloat(document.getElementById('cmp-atr').value) || 0;
  const Lkey    = document.getElementById('cmp-left').value;
  const Rkey    = document.getElementById('cmp-right').value;
  const L       = COMPARE_DATA[Lkey];
  const R       = COMPARE_DATA[Rkey];
  const el      = document.getElementById('cmp-calc-result');

  if (!capital || !entry || !stop) {
    el.innerHTML = '<div style="grid-column:1/-1;color:var(--muted);font-size:13px;text-align:center;padding:16px">ìì‚°Â·ë§¤ìˆ˜ê°€Â·ì†ì ˆê°€ë¥¼ ì…ë ¥í•˜ë©´ ë‘ ì „ëµì˜ í¬ì§€ì…˜ í¬ê¸°ë¥¼ ë¹„êµí•´ë“œë ¤ìš”</div>';
    return;
  }

  function calcCard(style, color, label) {
    const s = INVEST_STYLES[style];
    if (!s) return '<div></div>';
    const riskAmt   = capital * (s.riskPct / 100);
    const riskPerSh = Math.abs(entry - stop);

    let qty, stopUsed, method;
    if (style === 'turtle' && atr > 0) {
      // í„°í‹€: ATR ê¸°ë°˜
      qty      = Math.max(1, Math.floor((capital * 0.01) / (2 * atr)));
      stopUsed = Math.round(entry - 2 * atr);
      method   = `ATR ê¸°ë°˜ (-2N = -â‚©${Math.round(2*atr).toLocaleString()})`;
    } else {
      // ì¼ë°˜: ê³ ì • ì†ì ˆ ê¸°ë°˜
      qty      = riskPerSh > 0 ? Math.floor(riskAmt / riskPerSh) : 0;
      stopUsed = stop;
      method   = `ê³ ì • ì†ì ˆ (-${((entry-stop)/entry*100).toFixed(1)}%)`;
    }

    const totalAmt  = qty * entry;
    const portPct   = capital > 0 ? (totalAmt / capital * 100) : 0;
    const riskActual= qty * Math.abs(entry - stopUsed);
    const riskPctAct= capital > 0 ? (riskActual / capital * 100) : 0;

    return `
      <div style="background:${color}0a;border:2px solid ${color}30;border-radius:12px;padding:14px 16px">
        <div style="font-size:14px;font-weight:800;color:${color};margin-bottom:12px">${label}</div>
        <div style="display:flex;flex-direction:column;gap:6px">
          ${[
            ['ë¦¬ìŠ¤í¬ ë¹„ìœ¨', s.riskPct + '%', color],
            ['í—ˆìš© ì†ì‹¤ì•¡', 'â‚©' + Math.round(riskAmt).toLocaleString(), 'var(--loss)'],
            ['ì†ì ˆê°€', 'â‚©' + stopUsed.toLocaleString(), 'var(--loss)'],
            ['ê³„ì‚° ë°©ë²•', method, 'var(--muted)'],
            ['ë§¤ìˆ˜ ìˆ˜ëŸ‰', qty.toLocaleString() + 'ì£¼', 'var(--text)'],
            ['ì´ íˆ¬ìê¸ˆ', 'â‚©' + Math.round(totalAmt).toLocaleString(), color],
            ['í¬íŠ¸ ë¹„ì¤‘', portPct.toFixed(1) + '%', portPct > 20 ? 'var(--warn)' : 'var(--profit)'],
            ['ì‹¤ì œ ë¦¬ìŠ¤í¬', riskPctAct.toFixed(2) + '%', 'var(--muted)'],
            ['ë¶„í•  íšŸìˆ˜', s.splits + 'íšŒ', 'var(--text)'],
          ].map(([l,v,c]) => `
            <div style="display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid ${color}15">
              <span style="font-size:11px;color:var(--muted)">${l}</span>
              <span style="font-family:'Roboto Mono',monospace;font-size:12px;font-weight:700;color:${c}">${v}</span>
            </div>`).join('')}
        </div>
      </div>`;
  }

  el.innerHTML = calcCard(Lkey, L.color, L.label) + calcCard(Rkey, R.color, R.label);
}

function calcRisk() {
  const capital = parseFloat(document.getElementById('r-capital').value) || 0;
  const riskPct = parseFloat(document.getElementById('r-risk-pct').value) || 2;
  const entry   = parseFloat(document.getElementById('r-entry').value) || 0;
  const stop    = parseFloat(document.getElementById('r-stop').value) || 0;
  const target  = parseFloat(document.getElementById('r-target').value) || 0;
  const splits  = parseInt(document.getElementById('r-splits').value) || 1;
  const el      = document.getElementById('r-result');

  if (!capital || !entry || !stop) {
    el.innerHTML = '<div style="color:var(--muted);font-size:13px;text-align:center">ìì‚°Â·ë§¤ìˆ˜ê°€Â·ì†ì ˆê°€ë¥¼ ì…ë ¥í•˜ì„¸ìš”</div>';
    return;
  }

  const riskAmt    = capital * riskPct / 100;           // í—ˆìš© ì†ì‹¤ê¸ˆì•¡
  const riskPerSh  = Math.abs(entry - stop);            // ì£¼ë‹¹ ë¦¬ìŠ¤í¬
  const totalQty   = riskPerSh > 0 ? Math.floor(riskAmt / riskPerSh) : 0;
  const totalAmt   = totalQty * entry;                  // ì´ íˆ¬ìê¸ˆ
  const portPct    = capital > 0 ? totalAmt / capital * 100 : 0;
  const rr         = target && riskPerSh ? (target - entry) / riskPerSh : 0;
  const stopPct    = entry ? (entry - stop) / entry * 100 : 0;
  const targetPct  = target && entry ? (target - entry) / entry * 100 : 0;
  const isLong     = entry > stop;

  // ë¶„í•  ë§¤ìˆ˜ ê³„íš
  const splitQtys = [];
  const splitRatios = splits === 1 ? [1] : splits === 2 ? [0.6,0.4] : splits === 3 ? [0.5,0.3,0.2] : [0.4,0.3,0.2,0.1];
  for (let i = 0; i < splits; i++) {
    const q = Math.floor(totalQty * splitRatios[i]);
    const priceAdj = isLong ? entry * (1 - i * 0.01) : entry * (1 + i * 0.01);
    splitQtys.push({ n: i+1, qty: q, price: Math.round(priceAdj), amt: Math.round(q * priceAdj) });
  }

  const rrColor = rr >= 2 ? 'var(--profit)' : rr >= 1 ? 'var(--warn)' : 'var(--loss)';

  el.innerHTML = `
    <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:9px;margin-bottom:12px">
      ${[
        ['ğŸ’° í—ˆìš© ì†ì‹¤', 'â‚©'+Math.round(riskAmt).toLocaleString(), 'var(--loss)'],
        ['ğŸ“¦ ë§¤ìˆ˜ ìˆ˜ëŸ‰', totalQty.toLocaleString()+'ì£¼', 'var(--text)'],
        ['ğŸ’µ ì´ íˆ¬ìê¸ˆ', 'â‚©'+Math.round(totalAmt).toLocaleString(), 'var(--accent)'],
        ['ğŸ“Š í¬íŠ¸ ë¹„ì¤‘', portPct.toFixed(1)+'%', portPct>30?'var(--loss)':portPct>15?'var(--warn)':'var(--profit)'],
        ['ğŸ“‰ ì†ì ˆí­', stopPct.toFixed(2)+'%', 'var(--loss)'],
        ['ğŸ“ˆ ì†ìµë¹„', rr ? rr.toFixed(2) : 'N/A', rrColor],
      ].map(([l,v,c])=>`
        <div style="background:var(--surface);border:1.5px solid var(--border);border-radius:8px;padding:10px 12px">
          <div style="font-size:10px;color:var(--muted);margin-bottom:4px">${l}</div>
          <div style="font-family:'Roboto Mono',monospace;font-size:15px;font-weight:700;color:${c}">${v}</div>
        </div>`).join('')}
    </div>

    ${target ? `
    <div style="background:${rr>=2?'rgba(224,49,49,.07)':rr>=1?'rgba(251,191,36,.07)':'rgba(29,111,242,.07)'};border:1.5px solid ${rr>=2?'rgba(224,49,49,.2)':rr>=1?'rgba(251,191,36,.2)':'rgba(29,111,242,.2)'};border-radius:8px;padding:10px 12px;margin-bottom:12px">
      <div style="font-size:11px;font-weight:700;color:${rrColor};margin-bottom:4px">${rr>=2?'âœ… ìš°ìˆ˜í•œ ì†ìµë¹„':'âš ï¸ ì†ìµë¹„ í™•ì¸ í•„ìš”'} â€” ${rr.toFixed(2)} : 1</div>
      <div style="font-size:11px;color:var(--muted)">ëª©í‘œ ìˆ˜ìµ +${targetPct.toFixed(2)}% Â· ì†ì ˆ -${stopPct.toFixed(2)}%</div>
      <div style="font-size:11px;color:var(--muted)">ëª©í‘œ ë„ë‹¬ ì‹œ +â‚©${Math.round(totalQty*(target-entry)).toLocaleString()}</div>
    </div>` : ''}

    ${splits > 1 ? `
    <div style="font-size:12px;font-weight:700;margin-bottom:7px;color:var(--text)">ğŸ“‹ ${splits}ë¶„í•  ë§¤ìˆ˜ ê³„íš</div>
    <div style="display:flex;flex-direction:column;gap:5px;margin-bottom:4px">
      ${splitQtys.map(s=>`
        <div style="display:flex;justify-content:space-between;align-items:center;background:var(--s2);border-radius:7px;padding:7px 11px;border:1.5px solid var(--border)">
          <span style="font-size:12px;color:var(--muted)">${s.n}ì°¨ ë§¤ìˆ˜</span>
          <span style="font-family:'Roboto Mono',monospace;font-size:12px">â‚©${s.price.toLocaleString()} Ã— ${s.qty}ì£¼</span>
          <span style="font-family:'Roboto Mono',monospace;font-size:12px;color:var(--accent)">â‚©${s.amt.toLocaleString()}</span>
        </div>`).join('')}
    </div>` : ''}

    <div style="background:${portPct>30?'rgba(248,113,113,.08)':'rgba(29,111,242,.05)'};border:1px solid ${portPct>30?'rgba(248,113,113,.2)':'var(--border)'};border-radius:7px;padding:9px 12px;font-size:11px;color:${portPct>30?'var(--loss)':'var(--muted)'}">
      ${portPct>30?'ğŸš¨ í¬íŠ¸ ë¹„ì¤‘ 30% ì´ˆê³¼ â€” ì§‘ì¤‘ ë¦¬ìŠ¤í¬ ì£¼ì˜!':portPct>15?'âš ï¸ í¬íŠ¸ ë¹„ì¤‘ 15% ì´ˆê³¼ â€” ëª¨ë‹ˆí„°ë§ ê°•í™” ê¶Œì¥':'âœ… ì ì • í¬íŠ¸ ë¹„ì¤‘'}
    </div>

    ${currentInvestStyle === 'minervini' ? `
    <div style="margin-top:10px;background:rgba(240,192,64,.06);border:1.5px solid rgba(240,192,64,.2);border-radius:8px;padding:10px 12px">
      <div style="font-size:11px;font-weight:700;color:#f0c040;margin-bottom:6px">âš¡ ë¯¸ë„ˆë¹„ë‹ˆ ì²´í¬</div>
      <div style="font-size:11px;color:var(--muted);line-height:1.9">
        ${stopPct > 8 ? 'ğŸš¨ ì†ì ˆí­ ' + stopPct.toFixed(1) + '% â€” í”¼ë²— ê¸°ì¤€ 7~8% ì´ˆê³¼. ì§„ì…ê°€ ì¬ê²€í†  ê¶Œì¥' : stopPct > 0 ? 'âœ… ì†ì ˆí­ ' + stopPct.toFixed(1) + '% â€” 7~8% ì´ë‚´ ì ì •' : ''}<br>
        ${rr > 0 ? (rr >= 3 ? 'âœ… ì†ìµë¹„ ' + rr.toFixed(1) + ':1 â€” ë¯¸ë„ˆë¹„ë‹ˆ ê¸°ì¤€(3:1) ì¶©ì¡±' : 'âš ï¸ ì†ìµë¹„ ' + rr.toFixed(1) + ':1 â€” ëª©í‘œ 3:1 ë¯¸ë‹¬. ëª©í‘œê°€ ìƒí–¥ ë˜ëŠ” íŒ¨ìŠ¤ ê³ ë ¤') : ''}<br>
        ${portPct > 0 ? 'í¬ì§€ì…˜ ë¦¬ìŠ¤í¬: ì´ìì‚°ì˜ ' + (riskAmt/capital*100).toFixed(2) + '% (' + (riskAmt/capital*100 <= 1.5 ? 'âœ… 1.5% ì´ë‚´' : 'âš ï¸ 1.5% ì´ˆê³¼') + ')' : ''}
      </div>
    </div>` : ''}`;
}


function calcKelly() {
  const wr = parseFloat(document.getElementById('k-wr').value) / 100;
  const rr = parseFloat(document.getElementById('k-rr').value);
  const el = document.getElementById('k-result');
  if (!wr || !rr) { el.innerHTML = '<div style="color:var(--muted);font-size:13px;text-align:center">ê°’ì„ ì…ë ¥í•˜ì„¸ìš”</div>'; return; }
  const kelly = wr - (1 - wr) / rr;
  const halfKelly = kelly / 2;
  const col = kelly > 0 ? 'var(--profit)' : 'var(--loss)';
  el.innerHTML = `
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px">
      <div>
        <div style="font-size:10px;color:var(--muted);margin-bottom:4px;text-transform:uppercase;letter-spacing:.6px">ì¼ˆë¦¬ ë¹„ìœ¨</div>
        <div style="font-family:'Roboto Mono',monospace;font-size:22px;font-weight:600;color:${col}">${(kelly*100).toFixed(1)}%</div>
      </div>
      <div>
        <div style="font-size:10px;color:var(--muted);margin-bottom:4px;text-transform:uppercase;letter-spacing:.6px">í•˜í”„ ì¼ˆë¦¬ (ê¶Œì¥)</div>
        <div style="font-family:'Roboto Mono',monospace;font-size:22px;font-weight:600;color:var(--accent)">${(halfKelly*100).toFixed(1)}%</div>
      </div>
    </div>
    <div style="font-size:11px;color:var(--muted)">
      ${kelly <= 0 ? 'âš ï¸ ê¸°ëŒ“ê°’ì´ ìŒìˆ˜ì…ë‹ˆë‹¤. ì „ëµì„ ì¬ê²€í† í•˜ì„¸ìš”.' : `í•˜í”„ ì¼ˆë¦¬ ê¸°ì¤€ìœ¼ë¡œ ì´ ìì‚°ì˜ <strong style="color:var(--accent)">${(halfKelly*100).toFixed(1)}%</strong>ë¥¼ íˆ¬ìí•˜ëŠ” ê²ƒì´ ìµœì ì…ë‹ˆë‹¤.`}
    </div>`;
}

function calcBEP() {
  const entry  = parseFloat(document.getElementById('b-entry').value);
  const feePct = parseFloat(document.getElementById('b-fee').value) || 0.015;
  const target = parseFloat(document.getElementById('b-target').value);
  const el = document.getElementById('b-result');
  if (!entry) { el.innerHTML = '<div style="color:var(--muted);font-size:13px;text-align:center">ë§¤ìˆ˜ê°€ë¥¼ ì…ë ¥í•˜ì„¸ìš”</div>'; return; }
  const bep    = entry * (1 + feePct/100 * 2);
  const tgtPrc = target ? entry * (1 + (target + feePct/100*2) / 100) : null;
  el.innerHTML = `
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
      <div>
        <div style="font-size:10px;color:var(--muted);margin-bottom:4px;text-transform:uppercase;letter-spacing:.6px">ì†ìµë¶„ê¸°ì </div>
        <div style="font-family:'Roboto Mono',monospace;font-size:20px;font-weight:600;color:var(--warn)">â‚©${Math.ceil(bep).toLocaleString()}</div>
        <div style="font-size:11px;color:var(--muted);margin-top:2px">+${((bep-entry)/entry*100).toFixed(3)}% ì´ìƒ ì˜¬ë¼ì•¼ ë³¸ì „</div>
      </div>
      ${tgtPrc ? `<div>
        <div style="font-size:10px;color:var(--muted);margin-bottom:4px;text-transform:uppercase;letter-spacing:.6px">ëª©í‘œ ë§¤ë„ê°€ (ìˆ˜ìˆ˜ë£Œ í¬í•¨)</div>
        <div style="font-family:'Roboto Mono',monospace;font-size:20px;font-weight:600;color:var(--profit)">â‚©${Math.ceil(tgtPrc).toLocaleString()}</div>
        <div style="font-size:11px;color:var(--muted);margin-top:2px">ìˆœìˆ˜ìµë¥  ${target}% ë‹¬ì„±</div>
      </div>` : ''}
    </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• íˆ¬ì ë°©ì‹ ê°€ì´ë“œ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const INVEST_STYLES = {
  minervini: {
    label: 'âš”ï¸ ë¯¸ë„ˆë¹„ë‹ˆ SEPA',
    riskPct: 1.5,
    splits: 3,
    desc: [
      'ğŸ“Œ <b>SEPA í•µì‹¬ ì² í•™</b>: Specific Entry Point Analysis â€” ìµœê³ ì˜ í€ë”ë©˜íƒˆ + ìµœì ì˜ ê¸°ìˆ ì  ì§„ì…ì ì´ ê²¹ì¹  ë•Œë§Œ ë§¤ìˆ˜. ìš´ì´ ì•„ë‹Œ í™•ë¥ ì˜ ê²Œì„',
      'ğŸ— <b>VCP (Volatility Contraction Pattern)</b>: ì¡°ì • í­ì´ ì ì  ì¤„ì–´ë“œëŠ” ìˆ˜ë ´ íŒ¨í„´ (-25% â†’ -15% â†’ -8% â†’ -4%). ê±°ë˜ëŸ‰ë„ í•¨ê»˜ ì¤„ì–´ì•¼ ì •ìƒ. ë§ˆì§€ë§‰ ìˆ˜ì¶•ì—ì„œ ê±°ë˜ëŸ‰ í­ë°œ+ëŒíŒŒ = ì§„ì… ì‹œê·¸ë„',
      'ğŸ“Š <b>íŠ¸ë Œë“œ í…œí”Œë¦¿ 7ê°€ì§€ (ëª¨ë‘ ì¶©ì¡± í•„ìˆ˜)</b>: â‘  í˜„ì¬ê°€ > 200ì¼ì„  â‘¡ í˜„ì¬ê°€ > 150ì¼ì„  â‘¢ 150ì¼ì„  > 200ì¼ì„  â‘£ 200ì¼ì„  ìµœì†Œ 1ê°œì›” ì´ìƒ ìš°ìƒí–¥ â‘¤ í˜„ì¬ê°€ > 50ì¼ì„  â‘¥ 52ì£¼ ì €ê°€ ëŒ€ë¹„ +30%â†‘ â‘¦ 52ì£¼ ê³ ê°€ ëŒ€ë¹„ -25% ì´ë‚´',
      'ğŸ¯ <b>ì†ì ˆ ê¸°ì¤€</b>: í”¼ë²— í¬ì¸íŠ¸(ëŒíŒŒê°€) ê¸°ì¤€ -7~8% ì´ë‚´ ë¬´ì¡°ê±´ ì†ì ˆ. ì˜ˆì™¸ ì—†ìŒ. "ì‘ê²Œ ì˜ë¼ë¼, í¬ê²Œ ê°€ì ¸ê°€ë¼"',
      'ğŸ“ˆ <b>ëª©í‘œ ì†ìµë¹„</b>: ìµœì†Œ 3:1. ì†ì‹¤ì€ -7~8%ë¡œ ì œí•œ, ìˆ˜ìµì€ 20~25%â†‘ ë¹„ëŒ€ì¹­ êµ¬ì¡°. ì†ìµë¹„ ë¯¸ë‹¬ ì‹œ ì§„ì… ìì²´ë¥¼ ê±°ì ˆ',
      'ğŸ”€ <b>ì§„ì… ì „ëµ</b>: í”¼ë²— ëŒíŒŒ + ê±°ë˜ëŸ‰ 50ì¼ í‰ê·  40%â†‘ í™•ì¸ ì¦‰ì‹œ ì§„ì…. 1ì°¨ 50~60%, ì¶”ì„¸ í™•ì¸ í›„ 2ì°¨ 25%, ê°€ì† ì‹œ 3ì°¨ 15% í”¼ë¼ë¯¸ë”©',
      'ğŸ’¡ <b>ìŠˆí¼ìŠ¤í†¡ í€ë”ë©˜íƒˆ ì¡°ê±´</b>: EPS ì„±ì¥ ì „ë…„æ¯” 25%â†‘ + ìµœê·¼ 2~3ë¶„ê¸° ê°€ì† ì„±ì¥ + ë§¤ì¶œ ì„±ì¥ + ROE 17%â†‘ + ê¸°ê´€ ìˆœë§¤ìˆ˜ ì¦ê°€ + ì—…ì¢… ì„ ë„ì£¼ + ì‹ ì´‰ë§¤(ì‹ ì œí’ˆÂ·ì‹ ì‹œì¥Â·ê²½ì˜ì§„ êµì²´)',
      'âš ï¸ <b>ì ˆëŒ€ ê¸ˆì§€ ì‚¬í•­</b>: ì§€ìˆ˜ í•˜ë½ì¥ ì‹ ê·œ ë§¤ìˆ˜ ê¸ˆì§€ / ê±°ë˜ëŸ‰ ì—†ëŠ” ëŒíŒŒ ì§„ì… ê¸ˆì§€ / ì†ì ˆê°€ ì„ì˜ ì—°ì¥ ê¸ˆì§€ / ì§„ì… í›„ -3% ì´ˆê³¼ ì‹œ ë¬´ì¡°ê±´ ì¬ê²€í† ',
    ],
    guide: [
      {
        icon: 'ğŸ—',
        title: 'VCP íŒ¨í„´ ì²´í¬ë¦¬ìŠ¤íŠ¸',
        body: 'â‘  52ì£¼ ê³ ì  ëŒ€ë¹„ 15~40% ì¡°ì • â‘¡ ìˆ˜ì¶• 2~4íšŒ ë°˜ë³µ (ë§¤ë²ˆ í­ ì¤„ì–´ì•¼) â‘¢ ê±°ë˜ëŸ‰ ì ì§„ì  ê°ì†Œ â‘£ ë§ˆì§€ë§‰ ìˆ˜ì¶•í­ 3~5% â‘¤ ëŒíŒŒ ì‹œ ê±°ë˜ëŸ‰ ì „ì¼æ¯” 50%â†‘ â€” 5ê°€ì§€ ëª¨ë‘ ì¶©ì¡± ì‹œì—ë§Œ ì§„ì…'
      },
      {
        icon: 'ğŸ“',
        title: 'í”¼ë²— í¬ì¸íŠ¸ ì§„ì…ë²•',
        body: 'ë² ì´ìŠ¤ ìµœê³ ì  + 1í˜¸ê°€ê°€ í”¼ë²—. ëŒíŒŒ ë‹¹ì¼ ê±°ë˜ëŸ‰ì´ 50ì¼ í‰ê·  2ë°° ì´ìƒì´ë©´ ê°•ë ¥ ì‹ í˜¸. ëŒíŒŒ í›„ 3~5% ì´ìƒ ì§€ë‚˜ë©´ "ëŠ¦ì€ ì§„ì…" â€” ë‹¤ìŒ ê¸°íšŒë¥¼ ê¸°ë‹¤ë¦´ ê²ƒ. ì¶”ê²©ë§¤ìˆ˜ ì ˆëŒ€ ê¸ˆì§€'
      },
      {
        icon: 'ğŸ“Š',
        title: 'íŠ¸ë Œë“œ í…œí”Œë¦¿ í™•ì¸ë²•',
        body: 'í˜„ì¬ê°€ > 50ì¼ì„  > 150ì¼ì„  > 200ì¼ì„  ìˆœì„œë¡œ ìœ„ì—ì„œ ì •ë ¬. 200ì¼ì„ ì´ ìš°ìƒí–¥ ì¤‘ì´ì–´ì•¼ í•¨. RS(ìƒëŒ€ê°•ë„) ìˆœìœ„ ìƒìœ„ 10% ì¢…ëª©ë§Œ ëŒ€ìƒ. ì´ ì¡°ê±´ ë¯¸ì¶©ì¡± = ì•„ë¬´ë¦¬ ì¢‹ì•„ ë³´ì—¬ë„ íŒ¨ìŠ¤'
      },
      {
        icon: 'âš”ï¸',
        title: 'í”¼ë¼ë¯¸ë”© (í¬ì§€ì…˜ ì¶”ê°€)',
        body: '1ì°¨ ì§„ì… í›„ +2~3% ìƒìŠ¹ + ê±°ë˜ëŸ‰ í™•ì¸ ì‹œ 2ì°¨ ì¶”ê°€. +5% ì´ìƒ ì¶”ì„¸ ê°•í™” ì‹œ 3ì°¨ ì†ŒëŸ‰ ì¶”ê°€. ì†ì‹¤ ì¤‘ ì¶”ê°€ë§¤ìˆ˜ ì ˆëŒ€ ê¸ˆì§€ â€” í”¼ë¼ë¯¸ë”©ì€ ìˆ˜ìµ ì¤‘ì¼ ë•Œë§Œ'
      },
      {
        icon: 'ğŸ›¡',
        title: 'ì†ì ˆÂ·í¬ì§€ì…˜ ê´€ë¦¬ ì² ì¹™',
        body: 'ì†ì ˆ -7~8% ì ˆëŒ€ ì›ì¹™. ìˆ˜ìµ +10~15% êµ¬ê°„ì—ì„œ 1/3 ì´ìµì‹¤í˜„. ë‚˜ë¨¸ì§€ëŠ” 20~50ì¼ì„  ì´íƒˆ ì‹œ íŠ¸ë ˆì¼ë§ ìŠ¤íƒ‘. 1í¬ì§€ì…˜ ìµœëŒ€ ë¦¬ìŠ¤í¬ = ì´ìì‚°ì˜ 1.5% ì´ë‚´'
      },
      {
        icon: 'ğŸ“…',
        title: 'ë§ˆì¼“ íƒ€ì´ë° (ì‹œì¥ ë°©í–¥ í™•ì¸)',
        body: 'Distribution Day(ë¶„ì‚°ì¼) 5ì¼â†‘ ëˆ„ì  ì‹œ í˜„ê¸ˆ ë¹„ì¤‘ í™•ëŒ€. ì£¼ìš” ì§€ìˆ˜ 200ì¼ì„  í•˜íšŒ ì‹œ ì‹ ê·œ ë§¤ìˆ˜ ì „ë©´ ì¤‘ë‹¨. Follow-Through Day(ì§€ìˆ˜ +1%â†‘ + ê±°ë˜ëŸ‰â†‘) í™•ì¸ í›„ì—ë§Œ ê³µê²© ì¬ê°œ'
      },
      {
        icon: 'ğŸ†',
        title: 'ìŠˆí¼í¼í¬ë¨¼ìŠ¤ ì¢…ëª© ë°œêµ´',
        body: 'ë§¤ì¶œÂ·EPS 3ë¶„ê¸° ì—°ì† ê°€ì† ì„±ì¥ / ROE 17%â†‘ / ê¸°ê´€ ë³´ìœ  ë¹„ì¤‘ ì¦ê°€ ì¶”ì„¸ / ì—…ì¢… 1ë“± RS ìˆœìœ„ ìƒìœ„ 10% / ì‹ ì´‰ë§¤ ì¡´ì¬ (ì‹ ì œí’ˆÂ·ì‹ ì‹œì¥Â·ì‹ ê²½ì˜ì§„Â·ê·œì œ ë³€í™”) â€” ì´ ì¡°ê±´ì´ VCP íŒ¨í„´ê³¼ ê²°í•©ë  ë•Œ ìµœê°•ì˜ ì…‹ì—…'
      },
      {
        icon: 'ğŸ“¦',
        title: 'ë² ì´ìŠ¤ ìœ í˜• ì¸ì‹',
        body: 'ì»µ&í•¸ë“¤(Cup & Handle): ê°€ì¥ ì‹ ë¢°ë„ ë†’ìŒ. ì»µ ê¹Šì´ -30% ì´ë‚´, í•¸ë“¤ -10~15%. í‰í‰í•œ ë² ì´ìŠ¤(Flat Base): ì¡°ì •í­ -15% ì´ë‚´. VCP: ìœ„ì—ì„œ ì„¤ëª…. ì´ì¤‘ë°”ë‹¥(Double Bottom). ë² ì´ìŠ¤ ê¸°ê°„ ìµœì†Œ 3~6ì£¼'
      },
    ]
  },
  momentum: {
    label: 'ğŸš€ ëª¨ë©˜í…€',
    riskPct: 2,
    splits: 2,
    desc: [
      'ğŸ“Œ <b>í•µì‹¬ ì›ì¹™</b>: ìƒìŠ¹ ì¶”ì„¸ í™•ì¸ëœ ì¢…ëª©ì— ë¹ ë¥´ê²Œ ì˜¬ë¼íƒ€ê³ , ì¶”ì„¸ êº¾ì´ë©´ ì¦‰ì‹œ ì´íƒˆ',
      'ğŸ¯ <b>ì†ì ˆ ê¸°ì¤€</b>: ë§¤ìˆ˜ê°€ -3~5% ë˜ëŠ” ì§ì „ ì €ì  ì´íƒˆ ì‹œ â€” ê¸°ê³„ì  ì‹¤í–‰ í•„ìˆ˜',
      'ğŸ“ˆ <b>ëª©í‘œ ì†ìµë¹„</b>: ìµœì†Œ 2:1 ì´ìƒ â€” ì†ìµë¹„ ë¯¸ë‹¬ ì‹œ ì§„ì… ìì œ',
      'ğŸ”€ <b>ë¶„í•  ì „ëµ</b>: 2ë¶„í•  â€” ëŒíŒŒ í™•ì¸ í›„ 1ì°¨ 60%, ì¶”ì„¸ ê°•í™” ì‹œ 2ì°¨ 40%',
      'â± <b>ë³´ìœ  ê¸°ê°„</b>: ë‹¨ê¸°~ì¤‘ê¸° (ìˆ˜ì¼~ìˆ˜ì£¼). ì¶”ì„¸ ìœ ì§€ ë™ì•ˆë§Œ ë³´ìœ ',
      'ğŸ“Š <b>ì§„ì… ì¡°ê±´</b>: ê±°ë˜ëŸ‰ 20ì¼ í‰ê·  150%â†‘ + ì‹ ê³ ê°€ ëŒíŒŒ + ì‹œì¥ ê°•ì„¸ í™•ì¸',
      'ğŸšª <b>ì²­ì‚° ì‹ í˜¸</b>: 5ì¼ì„  ì´íƒˆ, ê±°ë˜ëŸ‰ ê¸‰ê°, ìŒë´‰ 3ì¼ ì—°ì†, ì „ê³ ì  ì €í•­ ì‹¤íŒ¨',
      'âš ï¸ <b>ì£¼ì˜</b>: ë°•ìŠ¤ê¶ŒÂ·íš¡ë³´ì¥ ìˆ˜ìµì„± ì €í•˜. FOMO ì§„ì… ê¸ˆì§€. ì´ë¯¸ ë§ì´ ì˜¤ë¥¸ ì¢…ëª© ì¶”ê²© ê¸ˆì§€',
    ],
    guide: [
      { icon:'ğŸ“Š', title:'ê±°ë˜ëŸ‰ ëŒíŒŒ í™•ì¸', body:'ëŒíŒŒ ë‹¹ì¼ ê±°ë˜ëŸ‰ì´ ìµœê·¼ 20ì¼ í‰ê· ì˜ 150% ì´ìƒì´ì–´ì•¼ ìœ íš¨. ê±°ë˜ëŸ‰ ì—†ëŠ” ëŒíŒŒëŠ” ì†ì„ìˆ˜ì¼ í™•ë¥  ë†’ìŒ' },
      { icon:'ğŸ“‰', title:'ì†ì ˆ ì›ì¹™', body:'ì§„ì… í›„ 3~5% ì´íƒˆ ì¦‰ì‹œ ì†ì ˆ. ì†ì ˆê°€ ì‚¬ì „ ì„¤ì • í•„ìˆ˜. "ê¸°ë‹¤ë¦¬ë©´ ì˜¤ë¥¸ë‹¤" ê¸ˆì§€ â€” ëª¨ë©˜í…€ ì†Œë©¸ = ì¦‰ì‹œ ì´íƒˆ' },
      { icon:'ğŸ”€', title:'ë¶„í•  ì§„ì… íƒ€ì´ë°', body:'1ì°¨: ëŒíŒŒ í™•ì¸ ì§í›„ 60% ì§„ì…. 2ì°¨: ë‹¹ì¼ ì¢…ê°€ ì–‘ë´‰ ë§ˆê° í™•ì¸ í›„ 40% ì¶”ê°€. ëˆŒë¦¼ ì‹œ ë¶„í•  ì¶”ê°€ X' },
      { icon:'ğŸšª', title:'ì²­ì‚° ì‹ í˜¸ ì²´í¬ë¦¬ìŠ¤íŠ¸', body:'â‘  5ì¼ì„  í•˜í–¥ ì´íƒˆ â‘¡ ê±°ë˜ëŸ‰ ê¸‰ê°í•˜ë©° ìƒìŠ¹ â‘¢ ìŒë´‰ 3ì¼ ì—°ì† â‘£ ì „ê³ ì  ì €í•­ ëŒíŒŒ ì‹¤íŒ¨ â†’ 1ê°œë¼ë„ í•´ë‹¹ ì‹œ ì²­ì‚° ê²€í† ' },
    ]
  },
  value: {
    label: 'ğŸ’ ê°€ì¹˜íˆ¬ì',
    riskPct: 5,
    splits: 4,
    desc: [
      'ğŸ“Œ <b>í•µì‹¬ ì›ì¹™</b>: ë‚´ì¬ê°€ì¹˜ ëŒ€ë¹„ ì €í‰ê°€ëœ ì¢…ëª©ì„ ë°œêµ´. ì‹œì¥ ê³µí¬ ë•Œ ë§¤ìˆ˜, ì‹œì¥ íƒìš• ë•Œ ë§¤ë„',
      'ğŸ¯ <b>ì†ì ˆ ê¸°ì¤€</b>: ì£¼ê°€ í•˜ë½ì€ ì†ì ˆ ì‚¬ìœ  ì•„ë‹˜. <b>íˆ¬ì Thesisê°€ í›¼ì†ëì„ ë•Œë§Œ</b> ë§¤ë„ â€” ì‹¤ì  êµ¬ì¡°ì  ì•…í™”, ì—…í™© ë³€í™”, ê²½ì˜ì§„ ë¬¸ì œ',
      'ğŸ“ˆ <b>ëª©í‘œ ì†ìµë¹„</b>: 3:1 ì´ìƒ â€” ë‚´ì¬ê°€ì¹˜ ëŒ€ë¹„ 30~50% í• ì¸ ì§„ì…ì´ ì´ìƒì ',
      'ğŸ”€ <b>ë¶„í•  ì „ëµ</b>: 4ë¶„í•  ì¶”ì²œ â€” í•˜ë½í• ìˆ˜ë¡ ì¶”ê°€ë§¤ìˆ˜ë¡œ í‰ë‹¨ê°€ í•˜í–¥. ì´ˆê¸° 40%, -5%/-10%/-15% ì‹œ 30%/20%/10%',
      'â± <b>ë³´ìœ  ê¸°ê°„</b>: ì¤‘ì¥ê¸° (ìˆ˜ê°œì›”~ìˆ˜ë…„). ê°€ì¹˜ ì‹¤í˜„ê¹Œì§€ ì¸ë‚´. ë¶„ê¸° ì‹¤ì ë§ˆë‹¤ Thesis ì ê²€',
      'ğŸ“Š <b>ì§„ì… ì¡°ê±´</b>: PER ì—…ì¢… í‰ê·  ì´í•˜ + PBR 1 ë¯¸ë§Œ(ë˜ëŠ” ì—­ì‚¬ì  ì €ì ) + ROE 10%â†‘ + ë¶€ì±„ë¹„ìœ¨ 100%â†“',
      'ğŸ’¡ <b>ì•ˆì „ë§ˆì§„</b>: ëª©í‘œ ì£¼ê°€ ëŒ€ë¹„ ìµœì†Œ 30% í• ì¸ëœ ê°€ê²©ì—ì„œ ì§„ì…. ì•ˆì „ë§ˆì§„ ì—†ëŠ” ë§¤ìˆ˜ëŠ” íˆ¬ê¸°',
      'âš ï¸ <b>ì£¼ì˜</b>: "ì‹¸ë‹¤"ëŠ” ê²ƒë§Œìœ¼ë¡œ ë§¤ìˆ˜ ê¸ˆì§€. ê°€ì¹˜í•¨ì •(Value Trap) ê²½ê³„ â€” ì‹¼ ë°ëŠ” ì´ìœ ê°€ ìˆìŒ',
    ],
    guide: [
      { icon:'ğŸ“‹', title:'ë°¸ë¥˜ì—ì´ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸', body:'PER: ì—…ì¢… í‰ê·  ì´í•˜ / PBR: 1 ë¯¸ë§Œ ë˜ëŠ” ì—­ì‚¬ì  ì €ì  / ROE: 10% ì´ìƒ / ë¶€ì±„ë¹„ìœ¨: 100% ì´í•˜ / ì˜ì—…ì´ìµë¥ : ê°œì„  ì¶”ì„¸' },
      { icon:'ğŸ’°', title:'4ë¶„í•  ë§¤ìˆ˜ ì›ì¹™', body:'í˜„ì¬ê°€ 40% â†’ -5% ì‹œ 30% â†’ -10% ì‹œ 20% â†’ -15% ì‹œ 10%. í•˜ë½ì„ ê¸°íšŒë¡œ í™œìš©. ì´ íˆ¬ì í•œë„ëŠ” í¬íŠ¸ 20% ì´ë‚´' },
      { icon:'ğŸ“°', title:'Thesis(íˆ¬ìê·¼ê±°) ê´€ë¦¬', body:'ë§¤ìˆ˜ ì „ íˆ¬ì ê·¼ê±°ë¥¼ ë°˜ë“œì‹œ ë¬¸ì„œí™”. ì‹¤ì  ì•…í™”Â·ì—…í™© êµ¬ì¡° ë³€í™”Â·ê²½ì˜ì§„ ë¬¸ì œ ë°œìƒ ì‹œ Thesis í›¼ì† â†’ ì¦‰ì‹œ ë§¤ë„ ê²€í† ' },
      { icon:'â³', title:'ì¸ë‚´ì™€ ì´‰ë§¤ í™•ì¸', body:'ì €í‰ê°€ê°€ í•´ì†Œë˜ë ¤ë©´ ì´‰ë§¤(Catalyst)ê°€ í•„ìš” â€” ì‹¤ì  ê°œì„ , IR, ìì‚¬ì£¼ ë§¤ì…, ì—…í™© ë°˜ë“±. ì´‰ë§¤ ì—†ëŠ” ì €í‰ê°€ëŠ” ì¥ê¸°ê°„ ë°©ì¹˜ë  ìˆ˜ ìˆìŒ' },
    ]
  },
  swing: {
    label: 'ğŸŒŠ ìŠ¤ìœ™',
    riskPct: 2,
    splits: 2,
    desc: [
      'ğŸ“Œ <b>í•µì‹¬ ì›ì¹™</b>: ìˆ˜ì¼~ìˆ˜ì£¼ ë‹¨ìœ„ ê°€ê²© íŒŒë™ í¬ì°©. ì§€ì§€Â·ì €í•­ êµ¬ê°„ í™œìš©',
      'ğŸ¯ <b>ì†ì ˆ ê¸°ì¤€</b>: ì§€ì§€ì„  ì´íƒˆ or ë§¤ìˆ˜ê°€ -4~6% ì¤‘ ë¨¼ì € ì˜¤ëŠ” ê²ƒ',
      'ğŸ“ˆ <b>ëª©í‘œ ì†ìµë¹„</b>: 2:1 ì´ìƒ â€” ë‹¤ìŒ ì €í•­ê¹Œì§€ ê±°ë¦¬ê°€ ì†ì ˆí­ 2ë°° ì´ìƒì´ì–´ì•¼ ì§„ì…',
      'ğŸ”€ <b>ë¶„í•  ì „ëµ</b>: 2ë¶„í•  â€” 1ì°¨ ì§€ì§€ì„  ê·¼ì²˜ 70%, ëˆŒë¦¼ í™•ì¸ í›„ 2ì°¨ 30%',
      'â± <b>ë³´ìœ  ê¸°ê°„</b>: 3ì¼~4ì£¼. ëª©í‘œê°€ ë„ë‹¬ or ì§€ì§€ ì´íƒˆ ì‹œ ì²­ì‚°',
      'âš ï¸ <b>ì£¼ì˜</b>: ì‹¤ì  ë°œí‘œÂ·ê³µì‹œ ì¼ì • ì‚¬ì „ í™•ì¸. ì´ë²¤íŠ¸ ì „ í¬ì§€ì…˜ 50% ì¶•ì†Œ ê¶Œì¥',
    ],
    guide: [
      { icon:'ğŸ“', title:'ì§„ì… êµ¬ê°„ ì„¤ì •', body:'20ì¼ ì´ë™í‰ê· ì„  ë˜ëŠ” ì§ì „ ê³ ì  ì§€ì§€ í™•ì¸ í›„ ì§„ì…. ì§€ì§€ì„  -1% ì´ë‚´ê°€ ìµœì  ì§„ì…ì ' },
      { icon:'ğŸ¯', title:'ëª©í‘œê°€ ì„¤ì •', body:'ë‹¤ìŒ ì €í•­ì„ (ì „ê³ ì , í”¼ë³´ë‚˜ì¹˜ 61.8%)ì„ ëª©í‘œë¡œ ì„¤ì •. ì†ìµë¹„ 2:1 ë¯¸ë‹¬ ì‹œ íŒ¨ìŠ¤' },
      { icon:'ğŸ“…', title:'ì´ë²¤íŠ¸ ê´€ë¦¬', body:'ì‹¤ì  ë°œí‘œ ì „ í¬ì§€ì…˜ 50% ì¶•ì†Œ. ê³µì‹œÂ·ì´ìŠˆ ë°œìƒ ì‹œ ì¦‰ì‹œ ëŒ€ì‘ ê³„íš ìˆ˜ë¦½' },
      { icon:'ğŸ”„', title:'ì†ì ˆ í›„ ì¬ì§„ì…', body:'ì†ì ˆ í›„ ë™ì¼ ì¢…ëª© ì¦‰ì‹œ ì¬ì§„ì… ê¸ˆì§€. ìµœì†Œ 2ì¼ ê´€ë§ í›„ ìƒˆë¡œìš´ íŒ¨í„´ í™•ì¸ ì‹œì—ë§Œ ì¬ì§„ì…' },
    ]
  },
  scalping: {
    label: 'âš¡ ë‹¨ê¸°ìŠ¤ìº˜í•‘',
    riskPct: 1,
    splits: 1,
    desc: [
      'ğŸ“Œ <b>í•µì‹¬ ì›ì¹™</b>: ì§§ì€ ì‹œê°„ ë‚´ ì†Œí­ ìˆ˜ìµ ë°˜ë³µ. ì†ì ˆ ë¹ ë¥´ê³  ìˆ˜ìµë„ ë¹ ë¥´ê²Œ í™•ì •',
      'ğŸ¯ <b>ì†ì ˆ ê¸°ì¤€</b>: ë§¤ìˆ˜ê°€ -1~2%. ì ˆëŒ€ ì†ì ˆ ì—°ì¥ ê¸ˆì§€ â€” í•œ ë²ˆì˜ í° ì†ì‹¤ì´ ìˆ˜ì‹­ ë²ˆ ìˆ˜ìµì„ ë‚ ë¦¼',
      'ğŸ“ˆ <b>ëª©í‘œ ì†ìµë¹„</b>: 1.5:1 ì´ìƒ. ê±°ë˜ë¹„ìš©(ìˆ˜ìˆ˜ë£Œ+ì¦ê¶Œê±°ë˜ì„¸ ì•½ 0.23%) ë°˜ë“œì‹œ í¬í•¨ ê³„ì‚°',
      'ğŸ”€ <b>ë¶„í•  ì „ëµ</b>: 1íšŒ ì¼ê´„ ì§„ì… â€” ë¶„í•  ì‹œ í‰ê· ë‹¨ê°€ ê³„ì‚° ë³µì¡í•´ì§',
      'â± <b>ë³´ìœ  ê¸°ê°„</b>: ìˆ˜ë¶„~ë‹¹ì¼ ì²­ì‚°. ìµì¼ ë³´ìœ  ì ˆëŒ€ ê¸ˆì§€',
      'âš ï¸ <b>ì£¼ì˜</b>: í•˜ë£¨ ìµœëŒ€ ê±°ë˜ íšŸìˆ˜ ì„¤ì •. ì—°ì† ì†ì ˆ 2íšŒ ì‹œ ë‹¹ì¼ ê±°ë˜ ì¤‘ë‹¨ ê·œì¹™ ì ìš©',
    ],
    guide: [
      { icon:'âš¡', title:'ë¹ ë¥¸ ìµì ˆ ì›ì¹™', body:'ëª©í‘œê°€ ë„ë‹¬ ì¦‰ì‹œ ì²­ì‚°. "ì¡°ê¸ˆ ë”"ëŠ” ê¸ˆë¬¼. 1~2% ìˆ˜ìµ í™•ì •ì´ ëª©í‘œ â€” íƒìš•ì€ ìŠ¤ìº˜í•‘ì˜ ì ' },
      { icon:'ğŸ’¸', title:'ê±°ë˜ë¹„ìš© ê³„ì‚°', body:'ë§¤ìˆ˜Â·ë§¤ë„ ê° 0.015% + ì¦ê¶Œê±°ë˜ì„¸ 0.2% = ì™•ë³µ ì•½ 0.23%. ëª©í‘œìˆ˜ìµì´ ì´ë³´ë‹¤ ë†’ì•„ì•¼ ì˜ë¯¸ ìˆìŒ' },
      { icon:'ğŸ§ ', title:'ì§‘ì¤‘ë ¥ ê´€ë¦¬', body:'í•˜ë£¨ ìµœëŒ€ ê±°ë˜ íšŸìˆ˜ ì„¤ì • (ì˜ˆ: 5íšŒ). ì—°ì† 2íšŒ ì†ì ˆ ì‹œ ì¦‰ì‹œ ê±°ë˜ ì¤‘ë‹¨ â€” ê°ì •ì  ë³µìˆ˜ë§¤ë§¤ ë°©ì§€' },
      { icon:'ğŸ“µ', title:'1~2ì¢…ëª© ì§‘ì¤‘', body:'ì—¬ëŸ¬ ì¢…ëª© ë™ì‹œ ìŠ¤ìº˜í•‘ì€ ì‹¤ìˆ˜ í™•ë¥  ê¸‰ì¦. 1~2ì¢…ëª©ë§Œ ì§‘ì¤‘ ëª¨ë‹ˆí„°ë§. í˜¸ê°€ì°½ ìµìˆ™í•´ì§„ í›„ í™•ì¥' },
    ]
  },
  turtle: {
    label: 'ğŸ¢ í„°í‹€',
    riskPct: 1,
    splits: 4,
    desc: [
      'ğŸ“Œ <b>í•µì‹¬ ì›ì¹™</b>: ì‹œìŠ¤í…œì´ ì „ë¶€ â€” ì‚¬ëŒì˜ íŒë‹¨Â·ê°ì • ê°œì… ì—†ì´ ê¸°ê³„ì  ê·œì¹™ë§Œ ì‹¤í–‰. "ë‹¹ì‹ ì´ ì•„ë‹ˆë¼ ì‹œìŠ¤í…œì´ ë§¤ë§¤í•œë‹¤"',
      'ğŸ“ <b>N(ATR)</b>: 20ì¼ í‰ê·  ì‹¤ì œ ë³€ë™í­(Average True Range). ëª¨ë“  ë¦¬ìŠ¤í¬ ê³„ì‚°ì˜ ê¸°ì¤€ë‹¨ìœ„. ì†ì ˆÂ·ìˆ˜ëŸ‰Â·í”¼ë¼ë¯¸ë”© ì „ë¶€ Nìœ¼ë¡œ ê³„ì‚°',
      'ğŸ¯ <b>ì§„ì… ì‹œìŠ¤í…œ 1 (ë‹¨ê¸°)</b>: <b>20ì¼ ì‹ ê³ ê°€</b> ëŒíŒŒ ì‹œ ë§¤ìˆ˜. ë‹¨, ì§ì „ 20ì¼ ì‹ ê³ ê°€ ëŒíŒŒê°€ ìˆ˜ìµìœ¼ë¡œ ëë‚¬ë‹¤ë©´ íŒ¨ìŠ¤',
      'ğŸ¯ <b>ì§„ì… ì‹œìŠ¤í…œ 2 (ì¥ê¸°)</b>: <b>55ì¼ ì‹ ê³ ê°€</b> ëŒíŒŒ ì‹œ ë¬´ì¡°ê±´ ë§¤ìˆ˜ (í•„í„° ì—†ìŒ)',
      'ğŸ“‰ <b>ì†ì ˆ ê¸°ì¤€</b>: ë§¤ìˆ˜ê°€ ê¸°ì¤€ <b>-2N</b> ì´íƒˆ ì‹œ ì¦‰ì‹œ ì²­ì‚°. ê°ì • ê°œì… ì ˆëŒ€ ê¸ˆì§€',
      'ğŸ”€ <b>í”¼ë¼ë¯¸ë”©</b>: ì§„ì… í›„ <b>+0.5N</b>ë§ˆë‹¤ ë™ì¼ ìˆ˜ëŸ‰ ì¶”ê°€ë§¤ìˆ˜. ìµœëŒ€ 4íšŒê¹Œì§€ (ì´ 4ìœ ë‹›)',
      'ğŸ“¦ <b>í¬ì§€ì…˜ í¬ê¸°</b>: ê³„ì¢Œì˜ 1% ë¦¬ìŠ¤í¬ Ã· (2N Ã— ì£¼ê°€) = ë§¤ìˆ˜ ìˆ˜ëŸ‰. ë¦¬ìŠ¤í¬ ê³ ì •',
      'âš ï¸ <b>ì£¼ì˜</b>: í„°í‹€ì€ ì‹œìŠ¤í…œ ì‹ ë¢°ê°€ í•µì‹¬. ì†ì‹¤ êµ¬ê°„ì—ë„ ê·œì¹™ ì´íƒˆ ê¸ˆì§€. ì´ê¸°ëŠ” ë‚ ë³´ë‹¤ ê·œì¹™ ì§€í‚¤ëŠ” ë‚ ì´ ì¤‘ìš”',
    ],
    guide: [
      { icon:'ğŸ“', title:'N(ATR) ê³„ì‚°ë²•', body:'N = 20ì¼ê°„ì˜ TR(True Range) í‰ê· . TR = max(ë‹¹ì¼ê³ ê°€-ì €ê°€, |ë‹¹ì¼ê³ ê°€-ì „ì¼ì¢…ê°€|, |ë‹¹ì¼ì €ê°€-ì „ì¼ì¢…ê°€|). Nì´ í´ìˆ˜ë¡ ë³€ë™ì„± í° ì¢…ëª©' },
      { icon:'ğŸ“¦', title:'ìœ ë‹›(Unit) ê³„ì‚°', body:'ìœ ë‹› ìˆ˜ëŸ‰ = (ê³„ì¢Œ Ã— 1%) Ã· (N Ã— ì£¼ê°€). ì˜ˆ: ê³„ì¢Œ 1000ë§Œì›, N=500ì›, ì£¼ê°€ 50000ì› â†’ 1ìœ ë‹› = (100,000 Ã· 25,000,000) â‰ˆ 4ì£¼' },
      { icon:'ğŸ”¼', title:'í”¼ë¼ë¯¸ë”© ê·œì¹™', body:'1ìœ ë‹› ì§„ì… â†’ +0.5Në§ˆë‹¤ 1ìœ ë‹›ì”© ì¶”ê°€ â†’ ìµœëŒ€ 4ìœ ë‹›. ì¶”ê°€í•  ë•Œë§ˆë‹¤ ì „ì²´ ì†ì ˆê°€ë„ +0.5Nì”© ìƒí–¥. ì ˆëŒ€ 4ìœ ë‹› ì´ˆê³¼ ê¸ˆì§€' },
      { icon:'ğŸšª', title:'ì²­ì‚° ê·œì¹™', body:'ì‹œìŠ¤í…œ 1 ì²­ì‚°: 10ì¼ ì‹ ì €ê°€ ì´íƒˆ. ì‹œìŠ¤í…œ 2 ì²­ì‚°: 20ì¼ ì‹ ì €ê°€ ì´íƒˆ. ì†ì ˆ: ì§„ì…ê°€ -2N. íŠ¸ë ˆì¼ë§ ìŠ¤íƒ‘ê³¼ ê³ ì • ì†ì ˆ ì¤‘ ë¨¼ì € ê±¸ë¦¬ëŠ” ê²ƒ ì ìš©' },
    ]
  },
  growth: {
    label: 'ğŸŒ± ì„±ì¥ì£¼',
    riskPct: 3,
    splits: 3,
    desc: [
      'ğŸ“Œ <b>í•µì‹¬ ì›ì¹™</b>: ì‹¤ì Â·ë§¤ì¶œ ê³ ì„±ì¥ ê¸°ì—…ì— ì¥ê¸° íˆ¬ì. ë°¸ë¥˜ì—ì´ì…˜ë³´ë‹¤ ì„±ì¥ì„± ìš°ì„ ',
      'ğŸ¯ <b>ì†ì ˆ ê¸°ì¤€</b>: ì„±ì¥ ìŠ¤í† ë¦¬ í›¼ì† ì‹œ â€” ë§¤ì¶œ ì„±ì¥ë¥  ë‘”í™”, ì‹œì¥ì ìœ ìœ¨ í•˜ë½, ê²½ìŸì‚¬ ê¸‰ë¶€ìƒ',
      'ğŸ“ˆ <b>ëª©í‘œ ì†ìµë¹„</b>: 5:1 ì´ìƒ â€” í° ë³€ë™ì„± ê°ë‚´, í° ìˆ˜ìµ ëª©í‘œ',
      'ğŸ”€ <b>ë¶„í•  ì „ëµ</b>: 3ë¶„í•  â€” ì´ˆê¸° 50%, ë¶„ê¸° ì‹¤ì  í™•ì¸ í›„ 30%, ì¶”ê°€ ì„±ì¥ í™•ì¸ í›„ 20%',
      'â± <b>ë³´ìœ  ê¸°ê°„</b>: ì¥ê¸° (1ë…„ ì´ìƒ). ë¶„ê¸° ì‹¤ì ë§ˆë‹¤ ì„±ì¥ thesis ì ê²€',
      'âš ï¸ <b>ì£¼ì˜</b>: ê³ PER ì¢…ëª©ì€ ê¸ˆë¦¬ ìƒìŠ¹ ì‹œ ë°¸ë¥˜ì—ì´ì…˜ ì••ë°•. ê¸ˆë¦¬ í™˜ê²½ ë°˜ë“œì‹œ ì²´í¬',
    ],
    guide: [
      { icon:'ğŸ“ˆ', title:'ì„±ì¥ ì§€í‘œ í™•ì¸', body:'ë§¤ì¶œ YoY 20%+ ì„±ì¥ / ì˜ì—…ì´ìµ ì¦ê°€ ì¶”ì„¸ / TAM(ì „ì²´ ì‹œì¥) ì¶©ë¶„íˆ í°ì§€ / ë§¤ì¶œì´ì´ìµë¥  ê°œì„  ì—¬ë¶€' },
      { icon:'ğŸ”¬', title:'ê²½ìŸìš°ìœ„(Moat) ë¶„ì„', body:'íŠ¹í—ˆÂ·ê¸°ìˆ ë ¥Â·ë„¤íŠ¸ì›Œí¬íš¨ê³¼Â·ì „í™˜ë¹„ìš© ë“± í•´ì ì¡´ì¬ ì—¬ë¶€. 1~2ë…„ ë‚´ ë”°ë¼ì¡í ê¸°ì—…ì€ ì„±ì¥ì£¼ ì•„ë‹Œ ë‹¨ìˆœ í…Œë§ˆì£¼' },
      { icon:'ğŸ“Š', title:'ë¶„ê¸° ì‹¤ì  ëª¨ë‹ˆí„°ë§', body:'ê°€ì´ë˜ìŠ¤ í•˜íšŒ ì‹œ ì¦‰ì‹œ ì¬ê²€í† . 2ë¶„ê¸° ì—°ì† ê¸°ëŒ€ì¹˜ ë¯¸ë‹¬ì€ thesis í›¼ì† ì‹ í˜¸ â€” ë³´ìœ  ê·¼ê±° ì¬ê²€í†  í•„ìˆ˜' },
      { icon:'ğŸŒ', title:'ê¸ˆë¦¬Â·ë§¤í¬ë¡œ ì²´í¬', body:'ê¸ˆë¦¬ ì¸ìƒê¸°ì—ëŠ” ì„±ì¥ì£¼ ë¹„ì¤‘ ì¶•ì†Œ. ê¸ˆë¦¬ í•˜ë½ ì „í™˜ ì‹ í˜¸ ì‹œ ì„±ì¥ì£¼ ë¹„ì¤‘ í™•ëŒ€. PER ë†’ì„ìˆ˜ë¡ ê¸ˆë¦¬ ë¯¼ê°ë„ ì»¤ì§' },
    ]
  }
};

let currentInvestStyle = 'momentum';

const STYLE_RULES = {
  minervini: [
    'SEPA íŠ¸ë Œë“œ í…œí”Œë¦¿ 7ê°€ì§€ ëª¨ë‘ ì¶©ì¡± í™•ì¸',
    'VCP íŒ¨í„´ or ë² ì´ìŠ¤ í˜•ì„± í™•ì¸ (ìµœì†Œ 3~6ì£¼)',
    'í”¼ë²— í¬ì¸íŠ¸ ëŒíŒŒ + ê±°ë˜ëŸ‰ 50ì¼ í‰ê·  40%â†‘',
    'ì†ì ˆê°€ = í”¼ë²— ê¸°ì¤€ -7~8% ì‚¬ì „ ì„¤ì •',
    'ì‹œì¥ ë°©í–¥ í™•ì¸ (Confirmed Uptrend)',
    'í¬ì§€ì…˜ í¬ê¸° = ì´ìì‚° ì†ì‹¤ 1.5% ì´ë‚´',
    'ì¶”ê²©ë§¤ìˆ˜ ê¸ˆì§€ â€” í”¼ë²—ì—ì„œ 3% ì´ìƒ ì´ê²© ì‹œ íŒ¨ìŠ¤',
  ],
  momentum: [
    'ê±°ë˜ëŸ‰ 20ì¼ í‰ê·  150%â†‘ í™•ì¸',
    'ì‹ ê³ ê°€ ëŒíŒŒ í™•ì¸',
    'ì†ì ˆê°€ ì‚¬ì „ ì„¤ì • (ë§¤ìˆ˜ê°€ -3~5%)',
    'ì†ìµë¹„ 2:1 ì´ìƒ í™•ì¸',
    'ì‹œì¥ ê°•ì„¸ í™•ì¸',
  ],
  value: [
    'PER ì—…ì¢… í‰ê·  ì´í•˜ í™•ì¸',
    'ROE 10% ì´ìƒ í™•ì¸',
    'ë¶€ì±„ë¹„ìœ¨ 100% ì´í•˜ í™•ì¸',
    'íˆ¬ì Thesis ë¬¸ì„œí™” ì™„ë£Œ',
    'ì•ˆì „ë§ˆì§„ 30% ì´ìƒ í™•ì¸',
    'ì´‰ë§¤(Catalyst) ì¡´ì¬ í™•ì¸',
  ],
  swing: [
    'ì§€ì§€ì„ Â·ì €í•­ì„  í™•ì¸',
    'ì†ì ˆê°€ = ì§€ì§€ì„  ì´íƒˆê°€ ì‚¬ì „ ì„¤ì •',
    'ì†ìµë¹„ 2:1 ì´ìƒ í™•ì¸',
    'ì‹¤ì  ë°œí‘œ ì¼ì • í™•ì¸',
    'ì´ë™í‰ê· ì„ (20ì¼) ë°©í–¥ í™•ì¸',
  ],
  scalping: [
    'ì˜¤ëŠ˜ ì¼ì¼ ê±°ë˜ í•œë„ í™•ì¸',
    'ëª©í‘œê°€Â·ì†ì ˆê°€ ì‚¬ì „ ì„¤ì •',
    'ê±°ë˜ë¹„ìš© í¬í•¨ ì†ìµë¹„ ê³„ì‚°',
    'ì „ë‚  ì—°ì† ì†ì ˆ ì—†ì—ˆëŠ”ì§€ í™•ì¸',
  ],
  growth: [
    'ë§¤ì¶œ YoY 20%â†‘ í™•ì¸',
    'ê²½ìŸìš°ìœ„(Moat) ì¡´ì¬ í™•ì¸',
    'ê¸ˆë¦¬ í™˜ê²½ ì²´í¬',
    'ë¶„ê¸° ì‹¤ì  ê°€ì´ë˜ìŠ¤ í™•ì¸',
    'íˆ¬ì Thesis ë¬¸ì„œí™” ì™„ë£Œ',
  ],
};

function pickInvestStyle(btn) {
  document.querySelectorAll('.invest-style-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  currentInvestStyle = btn.dataset.style;
  const s = INVEST_STYLES[currentInvestStyle];

  // ì„¤ëª… ì—…ë°ì´íŠ¸
  const descEl = document.getElementById('invest-style-desc');
  if (descEl) descEl.innerHTML = s.desc.map(d => `<div style="padding:2px 0">${d}</div>`).join('');

  // ê¶Œì¥ ë¦¬ìŠ¤í¬% ìë™ ì ìš©
  const riskEl = document.getElementById('r-risk-pct');
  const riskLbl = document.getElementById('r-risk-pct-label');
  if (riskEl) { riskEl.value = s.riskPct; riskLbl.textContent = s.riskPct + '%'; }

  // ê¶Œì¥ ë¶„í•  ìë™ ì ìš©
  const splitEl = document.getElementById('r-splits');
  if (splitEl) splitEl.value = s.splits;

  // ê°€ì´ë“œ ì¹´ë“œ ì—…ë°ì´íŠ¸
  renderInvestGuide();
  calcRisk();

  // ë¯¸ë„ˆë¹„ë‹ˆ VCP ì²´í¬ë¦¬ìŠ¤íŠ¸ ì„¹ì…˜ í‘œì‹œ/ìˆ¨ê¹€
  const vcpSection = document.getElementById('vcp-checklist-section');
  if (vcpSection) vcpSection.style.display = currentInvestStyle === 'minervini' ? 'block' : 'none';

  // í„°í‹€ ì„¹ì…˜ í‘œì‹œ/ìˆ¨ê¹€
  const turtleSection = document.getElementById('turtle-section');
  if (turtleSection) turtleSection.style.display = currentInvestStyle === 'turtle' ? 'block' : 'none';
}



// â”€â”€ í„°í‹€ ATR ê¸°ë°˜ ê³„ì‚°ê¸° â”€â”€
function calcTurtle() {
  const capital = parseFloat(document.getElementById('t-capital').value) || 0;
  const atr     = parseFloat(document.getElementById('t-atr').value) || 0;
  const price   = parseFloat(document.getElementById('t-price').value) || 0;
  const unit    = parseInt(document.getElementById('t-unit').value) || 1;
  const system  = parseInt(document.getElementById('t-system').value) || 20;
  const el      = document.getElementById('t-result');
  const pyrEl   = document.getElementById('t-pyramid');
  const pyrSum  = document.getElementById('t-pyramid-summary');

  if (!capital || !atr || !price) {
    el.innerHTML = '<div style="color:var(--muted);font-size:13px;padding:16px;text-align:center;background:var(--s2);border-radius:8px;border:1px solid var(--border)">ê³„ì¢ŒÂ·NÂ·ì£¼ê°€ë¥¼ ì…ë ¥í•˜ë©´<br>ìœ ë‹› ìˆ˜ëŸ‰ê³¼ ì†ì ˆê°€ê°€ ê³„ì‚°ë¼ìš”</div>';
    return;
  }

  // ìœ ë‹› ê³„ì‚°: ê³„ì¢Œ 1% Ã· (2N per share)  [ì†ì ˆ 2N ê¸°ì¤€]
  const riskPerUnit = capital * 0.01;          // 1ìœ ë‹›ë‹¹ í—ˆìš© ì†ì‹¤
  const riskPerShare = 2 * atr;                // ì£¼ë‹¹ ì†ì‹¤ (2N)
  const unitQty = Math.max(1, Math.floor(riskPerUnit / (riskPerShare)));
  const stopPrice = Math.round(price - riskPerShare);
  const stopPct = (riskPerShare / price * 100).toFixed(2);
  const unitAmt = unitQty * price;
  const portPct = (unitAmt / capital * 100).toFixed(1);

  // í˜„ì¬ ìœ ë‹›ì˜ ì§„ì…ê°€ (í”¼ë¼ë¯¸ë”©)
  const entryPrice = Math.round(price + (unit - 1) * atr * 0.5);
  const currentStop = Math.round(entryPrice - riskPerShare);

  el.innerHTML = `
    <div style="display:flex;flex-direction:column;gap:7px">
      ${[
        ['ğŸ“¦ 1ìœ ë‹› ìˆ˜ëŸ‰', unitQty.toLocaleString() + 'ì£¼', 'var(--text)'],
        ['ğŸ’° 1ìœ ë‹› ê¸ˆì•¡', 'â‚©' + Math.round(unitQty * price).toLocaleString(), 'var(--accent)'],
        ['ğŸ“Š í¬íŠ¸ ë¹„ì¤‘', portPct + '%', parseFloat(portPct)>10?'var(--warn)':'var(--profit)'],
        ['ğŸ“‰ ì†ì ˆê°€ (-2N)', 'â‚©' + stopPrice.toLocaleString(), 'var(--loss)'],
        ['ğŸ“‰ ì†ì ˆí­', stopPct + '%', 'var(--loss)'],
        ['ğŸ“ N (ATR)', 'â‚©' + Math.round(atr).toLocaleString(), 'var(--muted)'],
      ].map(([l,v,c]) => `
        <div style="display:flex;justify-content:space-between;align-items:center;background:var(--s2);border-radius:7px;padding:8px 11px;border:1px solid var(--border)">
          <span style="font-size:11px;color:var(--muted)">${l}</span>
          <span style="font-family:'Roboto Mono',monospace;font-size:13px;font-weight:700;color:${c}">${v}</span>
        </div>`).join('')}
      <div style="padding:8px 11px;background:rgba(29,111,242,.06);border:1px solid rgba(29,111,242,.15);border-radius:7px;font-size:11px;color:var(--muted)">
        ğŸ“Œ ì‹œìŠ¤í…œ ${system} â€” ${system}ì¼ ì‹ ê³ ê°€ ëŒíŒŒ ì§„ì… / ${system===20?'10':'20'}ì¼ ì‹ ì €ê°€ ì´íƒˆ ì²­ì‚°
      </div>
    </div>`;

  // 4ìœ ë‹› í”¼ë¼ë¯¸ë”© í”Œëœ
  const UNIT_COLORS = ['rgba(29,111,242,.07)','rgba(52,211,153,.07)','rgba(251,191,36,.07)','rgba(248,113,113,.07)'];
  const UNIT_BORDER = ['rgba(29,111,242,.25)','rgba(52,211,153,.25)','rgba(251,191,36,.25)','rgba(248,113,113,.25)'];
  const UNIT_COL    = ['var(--accent)','var(--profit)','var(--warn)','var(--loss)'];

  let totalQty = 0, totalAmt = 0;
  const rows = [1,2,3,4].map(u => {
    const ep  = Math.round(price + (u-1) * atr * 0.5);
    const sp  = Math.round(ep - riskPerShare);
    const amt = unitQty * ep;
    totalQty += unitQty;
    totalAmt += amt;
    return `
      <div style="display:grid;grid-template-columns:auto 1fr 1fr 1fr 1fr;gap:7px;padding:9px 12px;border-radius:8px;background:${UNIT_COLORS[u-1]};border:1.5px solid ${UNIT_BORDER[u-1]};align-items:center;font-size:12px">
        <span style="font-weight:700;color:${UNIT_COL[u-1]};min-width:28px">${u}ìœ ë‹›</span>
        <span style="font-family:'Roboto Mono',monospace">â‚©${ep.toLocaleString()}</span>
        <span style="font-family:'Roboto Mono',monospace">${unitQty}ì£¼</span>
        <span style="font-family:'Roboto Mono',monospace;color:var(--loss)">â‚©${sp.toLocaleString()}</span>
        <span style="font-family:'Roboto Mono',monospace;color:var(--muted)">â‚©${Math.round(amt).toLocaleString()}</span>
      </div>`;
  });

  pyrEl.innerHTML = rows.join('');
  pyrSum.innerHTML = `
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <div style="flex:1;min-width:120px;background:var(--s2);border:1.5px solid var(--border);border-radius:8px;padding:10px 12px">
        <div style="font-size:10px;color:var(--muted);margin-bottom:3px">4ìœ ë‹› ì´ ìˆ˜ëŸ‰</div>
        <div style="font-family:'Roboto Mono',monospace;font-size:15px;font-weight:700">${totalQty.toLocaleString()}ì£¼</div>
      </div>
      <div style="flex:1;min-width:120px;background:var(--s2);border:1.5px solid var(--border);border-radius:8px;padding:10px 12px">
        <div style="font-size:10px;color:var(--muted);margin-bottom:3px">4ìœ ë‹› ì´ íˆ¬ìê¸ˆ</div>
        <div style="font-family:'Roboto Mono',monospace;font-size:15px;font-weight:700;color:var(--accent)">â‚©${Math.round(totalAmt).toLocaleString()}</div>
      </div>
      <div style="flex:1;min-width:120px;background:var(--s2);border:1.5px solid var(--border);border-radius:8px;padding:10px 12px">
        <div style="font-size:10px;color:var(--muted);margin-bottom:3px">4ìœ ë‹› í¬íŠ¸ ë¹„ì¤‘</div>
        <div style="font-family:'Roboto Mono',monospace;font-size:15px;font-weight:700;color:${totalAmt/capital*100>20?'var(--warn)':'var(--profit)'}">
          ${(totalAmt/capital*100).toFixed(1)}%
        </div>
      </div>
    </div>`;
}

// â”€â”€ VCP ìŠ¤ì½”ì–´ ê³„ì‚° â”€â”€
function calcVcpScore() {
  const cbs = document.querySelectorAll('.vcp-cb');
  const total   = cbs.length;
  const checked = [...cbs].filter(c => c.checked).length;
  const pct = total > 0 ? checked / total * 100 : 0;

  const scoreText = document.getElementById('vcp-score-text');
  const scoreFill = document.getElementById('vcp-score-fill');
  const verdict   = document.getElementById('vcp-score-verdict');

  if (!scoreText) return;
  scoreText.textContent = `${checked} / ${total}`;

  let color, msg;
  if (pct >= 85) {
    color = 'var(--profit)';
    msg = 'âœ… <b style="color:var(--profit)">ì§„ì… ê°€ëŠ¥</b> â€” VCP ì¡°ê±´ ëŒ€ë¶€ë¶„ ì¶©ì¡±. í”¼ë´‡ ëŒíŒŒ + ê±°ë˜ëŸ‰ í™•ì¸ í›„ ì§„ì…í•˜ì„¸ìš”';
  } else if (pct >= 65) {
    color = 'var(--warn)';
    msg = 'âš ï¸ <b style="color:var(--warn)">ì£¼ì˜ ì§„ì…</b> â€” ì¼ë¶€ ì¡°ê±´ ë¯¸ì¶©ì¡±. ë¯¸ì¶©ì¡± í•­ëª© ì¬í™•ì¸ í›„ ê²°ì •í•˜ì„¸ìš”';
  } else if (pct >= 40) {
    color = 'var(--accent)';
    msg = 'ğŸ” <b style="color:var(--accent)">ì¤€ë¹„ ë¯¸í¡</b> â€” ì•„ì§ VCP ì¡°ê±´ì´ ë¶€ì¡±í•´ìš”. ê´€ì‹¬ì¢…ëª©ìœ¼ë¡œë§Œ ë“±ë¡í•˜ì„¸ìš”';
  } else {
    color = 'var(--muted)';
    msg = 'âŒ <b>ì§„ì… ë¶ˆê°€</b> â€” í•µì‹¬ ì¡°ê±´ì´ ì¶©ì¡±ë˜ì§€ ì•Šì•˜ì–´ìš”. ì§€ê¸ˆì€ ê´€ë§ì´ ë§ì•„ìš”';
  }

  scoreText.style.color = color;
  scoreFill.style.width = pct + '%';
  scoreFill.style.background = color;
  verdict.innerHTML = msg;
}

function renderInvestGuide() {
  const el = document.getElementById('invest-guide-grid');
  if (!el) return;
  const s = INVEST_STYLES[currentInvestStyle];
  el.innerHTML = s.guide.map(g => `
    <div style="background:var(--s2);border:1.5px solid var(--border);border-radius:10px;padding:13px 15px">
      <div style="font-size:20px;margin-bottom:6px">${g.icon}</div>
      <div style="font-size:13px;font-weight:700;margin-bottom:5px;color:var(--text)">${g.title}</div>
      <div style="font-size:12px;color:var(--muted);line-height:1.7">${g.body}</div>
    </div>`).join('');
}

function renderRisk() {
  // íˆ¬ì ë°©ì‹ ê°€ì´ë“œ ì´ˆê¸°í™”
  const activeBtn = document.querySelector('.invest-style-btn.active');
  if (activeBtn) pickInvestStyle(activeBtn);
  else renderInvestGuide();
  // íŒŒì´ì°¨íŠ¸
  drawPieChart();
  // í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ìŠ¤í¬ ìš”ì•½
  const held = positions.filter(p => p.status === 'holding');
  const el = document.getElementById('portfolio-risk');
  if (!held.length) { el.innerHTML = '<div style="color:var(--muted);font-size:13px">ë³´ìœ  í¬ì§€ì…˜ì´ ì—†ìŠµë‹ˆë‹¤</div>'; return; }
  const totalInv = held.reduce((s,p) => s + calcPos(p).invested, 0);
  const totalUnreal = held.reduce((s,p) => s + calcPos(p).unrealPnL, 0);
  const stpSet = held.filter(p => p.stopPrice);
  const noStp = held.filter(p => !p.stopPrice);
  el.innerHTML = `
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:9px;margin-bottom:12px">
      <div style="background:var(--s2);border-radius:8px;padding:11px;border:1px solid var(--border)">
        <div style="font-size:10px;color:var(--muted);margin-bottom:4px;text-transform:uppercase;letter-spacing:.6px">ì´ íˆ¬ìê¸ˆ</div>
        <div style="font-family:'Roboto Mono',monospace;font-size:16px">â‚©${Math.round(totalInv).toLocaleString()}</div>
      </div>
      <div style="background:var(--s2);border-radius:8px;padding:11px;border:1px solid var(--border)">
        <div style="font-size:10px;color:var(--muted);margin-bottom:4px;text-transform:uppercase;letter-spacing:.6px">í‰ê°€ ì†ìµ</div>
        <div style="font-family:'Roboto Mono',monospace;font-size:16px" class="${totalUnreal>=0?'profit':'loss'}">${fmtN(totalUnreal,'KRW')}</div>
      </div>
    </div>
    <div style="font-size:12px;color:var(--muted);margin-bottom:6px">ì†ì ˆê°€ ì„¤ì •: ${stpSet.length}/${held.length}ê°œ</div>
    ${noStp.length ? `<div style="background:rgba(248,113,113,.08);border:1px solid rgba(248,113,113,.2);border-radius:8px;padding:10px 12px">
      <div style="font-size:12px;color:var(--loss);font-weight:600;margin-bottom:5px">âš ï¸ ì†ì ˆê°€ ë¯¸ì„¤ì •</div>
      ${noStp.map(p=>`<div style="font-size:12px;color:var(--muted)">â€¢ ${p.name}</div>`).join('')}
    </div>` : '<div style="background:rgba(52,211,153,.08);border:1px solid rgba(52,211,153,.2);border-radius:8px;padding:10px 12px;font-size:12px;color:var(--profit)">âœ… ëª¨ë“  í¬ì§€ì…˜ì— ì†ì ˆê°€ ì„¤ì •ë¨</div>'}`;
}

function drawPieChart() {
  const canvas = document.getElementById('cv-pie');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const held = positions.filter(p => p.status === 'holding');
  ctx.clearRect(0, 0, 280, 280);
  if (!held.length) {
    ctx.fillStyle = 'rgba(74,85,104,.5)'; ctx.font = '13px sans-serif';
    ctx.textAlign = 'center'; ctx.fillText('ë³´ìœ  í¬ì§€ì…˜ ì—†ìŒ', 140, 140); return;
  }
  const data = held.map(p => ({ name: p.name, val: calcPos(p).invested }));
  const total = data.reduce((s,d) => s+d.val, 0);
  const colors = ['#4f9cf9','#34d399','#f87171','#fbbf24','#a78bfa','#38bdf8','#fb923c','#4ade80'];
  let angle = -Math.PI / 2;
  const cx=140, cy=140, r=110, ir=60;
  data.forEach((d, i) => {
    const slice = d.val / total * Math.PI * 2;
    ctx.beginPath(); ctx.moveTo(cx, cy);
    ctx.arc(cx, cy, r, angle, angle+slice);
    ctx.closePath(); ctx.fillStyle = colors[i%colors.length]; ctx.fill();
    ctx.beginPath(); ctx.moveTo(cx, cy);
    ctx.arc(cx, cy, ir, angle, angle+slice);
    ctx.closePath(); ctx.fillStyle = 'var(--surface)'; ctx.fill();
    angle += slice;
  });
  // ì¤‘ì•™ í…ìŠ¤íŠ¸
  ctx.fillStyle = '#e2e8f0'; ctx.font = 'bold 13px sans-serif';
  ctx.textAlign = 'center'; ctx.fillText(held.length+'ê°œ ì¢…ëª©', cx, cy-4);
  ctx.fillStyle = 'rgba(74,85,104,.8)'; ctx.font = '11px sans-serif';
  ctx.fillText('ë³´ìœ ì¤‘', cx, cy+14);
  // ë²”ë¡€
  document.getElementById('pie-legend').innerHTML = data.map((d,i) => `
    <div style="display:flex;align-items:center;gap:8px;font-size:12px">
      <div style="width:10px;height:10px;border-radius:2px;background:${colors[i%colors.length]};flex-shrink:0"></div>
      <span style="flex:1">${d.name}</span>
      <span style="font-family:'Roboto Mono',monospace;color:var(--muted)">${(d.val/total*100).toFixed(1)}%</span>
    </div>`).join('');
  // ë¹„ì¤‘ ë°”
  document.getElementById('alloc-bars').innerHTML = data.map((d,i) => {
    const pct = d.val/total*100;
    return `<div style="margin-bottom:7px">
      <div style="display:flex;justify-content:space-between;font-size:11px;margin-bottom:3px">
        <span>${d.name}</span><span style="font-family:'Roboto Mono',monospace;color:var(--muted)">${pct.toFixed(1)}%</span>
      </div>
      <div class="prog-track" style="height:5px"><div class="prog-fill" style="width:${pct}%;background:${colors[i%colors.length]}"></div></div>
    </div>`;
  }).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ğŸ“‹ ë§¤ë§¤ ê·œì¹™ ì²´í¬ë¦¬ìŠ¤íŠ¸ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderRules() {
  renderChecklist('entry', DEFAULT_ENTRY_CHECKS, 'ì§„ì… ì „');
  renderChecklist('exit', DEFAULT_EXIT_CHECKS, 'ì²­ì‚° ì „');
  renderRulesList();
  renderViolations();
}

function renderChecklist(type, defaults, label) {
  const el = document.getElementById(type+'-checklist');
  const cntEl = document.getElementById(type+'-check-count');
  const items = checkState[type];
  const checked = Object.values(items).filter(Boolean).length;
  cntEl.textContent = `${checked}/${defaults.length} ì™„ë£Œ`;
  el.innerHTML = defaults.map((text, i) => {
    const key = type+'_'+i;
    const done = items[key] || false;
    return `<div style="display:flex;align-items:flex-start;gap:10px;padding:9px 0;border-bottom:1px solid var(--border);cursor:pointer" onclick="toggleCheck('${type}','${key}')">
      <div style="width:20px;height:20px;border-radius:5px;border:2px solid ${done?'var(--accent)':'var(--border)'};background:${done?'var(--accent)':'transparent'};flex-shrink:0;display:flex;align-items:center;justify-content:center;margin-top:1px;transition:all .15s">
        ${done?'<span style="color:#0d1117;font-size:13px;font-weight:900">âœ“</span>':''}
      </div>
      <span style="font-size:13px;color:${done?'var(--muted)':'var(--text)'};text-decoration:${done?'line-through':'none'};transition:all .15s">${text}</span>
    </div>`;
  }).join('') + `<div style="margin-top:12px">
    <div style="background:${checked===defaults.length?'rgba(52,211,153,.1)':'rgba(79,156,249,.08)'};border:1px solid ${checked===defaults.length?'rgba(52,211,153,.25)':'rgba(79,156,249,.2)'};border-radius:8px;padding:10px 14px;display:flex;align-items:center;justify-content:space-between">
      <span style="font-size:13px;font-weight:600;color:${checked===defaults.length?'var(--profit)':'var(--accent)'}">${checked===defaults.length?'âœ… ëª¨ë“  ì¡°ê±´ ì¶©ì¡±!':'â³ '+checked+'/'+defaults.length+' ì™„ë£Œ'}</span>
      <div style="background:var(--border);border-radius:4px;height:6px;width:120px;overflow:hidden"><div style="background:${checked===defaults.length?'var(--profit)':'var(--accent)'};height:100%;width:${checked/defaults.length*100}%;transition:width .3s"></div></div>
    </div>
  </div>`;
}

function toggleCheck(type, key) {
  checkState[type][key] = !checkState[type][key];
  saveRules();
  renderChecklist(type, type==='entry'?DEFAULT_ENTRY_CHECKS:DEFAULT_EXIT_CHECKS, '');
}

function resetChecklist(type) {
  checkState[type] = {};
  saveRules();
  renderChecklist(type, type==='entry'?DEFAULT_ENTRY_CHECKS:DEFAULT_EXIT_CHECKS, '');
}

function renderRulesList() {
  const el = document.getElementById('rules-list');
  if (!rules.length) { el.innerHTML = '<div style="color:var(--muted);font-size:13px">ì•„ì§ ì›ì¹™ì´ ì—†ìŠµë‹ˆë‹¤. ì¶”ê°€í•´ë³´ì„¸ìš”!</div>'; return; }
  el.innerHTML = rules.map((r,i) => `
    <div style="display:flex;align-items:flex-start;gap:10px;padding:10px 0;border-bottom:1px solid var(--border)">
      <div style="background:var(--navy1);color:var(--accent);border-radius:6px;padding:3px 8px;font-family:'Roboto Mono',monospace;font-size:12px;font-weight:700;flex-shrink:0">${i+1}</div>
      <div style="flex:1">
        <div style="font-size:13px;font-weight:600">${r.text}</div>
        ${r.memo?`<div style="font-size:11px;color:var(--muted);margin-top:2px">${r.memo}</div>`:''}
      </div>
      <button class="btn btn-danger btn-xs" onclick="delRule(${i})">ğŸ—‘</button>
    </div>`).join('');
}

function addRule() {
  const text = prompt('ë§¤ë§¤ ì›ì¹™ì„ ì…ë ¥í•˜ì„¸ìš”:\nì˜ˆ) ì†ì ˆê°€ ì—†ì´ëŠ” ì ˆëŒ€ ì§„ì…í•˜ì§€ ì•ŠëŠ”ë‹¤');
  if (!text) return;
  const memo = prompt('ë³´ì¡° ì„¤ëª… (ì„ íƒì‚¬í•­, ì—†ìœ¼ë©´ ì—”í„°)') || '';
  rules.push({ text: text.trim(), memo: memo.trim(), date: td() });
  saveRules(); renderRulesList();
  showToast('âœ… ì›ì¹™ ì¶”ê°€ë¨');
}
function delRule(i) {
  if (!confirm('ì´ ì›ì¹™ì„ ì‚­ì œí• ê¹Œìš”?')) return;
  rules.splice(i,1); saveRules(); renderRulesList();
}

function renderViolations() {
  const el = document.getElementById('violations-list');
  if (!violations.length) { el.innerHTML = '<div style="color:var(--muted);font-size:13px">ìœ„ë°˜ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤ ğŸ‘</div>'; return; }
  el.innerHTML = violations.slice().reverse().map((v,i) => `
    <div style="padding:9px 0;border-bottom:1px solid var(--border)">
      <div style="display:flex;justify-content:space-between;margin-bottom:3px">
        <span style="font-size:12px;font-weight:600;color:var(--warn)">${v.rule}</span>
        <span style="font-size:11px;color:var(--muted)">${v.date}</span>
      </div>
      <div style="font-size:12px;color:var(--muted)">${v.note||''}</div>
    </div>`).join('') + `<button class="btn btn-primary btn-sm" style="margin-top:10px;width:100%" onclick="addViolation()">âš ï¸ ìœ„ë°˜ ê¸°ë¡ ì¶”ê°€</button>`;
}

function addViolation() {
  const rule = prompt('ì–´ë–¤ ì›ì¹™ì„ ìœ„ë°˜í–ˆë‚˜ìš”?');
  if (!rule) return;
  const note = prompt('ìƒí™© ì„¤ëª… (ì„ íƒì‚¬í•­)') || '';
  violations.push({ rule: rule.trim(), note: note.trim(), date: td() });
  saveRules(); renderViolations();
  showToast('ğŸ“ ìœ„ë°˜ ê¸°ë¡ë¨');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ğŸ¯ íˆ¬ì ëª©í‘œ ê´€ë¦¬ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function onGoalTypeChg() {
  const type = document.getElementById('g-type').value;
  const lbl = document.getElementById('g-val-lbl');
  const labels = { return:'ëª©í‘œê°’ (%)', amount:'ëª©í‘œ ê¸ˆì•¡ (ì›)', winrate:'ëª©í‘œ ìŠ¹ë¥  (%)', trades:'ëª©í‘œ ê±°ë˜ íšŸìˆ˜' };
  lbl.textContent = labels[type] || 'ëª©í‘œê°’';
}

function saveGoal() {
  const name = document.getElementById('g-name').value.trim();
  const type = document.getElementById('g-type').value;
  const value = parseFloat(document.getElementById('g-value').value);
  const deadline = document.getElementById('g-deadline').value;
  if (!name || isNaN(value)) { showToast('âš ï¸ ì´ë¦„ê³¼ ëª©í‘œê°’ì„ ì…ë ¥í•˜ì„¸ìš”'); return; }
  goals.push({ id: Date.now().toString(), name, type, value, deadline, memo: document.getElementById('g-memo').value.trim(), created: td(), done: false });
  cm('m-add-goal');
  saveGoalsStore();
  ['g-name','g-value','g-deadline','g-memo'].forEach(id => document.getElementById(id).value='');
  renderGoals();
  showToast('ğŸ¯ ëª©í‘œ ì €ì¥ë¨');
}

function getGoalProgress(g) {
  const closed = positions.filter(p => p.status==='closed');
  const allT = positions.flatMap(p => p.trades);
  switch(g.type) {
    case 'return': {
      const totalPnL = closed.reduce((s,p) => s+calcPos(p).realPnL, 0);
      const totalInv = closed.reduce((s,p) => s+calcPos(p).invested + calcPos(p).realPnL, 0) || 1;
      const ret = totalPnL / totalInv * 100;
      return { current: ret, unit:'%', label: ret.toFixed(2)+'%' };
    }
    case 'amount': {
      const pnl = closed.reduce((s,p) => s+calcPos(p).realPnL, 0);
      return { current: pnl, unit:'ì›', label: fmtN(pnl,'KRW') };
    }
    case 'winrate': {
      const wins = closed.filter(p=>calcPos(p).realPnL>0).length;
      const wr = closed.length ? wins/closed.length*100 : 0;
      return { current: wr, unit:'%', label: wr.toFixed(1)+'%' };
    }
    case 'trades': {
      return { current: allT.length, unit:'íšŒ', label: allT.length+'íšŒ' };
    }
    default: return { current: 0, unit:'', label: '0' };
  }
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ì´ë²¤íŠ¸ ê¸°ëŠ¥ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let _evtFilter = 'all';
let _editingEventId = null;

// í…Œë§ˆ í—¬í¼ í•¨ìˆ˜
function toggleThemeChip(btn) {
  btn.classList.toggle('active');
}

function setEventThemes(themes) {
  // ì¹© ì´ˆê¸°í™”
  document.querySelectorAll('.theme-chip').forEach(b => {
    b.classList.toggle('active', themes.includes(b.dataset.theme));
  });
  // ì§ì ‘ì…ë ¥: ë¯¸ë¦¬ì •ì˜ ëª©ë¡ì— ì—†ëŠ” ê²ƒë§Œ
  const presets = Array.from(document.querySelectorAll('.theme-chip')).map(b => b.dataset.theme);
  const custom = themes.filter(t => !presets.includes(t));
  document.getElementById('ev-theme-custom').value = custom.join(', ');
}

function getSelectedThemes() {
  const chips = Array.from(document.querySelectorAll('.theme-chip.active')).map(b => b.dataset.theme);
  const custom = document.getElementById('ev-theme-custom').value
    .split(',').map(s=>s.trim()).filter(Boolean);
  return [...new Set([...chips, ...custom])];
}

function getEventThemes(e) {
  return e.themes && e.themes.length ? e.themes : [];
}

const EVT_CAT = {
  earnings:    { label:'ì‹¤ì ë°œí‘œ', icon:'ğŸ“Š', color:'#3b82f6' },
  court:       { label:'ë²•ì›/ê·œì œ', icon:'âš–ï¸', color:'#ef4444' },
  disclosure:  { label:'ê³µì‹œ/ë°œí‘œ', icon:'ğŸ“¢', color:'#f59e0b' },
  macro:       { label:'ê±°ì‹œê²½ì œ', icon:'ğŸŒ', color:'#8b5cf6' },
  dividend:    { label:'ë°°ë‹¹',     icon:'ğŸ’°', color:'#10b981' },
  etc:         { label:'ê¸°íƒ€',     icon:'ğŸ“Œ', color:'#6b7280' },
};

function setEvtFilter(f) {
  _evtFilter = f;
  ['all','upcoming','past'].forEach(k => {
    const b = document.getElementById('ef-'+k);
    if (!b) return;
    if (k === f) { b.style.background='var(--accent)'; b.style.color='#fff'; b.style.border='none'; }
    else { b.style.background='var(--s2)'; b.style.color='var(--text)'; b.style.border='1px solid var(--border)'; }
  });
  renderEvents();
}

function getEffectiveEvents() {
  const today = td();
  let list = [];
  events.forEach(e => {
    list.push({...e});
    if (e.repeat === 'yearly') {
      const thisYear = today.slice(0,4);
      const nextYear = String(parseInt(thisYear)+1);
      [thisYear, nextYear].forEach(yr => {
        const d = yr + e.date.slice(4);
        if (d !== e.date) list.push({...e, id: e.id+'_'+yr, date: d, _virtual: true});
      });
    }
  });
  return list.sort((a,b) => a.date.localeCompare(b.date));
}

function dday(dateStr) {
  const today = new Date(); today.setHours(0,0,0,0);
  const ev = new Date(dateStr); ev.setHours(0,0,0,0);
  const diff = Math.round((ev - today) / 86400000);
  if (diff === 0) return { label: 'D-Day', color: '#ef4444' };
  if (diff > 0)  return { label: `D-${diff}`, color: diff <= 7 ? '#f59e0b' : '#3b82f6' };
  return { label: `D+${Math.abs(diff)}`, color: '#6b7280' };
}

function renderEvents() {
  const el = document.getElementById('events-list');
  if (!el) return;
  const today = td();
  let list = getEffectiveEvents();

  if (_evtFilter === 'upcoming') list = list.filter(e => e.date >= today);
  else if (_evtFilter === 'past') list = list.filter(e => e.date < today);

  if (!list.length) {
    el.innerHTML = `<div style="text-align:center;padding:48px 24px;color:var(--muted)">
      <div style="font-size:40px;margin-bottom:12px">ğŸ””</div>
      <div style="font-size:15px;font-weight:600;margin-bottom:6px;color:var(--text)">ë“±ë¡ëœ ì´ë²¤íŠ¸ê°€ ì—†ì–´ìš”</div>
      <div style="font-size:12px;margin-bottom:20px">ì‹¤ì ë°œí‘œ, ë²•ì› íŒê²°, FOMC ë“±<br>ì¤‘ìš”í•œ ë‚ ì§œë¥¼ ë¯¸ë¦¬ ë“±ë¡í•´ë‘ì„¸ìš”</div>
      <button class="btn btn-primary" onclick="openEventModal()">+ ì²« ì´ë²¤íŠ¸ ì¶”ê°€í•˜ê¸°</button>
    </div>`;
    return;
  }

  // ë‚ ì§œë³„ ê·¸ë£¹í™”
  const groups = {};
  list.forEach(e => {
    const ym = e.date.slice(0,7);
    if (!groups[ym]) groups[ym] = [];
    groups[ym].push(e);
  });

  el.innerHTML = Object.entries(groups).map(([ym, evts]) => {
    const [yr, mo] = ym.split('-');
    return `<div style="margin-bottom:20px">
      <div style="font-size:12px;font-weight:700;color:var(--muted);margin-bottom:8px;letter-spacing:1px">${yr}ë…„ ${parseInt(mo)}ì›”</div>
      ${evts.map(e => renderEventCard(e)).join('')}
    </div>`;
  }).join('');
}

function renderEventCard(e) {
  const cat = EVT_CAT[e.category] || EVT_CAT.etc;
  const dd = dday(e.date);
  const isVirtual = e._virtual;
  const stocks = e.stocks ? e.stocks.split(',').map(s=>s.trim()).filter(Boolean) : [];
  const themes = getEventThemes(e);

  // í…Œë§ˆ ìƒ‰ìƒ íŒ”ë ˆíŠ¸
  const themeColors = ['#6366f1','#8b5cf6','#ec4899','#f59e0b','#10b981','#3b82f6','#ef4444','#14b8a6','#f97316','#84cc16'];
  const themeHTML = themes.length ? `
    <div style="display:flex;gap:5px;flex-wrap:wrap;margin-bottom:8px">
      ${themes.map((t,i) => `<span style="font-size:11px;font-weight:700;padding:3px 10px;border-radius:20px;background:${themeColors[i%themeColors.length]}22;color:${themeColors[i%themeColors.length]};border:1.5px solid ${themeColors[i%themeColors.length]}44"># ${t}</span>`).join('')}
    </div>` : '';

  const isUrgent = dd.label === 'D-Day' || (dd.label.startsWith('D-') && parseInt(dd.label.slice(2)) <= 3);
  const borderStyle = isUrgent ? `border:2px solid ${dd.color};box-shadow:0 0 0 3px ${dd.color}22` : 'border:1.5px solid var(--border)';

  return `<div style="background:var(--surface);${borderStyle};border-radius:12px;padding:12px 14px;margin-bottom:8px">
    ${themeHTML}
    <div style="display:flex;gap:12px;align-items:flex-start">
      <div style="text-align:center;min-width:48px">
        <div style="font-size:20px">${cat.icon}</div>
        <div style="font-size:10px;color:var(--muted);margin-top:2px">${e.date.slice(5).replace('-','/')}</div>
      </div>
      <div style="flex:1;min-width:0">
        <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;margin-bottom:4px">
          <span style="font-weight:700;font-size:14px">${e.title}</span>
          <span style="font-size:10px;background:${cat.color}22;color:${cat.color};padding:2px 7px;border-radius:10px;font-weight:600">${cat.label}</span>
          ${e.repeat==='yearly' ? '<span style="font-size:10px;color:var(--muted);background:var(--s2);padding:2px 6px;border-radius:8px">ğŸ” ë§¤ë…„</span>' : ''}
        </div>
        ${stocks.length ? `<div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:4px">${stocks.map(s=>`<span style="font-size:10px;background:var(--s2);border:1px solid var(--border);padding:2px 6px;border-radius:6px">${s}</span>`).join('')}</div>` : ''}
        ${e.memo ? `<div style="font-size:12px;color:var(--muted);margin-top:2px">${e.memo}</div>` : ''}
      </div>
      <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px;min-width:52px">
        <span style="font-size:12px;font-weight:700;color:${dd.color}">${dd.label}</span>
        ${!isVirtual ? `<div style="display:flex;gap:4px">
          <button onclick="openEventModal('${e.id}')" style="font-size:10px;padding:3px 7px;border-radius:6px;background:var(--s2);border:1px solid var(--border);cursor:pointer;color:var(--text)">ìˆ˜ì •</button>
          <button onclick="deleteEvent('${e.id}')" style="font-size:10px;padding:3px 7px;border-radius:6px;background:var(--s2);border:1px solid var(--border);cursor:pointer;color:var(--loss)">ì‚­ì œ</button>
        </div>` : ''}
      </div>
    </div>
  </div>`;
}

function openEventModal(id) {
  _editingEventId = id || null;
  const titleEl = document.getElementById('event-modal-title');
  if (id) {
    const e = events.find(x => x.id === id);
    if (!e) return;
    titleEl.textContent = 'ğŸ”” ì´ë²¤íŠ¸ ìˆ˜ì •';
    document.getElementById('ev-title').value = e.title || '';
    document.getElementById('ev-date').value = e.date || '';
    document.getElementById('ev-category').value = e.category || 'etc';
    document.getElementById('ev-stocks').value = e.stocks || '';
    document.getElementById('ev-memo').value = e.memo || '';
    document.getElementById('ev-repeat').value = e.repeat || 'none';
    setEventThemes(e.themes || []);
  } else {
    titleEl.textContent = 'ğŸ”” ì´ë²¤íŠ¸ ì¶”ê°€';
    document.getElementById('ev-title').value = '';
    document.getElementById('ev-date').value = td();
    document.getElementById('ev-category').value = 'earnings';
    document.getElementById('ev-stocks').value = '';
    document.getElementById('ev-memo').value = '';
    document.getElementById('ev-repeat').value = 'none';
    setEventThemes([]);
  }
  om('m-event');
}

function saveEvent() {
  const title = document.getElementById('ev-title').value.trim();
  const date  = document.getElementById('ev-date').value;
  if (!title) { alert('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”'); return; }
  if (!date)  { alert('ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'); return; }

  const obj = {
    id:       _editingEventId || (Date.now().toString(36)+Math.random().toString(36).slice(2,5)),
    title,
    date,
    category: document.getElementById('ev-category').value,
    stocks:   document.getElementById('ev-stocks').value.trim(),
    memo:     document.getElementById('ev-memo').value.trim(),
    repeat:   document.getElementById('ev-repeat').value,
    themes:   getSelectedThemes(),
  };

  if (_editingEventId) {
    const idx = events.findIndex(e => e.id === _editingEventId);
    if (idx >= 0) events[idx] = obj;
  } else {
    events.push(obj);
  }
  saveEvents();
  cm('m-event');
  renderEvents();
  renderHome();
  showToast('âœ… ì´ë²¤íŠ¸ ì €ì¥ ì™„ë£Œ');
}

function deleteEvent(id) {
  if (!confirm('ì´ë²¤íŠ¸ë¥¼ ì‚­ì œí• ê¹Œìš”?')) return;
  events = events.filter(e => e.id !== id);
  saveEvents();
  renderEvents();
  renderHome();
  showToast('ğŸ—‘ ì´ë²¤íŠ¸ ì‚­ì œë¨');
}

function renderUpcomingEventsWidget() {
  const today = td();
  const upcoming = getEffectiveEvents()
    .filter(e => e.date >= today)
    .slice(0, 5);

  const body = !upcoming.length
    ? `<div style="text-align:center;padding:16px;color:var(--muted);font-size:13px">ë‹¤ê°€ì˜¤ëŠ” ì´ë²¤íŠ¸ ì—†ìŒ</div>`
    : upcoming.map(e => {
        const cat = EVT_CAT[e.category] || EVT_CAT.etc;
        const dd = dday(e.date);
        const urgentBorder = dd.label === 'D-Day' || (dd.label.startsWith('D-') && parseInt(dd.label.slice(2))<=3) ? `border:1.5px solid ${dd.color}` : 'border:1.5px solid var(--border)';
        return `<div style="display:flex;align-items:center;gap:10px;padding:8px 10px;background:var(--s2);border-radius:8px;${urgentBorder}">
          <span style="font-size:16px">${cat.icon}</span>
          <div style="flex:1;min-width:0">
            <div style="font-size:13px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${e.title}</div>
            <div style="font-size:11px;color:var(--muted)">${e.date}${e.stocks ? ' Â· '+e.stocks : ''}</div>
          </div>
          <span style="font-size:12px;font-weight:700;color:${dd.color};white-space:nowrap">${dd.label}</span>
        </div>`;
      }).join('');

  return `<div class="section">
    <div class="sec-hdr">
      <span class="sec-title">ğŸ”” ë‹¤ê°€ì˜¤ëŠ” ì´ë²¤íŠ¸</span>
      <button class="btn btn-outline btn-xs" onclick="switchTab('events')">ì „ì²´ë³´ê¸°</button>
    </div>
    <div style="padding:10px 14px;display:flex;flex-direction:column;gap:6px">
      ${body}
      <button class="btn btn-outline btn-sm" style="width:100%;margin-top:4px" onclick="openEventModal()">+ ì´ë²¤íŠ¸ ì¶”ê°€</button>
    </div>
  </div>`;
}

function renderGoals() {
  const closed = positions.filter(p => p.status === 'closed');
  const holding = positions.filter(p => p.status === 'holding');
  const active = goals.filter(g => !g.done);
  const done = goals.filter(g => g.done);
  const typeLabel = { return:'ìˆ˜ìµë¥ ', amount:'ìˆ˜ìµê¸ˆì•¡', winrate:'ìŠ¹ë¥ ', trades:'ê±°ë˜íšŸìˆ˜' };

  // â”€â”€ ì‹¤ì œ ëˆ„ì  ì†ìµ ê³„ì‚° â”€â”€
  const totalRealPnL = closed.reduce((s, p) => s + (p.currency !== 'USD' ? calcPos(p).realPnL : 0), 0);
  const totalUnrealPnL = holding.reduce((s, p) => s + (p.currency !== 'USD' ? calcPos(p).unrealPnL : 0), 0);
  const totalPnL = totalRealPnL + totalUnrealPnL;
  const wr = closed.length ? closed.filter(p => calcPos(p).realPnL > 0).length / closed.length * 100 : 0;
  const thisYear = new Date().getFullYear();
  const yearClosed = closed.filter(p => {
    const c = calcPos(p); return c.last && c.last.startsWith(thisYear);
  });
  const yearPnL = yearClosed.reduce((s, p) => s + (p.currency !== 'USD' ? calcPos(p).realPnL : 0), 0);

  // â”€â”€ 1. ë¡œë“œë§µ ë°°ë„ˆ â”€â”€
  const ROAD = [
    { year: 2025, target: 50000000,  label: '5ì²œë§Œì›' },
    { year: 2026, target: 100000000, label: '1ì–µ' },
    { year: 2027, target: 200000000, label: '2ì–µ' },
    { year: 2028, target: 500000000, label: '5ì–µ' },
    { year: 2029, target: 2000000000,label: '20ì–µ' },
    { year: 2030, target: 8000000000,label: '80ì–µ' },
  ];
  const nowYear = new Date().getFullYear();
  const roadHTML = ROAD.map((r, i) => {
    const isPast = r.year < nowYear;
    const isCur  = r.year === nowYear;
    const prog   = isCur ? Math.min(100, totalPnL / r.target * 100) : isPast ? 100 : 0;
    const col    = isPast ? 'var(--profit)' : isCur ? 'var(--accent)' : 'var(--muted)';
    const bg     = isPast ? 'rgba(224,49,49,.1)' : isCur ? 'rgba(29,111,242,.1)' : 'var(--s2)';
    const border = isCur ? '2px solid var(--accent)' : '1.5px solid var(--border)';
    return `<div style="flex:1;min-width:90px;background:${bg};border:${border};border-radius:10px;padding:10px 12px;text-align:center">
      <div style="font-size:11px;color:${col};font-weight:700">${r.year}ë…„</div>
      <div style="font-size:15px;font-weight:800;color:${col};margin:3px 0">${r.label}</div>
      ${isCur ? `<div style="background:var(--border);border-radius:3px;height:5px;margin:5px 0 2px;overflow:hidden"><div style="background:var(--accent);height:100%;width:${prog.toFixed(1)}%;border-radius:3px;transition:width .6s"></div></div><div style="font-size:10px;color:var(--accent)">${prog.toFixed(1)}%</div>` : isPast ? '<div style="font-size:14px">âœ…</div>' : '<div style="font-size:10px;color:var(--muted)">-</div>'}
    </div>`;
  }).join('<div style="display:flex;align-items:center;color:var(--muted);font-size:14px;padding:0 2px">â€º</div>');

  document.getElementById('goals-roadmap').innerHTML = `
    <div class="section">
      <div class="sec-hdr"><span class="sec-title">ğŸš€ 2030ë…„ 80ì–µ ë¡œë“œë§µ</span><span style="font-size:11px;color:var(--muted)">í˜„ì¬ ëˆ„ì  ì†ìµ ê¸°ì¤€</span></div>
      <div style="padding:14px 16px;display:flex;gap:6px;align-items:stretch;overflow-x:auto">${roadHTML}</div>
    </div>`;

  // â”€â”€ 2. í•µì‹¬ KPI â”€â”€
  document.getElementById('goals-kpi').innerHTML = `
    <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px">
      <div class="stat-card">
        <div class="stat-label">ì˜¬í•´ ì‹¤í˜„ì†ìµ (KRW)</div>
        <div class="stat-value ${yearPnL>=0?'profit':'loss'}">${yearPnL>=0?'+':''}â‚©${Math.round(yearPnL).toLocaleString()}</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">ëˆ„ì  ì‹¤í˜„+í‰ê°€ì†ìµ</div>
        <div class="stat-value ${totalPnL>=0?'profit':'loss'}">${totalPnL>=0?'+':''}â‚©${Math.round(totalPnL).toLocaleString()}</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">ìŠ¹ë¥  (ì²­ì‚° ê¸°ì¤€)</div>
        <div class="stat-value ${wr>=50?'profit':'loss'}">${wr.toFixed(1)}%</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">ì²­ì‚° í¬ì§€ì…˜ ìˆ˜</div>
        <div class="stat-value neutral">${closed.length}ê°œ</div>
      </div>
    </div>`;

  // â”€â”€ 3. ì§„í–‰ ì¤‘ ëª©í‘œ â”€â”€
  const activeEl = document.getElementById('goals-active');
  if (!active.length) {
    activeEl.innerHTML = '<div style="color:var(--muted);font-size:13px;padding:8px 0">+ ì¶”ê°€ ë²„íŠ¼ìœ¼ë¡œ ëª©í‘œë¥¼ ì„¤ì •í•´ë³´ì„¸ìš”!</div>';
  } else {
    activeEl.innerHTML = active.map(g => {
      const prog = getGoalProgress(g);
      const pct = Math.min(100, Math.max(0, prog.current / g.value * 100));
      const isOver = prog.current >= g.value;
      const daysLeft = g.deadline ? dBetween(td(), g.deadline) : null;
      const barCol = isOver ? 'var(--profit)' : pct > 70 ? 'var(--accent)' : pct > 40 ? 'var(--warn)' : 'var(--loss)';
      return `<div style="background:var(--s2);border-radius:10px;padding:13px 15px;margin-bottom:10px;border:1.5px solid ${isOver?'rgba(224,49,49,.3)':'var(--border)'}">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:6px">
          <div style="font-size:13px;font-weight:700">${g.name}</div>
          <div style="display:flex;gap:5px;align-items:center;flex-shrink:0;margin-left:8px">
            ${isOver?`<span style="background:rgba(224,49,49,.15);color:var(--profit);font-size:11px;padding:2px 8px;border-radius:4px;font-weight:700">ğŸ‰ ë‹¬ì„±!</span>`:''}
            ${daysLeft!==null?`<span style="font-size:11px;color:${daysLeft<7?'var(--loss)':daysLeft<30?'var(--warn)':'var(--muted)'}">D-${daysLeft<0?'ê¸°í•œì´ˆê³¼':daysLeft}</span>`:''}
          </div>
        </div>
        <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:5px">
          <span style="color:var(--muted)">${typeLabel[g.type]}</span>
          <span style="font-family:'Roboto Mono',monospace;font-weight:700;color:${barCol}">${prog.label} <span style="color:var(--muted);font-weight:400">/ ${g.type==='amount'?'â‚©'+Number(g.value).toLocaleString():g.value+(g.type==='trades'?'íšŒ':'%')}</span></span>
        </div>
        <div style="background:var(--border);border-radius:4px;height:8px;overflow:hidden;margin-bottom:7px">
          <div style="background:${barCol};height:100%;width:${pct}%;transition:width .5s;border-radius:4px"></div>
        </div>
        <div style="display:flex;align-items:center;justify-content:space-between">
          <span style="font-size:11px;color:${barCol};font-weight:600">${pct.toFixed(1)}% ë‹¬ì„±</span>
          <div style="display:flex;gap:5px">
            ${isOver?`<button class="btn btn-primary btn-xs" onclick="completeGoal('${g.id}')">ğŸ† ì™„ë£Œ</button>`:''}
            <button class="btn btn-danger btn-xs" onclick="deleteGoal('${g.id}')">ğŸ—‘</button>
          </div>
        </div>
        ${g.memo?`<div style="font-size:11px;color:var(--muted);margin-top:6px;padding-top:6px;border-top:1px solid var(--border)">${g.memo}</div>`:''}
      </div>`;
    }).join('');
  }

  // â”€â”€ 4. ë‹¬ì„± ì™„ë£Œ â”€â”€
  const doneEl = document.getElementById('goals-done');
  if (!done.length) {
    doneEl.innerHTML = '<div style="color:var(--muted);font-size:13px">ë‹¬ì„±í•œ ëª©í‘œê°€ ì—†ìŠµë‹ˆë‹¤</div>';
  } else {
    doneEl.innerHTML = done.map(g => `
      <div style="display:flex;align-items:center;gap:9px;padding:9px 0;border-bottom:1px solid var(--border)">
        <span style="font-size:18px">ğŸ†</span>
        <div style="flex:1"><div style="font-size:13px;font-weight:600">${g.name}</div>
        <div style="font-size:11px;color:var(--muted)">${g.doneDate||''}</div></div>
        <button class="btn btn-danger btn-xs" onclick="deleteGoal('${g.id}')">ğŸ—‘</button>
      </div>`).join('');
  }

  // â”€â”€ 5. ì—°ë„ë³„ ìš”ì•½ â”€â”€
  const summaryEl = document.getElementById('goals-summary');
  const yearGroups = {};
  goals.forEach(g => {
    const y = g.deadline ? g.deadline.slice(0,4) : 'ê¸°í•œì—†ìŒ';
    if (!yearGroups[y]) yearGroups[y] = { total:0, done:0 };
    yearGroups[y].total++;
    if (g.done) yearGroups[y].done++;
  });
  if (!goals.length) {
    summaryEl.innerHTML = '<div style="color:var(--muted);font-size:13px">ëª©í‘œë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”!</div>';
  } else {
    summaryEl.innerHTML = Object.entries(yearGroups).sort().map(([year, v]) => {
      const p = v.total ? v.done/v.total*100 : 0;
      return `<div style="margin-bottom:10px">
        <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px">
          <span style="font-weight:600">${year}ë…„</span>
          <span style="color:var(--muted)">${v.done}/${v.total} ë‹¬ì„±</span>
        </div>
        <div style="background:var(--border);border-radius:4px;height:7px;overflow:hidden">
          <div style="background:${p>=100?'var(--profit)':'var(--accent)'};height:100%;width:${p}%;border-radius:4px;transition:width .5s"></div>
        </div>
      </div>`;
    }).join('');
  }

  // â”€â”€ 6. ì‹¤ì‹œê°„ ì†ìµ í˜„í™© â”€â”€
  const rtEl = document.getElementById('goals-realtime');
  const usdClosed = closed.filter(p => p.currency === 'USD');
  const usdPnL = usdClosed.reduce((s, p) => s + calcPos(p).realPnL, 0);
  const usdUnreal = holding.filter(p => p.currency === 'USD').reduce((s,p) => s + calcPos(p).unrealPnL, 0);
  rtEl.innerHTML = `
    <div style="display:flex;flex-direction:column;gap:9px">
      <div style="display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:var(--s2);border-radius:8px;border:1.5px solid var(--border)">
        <span style="font-size:12px;color:var(--muted)">KRW ì‹¤í˜„ì†ìµ</span>
        <span style="font-family:'Roboto Mono',monospace;font-weight:700;color:${totalRealPnL>=0?'var(--profit)':'var(--loss)'}">${totalRealPnL>=0?'+':''}â‚©${Math.round(totalRealPnL).toLocaleString()}</span>
      </div>
      <div style="display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:var(--s2);border-radius:8px;border:1.5px solid var(--border)">
        <span style="font-size:12px;color:var(--muted)">KRW í‰ê°€ì†ìµ (ë³´ìœ ì¤‘)</span>
        <span style="font-family:'Roboto Mono',monospace;font-weight:700;color:${totalUnrealPnL>=0?'var(--profit)':'var(--loss)'}">${totalUnrealPnL>=0?'+':''}â‚©${Math.round(totalUnrealPnL).toLocaleString()}</span>
      </div>
      <div style="display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:var(--navy1);border-radius:8px;border:1.5px solid var(--accent)">
        <span style="font-size:12px;font-weight:700">KRW í•©ê³„</span>
        <span style="font-family:'Roboto Mono',monospace;font-weight:800;font-size:15px;color:${totalPnL>=0?'var(--profit)':'var(--loss)'}">${totalPnL>=0?'+':''}â‚©${Math.round(totalPnL).toLocaleString()}</span>
      </div>
      ${usdPnL||usdUnreal ? `<div style="display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:rgba(251,191,36,.08);border-radius:8px;border:1.5px solid rgba(251,191,36,.3)">
        <span style="font-size:12px;color:var(--warn)">USD ì†ìµ (ì‹¤í˜„+í‰ê°€)</span>
        <span style="font-family:'Roboto Mono',monospace;font-weight:700;color:var(--warn)">${(usdPnL+usdUnreal)>=0?'+':''}$${(usdPnL+usdUnreal).toFixed(2)}</span>
      </div>` : ''}
    </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ì¢…ëª© DB & ìë™ì™„ì„± â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const STOCK_DB = [["098120","ë§ˆì´í¬ë¡œì»¨í…ì†”","KRX"],["009520","í¬ìŠ¤ì½”ì— í…","KRX"],["095570","AJë„¤íŠ¸ì›ìŠ¤","KRX"],["006840","AKí™€ë”©ìŠ¤","KRX"],["282330","BGFë¦¬í…Œì¼","KRX"],["027410","BGF","KRX"],["138930","BNKê¸ˆìœµì§€ì£¼","KRX"],["001465","BYCìš°","KRX"],["001460","BYC","KRX"],["001045","CJìš°","KRX"],["00104K","CJ4ìš°(ì „í™˜)","KRX"],["001040","CJ","KRX"],["011155","CJì”¨í‘¸ë“œ1ìš°","KRX"],["011150","CJì”¨í‘¸ë“œ","KRX"],["058820","CMGì œì•½","KRX"],["000590","CSí™€ë”©ìŠ¤","KRX"],["012030","DB","KRX"],["005830","DBì†í•´ë³´í—˜","KRX"],["016610","DBì¦ê¶Œ","KRX"],["000990","DBí•˜ì´í…","KRX"],["001530","DIë™ì¼","KRX"],["000215","DLìš°","KRX"],["000210","DL","KRX"],["37550K","DLì´ì•¤ì”¨ìš°","KRX"],["37550L","DLì´ì•¤ì”¨2ìš°(ì „í™˜)","KRX"],["375500","DLì´ì•¤ì”¨","KRX"],["155660","DSR","KRX"],["069730","DSRì œê°•","KRX"],["017860","DSë‹¨ì„","KRX"],["017940","E1","KRX"],["365550","ESRì¼„ë‹¬ìŠ¤í€˜ì–´ë¦¬ì¸ ","KRX"],["050120","ESíë¸Œ","KRX"],["383220","F&F","KRX"],["007700","F&Fí™€ë”©ìŠ¤","KRX"],["078935","GSìš°","KRX"],["006360","GSê±´ì„¤","KRX"],["078930","GS","KRX"],["012630","HDC","KRX"],["294870","HDCí˜„ëŒ€ì‚°ì—…ê°œë°œ","KRX"],["097230","HJì¤‘ê³µì—…","KRX"],["014790","HL D&I","KRX"],["024850","HLBì´ë…¸ë² ì´ì…˜","KRX"],["204320","HLë§Œë„","KRX"],["060980","HLí™€ë”©ìŠ¤","KRX"],["035000","HSì• ë“œ","KRX"],["015360","INVENI","KRX"],["175330","JBê¸ˆìœµì§€ì£¼","KRX"],["234080","JWìƒëª…ê³¼í•™","KRX"],["001065","JWì¤‘ì™¸ì œì•½ìš°","KRX"],["001067","JWì¤‘ì™¸ì œì•½2ìš°B","KRX"],["001060","JWì¤‘ì™¸ì œì•½","KRX"],["096760","JWí™€ë”©ìŠ¤","KRX"],["105560","KBê¸ˆìœµ","KRX"],["432320","KBìŠ¤íƒ€ë¦¬ì¸ ","KRX"],["024120","KBì˜¤í† ì‹œìŠ¤","KRX"],["009070","KCTC","KRX"],["044180","KD","KRX"],["003620","KGëª¨ë¹Œë¦¬í‹°","KRX"],["016380","KGìŠ¤í‹¸","KRX"],["001390","KGì¼€ë¯¸ì¹¼","KRX"],["001940","KISCOí™€ë”©ìŠ¤","KRX"],["025000","KPXì¼€ë¯¸ì¹¼","KRX"],["092230","KPXí™€ë”©ìŠ¤","KRX"],["000040","KRëª¨í„°ìŠ¤","KRX"],["093050","LF","KRX"],["003555","LGìš°","KRX"],["034220","LGë””ìŠ¤í”Œë ˆì´","KRX"],["003550","LG","KRX"],["051905","LGìƒí™œê±´ê°•ìš°","KRX"],["051900","LGìƒí™œê±´ê°•","KRX"],["373220","LGì—ë„ˆì§€ì†”ë£¨ì…˜","KRX"],["032640","LGìœ í”ŒëŸ¬ìŠ¤","KRX"],["011070","LGì´ë…¸í…","KRX"],["066575","LGì „ììš°","KRX"],["066570","LGì „ì","KRX"],["051915","LGí™”í•™ìš°","KRX"],["051910","LGí™”í•™","KRX"],["079550","LIGë„¥ìŠ¤ì›","KRX"],["010120","LS ELECTRIC","KRX"],["000680","LSë„¤íŠ¸ì›ìŠ¤","KRX"],["006260","LS","KRX"],["229640","LSì—ì½”ì—ë„ˆì§€","KRX"],["108320","LXì„¸ë¯¸ì½˜","KRX"],["001120","LXì¸í„°ë‚´ì…”ë„","KRX"],["086960","MDSí…Œí¬","KRX"],["023150","MHì—íƒ„ì˜¬","KRX"],["035420","NAVER","KRX"],["181710","NHN","KRX"],["338100","NHí”„ë¼ì„ë¦¬ì¸ ","KRX"],["034310","NICE","KRX"],["063570","NICEì¸í”„ë¼","KRX"],["008260","NIìŠ¤í‹¸","KRX"],["004255","NPCìš°","KRX"],["004250","NPC","KRX"],["456040","OCI","KRX"],["010955","S-Oilìš°","KRX"],["010950","S-Oil","KRX"],["005090","SGCì—ë„ˆì§€","KRX"],["001380","SGê¸€ë¡œë²Œ","KRX"],["001770","SHD","KRX"],["002360","SHì—ë„ˆì§€í™”í•™","KRX"],["009160","SIMPAC","KRX"],["123700","SJM","KRX"],["025530","SJMí™€ë”©ìŠ¤","KRX"],["03473K","SKìš°","KRX"],["011790","SKC","KRX"],["018670","SKê°€ìŠ¤","KRX"],["001740","SKë„¤íŠ¸ì›ìŠ¤","KRX"],["210980","SKë””ì•¤ë””","KRX"],["395400","SKë¦¬ì¸ ","KRX"],["034730","SK","KRX"],["402340","SKìŠ¤í€˜ì–´","KRX"],["260870","SKì‹œê·¸ë„·","KRX"],["361610","SKì•„ì´ì´í…Œí¬ë†€ë¡œì§€","KRX"],["100090","SKì˜¤ì…˜í”ŒëœíŠ¸","KRX"],["096775","SKì´ë…¸ë² ì´ì…˜ìš°","KRX"],["096770","SKì´ë…¸ë² ì´ì…˜","KRX"],["001515","SKì¦ê¶Œìš°","KRX"],["001510","SKì¦ê¶Œ","KRX"],["28513K","SKì¼€ë¯¸ì¹¼ìš°","KRX"],["285130","SKì¼€ë¯¸ì¹¼","KRX"],["017670","SKí…”ë ˆì½¤","KRX"],["003570","SNTë‹¤ì´ë‚´ë¯¹ìŠ¤","KRX"],["064960","SNTëª¨í‹°ë¸Œ","KRX"],["100840","SNTì—ë„ˆì§€","KRX"],["036530","SNTí™€ë”©ìŠ¤","KRX"],["005610","SPCì‚¼ë¦½","KRX"],["465770","STXê·¸ë¦°ë¡œì§€ìŠ¤","KRX"],["011810","STX","KRX"],["077970","STXì—”ì§„","KRX"],["084870","TBHê¸€ë¡œë²Œ","KRX"],["002710","TCCìŠ¤í‹¸","KRX"],["024070","WISCOM","KRX"],["079940","ê°€ë¹„ì•„","KRX"],["078890","ê°€ì˜¨ê·¸ë£¹","KRX"],["000500","ê°€ì˜¨ì „ì„ ","KRX"],["399720","ê°€ì˜¨ì¹©ìŠ¤","KRX"],["296520","ê°€ì´ì•„ì½”í¼ë ˆì´ì…˜","KRX"],["036620","ê°ì„±ì½”í¼ë ˆì´ì…˜","KRX"],["000860","ê°•ë‚¨ì œë¹„ìŠ¤ì½”","KRX"],["198440","ê°•ë™ì”¨ì•¤ì—˜","KRX"],["217730","ê°•ìŠ¤í…œë°”ì´ì˜¤í…","KRX"],["035250","ê°•ì›ëœë“œ","KRX"],["114190","ê°•ì›ì—ë„ˆì§€","KRX"],["094480","ê°¤ëŸ­ì‹œì•„ë¨¸ë‹ˆíŠ¸ë¦¬","KRX"],["011420","ê°¤ëŸ­ì‹œì•„ì—ìŠ¤ì— ","KRX"],["039240","ê²½ë‚¨ìŠ¤í‹¸","KRX"],["053950","ê²½ë‚¨ì œì•½","KRX"],["002100","ê²½ë†","KRX"],["009450","ê²½ë™ë‚˜ë¹„ì—”","KRX"],["267290","ê²½ë™ë„ì‹œê°€ìŠ¤","KRX"],["012320","ê²½ë™ì¸ë² ìŠ¤íŠ¸","KRX"],["011040","ê²½ë™ì œì•½","KRX"],["000050","ê²½ë°©","KRX"],["214390","ê²½ë³´ì œì•½","KRX"],["012610","ê²½ì¸ì–‘í–‰","KRX"],["009140","ê²½ì¸ì „ì","KRX"],["024910","ê²½ì°½ì‚°ì—…","KRX"],["013580","ê³„ë£¡ê±´ì„¤","KRX"],["012205","ê³„ì–‘ì „ê¸°ìš°","KRX"],["012200","ê³„ì–‘ì „ê¸°","KRX"],["002140","ê³ ë ¤ì‚°ì—…","KRX"],["049720","ê³ ë ¤ì‹ ìš©ì •ë³´","KRX"],["010130","ê³ ë ¤ì•„ì—°","KRX"],["002240","ê³ ë ¤ì œê°•","KRX"],["014570","ê³ ë ¤ì œì•½","KRX"],["348150","ê³ ë°”ì´ì˜¤ë©","KRX"],["950190","ê³ ìŠ¤íŠ¸ìŠ¤íŠœë””ì˜¤","KRX"],["098460","ê³ ì˜","KRX"],["035290","ê³¨ë“œì•¤ì—ìŠ¤","KRX"],["215000","ê³¨í”„ì¡´","KRX"],["121440","ê³¨í”„ì¡´í™€ë”©ìŠ¤","KRX"],["366030","ê³µêµ¬ìš°ë¨¼","KRX"],["009290","ê´‘ë™ì œì•½","KRX"],["086220","ê´‘ë™í—¬ìŠ¤ë°”ì´ì˜¤","KRX"],["017040","ê´‘ëª…ì „ê¸°","KRX"],["029480","ê´‘ë¬´","KRX"],["017900","ê´‘ì „ì","KRX"],["037710","ê´‘ì£¼ì‹ ì„¸ê³„","KRX"],["026910","ê´‘ì§„ì‹¤ì—…","KRX"],["465320","êµë³´15í˜¸ìŠ¤íŒ©","KRX"],["482520","êµë³´16í˜¸ìŠ¤íŒ©","KRX"],["489210","êµë³´17í˜¸ìŠ¤íŒ©","KRX"],["0041B0","êµë³´18í˜¸ìŠ¤íŒ©","KRX"],["0098T0","êµë³´19í˜¸ìŠ¤íŒ©","KRX"],["030610","êµë³´ì¦ê¶Œ","KRX"],["339770","êµì´Œì—í”„ì•¤ë¹„","KRX"],["053270","êµ¬ì˜í…Œí¬","KRX"],["007690","êµ­ë„í™”í•™","KRX"],["066620","êµ­ë³´ë””ìì¸","KRX"],["043650","êµ­ìˆœë‹¹","KRX"],["006050","êµ­ì˜ì§€ì•¤ì— ","KRX"],["060480","êµ­ì¼ì‹ ë™","KRX"],["078130","êµ­ì¼ì œì§€","KRX"],["307750","êµ­ì „ì•½í’ˆ","KRX"],["002720","êµ­ì œì•½í’ˆ","KRX"],["035080","ê·¸ë˜ë””ì–¸íŠ¸","KRX"],["318060","ê·¸ë˜í”¼","KRX"],["114090","GKL","KRX"],["900290","GRT","KRX"],["453450","ê·¸ë¦¬ë“œìœ„ì¦ˆ","KRX"],["204020","ê·¸ë¦¬í‹°","KRX"],["0015G0","ê·¸ë¦°ê´‘í•™","KRX"],["402490","ê·¸ë¦°ë¦¬ì†ŒìŠ¤","KRX"],["114450","ê·¸ë¦°ìƒëª…ê³¼í•™","KRX"],["083420","ê·¸ë¦°ì¼€ë¯¸ì¹¼","KRX"],["186230","ê·¸ë¦°í”ŒëŸ¬ìŠ¤","KRX"],["014530","ê·¹ë™ìœ í™”","KRX"],["083450","GST","KRX"],["900070","ê¸€ë¡œë²Œì—ìŠ¤ì— ","KRX"],["204620","ê¸€ë¡œë²Œí…ìŠ¤í”„ë¦¬","KRX"],["019660","ê¸€ë¡œë³¸","KRX"],["014285","ê¸ˆê°•ê³µì—…ìš°","KRX"],["014280","ê¸ˆê°•ê³µì—…","KRX"],["053260","ê¸ˆê°•ì² ê°•","KRX"],["008870","ê¸ˆë¹„","KRX"],["282720","ê¸ˆì–‘ê·¸ë¦°íŒŒì›Œ","KRX"],["001570","ê¸ˆì–‘","KRX"],["002995","ê¸ˆí˜¸ê±´ì„¤ìš°","KRX"],["002990","ê¸ˆí˜¸ê±´ì„¤","KRX"],["011785","ê¸ˆí˜¸ì„ìœ í™”í•™ìš°","KRX"],["011780","ê¸ˆí˜¸ì„ìœ í™”í•™","KRX"],["214330","ê¸ˆí˜¸ì—ì´ì¹˜í‹°","KRX"],["001210","ê¸ˆí˜¸ì „ê¸°","KRX"],["073240","ê¸ˆí˜¸íƒ€ì´ì–´","KRX"],["036190","ê¸ˆí™”í”¼ì—ìŠ¤ì‹œ","KRX"],["049080","ê¸°ê°€ë ˆì¸","KRX"],["420770","ê¸°ê°€ë¹„ìŠ¤","KRX"],["035460","ê¸°ì‚°í…”ë ˆì½¤","KRX"],["092440","ê¸°ì‹ ì •ê¸°","KRX"],["000270","ê¸°ì•„","KRX"],["013700","ê¹Œë®¤ì´ì•¤ì”¨","KRX"],["004545","ê¹¨ë—í•œë‚˜ë¼ìš°","KRX"],["004540","ê¹¨ë—í•œë‚˜ë¼","KRX"],["407400","ê¿ˆë¹„","KRX"],["187790","ë‚˜ë…¸","KRX"],["121600","ë‚˜ë…¸ì‹ ì†Œì¬","KRX"],["286750","ë‚˜ë…¸ì‹¤ë¦¬ì¹¸ì²¨ë‹¨ì†Œì¬","KRX"],["247660","ë‚˜ë…¸ì”¨ì— ì—ìŠ¤","KRX"],["039860","ë‚˜ë…¸ì—”í…","KRX"],["091970","ë‚˜ë…¸ìº í…","KRX"],["417010","ë‚˜ë…¸íŒ€","KRX"],["244880","ë‚˜ëˆ”í…Œí¬","KRX"],["405920","ë‚˜ë¼ì…€ë¼","KRX"],["478340","ë‚˜ë¼ìŠ¤í˜ì´ìŠ¤í…Œí¬ë†€ë¡œì§€","KRX"],["051490","ë‚˜ë¼ì— ì•¤ë””","KRX"],["137080","ë‚˜ë˜ë‚˜ë…¸í…","KRX"],["190510","ë‚˜ë¬´ê°€","KRX"],["242040","ë‚˜ë¬´ê¸°ìˆ ","KRX"],["459510","ë‚˜ìš°ë¡œë³´í‹±ìŠ¤","KRX"],["293580","ë‚˜ìš°IB","KRX"],["257990","ë‚˜ìš°ì½”ìŠ¤","KRX"],["138610","ë‚˜ì´ë²¡","KRX"],["130580","ë‚˜ì´ìŠ¤ë””ì•¤ë¹„","KRX"],["036800","ë‚˜ì´ìŠ¤ì •ë³´í†µì‹ ","KRX"],["030190","NICEí‰ê°€ì •ë³´","KRX"],["267320","ë‚˜ì¸í…Œí¬","KRX"],["001260","ë‚¨ê´‘í† ê±´","KRX"],["008355","ë‚¨ì„ ì•Œë¯¸ìš°","KRX"],["008350","ë‚¨ì„ ì•Œë¯¸ëŠ„","KRX"],["004270","ë‚¨ì„±","KRX"],["003925","ë‚¨ì–‘ìœ ì—…ìš°","KRX"],["003920","ë‚¨ì–‘ìœ ì—…","KRX"],["025860","ë‚¨í•´í™”í•™","KRX"],["111710","ë‚¨í™”ì‚°ì—…","KRX"],["091590","ë‚¨í™”í† ê±´","KRX"],["168330","ë‚´ì¸„ëŸ´ì—”ë„í…","KRX"],["094860","ë„¤ì˜¤ë¦¬ì§„","KRX"],["253590","ë„¤ì˜¤ì…ˆ","KRX"],["212560","ë„¤ì˜¤ì˜¤í† ","KRX"],["095660","ë„¤ì˜¤ìœ„ì¦ˆ","KRX"],["042420","ë„¤ì˜¤ìœ„ì¦ˆí™€ë”©ìŠ¤","KRX"],["950220","ë„¤ì˜¤ì´ë®¨í…","KRX"],["311390","ë„¤ì˜¤í¬ë ˆë§ˆ","KRX"],["085910","ë„¤ì˜¤í‹°ìŠ¤","KRX"],["092730","ë„¤ì˜¤íŒœ","KRX"],["290660","ë„¤ì˜¤í™íŠ¸","KRX"],["153460","ë„¤ì´ë¸”","KRX"],["007390","ë„¤ì´ì²˜ì…€","KRX"],["033640","ë„¤íŒ¨ìŠ¤","KRX"],["330860","ë„¤íŒ¨ìŠ¤ì•„í¬","KRX"],["351320","ë„¥ì‚¬ë‹¤ì´ë‚´ë¯¹ìŠ¤","KRX"],["005725","ë„¥ì„¼ìš°","KRX"],["005720","ë„¥ì„¼","KRX"],["002355","ë„¥ì„¼íƒ€ì´ì–´1ìš°B","KRX"],["002350","ë„¥ì„¼íƒ€ì´ì–´","KRX"],["089140","ë„¥ìŠ¤í„´ì•¤ë¡¤ì½”ë¦¬ì•„","KRX"],["389650","ë„¥ìŠ¤íŠ¸ë°”ì´ì˜¤ë©”ë””ì»¬","KRX"],["137940","ë„¥ìŠ¤íŠ¸ì•„ì´","KRX"],["160550","NEW","KRX"],["396270","ë„¥ìŠ¤íŠ¸ì¹©","KRX"],["348210","ë„¥ìŠ¤í‹´","KRX"],["092790","ë„¥ìŠ¤í‹¸","KRX"],["225570","ë„¥ìŠ¨ê²Œì„ì¦ˆ","KRX"],["205500","ë„¥ì¨ì“°","KRX"],["217270","ë„µíŠ ","KRX"],["251270","ë„·ë§ˆë¸”","KRX"],["317860","ë…¸ë“œë©”ì´ìŠ¨","KRX"],["104620","ë…¸ë‘í’ì„ ","KRX"],["090355","ë…¸ë£¨í˜ì¸íŠ¸ìš°","KRX"],["090350","ë…¸ë£¨í˜ì¸íŠ¸","KRX"],["000325","ë…¸ë£¨í™€ë”©ìŠ¤ìš°","KRX"],["000320","ë…¸ë£¨í™€ë”©ìŠ¤","KRX"],["473980","ë…¸ë¨¸ìŠ¤","KRX"],["194700","ë…¸ë°”ë ‰ìŠ¤","KRX"],["285490","ë…¸ë°”í…","KRX"],["145170","ë…¸ë¸Œëœë“œ","KRX"],["229500","ë…¸ë¸Œë©”íƒ€íŒŒë§ˆ","KRX"],["106520","ë…¸ë¸”ì— ì•¤ë¹„","KRX"],["376930","ë…¸ì„","KRX"],["486990","ë…¸íƒ€","KRX"],["006280","ë…¹ì‹­ì","KRX"],["142280","ë…¹ì‹­ìì— ì—ìŠ¤","KRX"],["234690","ë…¹ì‹­ìì›°ë¹™","KRX"],["005257","ë…¹ì‹­ìí™€ë”©ìŠ¤2ìš°","KRX"],["005250","ë…¹ì‹­ìí™€ë”©ìŠ¤","KRX"],["004370","ë†ì‹¬","KRX"],["072710","ë†ì‹¬í™€ë”©ìŠ¤","KRX"],["154030","ì•„ì‹œì•„ì¢…ë¬˜","KRX"],["054050","ë†ìš°ë°”ì´ì˜¤","KRX"],["403490","ìš°ë“¬ì§€íŒœ","KRX"],["069140","ëˆ„ë¦¬í”Œëœ","KRX"],["040160","ëˆ„ë¦¬í”Œë ‰ìŠ¤","KRX"],["332290","ëˆ„ë³´","KRX"],["348340","ë‰´ë¡œë©”ì¹´","KRX"],["380550","ë‰´ë¡œí•","KRX"],["060260","ë‰´ë³´í…","KRX"],["463020","ë‰´ì—”AI","KRX"],["123840","ë‰´ì˜¨","KRX"],["012340","ë‰´ì¸í…","KRX"],["462310","ë‰´í‚¤ì¦ˆì˜¨","KRX"],["270870","ë‰´íŠ¸ë¦¬","KRX"],["144960","ë‰´íŒŒì›Œí”„ë¼ì¦ˆë§ˆ","KRX"],["085670","ë‰´í”„ë ‰ìŠ¤","KRX"],["064260","ë‹¤ë‚ ","KRX"],["340360","ë‹¤ë³´ë§í¬","KRX"],["039560","ë‹¤ì‚°ë„¤íŠ¸ì›ìŠ¤","KRX"],["208860","ë‹¤ì‚°ë””ì— ì”¨","KRX"],["154040","ë‹¤ì‚°ì†”ë£¨ì—íƒ€","KRX"],["058730","ë‹¤ìŠ¤ì½”","KRX"],["030210","ë‹¤ì˜¬íˆ¬ìì¦ê¶Œ","KRX"],["023590","ë‹¤ìš°ê¸°ìˆ ","KRX"],["032190","ë‹¤ìš°ë°ì´íƒ€","KRX"],["323350","ë‹¤ì›ë„¥ìŠ¤ë·°","KRX"],["068240","ë‹¤ì›ì‹œìŠ¤","KRX"],["145210","ë‹¤ì´ë‚˜ë¯¹ë””ìì¸","KRX"],["483650","ë‹¬ë°”ê¸€ë¡œë²Œ","KRX"],["464580","ë‹·ë°€","KRX"],["019680","ëŒ€êµ","KRX"],["019685","ëŒ€êµìš°B","KRX"],["006370","ëŒ€êµ¬ë°±í™”ì ","KRX"],["00806K","ëŒ€ë•1ìš°","KRX"],["008060","ëŒ€ë•","KRX"],["353200","ëŒ€ë•ì „ì","KRX"],["35320K","ëŒ€ë•ì „ì1ìš°","KRX"],["178600","ëŒ€ë™ê³ ë ¤ì‚¼","KRX"],["020400","ëŒ€ë™ê¸ˆì†","KRX"],["008830","ëŒ€ë™ê¸°ì–´","KRX"],["000490","ëŒ€ë™","KRX"],["048470","ëŒ€ë™ìŠ¤í‹¸","KRX"],["008110","ëŒ€ë™ì „ì","KRX"],["004780","ëŒ€ë¥™ì œê´€","KRX"],["005750","ëŒ€ë¦¼ë°”ìŠ¤","KRX"],["017650","ëŒ€ë¦¼ì œì§€","KRX"],["006570","ëŒ€ë¦¼í†µìƒ","KRX"],["389260","ëŒ€ëª…ì—ë„ˆì§€","KRX"],["317850","ëŒ€ëª¨","KRX"],["290670","ëŒ€ë³´ë§ˆê·¸ë„¤í‹±","KRX"],["078140","ëŒ€ë´‰ì—˜ì—ìŠ¤","KRX"],["065150","ëŒ€ì‚°F&B","KRX"],["001685","ëŒ€ìƒìš°","KRX"],["001680","ëŒ€ìƒ","KRX"],["084695","ëŒ€ìƒí™€ë”©ìŠ¤ìš°","KRX"],["084690","ëŒ€ìƒí™€ë”©ìŠ¤","KRX"],["036480","ëŒ€ì„±ë¯¸ìƒë¬¼","KRX"],["128820","ëŒ€ì„±ì‚°ì—…","KRX"],["117580","ëŒ€ì„±ì—ë„ˆì§€","KRX"],["027830","ëŒ€ì„±ì°½íˆ¬","KRX"],["104040","ëŒ€ì„±íŒŒì¸í…","KRX"],["129920","ëŒ€ì„±í•˜ì´í…","KRX"],["016710","ëŒ€ì„±í™€ë”©ìŠ¤","KRX"],["457630","ëŒ€ì‹ ë°¸ëŸ°ìŠ¤ì œ16í˜¸ìŠ¤íŒ©","KRX"],["471050","ëŒ€ì‹ ë°¸ëŸ°ìŠ¤ì œ17í˜¸ìŠ¤íŒ©","KRX"],["482690","ëŒ€ì‹ ë°¸ëŸ°ìŠ¤ì œ19í˜¸ìŠ¤íŒ©","KRX"],["0030R0","ëŒ€ì‹ ë°¸ë¥˜ë¦¬ì¸ ","KRX"],["020180","ëŒ€ì‹ ì •ë³´í†µì‹ ","KRX"],["003545","ëŒ€ì‹ ì¦ê¶Œìš°","KRX"],["003547","ëŒ€ì‹ ì¦ê¶Œ2ìš°B","KRX"],["003540","ëŒ€ì‹ ì¦ê¶Œ","KRX"],["045390","ëŒ€ì•„í‹°ì•„ì´","KRX"],["009190","ëŒ€ì–‘ê¸ˆì†","KRX"],["108380","ëŒ€ì–‘ì „ê¸°ê³µì—…","KRX"],["014160","ëŒ€ì˜í¬ì¥","KRX"],["047040","ëŒ€ìš°ê±´ì„¤","KRX"],["003090","ëŒ€ì›…","KRX"],["069620","ëŒ€ì›…ì œì•½","KRX"],["007680","ëŒ€ì›","KRX"],["000430","ëŒ€ì›ê°•ì—…","KRX"],["048910","ëŒ€ì›ë¯¸ë””ì–´","KRX"],["005710","ëŒ€ì›ì‚°ì—…","KRX"],["006345","ëŒ€ì›ì „ì„ ìš°","KRX"],["006340","ëŒ€ì›ì „ì„ ","KRX"],["003220","ëŒ€ì›ì œì•½","KRX"],["024890","ëŒ€ì›í™”ì„±","KRX"],["002880","ëŒ€ìœ ì—ì´í…","KRX"],["120240","ëŒ€ì •í™”ê¸ˆ","KRX"],["003310","ëŒ€ì£¼ì‚°ì—…","KRX"],["114920","ëŒ€ì£¼ì´ì—”í‹°","KRX"],["078600","ëŒ€ì£¼ì „ìì¬ë£Œ","KRX"],["393970","ëŒ€ì§„ì²¨ë‹¨ì†Œì¬","KRX"],["015230","ëŒ€ì°½ë‹¨ì¡°","KRX"],["012800","ëŒ€ì°½","KRX"],["096350","ëŒ€ì°½ì†”ë£¨ì…˜","KRX"],["140520","ëŒ€ì°½ìŠ¤í‹¸","KRX"],["131220","ëŒ€í•œê³¼í•™","KRX"],["010170","ëŒ€í•œê´‘í†µì‹ ","KRX"],["054670","ëŒ€í•œë‰´íŒœ","KRX"],["001070","ëŒ€í•œë°©ì§","KRX"],["023910","ëŒ€í•œì•½í’ˆ","KRX"],["006650","ëŒ€í•œìœ í™”","KRX"],["001440","ëŒ€í•œì „ì„ ","KRX"],["084010","ëŒ€í•œì œê°•","KRX"],["001795","ëŒ€í•œì œë‹¹ìš°","KRX"],["001790","ëŒ€í•œì œë‹¹","KRX"],["001130","ëŒ€í•œì œë¶„","KRX"],["439260","ëŒ€í•œì¡°ì„ ","KRX"],["003495","ëŒ€í•œí•­ê³µìš°","KRX"],["003490","ëŒ€í•œí•­ê³µ","KRX"],["005880","ëŒ€í•œí•´ìš´","KRX"],["003830","ëŒ€í•œí™”ì„¬","KRX"],["016090","ëŒ€í˜„","KRX"],["069460","ëŒ€í˜¸ì—ì´ì—˜","KRX"],["021040","ëŒ€í˜¸íŠ¹ìˆ˜ê°•","KRX"],["021045","ëŒ€í˜¸íŠ¹ìˆ˜ê°•ìš°","KRX"],["067080","ëŒ€í™”ì œì•½","KRX"],["043090","ë”í…Œí¬ë†€ë¡œì§€","KRX"],["298540","ë”ë„¤ì´ì³í™€ë”©ìŠ¤","KRX"],["032860","ë”ë¼ë¯¸","KRX"],["475560","ë”ë³¸ì½”ë¦¬ì•„","KRX"],["192080","ë”ë¸”ìœ ê²Œì„ì¦ˆ","KRX"],["393890","ë”ë¸”ìœ ì”¨í”¼","KRX"],["299170","ë”ë¸”ìœ ì—ìŠ¤ì•„ì´","KRX"],["089230","THE E&M","KRX"],["012510","ë”ì¡´ë¹„ì¦ˆì˜¨","KRX"],["462860","ë”ì¦Œ","KRX"],["224060","ë”ì½”ë””","KRX"],["302920","ë”ì½˜í…ì¸ ì˜¨","KRX"],["013720","THE CUBE&","KRX"],["403850","ë”í•‘í¬íì»´í¼ë‹ˆ","KRX"],["213420","ë•ì‚°ë„¤ì˜¤ë£©ìŠ¤","KRX"],["317330","ë•ì‚°í…Œì½”í”¼ì•„","KRX"],["077360","ë•ì‚°í•˜ì´ë©”íƒˆ","KRX"],["004835","ë•ì„±ìš°","KRX"],["004830","ë•ì„±","KRX"],["090410","ë•ì‹ ì´í”¼ì”¨","KRX"],["0001A0","ë•ì–‘ì—ë„ˆì  ","KRX"],["263600","ë•ìš°ì „ì","KRX"],["194480","ë°ë¸Œì‹œìŠ¤í„°ì¦ˆ","KRX"],["373160","ë°ì´ì›ì»´í¼ë‹ˆ","KRX"],["263800","ë°ì´íƒ€ì†”ë£¨ì…˜","KRX"],["199150","ë°ì´í„°ìŠ¤íŠ¸ë¦¼ì¦ˆ","KRX"],["206560","ë±ìŠ¤í„°","KRX"],["261200","ë´í‹°ìŠ¤","KRX"],["145720","ë´í‹°ì›€","KRX"],["227420","ë„ë¶€","KRX"],["484120","ë„ìš°ì¸ì‹œìŠ¤","KRX"],["067990","ë„ì´ì¹˜ëª¨í„°ìŠ¤","KRX"],["002150","ë„í™”ì—”ì§€ë‹ˆì–´ë§","KRX"],["006620","ë™êµ¬ë°”ì´ì˜¤ì œì•½","KRX"],["005160","ë™êµ­ì‚°ì—…","KRX"],["303810","ë™êµ­ìƒëª…ê³¼í•™","KRX"],["460850","ë™êµ­ì”¨ì— ","KRX"],["075970","ë™êµ­ì•Œì•¤ì—ìŠ¤","KRX"],["100130","ë™êµ­S&C","KRX"],["460860","ë™êµ­ì œê°•","KRX"],["086450","ë™êµ­ì œì•½","KRX"],["001230","ë™êµ­í™€ë”©ìŠ¤","KRX"],["240550","ë™ë°©ë©”ë””ì»¬","KRX"],["004140","ë™ë°©","KRX"],["099410","ë™ë°©ì„ ê¸°","KRX"],["007590","ë™ë°©ì•„ê·¸ë¡œ","KRX"],["005965","ë™ë¶€ê±´ì„¤ìš°","KRX"],["005960","ë™ë¶€ê±´ì„¤","KRX"],["026960","ë™ì„œ","KRX"],["002210","ë™ì„±ì œì•½","KRX"],["102260","ë™ì„±ì¼€ë¯¸ì»¬","KRX"],["033500","ë™ì„±í™”ì¸í…","KRX"],["025950","ë™ì‹ ê±´ì„¤","KRX"],["000640","ë™ì•„ì˜ì‹œì˜¤í™€ë”©ìŠ¤","KRX"],["170900","ë™ì•„ì—ìŠ¤í‹°","KRX"],["088130","ë™ì•„ì—˜í…","KRX"],["028100","ë™ì•„ì§€ì§ˆ","KRX"],["041930","ë™ì•„í™”ì„±","KRX"],["001525","ë™ì–‘ìš°","KRX"],["001527","ë™ì–‘2ìš°B","KRX"],["084670","ë™ì–‘ê³ ì†","KRX"],["001520","ë™ì–‘","KRX"],["082640","ë™ì–‘ìƒëª…","KRX"],["060380","ë™ì–‘ì—ìŠ¤í…","KRX"],["079960","ë™ì–‘ì´ì—”í”¼","KRX"],["228340","ë™ì–‘íŒŒì¼","KRX"],["088910","ë™ìš°íŒœíˆ¬í…Œì´ë¸”","KRX"],["094170","ë™ìš´ì•„ë‚˜í…","KRX"],["013120","ë™ì›ê°œë°œ","KRX"],["018500","ë™ì›ê¸ˆì†","KRX"],["006040","ë™ì›ì‚°ì—…","KRX"],["030720","ë™ì›ìˆ˜ì‚°","KRX"],["014825","ë™ì›ì‹œìŠ¤í…œì¦ˆìš°","KRX"],["014820","ë™ì›ì‹œìŠ¤í…œì¦ˆ","KRX"],["111380","ë™ì¸ê¸°ì—°","KRX"],["163560","ë™ì¼ê³ ë¬´ë²¨íŠ¸","KRX"],["109860","ë™ì¼ê¸ˆì†","KRX"],["032960","ë™ì¼ê¸°ì—°","KRX"],["004890","ë™ì¼ì‚°ì—…","KRX"],["023790","ë™ì¼ìŠ¤í‹¸ëŸ­ìŠ¤","KRX"],["002690","ë™ì¼ì œê°•","KRX"],["005290","ë™ì§„ì„ë¯¸ì¼","KRX"],["025900","ë™í™”ê¸°ì—…","KRX"],["000020","ë™í™”ì•½í’ˆ","KRX"],["000155","ë‘ì‚°ìš°","KRX"],["000157","ë‘ì‚°2ìš°B","KRX"],["454910","ë‘ì‚°ë¡œë³´í‹±ìŠ¤","KRX"],["241560","ë‘ì‚°ë°¥ìº£","KRX"],["000150","ë‘ì‚°","KRX"],["034020","ë‘ì‚°ì—ë„ˆë¹Œë¦¬í‹°","KRX"],["131970","ë‘ì‚°í…ŒìŠ¤ë‚˜","KRX"],["33626K","ë‘ì‚°í“¨ì–¼ì…€1ìš°","KRX"],["33626L","ë‘ì‚°í“¨ì–¼ì…€2ìš°B","KRX"],["336260","ë‘ì‚°í“¨ì–¼ì…€","KRX"],["016740","ë‘ì˜¬","KRX"],["073190","ë“€ì˜¤ë°±","KRX"],["176750","ë“€ì¼ë°”ì´ì˜¤","KRX"],["030350","ë“œë˜ê³¤í”Œë¼ì´","KRX"],["203650","ë“œë¦¼ì‹œíë¦¬í‹°","KRX"],["223250","ë“œë¦¼ì”¨ì•„ì´ì—ìŠ¤","KRX"],["060570","ë“œë¦¼ì–´ìŠ¤ì»´í¼ë‹ˆ","KRX"],["362990","ë“œë¦¼ì¸ì‚¬ì´íŠ¸","KRX"],["192650","ë“œë¦¼í…","KRX"],["016670","ë””ëª¨ì•„","KRX"],["187870","ë””ë°”ì´ìŠ¤","KRX"],["477760","DBê¸ˆìœµìŠ¤íŒ©12í˜¸","KRX"],["489730","ë””ë¹„ê¸ˆìœµì œ13í˜¸ìŠ¤íŒ©","KRX"],["0004Y0","ë””ë¹„ê¸ˆìœµì œ14í˜¸ìŠ¤íŒ©","KRX"],["024090","ë””ì”¨ì— ","KRX"],["003160","ë””ì•„ì´","KRX"],["092200","ë””ì•„ì´ì”¨","KRX"],["110990","ë””ì•„ì´í‹°","KRX"],["004840","DRBë™ì¼","KRX"],["263690","ë””ì•Œì ¬","KRX"],["214680","ë””ì•Œí…","KRX"],["347850","ë””ì•¤ë””íŒŒë§ˆí…","KRX"],["377190","ë””ì•¤ë””í”Œë«í¼ë¦¬ì¸ ","KRX"],["263720","ë””ì•¤ì”¨ë¯¸ë””ì–´","KRX"],["376300","ë””ì–´ìœ ","KRX"],["241520","DSCì¸ë² ìŠ¤íŠ¸ë¨¼íŠ¸","KRX"],["109740","ë””ì—ìŠ¤ì¼€ì´","KRX"],["031860","ë””ì—ì´ì¹˜ì—‘ìŠ¤ì»´í¼ë‹ˆ","KRX"],["000300","DHì˜¤í† ë„¥ìŠ¤","KRX"],["290120","DHì˜¤í† ë¦¬ë“œ","KRX"],["025440","DHì˜¤í† ì›¨ì–´","KRX"],["196490","ë””ì—ì´í…Œí¬ë†€ë¡œì§€","KRX"],["066900","ë””ì—ì´í”¼","KRX"],["180400","DXVX","KRX"],["092070","ë””ì—”ì—í”„","KRX"],["007340","DNì˜¤í† ëª¨í‹°ë¸Œ","KRX"],["068790","DMS","KRX"],["039840","ë””ì˜¤","KRX"],["024900","ë””ì™€ì´ë•ì–‘","KRX"],["219550","ë””ì™€ì´ë””","KRX"],["013570","ë””ì™€ì´","KRX"],["310870","ë””ì™€ì´ì”¨","KRX"],["210540","ë””ì™€ì´íŒŒì›Œ","KRX"],["092780","DYP","KRX"],["104460","ë””ì™€ì´í”¼ì—”ì—í”„","KRX"],["079810","ë””ì´ì—”í‹°","KRX"],["113810","ë””ì  ìŠ¤","KRX"],["043360","ë””ì§€ì•„ì´","KRX"],["099520","DGI","KRX"],["197140","ë””ì§€ìº¡","KRX"],["068930","ë””ì§€í„¸ëŒ€ì„±","KRX"],["033130","ë””ì§€í‹€ì¡°ì„ ","KRX"],["105740","ë””ì¼€ì´ë½","KRX"],["263020","ë””ì¼€ì´ì•¤ë””","KRX"],["015590","DKME","KRX"],["290550","ë””ì¼€ì´í‹°","KRX"],["066670","ë””í‹°ì”¨","KRX"],["187220","ë””í‹°ì•¤ì”¨","KRX"],["383930","ë””í‹°ì•¤ì”¨ì•Œì˜¤","KRX"],["131180","ë”œë¦¬","KRX"],["315640","ë”¥ë…¸ì´ë“œ","KRX"],["317120","ë¼ë‹‰ìŠ¤","KRX"],["462510","ë¼ë©”ë””í…","KRX"],["232680","ë¼ì˜¨ë¡œë³´í‹±ìŠ¤","KRX"],["042510","ë¼ì˜¨ì‹œíì–´","KRX"],["418420","ë¼ì˜¨í…","KRX"],["300120","ë¼ì˜¨í”¼í”Œ","KRX"],["171120","ë¼ì´ì˜¨ì¼í…","KRX"],["388790","ë¼ì´ì½¤","KRX"],["214260","ë¼íŒŒìŠ¤","KRX"],["403360","ë¼í”¼ì¹˜","KRX"],["171010","ë¨í…Œí¬ë†€ëŸ¬ì§€","KRX"],["084650","ë©ì§€ë…¸ë¯¹ìŠ¤","KRX"],["217500","ëŸ¬ì…€","KRX"],["092590","ëŸ­ìŠ¤í”¼ì•„","KRX"],["266170","ë ˆë“œìš°ì¦ˆ","KRX"],["038390","ë ˆë“œìº¡íˆ¬ì–´","KRX"],["294140","ë ˆëª¬","KRX"],["443250","ë ˆë·°ì½”í¼ë ˆì´ì…˜","KRX"],["228670","ë ˆì´","KRX"],["228850","ë ˆì´ì–¸ìŠ¤","KRX"],["412350","ë ˆì´ì €ìŒ","KRX"],["199550","ë ˆì´ì €ì˜µí…","KRX"],["281740","ë ˆì´í¬ë¨¸í‹°ë¦¬ì–¼ì¦ˆ","KRX"],["277810","ë ˆì¸ë³´ìš°ë¡œë³´í‹±ìŠ¤","KRX"],["215100","ë¡œë³´ë¡œë³´","KRX"],["090360","ë¡œë³´ìŠ¤íƒ€","KRX"],["238500","ë¡œë³´ì“°ë¦¬ì—ì´ì•„ì´","KRX"],["108490","ë¡œë³´í‹°ì¦ˆ","KRX"],["900260","ë¡œìŠ¤ì›°","KRX"],["033290","ë¡œì  ","KRX"],["223220","ë¡œì§€ìŠ¤ëª¬","KRX"],["067730","ë¡œì§€ì‹œìŠ¤","KRX"],["071280","ë¡œì²´ì‹œìŠ¤í…œì¦ˆ","KRX"],["376900","ë¡œí‚·í—¬ìŠ¤ì¼€ì–´","KRX"],["214610","ë¡¤ë§ìŠ¤í†¤","KRX"],["032350","ë¡¯ë°ê´€ê´‘ê°œë°œ","KRX"],["089860","ë¡¯ë°ë Œíƒˆ","KRX"],["330590","ë¡¯ë°ë¦¬ì¸ ","KRX"],["000400","ë¡¯ë°ì†í•´ë³´í—˜","KRX"],["023530","ë¡¯ë°ì‡¼í•‘","KRX"],["020150","ë¡¯ë°ì—ë„ˆì§€ë¨¸í‹°ë¦¬ì–¼ì¦ˆ","KRX"],["280360","ë¡¯ë°ì›°í‘¸ë“œ","KRX"],["286940","ë¡¯ë°ì´ë…¸ë² ì´íŠ¸","KRX"],["004000","ë¡¯ë°ì •ë°€í™”í•™","KRX"],["00499K","ë¡¯ë°ì§€ì£¼ìš°","KRX"],["004990","ë¡¯ë°ì§€ì£¼","KRX"],["005305","ë¡¯ë°ì¹ ì„±ìš°","KRX"],["005300","ë¡¯ë°ì¹ ì„±","KRX"],["011170","ë¡¯ë°ì¼€ë¯¸ì¹¼","KRX"],["071840","ë¡¯ë°í•˜ì´ë§ˆíŠ¸","KRX"],["328130","ë£¨ë‹›","KRX"],["038060","ë£¨ë©˜ìŠ¤","KRX"],["474170","ë£¨ë¯¸ë¥´","KRX"],["162120","ë£¨ì¼„í…Œí¬ë†€ëŸ¬ì§€ìŠ¤","KRX"],["253610","ë£¨íŠ¸ë½","KRX"],["141080","ë¦¬ê°€ì¼ë°”ì´ì˜¤","KRX"],["058470","ë¦¬ë…¸ê³µì—…","KRX"],["016100","ë¦¬ë”ìŠ¤ì½”ìŠ¤ë©”í‹±","KRX"],["012700","ë¦¬ë“œì½”í”„","KRX"],["302550","ë¦¬ë©”ë“œ","KRX"],["491000","ë¦¬ë¸ŒìŠ¤ë©”ë“œ","KRX"],["073570","ë¦¬íŠ¬í¬ì–´ìŠ¤","KRX"],["377450","ë¦¬íŒŒì¸","KRX"],["277070","ë¦°ë“œë¨¼ì•„ì‹œì•„","KRX"],["042500","ë§ë„¤íŠ¸","KRX"],["193250","ë§í¬ë“œ","KRX"],["474650","ë§í¬ì†”ë£¨ì…˜","KRX"],["219420","ë§í¬ì œë‹ˆì‹œìŠ¤","KRX"],["439090","ë§ˆë…€ê³µì¥","KRX"],["027740","ë§ˆë‹ˆì»¤","KRX"],["195500","ë§ˆë‹ˆì»¤ì—í”„ì•¤ì§€","KRX"],["357430","ë§ˆìŠ¤í„´í”„ë¦¬ë¯¸ì–´ë¦¬ì¸ ","KRX"],["377480","ë§ˆìŒAI","KRX"],["305090","ë§ˆì´í¬ë¡œë””ì§€íƒˆ","KRX"],["448780","ë§ˆì´í¬ë¡œì—”ì—‘ìŠ¤","KRX"],["424980","ë§ˆì´í¬ë¡œíˆ¬ë‚˜ë…¸","KRX"],["169330","ì— ë¸Œë ˆì¸","KRX"],["038290","ë§ˆí¬ë¡œì  ","KRX"],["001080","ë§Œí˜¸ì œê°•","KRX"],["267980","ë§¤ì¼ìœ ì—…","KRX"],["005990","ë§¤ì¼í™€ë”©ìŠ¤","KRX"],["093520","ë§¤ì»¤ìŠ¤","KRX"],["088980","ë§¥ì¿¼ë¦¬ì¸í”„ë¼","KRX"],["179720","ë¨¸ë‹ˆë¬´ë¸Œ","KRX"],["100590","ë¨¸íë¦¬","KRX"],["067280","ë©€í‹°ìº í¼ìŠ¤","KRX"],["072870","ë©”ê°€ìŠ¤í„°ë””","KRX"],["215200","ë©”ê°€ìŠ¤í„°ë””êµìœ¡","KRX"],["133750","ë©”ê°€ì— ë””","KRX"],["446540","ë©”ê°€í„°ì¹˜","KRX"],["235980","ë©”ë“œíŒ©í† ","KRX"],["200580","ë©”ë””ì„ì´","KRX"],["041920","ë©”ë””ì•„ë‚˜","KRX"],["233250","ë©”ë””ì•ˆë””ë…¸ìŠ¤í‹±","KRX"],["014100","ë©”ë””ì•™ìŠ¤","KRX"],["236340","ë©”ë””ì  íœ´ë¨¼ì¼€ì–´","KRX"],["054180","ë©”ë””ì½•ìŠ¤","KRX"],["086900","ë©”ë””í†¡ìŠ¤","KRX"],["078160","ë©”ë””í¬ìŠ¤íŠ¸","KRX"],["138040","ë©”ë¦¬ì¸ ê¸ˆìœµì§€ì£¼","KRX"],["0088D0","ë©”ë¦¬ì¸ ì œ1í˜¸ìŠ¤íŒ©","KRX"],["408920","ë©”ì„ì´ìƒ","KRX"],["021880","ë©”ì´ìŠ¨ìºí”¼íƒˆ","KRX"],["140410","ë©”ì§€ì˜¨","KRX"],["241770","ë©”ì¹´ë¡œ","KRX"],["090370","ë©”íƒ€ë©ìŠ¤","KRX"],["059210","ë©”íƒ€ë°”ì´ì˜¤ë©”ë“œ","KRX"],["118000","ë©”íƒ€ì¼€ì–´","KRX"],["058110","ë©•ì•„ì´ì”¨ì—ìŠ¤","KRX"],["072770","ë©¤ë ˆì´ë¹„í‹°","KRX"],["017180","ëª…ë¬¸ì œì•½","KRX"],["009900","ëª…ì‹ ì‚°ì—…","KRX"],["317450","ëª…ì¸ì œì•½","KRX"],["012690","ëª¨ë‚˜ë¦¬ì","KRX"],["005360","ëª¨ë‚˜ë¯¸","KRX"],["070960","ëª¨ë‚˜ìš©í‰","KRX"],["434480","ëª¨ë‹ˆí„°ë©","KRX"],["080420","ëª¨ë‹¤ì´ë…¸ì¹©","KRX"],["417970","ëª¨ë¸ì†”ë£¨ì…˜","KRX"],["080160","ëª¨ë‘íˆ¬ì–´","KRX"],["087260","ëª¨ë°”ì¼ì–´í”Œë¼ì´ì–¸ìŠ¤","KRX"],["101330","ëª¨ë² ì´ìŠ¤","KRX"],["012860","ëª¨ë² ì´ìŠ¤ì „ì","KRX"],["363260","ëª¨ë¹„ë°ì´ì¦ˆ","KRX"],["348030","ëª¨ë¹„ë¦­ìŠ¤","KRX"],["250060","ëª¨ë¹„ìŠ¤","KRX"],["288980","ëª¨ì•„ë°ì´íƒ€","KRX"],["142760","ëª¨ì•„ë¼ì´í”„í”ŒëŸ¬ìŠ¤","KRX"],["033200","ëª¨ì•„í…","KRX"],["333050","ëª¨ì½”ì— ì‹œìŠ¤","KRX"],["009680","ëª¨í† ë‹‰","KRX"],["118990","ëª¨íŠ¸ë ‰ìŠ¤","KRX"],["463480","ëª¨í‹°ë¸Œë§í¬","KRX"],["006920","ëª¨í—¨ì¦ˆ","KRX"],["001810","ë¬´ë¦¼SP","KRX"],["009200","ë¬´ë¦¼í˜ì´í¼","KRX"],["009580","ë¬´ë¦¼P&P","KRX"],["322970","ë¬´ì§„ë©”ë””","KRX"],["033920","ë¬´í•™","KRX"],["008420","ë¬¸ë°°ì² ê°•","KRX"],["279600","ë¯¸ë””ì–´ì  ","KRX"],["095500","ë¯¸ë˜ë‚˜ë…¸í…","KRX"],["254490","ë¯¸ë˜ë°˜ë„ì²´","KRX"],["025560","ë¯¸ë˜ì‚°ì—…","KRX"],["218150","ë¯¸ë˜ìƒëª…ìì›","KRX"],["007120","ë¯¸ë˜ì•„ì´ì•¤ì§€","KRX"],["396690","ë¯¸ë˜ì—ì…‹ê¸€ë¡œë²Œë¦¬ì¸ ","KRX"],["094800","ë§µìŠ¤ë¦¬ì–¼í‹°","KRX"],["357250","ë¯¸ë˜ì—ì…‹ë§µìŠ¤ë¦¬ì¸ ","KRX"],["100790","ë¯¸ë˜ì—ì…‹ë²¤ì²˜íˆ¬ì","KRX"],["0097F0","ë¯¸ë˜ì—ì…‹ë¹„ì „ìŠ¤íŒ©10í˜¸","KRX"],["0099W0","ë¯¸ë˜ì—ì…‹ë¹„ì „ìŠ¤íŒ©11í˜¸","KRX"],["477380","ë¯¸ë˜ì—ì…‹ë¹„ì „ìŠ¤íŒ©4í˜¸","KRX"],["477470","ë¯¸ë˜ì—ì…‹ë¹„ì „ìŠ¤íŒ©5í˜¸","KRX"],["478440","ë¯¸ë˜ì—ì…‹ë¹„ì „ìŠ¤íŒ©6í˜¸","KRX"],["482680","ë¯¸ë˜ì—ì…‹ë¹„ì „ìŠ¤íŒ©7í˜¸","KRX"],["0093G0","ë¯¸ë˜ì—ì…‹ë¹„ì „ìŠ¤íŒ©8í˜¸","KRX"],["0096D0","ë¯¸ë˜ì—ì…‹ë¹„ì „ìŠ¤íŒ©9í˜¸","KRX"],["085620","ë¯¸ë˜ì—ì…‹ìƒëª…","KRX"],["006805","ë¯¸ë˜ì—ì…‹ì¦ê¶Œìš°","KRX"],["00680K","ë¯¸ë˜ì—ì…‹ì¦ê¶Œ2ìš°B","KRX"],["006800","ë¯¸ë˜ì—ì…‹ì¦ê¶Œ","KRX"],["208890","ë¯¸ë˜ì—”ì—ë“€íŒŒíŠ¸ë„ˆ","KRX"],["049950","ë¯¸ë˜ì»´í¼ë‹ˆ","KRX"],["207760","ë¯¸ìŠ¤í„°ë¸”ë£¨","KRX"],["081660","ë¯¸ìŠ¤í† í™€ë”©ìŠ¤","KRX"],["002840","ë¯¸ì›ìƒì‚¬","KRX"],["268280","ë¯¸ì›ì—ìŠ¤ì”¨","KRX"],["107590","ë¯¸ì›í™€ë”©ìŠ¤","KRX"],["134380","ë¯¸ì›í™”í•™","KRX"],["351020","ë¯¸ì¥¬","KRX"],["003650","ë¯¸ì°½ì„ìœ ","KRX"],["059090","ë¯¸ì½”","KRX"],["201490","ë¯¸íˆ¬ì˜¨","KRX"],["475460","ë¯¸íŠ¸ë°•ìŠ¤","KRX"],["452200","ë¯¼í…Œí¬","KRX"],["206640","ë°”ë””í…ë©”ë“œ","KRX"],["018700","ë°”ë¥¸ì†","KRX"],["035620","ë°”ë¥¸ì†ì´ì•¤ì—ì´","KRX"],["354390","ë°”ìŠ¤ì¹¸ë°”ì´ì˜¤ì œì•½","KRX"],["053030","ë°”ì´ë„¥ìŠ¤","KRX"],["301300","ë°”ì´ë¸Œì»´í¼ë‹ˆ","KRX"],["377740","ë°”ì´ì˜¤ë…¸íŠ¸","KRX"],["064550","ë°”ì´ì˜¤ë‹ˆì•„","KRX"],["314930","ë°”ì´ì˜¤ë‹¤ì¸","KRX"],["489460","ë°”ì´ì˜¤ë¹„ì¥¬","KRX"],["086820","ë°”ì´ì˜¤ì†”ë£¨ì…˜","KRX"],["038460","ë°”ì´ì˜¤ìŠ¤ë§ˆíŠ¸","KRX"],["251120","ë°”ì´ì˜¤ì—í”„ë””ì—”ì”¨","KRX"],["199730","ë°”ì´ì˜¤ì¸í”„ë¼","KRX"],["266470","ë°”ì´ì˜¤ì¸í”„ë¼ìƒëª…ê³¼í•™","KRX"],["289170","ë°”ì´ì˜¤í…","KRX"],["086040","ë°”ì´ì˜¤í†¡ìŠ¤í…","KRX"],["188040","ë°”ì´ì˜¤í¬íŠ¸","KRX"],["199290","ë°”ì´ì˜¤í”„ë¡œí…Œí¬","KRX"],["099430","ë°”ì´ì˜¤í”ŒëŸ¬ìŠ¤","KRX"],["032980","ë°”ì´ì˜¨","KRX"],["308080","ë°”ì´ì  ì…€","KRX"],["043150","ë°”í…","KRX"],["323990","ë°•ì…€ë°”ì´ì˜¤","KRX"],["003610","ë°©ë¦¼","KRX"],["267790","ë°°ëŸ´","KRX"],["046310","ë°±ê¸ˆT&A","KRX"],["035150","ë°±ì‚°","KRX"],["331520","ë°¸ë¡œí”„","KRX"],["199480","ë±…í¬ì›¨ì–´ê¸€ë¡œë²Œ","KRX"],["438700","ë²„ë„¥íŠ¸","KRX"],["066410","ë²„í‚·ìŠ¤íŠœë””ì˜¤","KRX"],["002410","ë²”ì–‘ê±´ì˜","KRX"],["382900","ë²”í•œí“¨ì–¼ì…€","KRX"],["206400","ë² ë…¸í‹°ì•¤ì•Œ","KRX"],["019010","ë² ë‰´ì§€","KRX"],["177350","ë² ì…€","KRX"],["457600","ë²¡íŠ¸","KRX"],["424760","ë²¨ë¡œí¬","KRX"],["007210","ë²½ì‚°","KRX"],["250000","ë³´ë¼í‹°ì•Œ","KRX"],["002760","ë³´ë½","KRX"],["003850","ë³´ë ¹","KRX"],["310210","ë³´ë¡œë…¸ì´","KRX"],["006910","ë³´ì„±íŒŒì›Œí…","KRX"],["000890","ë³´í•´ì–‘ì¡°","KRX"],["226340","ë³¸ëŠ","KRX"],["496320","ë³¸ì‹œìŠ¤í…œì¦ˆ","KRX"],["206950","ë³¼ë¹…","KRX"],["008470","ë¶€ìŠ¤íƒ€","KRX"],["003000","ë¶€ê´‘ì•½í’ˆ","KRX"],["001275","ë¶€êµ­ì¦ê¶Œìš°","KRX"],["001270","ë¶€êµ­ì¦ê¶Œ","KRX"],["026940","ë¶€êµ­ì² ê°•","KRX"],["014470","ë¶€ë°©","KRX"],["011390","ë¶€ì‚°ì‚°ì—…","KRX"],["005030","ë¶€ì‚°ì£¼ê³µ","KRX"],["338220","ë·°ë…¸","KRX"],["100120","ë·°ì›ìŠ¤","KRX"],["406820","ë·°í‹°ìŠ¤í‚¨","KRX"],["099390","ë¸Œë ˆì¸ì¦ˆì»´í¼ë‹ˆ","KRX"],["064480","ë¸Œë¦¬ì§€í…","KRX"],["365900","ë¸Œì´ì”¨","KRX"],["089970","ë¸Œì´ì— ","KRX"],["251630","ë¸Œì´ì›í…","KRX"],["018290","ë¸Œì´í‹°","KRX"],["478560","ë¸”ë™ì•¼í¬ì•„ì´ì•¤ì”¨","KRX"],["006740","ë¸”ë£¨ì‚°ì—…ê°œë°œ","KRX"],["439580","ë¸”ë£¨ì— í…","KRX"],["033560","ë¸”ë£¨ì½¤","KRX"],["191600","ë¸”ë£¨íƒ‘","KRX"],["369370","ë¸”ë¦¬ì¸ ì›¨ì´ì—”í„°í…Œì¸ë¨¼íŠ¸","KRX"],["126340","ë¹„ë‚˜í…","KRX"],["121800","ë¹„ë´íŠ¸","KRX"],["082800","ë¹„ë³´ì¡´ ì œì•½","KRX"],["318410","ë¹„ë¹„ì”¨","KRX"],["002070","ë¹„ë¹„ì•ˆ","KRX"],["100220","ë¹„ìƒêµìœ¡","KRX"],["419540","ë¹„ìŠ¤í† ìŠ¤","KRX"],["146320","ë¹„ì”¨ì—”ì”¨","KRX"],["200780","ë¹„ì”¨ì›”ë“œì œì•½","KRX"],["413640","ë¹„ì•„ì´ë§¤íŠ¸ë¦­ìŠ¤","KRX"],["141000","ë¹„ì•„íŠ¸ë¡ ","KRX"],["090460","ë¹„ì—ì´ì¹˜","KRX"],["083650","ë¹„ì—ì´ì¹˜ì•„ì´","KRX"],["139050","BFë©ìŠ¤","KRX"],["473370","ë¹„ì—”ì¼€ì´ì œ2í˜¸ìŠ¤íŒ©","KRX"],["0068Y0","ë¹„ì—”ì¼€ì´ì œ3í˜¸ìŠ¤íŒ©","KRX"],["065170","ë¹„ì—˜íŒœí…","KRX"],["086670","ë¹„ì— í‹°","KRX"],["230980","ë¹„ìœ í…Œí¬ë†€ëŸ¬ì§€","KRX"],["126600","BGFì—ì½”ë¨¸í‹°ë¦¬ì–¼ì¦ˆ","KRX"],["488900","ë¹„ì¸ ë¡œë„¥ìŠ¤í…","KRX"],["082920","ë¹„ì¸ ë¡œì…€","KRX"],["054220","ë¹„ì¸ ë¡œì‹œìŠ¤","KRX"],["042370","ë¹„ì¸ ë¡œí…Œí¬","KRX"],["050090","ë¹„ì¼€ì´í™€ë”©ìŠ¤","KRX"],["148780","ë¹„íAI","KRX"],["307870","ë¹„íˆ¬ì—”","KRX"],["377030","ë¹„íŠ¸ë§¥ìŠ¤","KRX"],["032850","ë¹„íŠ¸ì»´í“¨í„°","KRX"],["049470","ë¹„íŠ¸í”Œë˜ë‹›","KRX"],["238200","ë¹„í”¼ë„","KRX"],["093190","ë¹…ì†”ë¡ ","KRX"],["065450","ë¹…í…","KRX"],["044480","ë¹Œë¦¬ì–¸ìŠ¤","KRX"],["005180","ë¹™ê·¸ë ˆ","KRX"],["069540","ë¹›ê³¼ì „ì","KRX"],["072950","ë¹›ìƒ˜ì „ì","KRX"],["451250","ì‚ì•„","KRX"],["143240","ì‚¬ëŒì¸","KRX"],["466410","ì‚¬ì´ëƒ…ì†Œí”„íŠ¸","KRX"],["003960","ì‚¬ì¡°ëŒ€ë¦¼","KRX"],["008040","ì‚¬ì¡°ë™ì•„ì›","KRX"],["007160","ì‚¬ì¡°ì‚°ì—…","KRX"],["014710","ì‚¬ì¡°ì”¨í‘¸ë“œ","KRX"],["006090","ì‚¬ì¡°ì˜¤ì–‘","KRX"],["223310","ì‚¬í† ì‹œí™€ë”©ìŠ¤","KRX"],["452430","ì‚¬í”¼ì—”ë°˜ë„ì²´","KRX"],["419120","ì‚°ëŒ","KRX"],["062040","ì‚°ì¼ì „ê¸°","KRX"],["122350","ì‚¼ê¸°","KRX"],["419050","ì‚¼ê¸°ì—ë„ˆì§€ì†”ë£¨ì…˜ì¦ˆ","KRX"],["014970","ì‚¼ë¥­ë¬¼ì‚°","KRX"],["018310","ì‚¼ëª©ì—ìŠ¤í¼","KRX"],["012210","ì‚¼ë¯¸ê¸ˆì†","KRX"],["053700","ì‚¼ë³´ëª¨í„°ìŠ¤","KRX"],["009620","ì‚¼ë³´ì‚°ì—…","KRX"],["023600","ì‚¼ë³´íŒì§€","KRX"],["001470","ì‚¼ë¶€í† ê±´","KRX"],["028050","ì‚¼ì„±E&A","KRX"],["448730","ì‚¼ì„±FNë¦¬ì¸ ","KRX"],["006405","ì‚¼ì„±SDIìš°","KRX"],["006400","ì‚¼ì„±SDI","KRX"],["006660","ì‚¼ì„±ê³µì¡°","KRX"],["0044K0","ì‚¼ì„±ìŠ¤íŒ©10í˜¸","KRX"],["0071M0","ì‚¼ì„±ìŠ¤íŒ©11í˜¸","KRX"],["0096B0","ì‚¼ì„±ìŠ¤íŒ©12í˜¸","KRX"],["0115H0","ì‚¼ì„±ìŠ¤íŒ©13í˜¸","KRX"],["02826K","ì‚¼ì„±ë¬¼ì‚°ìš°B","KRX"],["028260","ì‚¼ì„±ë¬¼ì‚°","KRX"],["207940","ì‚¼ì„±ë°”ì´ì˜¤ë¡œì§ìŠ¤","KRX"],["032830","ì‚¼ì„±ìƒëª…","KRX"],["018260","ì‚¼ì„±ì—ìŠ¤ë””ì—ìŠ¤","KRX"],["0126Z0","ì‚¼ì„±ì—í”¼ìŠ¤í™€ë”©ìŠ¤","KRX"],["009155","ì‚¼ì„±ì „ê¸°ìš°","KRX"],["009150","ì‚¼ì„±ì „ê¸°","KRX"],["005935","ì‚¼ì„±ì „ììš°","KRX"],["005930","ì‚¼ì„±ì „ì","KRX"],["001360","ì‚¼ì„±ì œì•½","KRX"],["010140","ì‚¼ì„±ì¤‘ê³µì—…","KRX"],["016360","ì‚¼ì„±ì¦ê¶Œ","KRX"],["068290","ì‚¼ì„±ì¶œíŒì‚¬","KRX"],["029780","ì‚¼ì„±ì¹´ë“œ","KRX"],["000815","ì‚¼ì„±í™”ì¬ìš°","KRX"],["000810","ì‚¼ì„±í™”ì¬","KRX"],["006110","ì‚¼ì•„ì•Œë¯¸ëŠ„","KRX"],["009300","ì‚¼ì•„ì œì•½","KRX"],["0120G0","ì‚¼ì–‘ë°”ì´ì˜¤íŒœ","KRX"],["145995","ì‚¼ì–‘ì‚¬ìš°","KRX"],["145990","ì‚¼ì–‘ì‚¬","KRX"],["003230","ì‚¼ì–‘ì‹í’ˆ","KRX"],["482630","ì‚¼ì–‘ì—”ì”¨ì¼","KRX"],["484590","ì‚¼ì–‘ì»´í…","KRX"],["036670","ì‚¼ì–‘ì¼€ì´ì”¨ì•„ì´","KRX"],["002170","ì‚¼ì–‘í†µìƒ","KRX"],["272550","ì‚¼ì–‘íŒ¨í‚¤ì§•","KRX"],["000070","ì‚¼ì–‘í™€ë”©ìŠ¤","KRX"],["060310","3S","KRX"],["002810","ì‚¼ì˜ë¬´ì—­","KRX"],["003720","ì‚¼ì˜","KRX"],["361670","ì‚¼ì˜ì—ìŠ¤ì•¤ì”¨","KRX"],["054540","ì‚¼ì˜ì— í…","KRX"],["065570","ì‚¼ì˜ì´ì—”ì”¨","KRX"],["005680","ì‚¼ì˜ì „ì","KRX"],["023000","ì‚¼ì›ê°•ì¬","KRX"],["004380","ì‚¼ìµTHK","KRX"],["002450","ì‚¼ìµì•…ê¸°","KRX"],["014950","ì‚¼ìµì œì•½","KRX"],["032280","ì‚¼ì¼","KRX"],["002290","ì‚¼ì¼ê¸°ì—…ê³µì‚¬","KRX"],["004440","ì‚¼ì¼ì”¨ì—”ì—ìŠ¤","KRX"],["000520","ì‚¼ì¼ì œì•½","KRX"],["009770","ì‚¼ì •í„í”„","KRX"],["037460","ì‚¼ì§€ì „ì","KRX"],["032750","ì‚¼ì§„","KRX"],["0013V0","ì‚¼ì§„ì‹í’ˆ","KRX"],["054090","ì‚¼ì§„ì—˜ì•¤ë””","KRX"],["005500","ì‚¼ì§„ì œì•½","KRX"],["000250","ì‚¼ì²œë‹¹ì œì•½","KRX"],["004690","ì‚¼ì²œë¦¬","KRX"],["024950","ì‚¼ì²œë¦¬ìì „ê±°","KRX"],["038500","ì‚¼í‘œì‹œë©˜íŠ¸","KRX"],["437730","ì‚¼í˜„","KRX"],["017480","ì‚¼í˜„ì² ê°•","KRX"],["010960","ì‚¼í˜¸ê°œë°œ","KRX"],["046390","ì‚¼í™”ë„¤íŠ¸ì›ìŠ¤","KRX"],["004450","ì‚¼í™”ì™•ê´€","KRX"],["009470","ì‚¼í™”ì „ê¸°","KRX"],["011230","ì‚¼í™”ì „ì","KRX"],["001820","ì‚¼í™”ì½˜ë´ì„œ","KRX"],["000390","ì‚¼í™”í˜ì¸íŠ¸","KRX"],["027580","ìƒë³´","KRX"],["038540","ìƒìƒì¸","KRX"],["452670","ìƒìƒì¸ì œ4í˜¸ìŠ¤íŒ©","KRX"],["001290","ìƒìƒì¸ì¦ê¶Œ","KRX"],["041650","ìƒì‹ ë¸Œë ˆì´í¬","KRX"],["091580","ìƒì‹ ì´ë””í”¼","KRX"],["263810","ìƒì‹ ì „ì","KRX"],["089980","ìƒì•„í”„ë¡ í…Œí¬","KRX"],["042940","ìƒì§€ê±´ì„¤","KRX"],["042600","ìƒˆë¡œë‹‰ìŠ¤","KRX"],["075180","ìƒˆë¡ ì˜¤í† ëª¨í‹°ë¸Œ","KRX"],["107600","ìƒˆë¹—ì¼","KRX"],["411080","ìƒŒì¦ˆë©","KRX"],["252990","ìƒ˜ì”¨ì—”ì—ìŠ¤","KRX"],["007540","ìƒ˜í‘œ","KRX"],["248170","ìƒ˜í‘œì‹í’ˆ","KRX"],["378800","ìƒ¤í˜ë¡ ","KRX"],["294630","ì„œë‚¨","KRX"],["038070","ì„œë¦°ë°”ì´ì˜¤","KRX"],["006730","ì„œë¶€T&D","KRX"],["079650","ì„œì‚°","KRX"],["100660","ì„œì•”ê¸°ê³„ê³µì—…","KRX"],["007860","ì„œì—°","KRX"],["200880","ì„œì—°ì´í™”","KRX"],["019770","ì„œì—°íƒ‘ë©”íƒˆ","KRX"],["017390","ì„œìš¸ê°€ìŠ¤","KRX"],["043710","ì„œìš¸ë¦¬ê±°","KRX"],["092190","ì„œìš¸ë°”ì´ì˜¤ì‹œìŠ¤","KRX"],["046890","ì„œìš¸ë°˜ë„ì²´","KRX"],["031210","ì„œìš¸ë³´ì¦ë³´í—˜","KRX"],["004415","ì„œìš¸ì‹í’ˆìš°","KRX"],["004410","ì„œìš¸ì‹í’ˆ","KRX"],["063170","ì„œìš¸ì˜¥ì…˜","KRX"],["027040","ì„œìš¸ì „ìí†µì‹ ","KRX"],["018680","ì„œìš¸ì œì•½","KRX"],["036120","ì„œìš¸í‰ê°€ì •ë³´","KRX"],["021050","ì„œì›","KRX"],["093920","ì„œì›ì¸í…","KRX"],["189860","ì„œì „ê¸°ì „","KRX"],["178320","ì„œì§„ì‹œìŠ¤í…œ","KRX"],["122690","ì„œì§„ì˜¤í† ëª¨í‹°ë¸Œ","KRX"],["140070","ì„œí”ŒëŸ¬ìŠ¤ê¸€ë¡œë²Œ","KRX"],["011370","ì„œí•œ","KRX"],["065710","ì„œí˜¸ì „ê¸°","KRX"],["008490","ì„œí¥","KRX"],["035890","ì„œí¬ê±´ì„¤","KRX"],["357550","ì„ê²½ì—ì´í‹°","KRX"],["003100","ì„ ê´‘","KRX"],["007610","ì„ ë„ì „ê¸°","KRX"],["067370","ì„ ë°”ì´ì˜¤","KRX"],["217620","ì„ ìƒ¤ì¸í‘¸ë“œ","KRX"],["002820","SUN&L","KRX"],["171090","ì„ ìµì‹œìŠ¤í…œ","KRX"],["136490","ì„ ì§„","KRX"],["086710","ì„ ì§„ë·°í‹°ì‚¬ì´ì–¸ìŠ¤","KRX"],["014620","ì„±ê´‘ë²¤ë“œ","KRX"],["037350","ì„±ë„ì´ì—”ì§€","KRX"],["014915","ì„±ë¬¸ì „ììš°","KRX"],["014910","ì„±ë¬¸ì „ì","KRX"],["004985","ì„±ì‹ ì–‘íšŒìš°","KRX"],["004980","ì„±ì‹ ì–‘íšŒ","KRX"],["011300","ì„±ì•ˆë¨¸í‹°ë¦¬ì–¼ìŠ¤","KRX"],["458650","ì„±ìš°","KRX"],["081580","ì„±ìš°ì „ì","KRX"],["045300","ì„±ìš°í…Œí¬ë¡ ","KRX"],["015750","ì„±ìš°í•˜ì´í…","KRX"],["365340","ì„±ì¼í•˜ì´í…","KRX"],["000180","ì„±ì°½ê¸°ì—…ì§€ì£¼","KRX"],["080470","ì„±ì°½ì˜¤í† í…","KRX"],["043260","ì„±í˜¸ì „ì","KRX"],["148150","ì„¸ê²½í•˜ì´í…Œí¬","KRX"],["002420","ì„¸ê¸°ìƒì‚¬","KRX"],["061090","ì„¸ë‚˜í…Œí¬ë†€ë¡œì§€","KRX"],["188260","ì„¸ë‹ˆì  ","KRX"],["053060","ì„¸ë™","KRX"],["340440","ì„¸ë¦¼B&G","KRX"],["017510","ì„¸ëª…ì „ê¸°","KRX"],["490470","ì„¸ë¯¸íŒŒì´ë¸Œ","KRX"],["004365","ì„¸ë°©ìš°","KRX"],["004360","ì„¸ë°©","KRX"],["004490","ì„¸ë°©ì „ì§€","KRX"],["011560","ì„¸ë³´ì— ì´ì”¨","KRX"],["267080","ì„¸ë¸ë¸Œë¡œì´ë§¥ì£¼","KRX"],["396300","ì„¸ì•„ë©”ì¹´ë‹‰ìŠ¤","KRX"],["001430","ì„¸ì•„ë² ìŠ¤í‹¸ì§€ì£¼","KRX"],["306200","ì„¸ì•„ì œê°•","KRX"],["003030","ì„¸ì•„ì œê°•ì§€ì£¼","KRX"],["058650","ì„¸ì•„í™€ë”©ìŠ¤","KRX"],["013000","ì„¸ìš°ê¸€ë¡œë²Œ","KRX"],["100700","ì„¸ìš´ë©”ë””ì¹¼","KRX"],["024830","ì„¸ì›ë¬¼ì‚°","KRX"],["021820","ì„¸ì›ì •ê³µ","KRX"],["067830","ì„¸ì´ë¸Œì¡´I&C","KRX"],["258830","ì„¸ì¢…ë©”ë””ì¹¼","KRX"],["036630","ì„¸ì¢…í…”ë ˆì½¤","KRX"],["039310","ì„¸ì¤‘","KRX"],["075580","ì„¸ì§„ì¤‘ê³µì—…","KRX"],["067770","ì„¸ì§„í‹°ì—ìŠ¤","KRX"],["053450","ì„¸ì½”ë‹‰ìŠ¤","KRX"],["222810","ì„¸í† í”¼ì•„","KRX"],["252500","ì„¸í™”í”¼ì•¤ì”¨","KRX"],["321370","ì„¼ì„œë·°","KRX"],["347000","ì„¼ì½”","KRX"],["331920","ì…€ë ˆë¯¹ìŠ¤","KRX"],["352770","ì…€ë ˆìŠ¤íŠ¸ë¼","KRX"],["471820","ì…€ë¡œë§¥ìŠ¤ì‚¬ì´ì–¸ìŠ¤","KRX"],["049180","ì…€ë£¨ë©”ë“œ","KRX"],["299660","ì…€ë¦¬ë“œ","KRX"],["108860","ì…€ë°”ìŠ¤AI","KRX"],["208370","ì…€ë°”ìŠ¤í—¬ìŠ¤ì¼€ì–´","KRX"],["318160","ì…€ë°”ì´ì˜¤íœ´ë¨¼í…","KRX"],["308430","ì…€ë¹„ì˜¨","KRX"],["068270","ì…€íŠ¸ë¦¬ì˜¨","KRX"],["068760","ì…€íŠ¸ë¦¬ì˜¨ì œì•½","KRX"],["068940","ì…€í”¼ê¸€ë¡œë²Œ","KRX"],["007720","ì†Œë…¸ìŠ¤í€˜ì–´","KRX"],["290690","ì†Œë£©ìŠ¤","KRX"],["950200","ì†Œë§ˆì  ","KRX"],["032680","ì†Œí”„íŠ¸ì„¼","KRX"],["032685","ì†Œí”„íŠ¸ì„¼ìš°","KRX"],["258790","ì†Œí”„íŠ¸ìº í”„","KRX"],["066910","ì†ì˜¤ê³µ","KRX"],["215090","ì†”ë””íœìŠ¤","KRX"],["33637K","ì†”ë£¨ìŠ¤ì²¨ë‹¨ì†Œì¬1ìš°","KRX"],["33637L","ì†”ë£¨ìŠ¤ì²¨ë‹¨ì†Œì¬2ìš°B","KRX"],["336370","ì†”ë£¨ìŠ¤ì²¨ë‹¨ì†Œì¬","KRX"],["248070","ì†”ë£¨ì— ","KRX"],["035610","ì†”ë³¸","KRX"],["357780","ì†”ë¸Œë ˆì¸","KRX"],["036830","ì†”ë¸Œë ˆì¸í™€ë”©ìŠ¤","KRX"],["304100","ì†”íŠ¸ë£©ìŠ¤","KRX"],["328380","ì†”íŠ¸ì›¨ì–´","KRX"],["004430","ì†¡ì›ì‚°ì—…","KRX"],["086980","ì‡¼ë°•ìŠ¤","KRX"],["017550","ìˆ˜ì‚°ì„¸ë³´í‹±ìŠ¤","KRX"],["050960","ìˆ˜ì‚°ì•„ì´ì•¤í‹°","KRX"],["126720","ìˆ˜ì‚°ì¸ë”ìŠ¤íŠ¸ë¦¬","KRX"],["084180","ìˆ˜ì„±ì›¹íˆ°","KRX"],["253840","ìˆ˜ì  í…","KRX"],["067160","SOOP","KRX"],["298830","ìŠˆì–´ì†Œí”„íŠ¸í…Œí¬","KRX"],["236200","ìŠˆí”„ë¦¬ë§ˆ","KRX"],["094840","ìŠˆí”„ë¦¬ë§ˆì—ì´ì¹˜í","KRX"],["192440","ìŠˆí”¼ê²ì½”ë¦¬ì•„","KRX"],["424960","ìŠ¤ë§ˆíŠ¸ë ˆì´ë”ì‹œìŠ¤í…œ","KRX"],["099440","ìŠ¤ë§¥","KRX"],["357880","SKAI","KRX"],["276040","ìŠ¤ì½”ë„¥","KRX"],["204210","ìŠ¤íƒ€ì—ìŠ¤ì— ë¦¬ì¸ ","KRX"],["060240","ìŠ¤íƒ€ì½”ë§í¬","KRX"],["115570","ìŠ¤íƒ€í”Œë ‰ìŠ¤","KRX"],["078860","ìŠ¤í…Œì´ì§€ì›ì—”í„°","KRX"],["330730","ìŠ¤í†¤ë¸Œë¦¿ì§€ë²¤ì²˜ìŠ¤","KRX"],["352090","ìŠ¤í†°í…Œí¬","KRX"],["204630","ìŠ¤íŠœë””ì˜¤ì‚°íƒ€í´ë¡œìŠ¤","KRX"],["253450","ìŠ¤íŠœë””ì˜¤ë“œë˜ê³¤","KRX"],["408900","ìŠ¤íŠœë””ì˜¤ë¯¸ë¥´","KRX"],["415380","ìŠ¤íŠœë””ì˜¤ì‚¼ìµ","KRX"],["026890","ìŠ¤í‹±ì¸ë² ìŠ¤íŠ¸ë¨¼íŠ¸","KRX"],["013810","ìŠ¤í˜ì½”","KRX"],["347700","ìŠ¤í”¼ì–´","KRX"],["049830","ìŠ¹ì¼","KRX"],["020710","ì‹œê³µí…Œí¬","KRX"],["033170","ì‹œê·¸ë„¤í‹±ìŠ¤","KRX"],["048870","ì‹œë„ˆì§€ì´ë…¸ë² ì´ì…˜","KRX"],["025320","ì‹œë…¸í™ìŠ¤","KRX"],["134790","ì‹œë””ì¦ˆ","KRX"],["340810","ì‹œì„ AI","KRX"],["269620","ì‹œìŠ¤ì›","KRX"],["000480","CRí™€ë”©ìŠ¤","KRX"],["056090","ì‹œì§€ë©”ë“œí…","KRX"],["429270","ì‹œì§€íŠ¸ë¡œë‹‰ìŠ¤","KRX"],["418250","ì‹œíë ˆí„°","KRX"],["131090","ì‹œíë¸Œ","KRX"],["462870","ì‹œí”„íŠ¸ì—…","KRX"],["016590","ì‹ ëŒ€ì–‘ì œì§€","KRX"],["290520","ì‹ ë„ê¸°ì—°","KRX"],["029530","ì‹ ë„ë¦¬ì½”","KRX"],["004970","ì‹ ë¼êµì—­","KRX"],["001000","ì‹ ë¼ì„¬ìœ ","KRX"],["025870","ì‹ ë¼ì—ìŠ¤ì§€","KRX"],["215600","ì‹ ë¼ì  ","KRX"],["065350","ì‹ ì„±ë¸íƒ€í…Œí¬","KRX"],["416180","ì‹ ì„±ì—ìŠ¤í‹°","KRX"],["011930","ì‹ ì„±ì´ì—”ì§€","KRX"],["004170","ì‹ ì„¸ê³„","KRX"],["035510","ì‹ ì„¸ê³„ I&C","KRX"],["031430","ì‹ ì„¸ê³„ì¸í„°ë‚´ì…”ë‚ ","KRX"],["031440","ì‹ ì„¸ê³„í‘¸ë“œ","KRX"],["006880","ì‹ ì†¡í™€ë”©ìŠ¤","KRX"],["162300","ì‹ ìŠ¤í‹¸","KRX"],["002800","ì‹ ì‹ ì œì•½","KRX"],["005800","ì‹ ì˜ì™€ì½”ë£¨","KRX"],["001720","ì‹ ì˜ì¦ê¶Œ","KRX"],["472220","ì‹ ì˜ìŠ¤íŒ©10í˜¸","KRX"],["0091W0","ì‹ ì˜ìŠ¤íŒ©11í˜¸","KRX"],["009270","ì‹ ì›","KRX"],["017000","ì‹ ì›ì¢…í•©ê°œë°œ","KRX"],["002700","ì‹ ì¼ì „ì","KRX"],["012790","ì‹ ì¼ì œì•½","KRX"],["138070","ì‹ ì§„ì—ìŠ¤ì— ","KRX"],["226330","ì‹ í…Œì¹´ë°”ì´ì˜¤","KRX"],["002870","ì‹ í’","KRX"],["019175","ì‹ í’ì œì•½ìš°","KRX"],["019170","ì‹ í’ì œì•½","KRX"],["481850","ì‹ í•œê¸€ë¡œë²Œì•¡í‹°ë¸Œë¦¬ì¸ ","KRX"],["055550","ì‹ í•œì§€ì£¼","KRX"],["404990","ì‹ í•œì„œë¶€í‹°ì—”ë””ë¦¬ì¸ ","KRX"],["293940","ì‹ í•œì•ŒíŒŒë¦¬ì¸ ","KRX"],["452980","ì‹ í•œì œ11í˜¸ìŠ¤íŒ©","KRX"],["474660","ì‹ í•œì œ12í˜¸ìŠ¤íŒ©","KRX"],["474930","ì‹ í•œì œ13í˜¸ìŠ¤íŒ©","KRX"],["487360","ì‹ í•œì œ14í˜¸ìŠ¤íŒ©","KRX"],["487830","ì‹ í•œì œ15í˜¸ìŠ¤íŒ©","KRX"],["496070","ì‹ í•œì œ16í˜¸ìŠ¤íŒ©","KRX"],["056700","ì‹ í™”ì¸í„°í…","KRX"],["187270","ì‹ í™”ì½˜í…","KRX"],["004080","ì‹ í¥","KRX"],["243840","ì‹ í¥ì—ìŠ¤ì´ì”¨","KRX"],["257720","ì‹¤ë¦¬ì½˜íˆ¬","KRX"],["222800","ì‹¬í…","KRX"],["036710","ì‹¬í…í™€ë”©ìŠ¤","KRX"],["444530","ì‹¬í”Œë«í¼","KRX"],["234030","ì‹¸ì´ë‹‰ì†”ë£¨ì…˜","KRX"],["160980","ì‹¸ì´ë§¥ìŠ¤","KRX"],["356890","ì‹¸ì´ë²„ì›","KRX"],["217330","ì‹¸ì´í† ì  ","KRX"],["004770","ì¨ë‹ˆì „ì","KRX"],["217320","ì¬í…Œí¬","KRX"],["208640","ì¸ì—ì´ì§€","KRX"],["222420","ì„ë…¸í…","KRX"],["037760","ì„ë‹ˆíŠ¸","KRX"],["081180","ì„í¬","KRX"],["099320","ì„íŠ¸ë ‰ì•„ì´","KRX"],["049960","ìŒë°”ì´ì˜¤í…","KRX"],["088280","ì˜ë‹‰ìŠ¤","KRX"],["403550","ì˜ì¹´","KRX"],["050890","ì ë¦¬ë“œ","KRX"],["394800","ì“°ë¦¬ë¹Œë¦¬ì–¸","KRX"],["177900","ì“°ë¦¬ì—ì´ë¡œì§ìŠ¤","KRX"],["475400","ì”¨ë©”ìŠ¤","KRX"],["109670","ì”¨ì‹¸ì´íŠ¸","KRX"],["066790","ì”¨ì”¨ì—ìŠ¤","KRX"],["222080","ì”¨ì•„ì´ì—ìŠ¤","KRX"],["004920","ì”¨ì•„ì´í…Œí¬","KRX"],["236030","ì”¨ì•Œí‘¸ë“œ","KRX"],["103660","ì”¨ì•—","KRX"],["352480","ì”¨ì•¤ì”¨ì¸í„°ë‚´ì…”ë„","KRX"],["245450","ì”¨ì•¤ì—ìŠ¤ë§í¬","KRX"],["264660","ì”¨ì•¤ì§€í•˜ì´í…Œí¬","KRX"],["352700","ì”¨ì•¤íˆ¬ìŠ¤","KRX"],["056730","CNT85","KRX"],["458870","ì”¨ì–´ìŠ¤í…Œí¬ë†€ë¡œì§€","KRX"],["065770","CS","KRX"],["297090","ì”¨ì—ìŠ¤ë² ì–´ë§","KRX"],["083660","CSA ì½”ìŠ¤ë¯¹","KRX"],["112610","ì”¨ì—ìŠ¤ìœˆë“œ","KRX"],["900120","ì”¨ì—‘ìŠ¤ì•„ì´","KRX"],["359090","ì”¨ì—”ì•Œë¦¬ì„œì¹˜","KRX"],["115530","ì”¨ì—”í”ŒëŸ¬ìŠ¤","KRX"],["388210","ì”¨ì— í‹°ì—‘ìŠ¤","KRX"],["115480","ì”¨ìœ ë©”ë””ì¹¼","KRX"],["376290","ì”¨ìœ í…Œí¬","KRX"],["189330","ì”¨ì´ë©","KRX"],["000120","CJëŒ€í•œí†µìš´","KRX"],["311690","CJ ë°”ì´ì˜¤ì‚¬ì´ì–¸ìŠ¤","KRX"],["079160","CJ CGV","KRX"],["035760","CJ ENM","KRX"],["097955","CJì œì¼ì œë‹¹ ìš°","KRX"],["097950","CJì œì¼ì œë‹¹","KRX"],["051500","CJí”„ë ˆì‹œì›¨ì´","KRX"],["096530","ì”¨ì  ","KRX"],["083790","CGì¸ë°”ì´ì¸ ","KRX"],["480370","ì”¨ì¼€ì´ì†”ë£¨ì…˜","KRX"],["101240","ì”¨íë¸Œ","KRX"],["060590","ì”¨í‹°ì”¨ë°”ì´ì˜¤","KRX"],["308170","ì”¨í‹°ì•Œëª¨ë¹Œë¦¬í‹°","KRX"],["260930","ì”¨í‹°ì¼€ì´","KRX"],["413630","ì”¨í”¼ì‹œìŠ¤í…œ","KRX"],["013990","ì•„ê°€ë°©ì»´í¼ë‹ˆ","KRX"],["123860","ì•„ë‚˜íŒ¨ìŠ¤","KRX"],["025980","ì•„ë‚œí‹°","KRX"],["008700","ì•„ë‚¨ì „ì","KRX"],["0015N0","ì•„ë¡œë§ˆí‹°ì¹´","KRX"],["125210","ì•„ëª¨ê·¸ë¦°í…","KRX"],["090435","ì•„ëª¨ë ˆí¼ì‹œí”½ìš°","KRX"],["090430","ì•„ëª¨ë ˆí¼ì‹œí”½","KRX"],["002795","ì•„ëª¨ë ˆí¼ì‹œí”½í™€ë”©ìŠ¤ìš°","KRX"],["00279K","ì•„ëª¨ë ˆí¼ì‹œí”½í™€ë”©ìŠ¤3ìš°C","KRX"],["002790","ì•„ëª¨ë ˆí¼ì‹œí”½í™€ë”©ìŠ¤","KRX"],["052710","ì•„ëª¨í…","KRX"],["074430","ì•„ë¯¸ë…¸ë¡œì§ìŠ¤","KRX"],["092040","ì•„ë¯¸ì½”ì  ","KRX"],["083930","ì•„ë°”ì½”","KRX"],["149950","ì•„ë°”í…","KRX"],["036010","ì•„ë¹„ì½”ì „ì","KRX"],["002030","ì•„ì„¸ì•„","KRX"],["183190","ì•„ì„¸ì•„ì‹œë©˜íŠ¸","KRX"],["002310","ì•„ì„¸ì•„ì œì§€","KRX"],["050860","ì•„ì„¸ì•„í…","KRX"],["012170","ì•„ì„¼ë””ì˜¤","KRX"],["136410","ì•„ì…ˆìŠ¤","KRX"],["246720","ì•„ìŠ¤íƒ€","KRX"],["450950","ì•„ìŠ¤í…Œë¼ì‹œìŠ¤","KRX"],["067390","ì•„ìŠ¤íŠ¸","KRX"],["159010","ì•„ìŠ¤í”Œë¡œ","KRX"],["127710","ì•„ì‹œì•„ê²½ì œ","KRX"],["267850","ì•„ì‹œì•„ë‚˜IDT","KRX"],["020560","ì•„ì‹œì•„ë‚˜í•­ê³µ","KRX"],["227610","ì•„ìš°ë”˜í“¨ì³ìŠ¤","KRX"],["331740","ì•„ìš°í† í¬ë¦½íŠ¸","KRX"],["143160","ì•„ì´ë””ìŠ¤","KRX"],["054800","ì•„ì´ë””ìŠ¤í™€ë”©ìŠ¤","KRX"],["332370","ì•„ì´ë””í”¼","KRX"],["066430","ì•„ì´ë¡œë³´í‹±ìŠ¤","KRX"],["122900","ì•„ì´ë§ˆì¼“ì½”ë¦¬ì•„","KRX"],["339950","ì•„ì´ë¹„ê¹€ì˜","KRX"],["469750","ì•„ì´ë¹„ì ¼ì›ìŠ¤","KRX"],["467930","IBKSì œ23í˜¸ìŠ¤íŒ©","KRX"],["469480","IBKSì œ24í˜¸ìŠ¤íŒ©","KRX"],["0099X0","IBKSì œ25í˜¸ìŠ¤íŒ©","KRX"],["460470","ì•„ì´ë¹”í…Œí¬ë†€ë¡œì§€","KRX"],["099190","ì•„ì´ì„¼ìŠ¤","KRX"],["461300","ì•„ì´ìŠ¤í¬ë¦¼ë¯¸ë””ì–´","KRX"],["289010","ì•„ì´ìŠ¤í¬ë¦¼ì—ë“€","KRX"],["214430","ì•„ì´ì“°ë¦¬ì‹œìŠ¤í…œ","KRX"],["040910","ì•„ì´ì”¨ë””","KRX"],["368600","ì•„ì´ì”¨ì—ì´ì¹˜","KRX"],["456010","ì•„ì´ì”¨í‹°ì¼€ì´","KRX"],["052860","ì•„ì´ì•¤ì”¨","KRX"],["464500","ì•„ì´ì–¸ë””ë°”ì´ìŠ¤","KRX"],["010780","ì•„ì´ì—ìŠ¤ë™ì„œ","KRX"],["095340","ISC","KRX"],["212710","ì•„ì´ì—ìŠ¤í‹°ì´","KRX"],["038880","ì•„ì´ì—ì´","KRX"],["307180","ì•„ì´ì—˜","KRX"],["403810","ì•„ì´ì—˜ë¡œë³´í‹±ìŠ¤","KRX"],["101390","ì•„ì´ì— ","KRX"],["139130","iMê¸ˆìœµì§€ì£¼","KRX"],["461030","ì•„ì´ì— ë¹„ë””ì—‘ìŠ¤","KRX"],["052220","iMBC","KRX"],["456570","ì•„ì´ì— ì§€í‹°","KRX"],["451220","ì•„ì´ì— í‹°","KRX"],["447690","ì•„ì´ì˜¤ë°”ì´ì˜¤","KRX"],["090150","ì•„ì´ìœˆ","KRX"],["031310","ì•„ì´ì¦ˆë¹„ì „","KRX"],["462980","ì•„ì´ì§€ë„·","KRX"],["185490","ì•„ì´ì§„","KRX"],["059100","ì•„ì´ì»´í¬ë„ŒíŠ¸","KRX"],["149010","ì•„ì´ì¼€ì´ì„¸ë¯¸ì½˜","KRX"],["262840","ì•„ì´í€˜ìŠ¤íŠ¸","KRX"],["175250","ì•„ì´íì–´","KRX"],["052460","ì•„ì´í¬ë˜í”„íŠ¸","KRX"],["119830","ì•„ì´í…","KRX"],["052770","ì•„ì´í†¡ì‹œ","KRX"],["124500","ì•„ì´í‹°ì„¼ê¸€ë¡œë²Œ","KRX"],["031820","ì•„ì´í‹°ì„¼ì”¨í‹°ì—ìŠ¤","KRX"],["010280","ì•„ì´í‹°ì„¼ì—”í…","KRX"],["243870","ì•„ì´í‹°ì„¼ì½”ì–´","KRX"],["232830","ì•„ì´í‹°ì„¼í”¼ì—”ì—ìŠ¤","KRX"],["372800","ì•„ì´í‹°ì•„ì´ì¦ˆ","KRX"],["084850","ì•„ì´í‹°ì— ë°˜ë„ì²´","KRX"],["309710","ì•„ì´í‹°ì¼","KRX"],["114840","ì•„ì´íŒ¨ë°€ë¦¬ì—ìŠ¤ì”¨","KRX"],["139990","ì•„ì£¼ìŠ¤í‹¸","KRX"],["027360","ì•„ì£¼IBíˆ¬ì","KRX"],["032080","ì•„ì¦ˆí…WB","KRX"],["013310","ì•„ì§„ì‚°ì—…","KRX"],["059120","ì•„ì§„ì—‘ìŠ¤í…","KRX"],["009320","ì•„ì§„ì „ìë¶€í’ˆ","KRX"],["0007C0","ì•„í¬ë¦´","KRX"],["203690","ì•„í¬ì†”ë£¨ì…˜ìŠ¤","KRX"],["158430","ì•„í†¤","KRX"],["200350","ì•„í‹°ìŠ¤íŠ¸ìŠ¤íŠœë””ì˜¤","KRX"],["321820","ì•„í‹°ìŠ¤íŠ¸ì»´í¼ë‹ˆ","KRX"],["149300","ì•„í“¨ì–´ìŠ¤","KRX"],["102950","ì•„í•˜","KRX"],["001540","ì•ˆêµ­ì•½í’ˆ","KRX"],["053800","ì•ˆë©","KRX"],["251280","ì•ˆì§€ì˜¤ë©","KRX"],["065660","ì•ˆíŠ¸ë¡œì  ","KRX"],["297570","ì•Œë¡œì´ìŠ¤","KRX"],["001780","ì•Œë£¨ì½”","KRX"],["260660","ì•Œë¦¬ì½”ì œì•½","KRX"],["354320","ì•Œë©•","KRX"],["361570","ì•Œë¹„ë”ë¸”ìœ ","KRX"],["131370","ì•Œì„œí¬íŠ¸","KRX"],["140670","ì•Œì—ìŠ¤ì˜¤í† ë©”ì´ì…˜","KRX"],["327260","RFë¨¸íŠ¸ë¦¬ì–¼ì¦ˆ","KRX"],["096610","ì•Œì—í”„ì„¸ë¯¸","KRX"],["474610","RFì‹œìŠ¤í…œì¦ˆ","KRX"],["218410","RFHIC","KRX"],["061040","ì•Œì—í”„í…","KRX"],["148250","ì•Œì—”íˆ¬í…Œí¬ë†€ë¡œì§€","KRX"],["123010","ì•Œì—”í‹°ì—‘ìŠ¤","KRX"],["476830","ì•Œì§€ë…¸ë¯¹ìŠ¤","KRX"],["347860","ì•Œì²´ë¼","KRX"],["196170","ì•Œí…Œì˜¤ì  ","KRX"],["123750","ì•Œí†¤","KRX"],["459550","ì•ŒíŠ¸","KRX"],["085810","ì•Œí‹°ìºìŠ¤íŠ¸","KRX"],["043100","ì•ŒíŒŒAI","KRX"],["117670","ì•ŒíŒŒì¹©ìŠ¤","KRX"],["314140","ì•Œí”¼ë°”ì´ì˜¤","KRX"],["291650","ì••íƒ€ë¨¸ì‚¬ì´ì–¸ìŠ¤","KRX"],["293780","ì••íƒ€ë°”ì´ì˜¤","KRX"],["018250","ì• ê²½ì‚°ì—…","KRX"],["161000","ì• ê²½ì¼€ë¯¸ì¹¼","KRX"],["390110","ì• ë‹ˆë©”ë””ì†”ë£¨ì…˜","KRX"],["310200","ì• ë‹ˆí”ŒëŸ¬ìŠ¤","KRX"],["179530","ì• ë“œë°”ì´ì˜¤í…","KRX"],["397810","ì• ë“œí¬ëŸ¬ìŠ¤","KRX"],["900100","ì• ë¨¸ë¦¿ì§€","KRX"],["052790","ì•¡í† ì¦ˆì†Œí”„íŠ¸","KRX"],["290740","ì•¡íŠ¸ë¡œ","KRX"],["238090","ì•¤ë””í¬ìŠ¤","KRX"],["138360","ì•¤ë¡œë³´í‹±ìŠ¤","KRX"],["092600","ì•¤ì”¨ì•¤","KRX"],["129890","ì•±ì½”","KRX"],["174900","ì•±í´ë¡ ","KRX"],["109960","ì•±í† í¬ë¡¬","KRX"],["270520","ì•±íŠ¼","KRX"],["255440","ì•¼ìŠ¤","KRX"],["030960","ì–‘ì§€ì‚¬","KRX"],["102120","ì–´ë³´ë¸Œë°˜ë„ì²´","KRX"],["238120","ì–¼ë¼ì¸ë“œ","KRX"],["224810","ì—„ì§€í•˜ìš°ìŠ¤","KRX"],["019990","ì—ë„ˆí† í¬","KRX"],["011090","ì—ë„¥ìŠ¤","KRX"],["435570","ì—ë¥´ì½”ìŠ¤","KRX"],["270660","ì—ë¸Œë¦¬ë´‡","KRX"],["038680","ì—ìŠ¤ë„·","KRX"],["137310","ì—ìŠ¤ë””ë°”ì´ì˜¤ì„¼ì„œ","KRX"],["217480","ì—ìŠ¤ë””ìƒëª…ê³µí•™","KRX"],["121890","ì—ìŠ¤ë””ì‹œìŠ¤í…œ","KRX"],["099220","SDN","KRX"],["304360","ì—ìŠ¤ë°”ì´ì˜¤ë©”ë”•ìŠ¤","KRX"],["289080","SVì¸ë² ìŠ¤íŠ¸ë¨¼íŠ¸","KRX"],["389500","ì—ìŠ¤ë¹„ë¹„í…Œí¬","KRX"],["003080","SBì„±ë³´","KRX"],["019550","SBIì¸ë² ìŠ¤íŠ¸ë¨¼íŠ¸","KRX"],["034120","SBS","KRX"],["042110","ì—ìŠ¤ì”¨ë””","KRX"],["246960","SCLì‚¬ì´ì–¸ìŠ¤","KRX"],["298060","ì—ìŠ¤ì”¨ì— ìƒëª…ê³¼í•™","KRX"],["065420","ì—ìŠ¤ì•„ì´ë¦¬ì†ŒìŠ¤","KRX"],["270210","ì—ìŠ¤ì•Œë°”ì´ì˜¤í…","KRX"],["103230","ì—ìŠ¤ì•¤ë”ë¸”ë¥˜","KRX"],["260970","ì—ìŠ¤ì•¤ë””","KRX"],["101490","ì—ìŠ¤ì•¤ì—ìŠ¤í…","KRX"],["095910","ì—ìŠ¤ì—ë„ˆì§€","KRX"],["275630","ì—ìŠ¤ì—ìŠ¤ì•Œ","KRX"],["419530","SAMGì—”í„°","KRX"],["031330","ì—ìŠ¤ì—ì´ì— í‹°","KRX"],["060540","ì—ìŠ¤ì—ì´í‹°","KRX"],["056190","ì—ìŠ¤ì—í”„ì—ì´","KRX"],["036540","SFAë°˜ë„ì²´","KRX"],["0008Z0","ì—ìŠ¤ì—”ì‹œìŠ¤","KRX"],["091340","S&Kí´ë¦¬í…","KRX"],["005850","ì—ìŠ¤ì—˜","KRX"],["246250","ì—ìŠ¤ì—˜ì—ìŠ¤ë°”ì´ì˜¤","KRX"],["063440","SM Life Design","KRX"],["010580","ì—ìŠ¤ì— ë²¡ì…€","KRX"],["460870","ì—ìŠ¤ì— ì”¨ì§€","KRX"],["041510","ì—ìŠ¤ì— ","KRX"],["048550","SM C&C","KRX"],["007820","ì—ìŠ¤ì— ì½”ì–´","KRX"],["464080","ì—ìŠ¤ì˜¤ì—ìŠ¤ë©","KRX"],["109610","ì—ìŠ¤ì™€ì´","KRX"],["365330","ì—ìŠ¤ì™€ì´ìŠ¤í‹¸í…","KRX"],["012750","ì—ìŠ¤ì›","KRX"],["306040","ì—ìŠ¤ì œì´ê·¸ë£¹","KRX"],["033530","SJGì„¸ì¢…","KRX"],["217910","ì—ìŠ¤ì œì´ì¼","KRX"],["004060","SGì„¸ê³„ë¬¼ì‚°","KRX"],["016250","SGC E&C","KRX"],["184230","SGAì†”ë£¨ì…˜ì¦ˆ","KRX"],["040610","SG&G","KRX"],["255220","SG","KRX"],["398120","ì—ìŠ¤ì§€í—¬ìŠ¤ì¼€ì–´","KRX"],["006125","SKë””ìŠ¤ì»¤ë²„ë¦¬ìš°","KRX"],["006120","SKë””ìŠ¤ì»¤ë²„ë¦¬","KRX"],["302440","SKë°”ì´ì˜¤ì‚¬ì´ì–¸ìŠ¤","KRX"],["326030","SKë°”ì´ì˜¤íŒœ","KRX"],["475150","SKì´í„°ë‹‰ìŠ¤","KRX"],["457940","ì—ìŠ¤ì¼€ì´ì¦ê¶Œì œ10í˜¸ìŠ¤íŒ©","KRX"],["472230","ì—ìŠ¤ì¼€ì´ì¦ê¶Œì œ11í˜¸ìŠ¤íŒ©","KRX"],["473000","ì—ìŠ¤ì¼€ì´ì¦ê¶Œì œ12í˜¸ìŠ¤íŒ©","KRX"],["473950","ì—ìŠ¤ì¼€ì´ì¦ê¶Œì œ13í˜¸ìŠ¤íŒ©","KRX"],["455910","ì—ìŠ¤ì¼€ì´ì¦ê¶Œì œ9í˜¸ìŠ¤íŒ©","KRX"],["000660","SKí•˜ì´ë‹‰ìŠ¤","KRX"],["475660","ì—ìŠ¤ì¼","KRX"],["096630","ì—ìŠ¤ì½”ë„¥","KRX"],["069510","ì—ìŠ¤í…","KRX"],["488280","ì—ìŠ¤íˆ¬ë”ë¸”ìœ ","KRX"],["234300","ì—ìŠ¤íŠ¸ë˜í”½","KRX"],["039440","ì—ìŠ¤í‹°ì•„ì´","KRX"],["098660","ì—ìŠ¤í‹°ì˜¤","KRX"],["052020","ì—ìŠ¤í‹°íë¸Œ","KRX"],["237690","ì—ìŠ¤í‹°íŒœ","KRX"],["050760","ì—ìŠ¤í´ë¦¬í…","KRX"],["288620","ì—ìŠ¤í“¨ì–¼ì…€","KRX"],["443670","ì—ìŠ¤í”¼ì†Œí”„íŠ¸","KRX"],["317830","ì—ìŠ¤í”¼ì‹œìŠ¤í…œìŠ¤","KRX"],["058610","ì—ìŠ¤í”¼ì§€","KRX"],["043340","ì—ìˆí…Œí¬","KRX"],["023960","ì—ì“°ì”¨ì—”ì§€ë‹ˆì–´ë§","KRX"],["163280","ì—ì–´ë ˆì¸","KRX"],["298690","ì—ì–´ë¶€ì‚°","KRX"],["200710","ì—ì´ë””í…Œí¬ë†€ë¡œì§€","KRX"],["475580","ì—ì´ëŸ­ìŠ¤","KRX"],["096690","ì—ì´ë£¨íŠ¸","KRX"],["078520","ì—ì´ë¸”ì”¨ì—”ì”¨","KRX"],["298380","ì—ì´ë¹„ì—˜ë°”ì´ì˜¤","KRX"],["203400","ì—ì´ë¹„ì˜¨","KRX"],["195990","ì—ì´ë¹„í”„ë¡œë°”ì´ì˜¤","KRX"],["003800","ì—ì´ìŠ¤ì¹¨ëŒ€","KRX"],["088800","ì—ì´ìŠ¤í…Œí¬","KRX"],["241840","ì—ì´ìŠ¤í† ë¦¬","KRX"],["364950","ì—ì´ì•„ì´ì½”ë¦¬ì•„","KRX"],["453860","ì—ì´ì—ìŠ¤í…","KRX"],["312610","ì—ì´ì—í”„ë”ë¸”ë¥˜","KRX"],["015260","ì—ì´ì—”í”¼","KRX"],["172670","ì—ì´ì—˜í‹°","KRX"],["234070","ì—ì´ì›ì•Œí¼","KRX"],["481070","ì—ì´ìœ ë¸Œëœì¦ˆ","KRX"],["140910","ì—ì´ë¦¬ì¸ ","KRX"],["060900","ì—ì´ì „íŠ¸AI","KRX"],["445090","ì—ì´ì§ëœë“œ","KRX"],["267270","HDê±´ì„¤ê¸°ê³„","KRX"],["039570","HDCë©ìŠ¤","KRX"],["089470","HDCí˜„ëŒ€EP","KRX"],["009540","HDí•œêµ­ì¡°ì„ í•´ì–‘","KRX"],["443060","HDí˜„ëŒ€ë§ˆë¦°ì†”ë£¨ì…˜","KRX"],["071970","HDí˜„ëŒ€ë§ˆë¦°ì—”ì§„","KRX"],["267250","HDí˜„ëŒ€","KRX"],["322000","HDí˜„ëŒ€ì—ë„ˆì§€ì†”ë£¨ì…˜","KRX"],["267260","HDí˜„ëŒ€ì¼ë ‰íŠ¸ë¦­","KRX"],["329180","HDí˜„ëŒ€ì¤‘ê³µì—…","KRX"],["295310","ì—ì´ì¹˜ë¸Œì´ì— ","KRX"],["297890","HBì†”ë£¨ì…˜","KRX"],["440290","HBì¸ë² ìŠ¤íŠ¸ë¨¼íŠ¸","KRX"],["078150","HBí…Œí¬ë†€ëŸ¬ì§€","KRX"],["072990","ì—ì´ì¹˜ì‹œí‹°","KRX"],["225530","HCë³´ê´‘ì‚°ì—…","KRX"],["060560","HCí™ˆì„¼íƒ€","KRX"],["036640","HRS","KRX"],["002460","HSí™”ì„±","KRX"],["487570","HSíš¨ì„±","KRX"],["298050","HSíš¨ì„±ì²¨ë‹¨ì†Œì¬","KRX"],["044990","ì—ì´ì¹˜ì—”ì—ìŠ¤í•˜ì´í…","KRX"],["028300","HLB","KRX"],["003580","HLBê¸€ë¡œë²Œ","KRX"],["278650","HLBë°”ì´ì˜¤ìŠ¤í…","KRX"],["067630","HLBìƒëª…ê³¼í•™","KRX"],["187420","HLBì œë„¥ìŠ¤","KRX"],["047920","HLBì œì•½","KRX"],["115450","HLBí…Œë¼í“¨í‹±ìŠ¤","KRX"],["046210","HLBíŒŒë‚˜ì§„","KRX"],["196300","HLBí©","KRX"],["239610","ì—ì´ì¹˜ì—˜ì‚¬ì´ì–¸ìŠ¤","KRX"],["036170","ì—ì´ì¹˜ì— ë„¥ìŠ¤","KRX"],["462020","ì—ì´ì¹˜ì— ì”¨ì œ6í˜¸ìŠ¤íŒ©","KRX"],["477340","ì—ì´ì¹˜ì— ì”¨ì œ7í˜¸ìŠ¤íŒ©","KRX"],["011200","HMM","KRX"],["148930","ì—ì´ì¹˜ì™€ì´í‹°ì”¨","KRX"],["376270","HEMíŒŒë§ˆ","KRX"],["044780","ì—ì´ì¹˜ì¼€ì´","KRX"],["195940","HKì´ë…¸ì—”","KRX"],["403870","HPSP","KRX"],["357230","ì—ì´ì¹˜í”¼ì˜¤","KRX"],["355690","ì—ì´í…€","KRX"],["071670","ì—ì´í…Œí¬ì†”ë£¨ì…˜","KRX"],["045660","ì—ì´í…","KRX"],["224110","ì—ì´í…ëª¨ë¹Œë¦¬í‹°","KRX"],["021080","ì—ì´í‹°ë„˜ì¸ë² ìŠ¤íŠ¸","KRX"],["200470","ì—ì´íŒ©íŠ¸","KRX"],["207490","ì—ì´í™ìŠ¤ì¸í…","KRX"],["262260","ì—ì´í”„ë¡œ","KRX"],["003060","ì—ì´í”„ë¡œì  ë°”ì´ì˜¤ë¡œì§ìŠ¤","KRX"],["007460","ì—ì´í”„ë¡œì  ","KRX"],["397030","ì—ì´í”„ë¦´ë°”ì´ì˜¤","KRX"],["244920","ì—ì´í”ŒëŸ¬ìŠ¤ì—ì…‹","KRX"],["265520","APì‹œìŠ¤í…œ","KRX"],["278470","ì—ì´í”¼ì•Œ","KRX"],["054620","APS","KRX"],["211270","APìœ„ì„±","KRX"],["0009K0","ì—ì„ë“œë°”ì´ì˜¤","KRX"],["230240","ì—ì¹˜ì—í”„ì•Œ","KRX"],["159910","ì—ì½”ê¸€ë¡œìš°","KRX"],["230360","ì—ì½”ë§ˆì¼€íŒ…","KRX"],["038870","ì—ì½”ë°”ì´ì˜¤","KRX"],["097780","ì—ì½”ë³¼íŠ¸","KRX"],["448280","ì—ì½”ì•„ì´","KRX"],["101360","ì—ì½”ì•¤ë“œë¦¼","KRX"],["128540","ì—ì½”ìº¡","KRX"],["086520","ì—ì½”í”„ë¡œ","KRX"],["450080","ì—ì½”í”„ë¡œë¨¸í‹°","KRX"],["247540","ì—ì½”í”„ë¡œë¹„ì— ","KRX"],["383310","ì—ì½”í”„ë¡œì—ì´ì¹˜ì—”","KRX"],["038110","ì—ì½”í”Œë¼ìŠ¤í‹±","KRX"],["073540","ì—í”„ì•Œí…","KRX"],["064850","ì—í”„ì•¤ê°€ì´ë“œ","KRX"],["214270","FSN","KRX"],["036810","ì—í”„ì—ìŠ¤í‹°","KRX"],["173940","ì—í”„ì—”ì”¨ì—”í„°","KRX"],["083500","ì—í”„ì—”ì—ìŠ¤í…Œí¬","KRX"],["446440","ì—í”¼ë°”ì´ì˜¤í…","KRX"],["054940","ì—‘ì‚¬ì´ì—”ì”¨","KRX"],["950130","ì—‘ì„¸ìŠ¤ë°”ì´ì˜¤","KRX"],["373110","ì—‘ì…€ì„¸ë¼í“¨í‹±ìŠ¤","KRX"],["205100","ì—‘ì…ˆ","KRX"],["356680","ì—‘ìŠ¤ê²Œì´íŠ¸","KRX"],["070300","ì—‘ìŠ¤íì–´","KRX"],["317770","ì—‘ìŠ¤í˜ë¦­ìŠ¤","KRX"],["373200","ì—‘ìŠ¤í”ŒëŸ¬ìŠ¤","KRX"],["069920","ì—‘ì‹œì˜¨ê·¸ë£¹","KRX"],["092870","ì—‘ì‹œì½˜","KRX"],["019490","ì—‘ì‹œíì–´í•˜ì´íŠ¸ë¡ ","KRX"],["059180","ì—”ë”ë¸”ìœ ì‹œ","KRX"],["317870","ì—”ë°”ì´ì˜¤ë‹ˆì•„","KRX"],["067570","ì—”ë¸Œì´ì—ì´ì¹˜ì½”ë¦¬ì•„","KRX"],["0004V0","ì—”ë¹„ì•Œëª¨ì…˜","KRX"],["236810","ì—”ë¹„í‹°","KRX"],["140610","ì—”ì†”ë°”ì´ì˜¤ì‚¬ì´ì–¸ìŠ¤","KRX"],["333620","ì—”ì‹œìŠ¤","KRX"],["101400","ì—”ì‹œíŠ¸ë¡ ","KRX"],["036570","ì—”ì”¨ì†Œí”„íŠ¸","KRX"],["475230","ì—”ì•Œë¹„","KRX"],["238170","ì—”ì—ìŠ¤ì— ","KRX"],["224760","ì—”ì—ìŠ¤ì»´í¼ë‹ˆ","KRX"],["451700","ì—”ì—ì´ì¹˜ìŠ¤íŒ©29í˜¸","KRX"],["466910","ì—”ì—ì´ì¹˜ìŠ¤íŒ©30í˜¸","KRX"],["481890","ì—”ì—ì´ì¹˜ìŠ¤íŒ©31í˜¸","KRX"],["0054V0","ì—”ì—ì´ì¹˜ìŠ¤íŒ©32í˜¸","KRX"],["104200","NHNë²…ìŠ¤","KRX"],["060250","NHN KCP","KRX"],["400760","NHì˜¬ì›ë¦¬ì¸ ","KRX"],["005945","NHíˆ¬ìì¦ê¶Œìš°","KRX"],["005940","NHíˆ¬ìì¦ê¶Œ","KRX"],["265740","ì—”ì—í”„ì”¨","KRX"],["053290","NEëŠ¥ë¥ ","KRX"],["354200","ì—”ì  ë°”ì´ì˜¤","KRX"],["455900","ì—”ì ¤ë¡œë³´í‹±ìŠ¤","KRX"],["419080","ì—”ì ¯","KRX"],["093510","ì—”ì§€ë¸Œì´ì•„ì´","KRX"],["183490","ì—”ì§€ì¼ìƒëª…ê³¼í•™","KRX"],["085310","ì—”ì¼€ì´","KRX"],["182400","ì—”ì¼€ì´ë§¥ìŠ¤","KRX"],["348370","ì—”ì¼","KRX"],["069410","ì—”í…”ìŠ¤","KRX"],["227950","ì—”íˆ¬í…","KRX"],["291230","ì—”í”¼","KRX"],["222160","NPX","KRX"],["048830","ì—”í”¼ì¼€ì´","KRX"],["096870","ì—˜ë””í‹°","KRX"],["276240","ì—˜ë¦¬ë¹„ì ¼","KRX"],["900140","ì—˜ë¸Œì´ì— ì”¨í™€ë”©ìŠ¤","KRX"],["061970","LBì„¸ë¯¸ì½˜","KRX"],["309960","LBì¸ë² ìŠ¤íŠ¸ë¨¼íŠ¸","KRX"],["290650","ì—˜ì•¤ì”¨ë°”ì´ì˜¤","KRX"],["066970","ì—˜ì•¤ì—í”„","KRX"],["156100","ì—˜ì•¤ì¼€ì´ë°”ì´ì˜¤","KRX"],["0041J0","ì—˜ì—ìŠ¤ìŠ¤íŒ©1í˜¸","KRX"],["060370","LSë§ˆë¦°ì†”ë£¨ì…˜","KRX"],["417200","LSë¨¸íŠ¸ë¦¬ì–¼ì¦ˆ","KRX"],["078020","LSì¦ê¶Œ","KRX"],["322180","LSí‹°ë¼ìœ í…","KRX"],["311060","ì—˜ì—ì´í‹°","KRX"],["108675","LXí•˜ìš°ì‹œìŠ¤ìš°","KRX"],["108670","LXí•˜ìš°ì‹œìŠ¤","KRX"],["38380K","LXí™€ë”©ìŠ¤1ìš°","KRX"],["383800","LXí™€ë”©ìŠ¤","KRX"],["073110","ì—˜ì— ì—ìŠ¤","KRX"],["083310","ì—˜ì˜¤í‹°ë² í ","KRX"],["064400","LGì”¨ì—”ì—ìŠ¤","KRX"],["037560","LGí—¬ë¡œë¹„ì „","KRX"],["037950","ì—˜ì»´í…","KRX"],["225190","LKì‚¼ì–‘","KRX"],["489500","ì—˜ì¼€ì´ì¼","KRX"],["170920","ì—˜í‹°ì”¨","KRX"],["476080","M83","KRX"],["058630","ì— ê²Œì„","KRX"],["226590","ì— ë””ë°”ì´ìŠ¤","KRX"],["058970","ì— ë¡œ","KRX"],["097520","ì— ì”¨ë„¥ìŠ¤","KRX"],["373170","ì— ì•„ì´íë¸Œì†”ë£¨ì…˜","KRX"],["179290","ì— ì•„ì´í…","KRX"],["484870","ì— ì•¤ì”¨ì†”ë£¨ì…˜","KRX"],["009780","ì— ì—ìŠ¤ì”¨","KRX"],["123040","ì— ì—ìŠ¤ì˜¤í† í…","KRX"],["432980","ì— ì—í”„ì”¨","KRX"],["413390","ì— ì˜¤í‹°","KRX"],["032790","ì— ì  ì†”ë£¨ì…˜","KRX"],["033160","ì— ì¼€ì´ì „ì","KRX"],["347890","ì— íˆ¬ì•„ì´","KRX"],["033310","ì— íˆ¬ì—”","KRX"],["259630","ì— í”ŒëŸ¬ìŠ¤","KRX"],["105550","ì—£ì§€íŒŒìš´ë“œë¦¬","KRX"],["060850","ì˜ë¦¼ì›ì†Œí”„íŠ¸ë©","KRX"],["014440","ì˜ë³´í™”í•™","KRX"],["143540","ì˜ìš°ë””ì—ìŠ¤í”¼","KRX"],["111770","ì˜ì›ë¬´ì—­","KRX"],["009970","ì˜ì›ë¬´ì—­í™€ë”©ìŠ¤","KRX"],["003520","ì˜ì§„ì•½í’ˆ","KRX"],["000670","ì˜í’","KRX"],["012280","ì˜í™”ê¸ˆì†","KRX"],["265560","ì˜í™”í…Œí¬","KRX"],["012160","ì˜í¥","KRX"],["036000","ì˜ˆë¦¼ë‹¹","KRX"],["250930","ì˜ˆì„ í…Œí¬","KRX"],["053280","ì˜ˆìŠ¤24","KRX"],["122640","ì˜ˆìŠ¤í‹°","KRX"],["476040","ì˜¤ê°€ë…¸ì´ë“œì‚¬ì´ì–¸ìŠ¤","KRX"],["900300","ì˜¤ê°€ë‹‰í‹°ì½”ìŠ¤ë©”í‹±","KRX"],["212310","ì˜¤ê±´ì—ì½”í…","KRX"],["045060","ì˜¤ê³µ","KRX"],["192410","ì˜¤ëŠ˜ì´ì—”ì— ","KRX"],["080520","ì˜¤ë””í…","KRX"],["007310","ì˜¤ëšœê¸°","KRX"],["039830","ì˜¤ë¡œë¼","KRX"],["322310","ì˜¤ë¡œìŠ¤í…Œí¬ë†€ë¡œì§€","KRX"],["046120","ì˜¤ë¥´ë¹„í…","KRX"],["475830","ì˜¤ë¦„í…Œë¼í“¨í‹±","KRX"],["014940","ì˜¤ë¦¬ì—”íƒˆì •ê³µ","KRX"],["002630","ì˜¤ë¦¬ì—”íŠ¸ë°”ì´ì˜¤","KRX"],["065500","ì˜¤ë¦¬ì—”íŠ¸ì •ê³µ","KRX"],["271560","ì˜¤ë¦¬ì˜¨","KRX"],["001800","ì˜¤ë¦¬ì˜¨í™€ë”©ìŠ¤","KRX"],["010470","ì˜¤ë¦¬ì½¤","KRX"],["417860","ì˜¤ë¸Œì  ","KRX"],["352910","ì˜¤ë¹„ê³ ","KRX"],["053980","ì˜¤ìƒìì´ì—˜","KRX"],["036220","ì˜¤ìƒí—¬ìŠ¤ì¼€ì–´","KRX"],["052420","ì˜¤ì„±ì²¨ë‹¨ì†Œì¬","KRX"],["332190","ì˜¤ì…˜ìŠ¤ë°”ì´ì˜¤","KRX"],["052300","ì˜¤ì…˜ì¸ë”ë¸”ìœ ","KRX"],["039200","ì˜¤ìŠ¤ì½”í…","KRX"],["031510","ì˜¤ìŠ¤í…œ","KRX"],["010060","OCIí™€ë”©ìŠ¤","KRX"],["342870","ì˜¤ì•„","KRX"],["368970","ì˜¤ì—ìŠ¤í”¼","KRX"],["138080","ì˜¤ì´ì†”ë£¨ì…˜","KRX"],["080580","ì˜¤í‚¨ìŠ¤ì „ì","KRX"],["067170","ì˜¤í…","KRX"],["353590","ì˜¤í† ì•¤","KRX"],["173130","ì˜¤íŒŒìŠ¤ë„·","KRX"],["049480","ì˜¤í”ˆë² ì´ìŠ¤","KRX"],["394280","ì˜¤í”ˆì—£ì§€í…Œí¬ë†€ë¡œì§€","KRX"],["476060","ì˜¨ì½”ë‹‰í…Œë¼í“¨í‹±ìŠ¤","KRX"],["382150","ì˜¨ì½”í¬ë¡œìŠ¤","KRX"],["005320","ì˜¨íƒ€ì´ë“œ","KRX"],["244460","ì˜¬ë¦¬íŒ¨ìŠ¤","KRX"],["226950","ì˜¬ë¦­ìŠ¤","KRX"],["057540","ì˜´ë‹ˆì‹œìŠ¤í…œ","KRX"],["131030","ì˜µíˆ¬ìŠ¤ì œì•½","KRX"],["082210","ì˜µíŠ¸ë¡ í…","KRX"],["109080","ì˜µí‹°ì‹œìŠ¤","KRX"],["380540","ì˜µí‹°ì½”ì–´","KRX"],["153710","ì˜µí‹°íŒœ","KRX"],["051390","YW","KRX"],["432430","ì™€ì´ë©","KRX"],["338840","ì™€ì´ë°”ì´ì˜¤ë¡œì§ìŠ¤","KRX"],["057030","YBMë„·","KRX"],["122990","ì™€ì´ì†”","KRX"],["232140","ì™€ì´ì”¨","KRX"],["112290","ì™€ì´ì”¨ì¼","KRX"],["065530","ì™€ì´ì–´ë¸”","KRX"],["067900","ì™€ì´ì—”í…","KRX"],["007530","ì™€ì´ì— ","KRX"],["155650","ì™€ì´ì— ì”¨","KRX"],["273640","ì™€ì´ì— í…","KRX"],["251370","ì™€ì´ì— í‹°","KRX"],["209640","ì™€ì´ì œì´ë§í¬","KRX"],["096250","ì™€ì´ì¦ˆë„›","KRX"],["273060","ì™€ì´ì¦ˆë²„ì¦ˆ","KRX"],["019210","ì™€ì´ì§€-ì›","KRX"],["122870","ì™€ì´ì§€ì—”í„°í…Œì¸ë¨¼íŠ¸","KRX"],["037270","YG PLUS","KRX"],["011690","ì™€ì´íˆ¬ì†”ë£¨ì…˜","KRX"],["040300","YTN","KRX"],["079000","ì™€í† ìŠ¤ì½”ë¦¬ì•„","KRX"],["316140","ìš°ë¦¬ê¸ˆìœµì§€ì£¼","KRX"],["032820","ìš°ë¦¬ê¸°ìˆ ","KRX"],["041190","ìš°ë¦¬ê¸°ìˆ íˆ¬ì","KRX"],["115440","ìš°ë¦¬ë„·","KRX"],["046970","ìš°ë¦¬ë¡œ","KRX"],["082850","ìš°ë¦¬ë°”ì´ì˜¤","KRX"],["215360","ìš°ë¦¬ì‚°ì—…","KRX"],["072470","ìš°ë¦¬ì‚°ì—…í™€ë”©ìŠ¤","KRX"],["073560","ìš°ë¦¬ì†ì—í”„ì•¤ì§€","KRX"],["037400","ìš°ë¦¬ì—”í„°í”„ë¼ì´ì¦ˆ","KRX"],["153490","ìš°ë¦¬ì´ì•¤ì—˜","KRX"],["101170","ìš°ë¦¼í”¼í‹°ì—ìŠ¤","KRX"],["006980","ìš°ì„±","KRX"],["066590","ìš°ìˆ˜AMS","KRX"],["017370","ìš°ì‹ ì‹œìŠ¤í…œ","KRX"],["103840","ìš°ì–‘","KRX"],["101970","ìš°ì–‘ì—ì´ì¹˜ì”¨","KRX"],["046940","ìš°ì›ê°œë°œ","KRX"],["215380","ìš°ì •ë°”ì´ì˜¤","KRX"],["065680","ìš°ì£¼ì¼ë ‰íŠ¸ë¡œ","KRX"],["105840","ìš°ì§„","KRX"],["018620","ìš°ì§„ë¹„ì•¤ì§€","KRX"],["010400","ìš°ì§„ì•„ì´ì—”ì—ìŠ¤","KRX"],["457550","ìš°ì§„ì—”í…","KRX"],["049800","ìš°ì§„í”Œë¼ì„","KRX"],["016880","ì›…ì§„","KRX"],["095720","ì›…ì§„ì”½í¬ë¹…","KRX"],["396470","ì›ŒíŠ¸","KRX"],["005820","ì›ë¦¼","KRX"],["307280","ì›ë°”ì´ì˜¤ì  ","KRX"],["032940","ì›ìµ","KRX"],["104830","ì›ìµë¨¸íŠ¸ë¦¬ì–¼ì¦ˆ","KRX"],["240810","ì›ìµIPS","KRX"],["014190","ì›ìµíë¸Œ","KRX"],["074600","ì›ìµQnC","KRX"],["217820","ì›ìµí”¼ì•¤ì´","KRX"],["030530","ì›ìµí™€ë”©ìŠ¤","KRX"],["012620","ì›ì¼íŠ¹ê°•","KRX"],["136150","ì›ì¼í‹°ì—”ì•„ì´","KRX"],["382840","ì›ì¤€","KRX"],["336570","ì›í…","KRX"],["376980","ì›í‹°ë“œë©","KRX"],["122830","ì›í¬ìœ ","KRX"],["008370","ì›í’","KRX"],["008290","ì›í’ë¬¼ì‚°","KRX"],["101160","ì›”ë±ìŠ¤","KRX"],["336060","ì›¨ì´ë²„ìŠ¤","KRX"],["095270","ì›¨ì´ë¸Œì¼ë ‰íŠ¸ë¡œ","KRX"],["289930","ì›¨ì´ë¹„ìŠ¤","KRX"],["065950","ì›°í¬ë¡ ","KRX"],["076080","ì›°í¬ë¡ í•œí…","KRX"],["043590","ì›°í‚µìŠ¤í•˜ì´í…","KRX"],["196700","ì›¹ìŠ¤","KRX"],["069080","ì›¹ì  ","KRX"],["053580","ì›¹ì¼€ì‹œ","KRX"],["479960","ìœ„ë„ˆìŠ¤","KRX"],["377460","ìœ„ë‹ˆì•„ì—ì´ë“œ","KRX"],["044340","ìœ„ë‹‰ìŠ¤","KRX"],["330350","ìœ„ë”ìŠ¤ì œì•½","KRX"],["348350","ìœ„ë“œí…","KRX"],["112040","ìœ„ë©”ì´ë“œ","KRX"],["101730","ìœ„ë©”ì´ë“œë§¥ìŠ¤","KRX"],["123420","ìœ„ë©”ì´ë“œí”Œë ˆì´","KRX"],["065370","ìœ„ì„¸ì•„ì´í…","KRX"],["140660","ìœ„ì›”ë“œ","KRX"],["038620","ìœ„ì¦ˆì½”í”„","KRX"],["299900","ìœ„ì§€ìœ…ìŠ¤íŠœë””ì˜¤","KRX"],["036090","ìœ„ì§€íŠ¸","KRX"],["459100","ìœ„ì¸ ","KRX"],["136540","ìœˆìŠ¤í…Œí¬ë„·","KRX"],["097800","ìœˆíŒ©","KRX"],["192390","ìœˆí•˜ì´í…","KRX"],["008600","ìœŒë¹„ìŠ¤","KRX"],["335870","ìœ™ìŠ¤í’‹","KRX"],["900340","ìœ™ì…í‘¸ë“œ","KRX"],["014830","ìœ ë‹ˆë“œ","KRX"],["446070","ìœ ë‹ˆë“œë¹„í‹°í”ŒëŸ¬ìŠ¤","KRX"],["036200","ìœ ë‹ˆì…ˆ","KRX"],["018000","ìœ ë‹ˆìŠ¨","KRX"],["047400","ìœ ë‹ˆì˜¨ë¨¸í‹°ë¦¬ì–¼","KRX"],["203450","ìœ ë‹ˆì˜¨ë°”ì´ì˜¤ë©”íŠ¸ë¦­ìŠ¤","KRX"],["000910","ìœ ë‹ˆì˜¨","KRX"],["011330","ìœ ë‹ˆì¼","KRX"],["077500","ìœ ë‹ˆí€˜ìŠ¤íŠ¸","KRX"],["011320","ìœ ë‹ˆí¬","KRX"],["086390","ìœ ë‹ˆí…ŒìŠ¤íŠ¸","KRX"],["241690","ìœ ë‹ˆí…Œí¬ë…¸","KRX"],["142210","ìœ ë‹ˆíŠ¸ë¡ í…","KRX"],["121060","ìœ ë‹ˆí¬ì¸íŠ¸","KRX"],["389680","ìœ ë””ì— í…","KRX"],["088340","ìœ ë¼í´","KRX"],["048430","ìœ ë¼í…Œí¬","KRX"],["206650","ìœ ë°”ì´ì˜¤ë¡œì§ìŠ¤","KRX"],["089850","ìœ ë¹„ë²¨ë¡ìŠ¤","KRX"],["495810","ìœ ë¹„ì”¨","KRX"],["084440","ìœ ë¹„ì˜¨","KRX"],["032620","ìœ ë¹„ì¼€ì–´","KRX"],["264450","ìœ ë¹„ì¿¼ìŠ¤","KRX"],["078070","ìœ ë¹„ì¿¼ìŠ¤í™€ë”©ìŠ¤","KRX"],["002920","ìœ ì„±ê¸°ì—…","KRX"],["024800","ìœ ì„±í‹°ì—”ì—ìŠ¤","KRX"],["000700","ìœ ìˆ˜í™€ë”©ìŠ¤","KRX"],["054930","ìœ ì‹ ","KRX"],["069330","ìœ ì•„ì´ë””","KRX"],["049520","ìœ ì•„ì´ì—˜","KRX"],["444920","ìœ ì•ˆíƒ€ì œ11í˜¸ìŠ¤íŒ©","KRX"],["450940","ìœ ì•ˆíƒ€ì œ14í˜¸ìŠ¤íŒ©","KRX"],["473050","ìœ ì•ˆíƒ€ì œ15í˜¸ìŠ¤íŒ©","KRX"],["474490","ìœ ì•ˆíƒ€ì œ16í˜¸ìŠ¤íŒ©","KRX"],["493790","ìœ ì•ˆíƒ€ì œ17í˜¸ìŠ¤íŒ©","KRX"],["003475","ìœ ì•ˆíƒ€ì¦ê¶Œìš°","KRX"],["003470","ìœ ì•ˆíƒ€ì¦ê¶Œ","KRX"],["263770","ìœ ì—ìŠ¤í‹°","KRX"],["337840","ìœ ì—‘ìŠ¤ì—”","KRX"],["072130","ìœ ì—”ì ¤","KRX"],["000225","ìœ ìœ ì œì•½1ìš°","KRX"],["000227","ìœ ìœ ì œì•½2ìš°B","KRX"],["000220","ìœ ìœ ì œì•½","KRX"],["388720","ìœ ì¼ë¡œë³´í‹±ìŠ¤","KRX"],["340930","ìœ ì¼ì—ë„ˆí…Œí¬","KRX"],["023410","ìœ ì§„ê¸°ì—…","KRX"],["468760","ìœ ì§„ìŠ¤íŒ©10í˜¸","KRX"],["488060","ìœ ì§„ìŠ¤íŒ©11í˜¸","KRX"],["0105P0","ìœ ì§„ìŠ¤íŒ©12í˜¸","KRX"],["056080","ìœ ì§„ë¡œë´‡","KRX"],["084370","ìœ ì§„í…Œí¬","KRX"],["240600","ìœ ì§„í…Œí¬ë†€ë¡œì§€","KRX"],["001200","ìœ ì§„íˆ¬ìì¦ê¶Œ","KRX"],["221800","ìœ íˆ¬ë°”ì´ì˜¤","KRX"],["179900","ìœ í‹°ì•„ì´","KRX"],["263050","ìœ í‹¸ë ‰ìŠ¤","KRX"],["000105","ìœ í•œì–‘í–‰ìš°","KRX"],["000100","ìœ í•œì–‘í–‰","KRX"],["003465","ìœ í™”ì¦ê¶Œìš°","KRX"],["003460","ìœ í™”ì¦ê¶Œ","KRX"],["191410","ìœ¡ì¼ì”¨ì—”ì—ì“°","KRX"],["372170","ìœ¤ì„±ì—í”„ì•¤ì”¨","KRX"],["146060","ìœ¨ì´Œ","KRX"],["008730","ìœ¨ì´Œí™”í•™","KRX"],["008250","ì´ê±´ì‚°ì—…","KRX"],["039020","ì´ê±´í™€ë”©ìŠ¤","KRX"],["025820","ì´êµ¬ì‚°ì—…","KRX"],["067920","ì´ê¸€ë£¨","KRX"],["044960","ì´ê¸€ë²³","KRX"],["303530","ì´ë…¸ë","KRX"],["296640","ì´ë…¸ë£°ìŠ¤","KRX"],["302430","ì´ë…¸ë©”íŠ¸ë¦¬","KRX"],["279060","ì´ë…¸ë²¡ìŠ¤","KRX"],["214320","ì´ë…¸ì…˜","KRX"],["462350","ì´ë…¸ìŠ¤í˜ì´ìŠ¤","KRX"],["274400","ì´ë…¸ì‹œë®¬ë ˆì´ì…˜","KRX"],["073490","ì´ë…¸ì™€ì´ì–´ë¦¬ìŠ¤","KRX"],["215790","ì´ë…¸ì¸ìŠ¤íŠ¸ë£¨ë¨¼íŠ¸","KRX"],["344860","ì´ë…¸ì§„","KRX"],["469610","ì´ë…¸í…Œí¬","KRX"],["088390","ì´ë…¹ìŠ¤","KRX"],["272290","ì´ë…¹ìŠ¤ì²¨ë‹¨ì†Œì¬","KRX"],["053350","ì´ë‹ˆí…","KRX"],["452400","ì´ë‹‰ìŠ¤","KRX"],["264850","ì´ëœì‹œìŠ¤","KRX"],["054210","ì´ëœí…","KRX"],["009730","ì´ë ˜","KRX"],["065440","ì´ë£¨ì˜¨","KRX"],["088260","ì´ë¦¬ì¸ ì½”í¬ë ™","KRX"],["139480","ì´ë§ˆíŠ¸","KRX"],["424870","ì´ë®¨ì˜¨ì‹œì•„","KRX"],["115610","ì´ë¯¸ì§€ìŠ¤","KRX"],["478110","ì´ë² ìŠ¤íŠ¸ìŠ¤íŒ©6í˜¸","KRX"],["131400","ì´ë¸Œì´ì²¨ë‹¨ì†Œì¬","KRX"],["208850","ì´ë¹„í…Œí¬","KRX"],["351330","ì´ì‚­ì—”ì§€ë‹ˆì–´ë§","KRX"],["080010","ì´ìƒë„¤íŠ¸ì›ìŠ¤","KRX"],["379390","ì´ì„±ì”¨ì—”ì•„ì´","KRX"],["457190","ì´ìˆ˜ìŠ¤í˜ì…œí‹°ì¼€ë¯¸ì»¬","KRX"],["086890","ì´ìˆ˜ì•±ì§€ìŠ¤","KRX"],["007660","ì´ìˆ˜í˜íƒ€ì‹œìŠ¤","KRX"],["005950","ì´ìˆ˜í™”í•™","KRX"],["015020","ì´ìŠ¤íƒ€ì½”","KRX"],["047560","ì´ìŠ¤íŠ¸ì†Œí”„íŠ¸","KRX"],["900110","ì´ìŠ¤íŠ¸ì•„ì‹œì•„í™€ë”©ìŠ¤","KRX"],["239340","ì´ìŠ¤íŠ¸ì—ì´ë“œ","KRX"],["067010","ì´ì”¨ì—ìŠ¤","KRX"],["418620","E8","KRX"],["456070","ì´ì—”ì…€","KRX"],["102710","ì´ì—”ì—í”„í…Œí¬ë†€ë¡œì§€","KRX"],["074610","ì´ì—”í”ŒëŸ¬ìŠ¤","KRX"],["041520","ì´ì—˜ì”¨","KRX"],["063760","ì´ì—˜í”¼","KRX"],["123570","ì´ì— ë„·","KRX"],["278990","EMB","KRX"],["083470","ì´ì— ì•¤ì•„ì´","KRX"],["095190","ì´ì— ì½”ë¦¬ì•„","KRX"],["091120","ì´ì— í…","KRX"],["232530","ì´ì— í‹°","KRX"],["102460","ì´ì—°ì œì•½","KRX"],["039030","ì´ì˜¤í…Œí¬ë‹‰ìŠ¤","KRX"],["294090","ì´ì˜¤í”Œë¡œìš°","KRX"],["245620","EDGC","KRX"],["088290","ì´ì›ì»´í¬í…","KRX"],["084680","ì´ì›”ë“œ","KRX"],["037370","EG","KRX"],["353810","ì´ì§€ë°”ì´ì˜¤","KRX"],["261520","ì´ì§€ìŠ¤","KRX"],["350520","ì´ì§€ìŠ¤ë ˆì§€ë˜ìŠ¤ë¦¬ì¸ ","KRX"],["334890","ì´ì§€ìŠ¤ë°¸ë¥˜í”ŒëŸ¬ìŠ¤ë¦¬ì¸ ","KRX"],["099750","ì´ì§€ì¼€ì–´í…","KRX"],["377330","ì´ì§€íŠ¸ë¡œë‹‰ìŠ¤","KRX"],["035810","ì´ì§€í™€ë”©ìŠ¤","KRX"],["092130","ì´í¬ë ˆë”ë¸”","KRX"],["134060","ì´í“¨ì³","KRX"],["001840","ì´í™”ê³µì˜","KRX"],["000760","ì´í™”ì‚°ì—…","KRX"],["014990","ì¸ë””ì—í”„","KRX"],["041830","ì¸ë°”ë””","KRX"],["352940","ì¸ë°”ì´ì˜¤","KRX"],["101140","ì¸ë°”ì´ì˜¤ì  ","KRX"],["216400","ì¸ë°”ì´ì¸ ë°”ì´ì˜¤ì½”ì•„","KRX"],["079950","ì¸ë² ë‹ˆì•„","KRX"],["389470","ì¸ë²¤í‹°ì§€ë©","KRX"],["277410","ì¸ì‚°ê°€","KRX"],["060150","ì¸ì„ ì´ì—”í‹°","KRX"],["033230","ì¸ì„±ì •ë³´","KRX"],["450520","ì¸ìŠ¤ì›¨ì´ë¸Œ","KRX"],["006490","ì¸ìŠ¤ì½”ë¹„","KRX"],["465480","ì¸ìŠ¤í”¼ì–¸","KRX"],["037330","ì¸ì§€ë””ìŠ¤í”Œë ˆ","KRX"],["100030","ì¸ì§€ì†Œí”„íŠ¸","KRX"],["023800","ì¸ì§€ì»¨íŠ¸ë¡¤ìŠ¤","KRX"],["034590","ì¸ì²œë„ì‹œê°€ìŠ¤","KRX"],["211050","ì¸ì¹´ê¸ˆìœµì„œë¹„ìŠ¤","KRX"],["083640","ì¸ì½˜","KRX"],["064090","ì¸í¬ë ˆë”ë¸”ë²„ì¦ˆ","KRX"],["216050","ì¸í¬ë¡œìŠ¤","KRX"],["049070","ì¸íƒ‘ìŠ¤","KRX"],["311960","ì¸í„°ë¡œì´ë“œ","KRX"],["119610","ì¸í„°ë¡œì¡°","KRX"],["017250","ì¸í„°ì— ","KRX"],["129260","ì¸í„°ì§€ìŠ¤","KRX"],["051370","ì¸í„°í”Œë ‰ìŠ¤","KRX"],["064290","ì¸í…í”ŒëŸ¬ìŠ¤","KRX"],["189300","ì¸í…”ë¦¬ì•ˆí…Œí¬","KRX"],["287840","ì¸íˆ¬ì…€","KRX"],["048530","ì¸íŠ¸ë¡ ë°”ì´ì˜¤","KRX"],["023810","ì¸íŒ©","KRX"],["115310","ì¸í¬ë°”ì¸","KRX"],["039290","ì¸í¬ë±…í¬","KRX"],["071200","ì¸í”¼ë‹ˆíŠ¸í—¬ìŠ¤ì¼€ì–´","KRX"],["101930","ì¸í™”ì •ê³µ","KRX"],["249420","ì¼ë™ì œì•½","KRX"],["000230","ì¼ë™í™€ë”©ìŠ¤","KRX"],["013360","ì¼ì„±ê±´ì„¤","KRX"],["003120","ì¼ì„±ì•„ì´ì—ìŠ¤","KRX"],["333430","ì¼ìŠ¹","KRX"],["068330","ì¼ì‹ ë°”ì´ì˜¤","KRX"],["003200","ì¼ì‹ ë°©ì§","KRX"],["007110","ì¼ì‹ ì„ì¬","KRX"],["007575","ì¼ì–‘ì•½í’ˆìš°","KRX"],["007570","ì¼ì–‘ì•½í’ˆ","KRX"],["178780","ì¼ì›”ì§€ì— ì—˜","KRX"],["008500","ì¼ì •ì‹¤ì—…","KRX"],["019540","ì¼ì§€í…Œí¬","KRX"],["081000","ì¼ì§„ë‹¤ì´ì•„","KRX"],["020760","ì¼ì§„ë””ìŠ¤í”Œ","KRX"],["103590","ì¼ì§„ì „ê¸°","KRX"],["094820","ì¼ì§„íŒŒì›Œ","KRX"],["271940","ì¼ì§„í•˜ì´ì†”ë£¨ìŠ¤","KRX"],["015860","ì¼ì§„í™€ë”©ìŠ¤","KRX"],["226320","ì‡ì¸ í•œë¶ˆ","KRX"],["950140","ì‰ê¸€ìš°ë“œë©","KRX"],["049550","ì‰í¬í…Œí¬","KRX"],["389020","ìëŒí…Œí¬ë†€ë¡œì§€","KRX"],["254120","ìë¹„ìŠ¤","KRX"],["043910","ìì—°ê³¼í™˜ê²½","KRX"],["234920","ìì´ê¸€","KRX"],["289220","ìì´ì–¸íŠ¸ìŠ¤í…","KRX"],["317400","ìì´ì—ìŠ¤ì•¤ë””","KRX"],["033240","ìí™”ì „ì","KRX"],["049630","ì¬ì˜ì†”ë£¨í…","KRX"],["417840","ì €ìŠ¤í…œ","KRX"],["000950","ì „ë°©","KRX"],["079900","ì „ì§„ê±´ì„¤ë¡œë´‡","KRX"],["110020","ì „ì§„ë°”ì´ì˜¤íŒœ","KRX"],["208140","ì •ë‹¤ìš´","KRX"],["040420","ì •ìƒì œì´ì—˜ì—ìŠ¤","KRX"],["045510","ì •ì›ì—”ì‹œìŠ¤","KRX"],["217190","ì œë„ˆì…ˆ","KRX"],["095700","ì œë„¥ì‹ ","KRX"],["122310","ì œë…¸ë ˆì´","KRX"],["361390","ì œë…¸ì½”","KRX"],["066830","ì œë…¸í…","KRX"],["225220","ì œë†€ë£¨ì…˜","KRX"],["123330","ì œë‹‰","KRX"],["381620","ì œë‹‰ìŠ¤ë¡œë³´í‹±ìŠ¤","KRX"],["159580","ì œë¡œíˆ¬ì„¸ë¸","KRX"],["147830","ì œë£¡ì‚°ì—…","KRX"],["033100","ì œë£¡ì „ê¸°","KRX"],["079370","ì œìš°ìŠ¤","KRX"],["067290","JWì‹ ì•½","KRX"],["054950","ì œì´ë¸Œì´ì— ","KRX"],["023440","ì œì´ìŠ¤ì½”í™€ë”©ìŠ¤","KRX"],["090470","ì œì´ìŠ¤í…","KRX"],["137950","ì œì´ì”¨ì¼€ë¯¸ì¹¼","KRX"],["033320","ì œì´ì”¨í˜„ì‹œìŠ¤í…œ","KRX"],["417500","ì œì´ì•„ì´í…Œí¬","KRX"],["348950","ì œì´ì•Œê¸€ë¡œë²Œë¦¬ì¸ ","KRX"],["204270","ì œì´ì•¤í‹°ì”¨","KRX"],["127120","ì œì´ì—ìŠ¤ë§í¬","KRX"],["194370","ì œì´ì—ìŠ¤ì½”í¼ë ˆì´ì…˜","KRX"],["026040","ì œì´ì—ìŠ¤í‹°ë‚˜","KRX"],["452160","ì œì´ì—”ë¹„","KRX"],["126880","ì œì´ì—”ì¼€ì´ê¸€ë¡œë²Œ","KRX"],["322510","ì œì´ì—˜ì¼€ì´","KRX"],["254160","ì œì´ì— ë©€í‹°","KRX"],["033050","ì œì´ì— ì•„ì´","KRX"],["094970","ì œì´ì— í‹°","KRX"],["418550","ì œì´ì˜¤","KRX"],["035900","JYP Ent.","KRX"],["060230","ì œì´ì¼€ì´ì‹œëƒ…ìŠ¤","KRX"],["420570","ì œì´íˆ¬ì¼€ì´ë°”ì´ì˜¤","KRX"],["089790","ì œì´í‹°","KRX"],["950170","JTC","KRX"],["0010V0","ì œì´í”¼ì•„ì´í—¬ìŠ¤ì¼€ì–´","KRX"],["030000","ì œì¼ê¸°íš","KRX"],["271980","ì œì¼ì•½í’ˆ","KRX"],["412540","ì œì¼ì— ì•¤ì—ìŠ¤","KRX"],["001560","ì œì¼ì—°ë§ˆ","KRX"],["199820","ì œì¼ì¼ë ‰íŠ¸ë¦­","KRX"],["038010","ì œì¼í…Œí¬ë…¸ìŠ¤","KRX"],["002620","ì œì¼íŒŒë§ˆí™€ë”©ìŠ¤","KRX"],["080220","ì œì£¼ë°˜ë„ì²´","KRX"],["006220","ì œì£¼ì€í–‰","KRX"],["089590","ì œì£¼í•­ê³µ","KRX"],["216080","ì œí…Œë§ˆ","KRX"],["337930","ì ì‹œë¯¹ìŠ¤","KRX"],["229000","ì  íë¦­ìŠ¤","KRX"],["082270","ì ¬ë°±ìŠ¤","KRX"],["004910","ì¡°ê´‘í˜ì¸íŠ¸","KRX"],["004700","ì¡°ê´‘í”¼í˜","KRX"],["001550","ì¡°ë¹„","KRX"],["462520","ì¡°ì„ ë‚´í™”","KRX"],["120030","ì¡°ì„ ì„ ì¬","KRX"],["034940","ì¡°ì•„ì œì•½","KRX"],["067000","ì¡°ì´ì‹œí‹°","KRX"],["309930","ì¡°ì´ì›ìŠ¤ì•¤ì½”","KRX"],["018470","ì¡°ì¼ì•Œë¯¸ëŠ„","KRX"],["002600","ì¡°í¥","KRX"],["063160","ì¢…ê·¼ë‹¹ë°”ì´ì˜¤","KRX"],["185750","ì¢…ê·¼ë‹¹","KRX"],["001630","ì¢…ê·¼ë‹¹í™€ë”©ìŠ¤","KRX"],["033340","ì¢‹ì€ì‚¬ëŒë“¤","KRX"],["036930","ì£¼ì„±ì—”ì§€ë‹ˆì–´ë§","KRX"],["109070","ì£¼ì„±ì½”í¼ë ˆì´ì…˜","KRX"],["185190","ìˆ˜í”„ë¡œ","KRX"],["357580","ì•„ëª¨ì„¼ìŠ¤","KRX"],["226400","ì˜¤ìŠ¤í…Œì˜¤ë‹‰","KRX"],["440320","ì˜¤í”ˆë†€","KRX"],["189350","ì½”ì…‹","KRX"],["348080","íë¼í‹°ìŠ¤","KRX"],["023450","ë™ë‚¨í•©ì„±","KRX"],["002380","KCC","KRX"],["044380","ì£¼ì—°í…Œí¬","KRX"],["024110","ê¸°ì—…ì€í–‰","KRX"],["072020","ì¤‘ì•™ë°±ì‹ ","KRX"],["000440","ì¤‘ì•™ì—ë„ˆë¹„ìŠ¤","KRX"],["051980","ì¤‘ì•™ì²¨ë‹¨ì†Œì¬","KRX"],["228760","ì§€ë…¸ë¯¹íŠ¸ë¦¬","KRX"],["314130","ì§€ë†ˆì•¤ì»´í¼ë‹ˆ","KRX"],["013890","ì§€ëˆ„ìŠ¤","KRX"],["389030","ì§€ë‹ˆë„ˆìŠ¤","KRX"],["263860","ì§€ë‹ˆì–¸ìŠ¤","KRX"],["303030","ì§€ë‹ˆí‹±ìŠ¤","KRX"],["036180","ì§€ë”ë¸”ìœ ë°”ì´í…","KRX"],["208350","ì§€ë€ì§€êµì‹œíë¦¬í‹°","KRX"],["446840","ì§€ìŠ¨","KRX"],["144510","ì§€ì”¨ì…€","KRX"],["340450","ì§€ì”¨ì§€ë†ˆ","KRX"],["306620","ì§€ì•„ì´ì—ìŠ¤","KRX"],["358570","ì§€ì•„ì´ì´ë…¸ë² ì´ì…˜","KRX"],["382480","ì§€ì•„ì´í…","KRX"],["382800","ì§€ì•¤ë¹„ì—ìŠ¤ ì—ì½”","KRX"],["299480","ì§€ì•¤ì´í—¬ìŠ¤ì¼€ì–´","KRX"],["051160","ì§€ì–´ì†Œí”„íŠ¸","KRX"],["001250","GSê¸€ë¡œë²Œ","KRX"],["007070","GSë¦¬í…Œì¼","KRX"],["053050","ì§€ì—ìŠ¤ì´","KRX"],["499790","GSí”¼ì•¤ì—˜","KRX"],["076340","ì§€ì—ì´ì´ë…¸ë”ìŠ¤","KRX"],["130500","GHì‹ ì†Œì¬","KRX"],["388610","ì§€ì—í”„ì”¨ìƒëª…ê³¼í•™","KRX"],["493330","ì§€ì—í”„ì•„ì´","KRX"],["119850","ì§€ì—”ì”¨ì—ë„ˆì§€","KRX"],["065060","ì§€ì—”ì½”","KRX"],["204840","ì§€ì—˜íŒœí…","KRX"],["013870","ì§€ì— ë¹„ì½”ë¦¬ì•„","KRX"],["071320","ì§€ì—­ë‚œë°©ê³µì‚¬","KRX"],["311320","ì§€ì˜¤ì—˜ë¦¬ë¨¼íŠ¸","KRX"],["456160","ì§€íˆ¬ì§€ë°”ì´ì˜¤","KRX"],["388050","ì§€íˆ¬íŒŒì›Œ","KRX"],["088790","ì§„ë„","KRX"],["018120","ì§„ë¡œë°œíš¨","KRX"],["109820","ì§„ë§¤íŠ¸ë¦­ìŠ¤","KRX"],["086060","ì§„ë°”ì´ì˜¤í…","KRX"],["036890","ì§„ì„±í‹°ì´ì”¨","KRX"],["363250","ì§„ì‹œìŠ¤í…œ","KRX"],["003780","ì§„ì–‘ì‚°ì—…","KRX"],["007370","ì§„ì–‘ì œì•½","KRX"],["010640","ì§„ì–‘í´ë¦¬","KRX"],["100250","ì§„ì–‘í™€ë”©ìŠ¤","KRX"],["051630","ì§„ì–‘í™”í•™","KRX"],["272450","ì§„ì—ì–´","KRX"],["285800","ì§„ì˜","KRX"],["011000","ì§„ì›ìƒëª…ê³¼í•™","KRX"],["250030","ì§„ì½”ìŠ¤í…","KRX"],["002785","ì§„í¥ê¸°ì—…ìš°B","KRX"],["002787","ì§„í¥ê¸°ì—…2ìš°B","KRX"],["002780","ì§„í¥ê¸°ì—…","KRX"],["233990","ì§ˆê²½ì´","KRX"],["025620","ì°¨AIí—¬ìŠ¤ì¼€ì–´","KRX"],["085660","ì°¨ë°”ì´ì˜¤í…","KRX"],["261780","ì°¨ë°±ì‹ ì—°êµ¬ì†Œ","KRX"],["900250","í¬ë¦¬ìŠ¤íƒˆì‹ ì†Œì¬","KRX"],["351870","ì°¨ì´ì»¤ë®¤ë‹ˆì¼€ì´ì…˜","KRX"],["009310","ì°¸ì—”ì§€ë‹ˆì–´ë§","KRX"],["094850","ì°¸ì¢‹ì€ì—¬í–‰","KRX"],["368030","ì°½ëŒ€ì •ë°€","KRX"],["004650","ì°½í•´ì—íƒ„ì˜¬","KRX"],["278280","ì²œë³´","KRX"],["000650","ì²œì¼ê³ ì†","KRX"],["362320","ì²­ë‹´ê¸€ë¡œë²Œ","KRX"],["066360","ì²´ë¦¬ë¶€ë¡œ","KRX"],["033250","ì²´ì‹œìŠ¤","KRX"],["047820","ì´ˆë¡ë±€ë¯¸ë””ì–´","KRX"],["094360","ì¹©ìŠ¤ì•¤ë¯¸ë””ì–´","KRX"],["016920","ì¹´ìŠ¤","KRX"],["284620","ì¹´ì´ë…¸ìŠ¤ë©”ë“œ","KRX"],["293490","ì¹´ì¹´ì˜¤ê²Œì„ì¦ˆ","KRX"],["323410","ì¹´ì¹´ì˜¤ë±…í¬","KRX"],["035720","ì¹´ì¹´ì˜¤","KRX"],["377300","ì¹´ì¹´ì˜¤í˜ì´","KRX"],["140430","ì¹´í‹°ìŠ¤","KRX"],["042000","ì¹´í˜24","KRX"],["006380","ì¹´í”„ë¡œ","KRX"],["313760","ìºë¦¬","KRX"],["317530","ìºë¦¬ì†Œí”„íŠ¸","KRX"],["071850","ìºìŠ¤í…ì½”ë¦¬ì•„","KRX"],["198080","ìºí”„","KRX"],["210120","ìº”ë²„ìŠ¤ì—”","KRX"],["050110","ìº ì‹œìŠ¤","KRX"],["452300","ìº¡ìŠ¤í†¤íŒŒíŠ¸ë„ˆìŠ¤","KRX"],["451760","ì»¨í…","KRX"],["900310","ì»¬ëŸ¬ë ˆì´","KRX"],["078340","ì»´íˆ¬ìŠ¤","KRX"],["063080","ì»´íˆ¬ìŠ¤í™€ë”©ìŠ¤","KRX"],["307930","ì»´í¼ë‹ˆì¼€ì´","KRX"],["079190","ì¼€ìŠ¤í”¼ì˜¨","KRX"],["263700","ì¼€ì–´ë©ìŠ¤","KRX"],["214370","ì¼€ì–´ì  ","KRX"],["221980","ì¼€ì´ë””ì¼","KRX"],["038530","ì¼€ì´ë°”ì´ì˜¤","KRX"],["415640","KBë°œí•´ì¸í”„ë¼","KRX"],["001620","ì¼€ì´ë¹„ì•„ì´ë™êµ­ì‹¤ì—…","KRX"],["008970","KBIë™ì–‘ì² ê´€","KRX"],["024840","KBIë©”íƒˆ","KRX"],["464680","KBì œ27í˜¸ìŠ¤íŒ©","KRX"],["478390","KBì œ29í˜¸ìŠ¤íŒ©","KRX"],["486630","KBì œ30í˜¸ìŠ¤íŒ©","KRX"],["492220","KBì œ31í˜¸ìŠ¤íŒ©","KRX"],["0037T0","KBì œ32í˜¸ìŠ¤íŒ©","KRX"],["0072Z0","KBì œ33í˜¸ìŠ¤íŒ©","KRX"],["318000","KBG","KRX"],["192250","ì¼€ì´ì‚¬ì¸","KRX"],["431190","ì¼€ì´ì“°ë¦¬ì•„ì´","KRX"],["009440","KCê·¸ë¦°í™€ë”©ìŠ¤","KRX"],["029460","ì¼€ì´ì”¨","KRX"],["112190","KCì‚°ì—…","KRX"],["021320","KCCê±´ì„¤","KRX"],["344820","KCCê¸€ë¼ìŠ¤","KRX"],["115500","ì¼€ì´ì”¨ì—ìŠ¤","KRX"],["119650","KCì½”íŠ¸ë ","KRX"],["281820","ì¼€ì´ì”¨í…","KRX"],["089150","ì¼€ì´ì”¨í‹°","KRX"],["025880","ì¼€ì´ì”¨í”¼ë“œ","KRX"],["093320","ì¼€ì´ì•„ì´ì—”ì—‘ìŠ¤","KRX"],["093640","ì¼€ì´ì•Œì— ","KRX"],["044450","KSSí•´ìš´","KRX"],["101000","KSì¸ë”ìŠ¤íŠ¸ë¦¬","KRX"],["073010","ì¼€ì´ì—ìŠ¤í”¼","KRX"],["060720","KHë°”í…","KRX"],["122450","KX","KRX"],["052900","KXí•˜ì´í…","KRX"],["105330","ì¼€ì´ì—”ë”ë¸”ìœ ","KRX"],["053080","ì¼€ì´ì—”ì†”","KRX"],["199430","ì¼€ì´ì—”ì•Œì‹œìŠ¤í…œ","KRX"],["432470","ì¼€ì´ì—”ì—ìŠ¤","KRX"],["058400","KNN","KRX"],["272110","ì¼€ì´ì—”ì œì´","KRX"],["039420","ì¼€ì´ì—˜ë„·","KRX"],["083550","ì¼€ì´ì— ","KRX"],["032500","ì¼€ì´ì— ë”ë¸”ìœ ","KRX"],["225430","ì¼€ì´ì— ì œì•½","KRX"],["102370","ì¼€ì´ì˜¥ì…˜","KRX"],["068100","ì¼€ì´ì›¨ë”","KRX"],["092220","KEC","KRX"],["106080","ì¼€ì´ì´ì— í…","KRX"],["036560","KZì •ë°€","KRX"],["046440","KGëª¨ë¹Œë¦¬ì–¸ìŠ¤","KRX"],["455180","ì¼€ì´ì§€ì—ì´","KRX"],["151860","KGì—ì½”ì†”ë£¨ì…˜","KRX"],["035600","KGì´ë‹ˆì‹œìŠ¤","KRX"],["381970","ì¼€ì´ì¹´","KRX"],["145270","ì¼€ì´íƒ‘ë¦¬ì¸ ","KRX"],["089600","KTë‚˜ìŠ¤ë¯¸ë””ì–´","KRX"],["418470","KTë°€ë¦¬ì˜ì„œì¬","KRX"],["030200","KT","KRX"],["053210","ìŠ¤ì¹´ì´ë¼ì´í”„","KRX"],["058850","KTcs","KRX"],["058860","KTis","KRX"],["036030","ì¼€ì´í‹°ì•ŒíŒŒ","KRX"],["033780","KT&G","KRX"],["043610","KTì§€ë‹ˆë®¤ì§","KRX"],["064820","ì¼€ì´í”„","KRX"],["024880","ì¼€ì´í”¼ì—í”„","KRX"],["042040","ì¼€ì´í”¼ì— í…Œí¬","KRX"],["054410","ì¼€ì´í”¼í‹°ìœ ","KRX"],["258610","ì¼€ì¼ëŸ¼","KRX"],["274090","ì¼„ì½”ì•„ì—ì–´ë¡œìŠ¤í˜ì´ìŠ¤","KRX"],["402420","ì¼ˆìŠ¤","KRX"],["089010","ì¼íŠ¸ë¡œë‹‰ìŠ¤","KRX"],["220260","ì¼íŠ¸ë¡œìŠ¤","KRX"],["176590","ì½”ë‚˜ì†”","KRX"],["052400","ì½”ë‚˜ì•„ì´","KRX"],["402030","ì½”ë‚œí…Œí¬ë†€ë¡œì§€","KRX"],["391710","ì½”ë‹‰ì˜¤í† ë©”ì´ì…˜","KRX"],["046070","ì½”ë‹¤ì½”","KRX"],["047770","ì½”ë°ì¦ˆì»´ë°”ì¸","KRX"],["080530","ì½”ë””","KRX"],["417310","ì½”ëŒì½”ë”ì›ë¦¬ì¸ ","KRX"],["357120","ì½”ëŒì½”ë¼ì´í”„ì¸í”„ë¼ë¦¬ì¸ ","KRX"],["104540","ì½”ë Œí…","KRX"],["027050","ì½”ë¦¬ì•„ë‚˜","KRX"],["007815","ì½”ë¦¬ì•„ì¨ìš°","KRX"],["00781K","ì½”ë¦¬ì•„ì¨í‚¤íŠ¸2ìš°B","KRX"],["007810","ì½”ë¦¬ì•„ì¨í‚¤íŠ¸","KRX"],["190650","ì½”ë¦¬ì•„ì—ì…‹íˆ¬ìì¦ê¶Œ","KRX"],["123410","ì½”ë¦¬ì•„ì—í”„í‹°","KRX"],["003690","ì½”ë¦¬ì•ˆë¦¬","KRX"],["036690","ì½”ë§¥ìŠ¤","KRX"],["049430","ì½”ë©”ë¡ ","KRX"],["183300","ì½”ë¯¸ì½”","KRX"],["041960","ì½”ë¯¸íŒœ","KRX"],["089890","ì½”ì„¸ìŠ¤","KRX"],["360350","ì½”ì…ˆ","KRX"],["082660","ì½”ìŠ¤ë‚˜ì¸","KRX"],["192820","ì½”ìŠ¤ë§¥ìŠ¤","KRX"],["044820","ì½”ìŠ¤ë§¥ìŠ¤ë¹„í‹°ì•„ì´","KRX"],["222040","ì½”ìŠ¤ë§¥ìŠ¤ì—”ë¹„í‹°","KRX"],["241710","ì½”ìŠ¤ë©”ì¹´ì½”ë¦¬ì•„","KRX"],["005070","ì½”ìŠ¤ëª¨ì‹ ì†Œì¬","KRX"],["005420","ì½”ìŠ¤ëª¨í™”í•™","KRX"],["355150","ì½”ìŠ¤í…ì‹œìŠ¤","KRX"],["169670","ì½”ìŠ¤í…ì‹œìŠ¤í…œ","KRX"],["071950","ì½”ì•„ìŠ¤","KRX"],["166480","ì½”ì•„ìŠ¤í…œì¼ì˜¨","KRX"],["045970","ì½”ì•„ì‹œì•„","KRX"],["196450","ì½”ì•„ì‹œì•„ì”¨ì— ","KRX"],["384470","ì½”ì–´ë¼ì¸ì†Œí”„íŠ¸","KRX"],["002025","ì½”ì˜¤ë¡±ìš°","KRX"],["003075","ì½”ì˜¤ë¡±ê¸€ë¡œë²Œìš°","KRX"],["003070","ì½”ì˜¤ë¡±ê¸€ë¡œë²Œ","KRX"],["002020","ì½”ì˜¤ë¡±","KRX"],["102940","ì½”ì˜¤ë¡±ìƒëª…ê³¼í•™","KRX"],["138490","ì½”ì˜¤ë¡±ENP","KRX"],["120115","ì½”ì˜¤ë¡±ì¸ë”ìš°","KRX"],["120110","ì½”ì˜¤ë¡±ì¸ë”","KRX"],["950160","ì½”ì˜¤ë¡±í‹°ìŠˆì§„","KRX"],["021240","ì½”ì›¨ì´","KRX"],["056360","ì½”ìœ„ë²„","KRX"],["282880","ì½”ìœˆí…Œí¬","KRX"],["121850","ì½”ì´ì¦ˆ","KRX"],["448710","ì½”ì¸ í…Œí¬ë†€ë¡œì§€","KRX"],["126730","ì½”ì¹©","KRX"],["015710","ì½”ì½¤","KRX"],["052330","ì½”í…","KRX"],["322780","ì½”í¼ìŠ¤ì½”ë¦¬ì•„","KRX"],["036420","ì½˜í…íŠ¸ë¦¬ì¤‘ì•™","KRX"],["200130","ì½œë§ˆë¹„ì•¤ì—ì´ì¹˜","KRX"],["024720","ì½œë§ˆí™€ë”©ìŠ¤","KRX"],["294570","ì¿ ì½˜","KRX"],["192400","ì¿ ì¿ í™€ë”©ìŠ¤","KRX"],["284740","ì¿ ì¿ í™ˆì‹œìŠ¤","KRX"],["464490","ì¿¼ë“œë©”ë””ìŠ¨","KRX"],["317690","í€€íƒ€ë§¤íŠ¸ë¦­ìŠ¤","KRX"],["432720","í€„ë¦¬íƒ€ìŠ¤ë°˜ë„ì²´","KRX"],["456190","íë¼ì¼","KRX"],["365270","íë¼í´","KRX"],["060280","íë ‰ì†Œ","KRX"],["372320","íë¡œì…€","KRX"],["051780","íë¡œí™€ë”©ìŠ¤","KRX"],["115180","íë¦¬ì–¸íŠ¸","KRX"],["494120","íë¦¬ì˜¤ì‹œìŠ¤","KRX"],["445680","íë¦¬ì˜¥ìŠ¤ë°”ì´ì˜¤ì‹œìŠ¤í…œì¦ˆ","KRX"],["182360","íë¸Œì—”í„°","KRX"],["405100","íì•Œí‹°","KRX"],["066310","íì—ìŠ¤ì•„ì´","KRX"],["136660","íì— ì”¨","KRX"],["016600","íìºí”¼íƒˆ","KRX"],["355390","í¬ë¼ìš°ë“œì›ìŠ¤","KRX"],["26490K","í¬ë¼ìš´ì œê³¼ìš°","KRX"],["264900","í¬ë¼ìš´ì œê³¼","KRX"],["005745","í¬ë¼ìš´í•´íƒœí™€ë”©ìŠ¤ìš°","KRX"],["005740","í¬ë¼ìš´í•´íƒœí™€ë”©ìŠ¤","KRX"],["259960","í¬ë˜í”„í†¤","KRX"],["096240","í¬ë ˆë²„ìŠ¤","KRX"],["040350","í¬ë ˆì˜¤ì—ìŠ¤ì§€","KRX"],["215570","í¬ë¡œë„¥ìŠ¤","KRX"],["110790","í¬ë¦¬ìŠ¤ì—í”„ì•¤ì”¨","KRX"],["045520","í¬ë¦°ì•¤ì‚¬ì´ì–¸ìŠ¤","KRX"],["214150","í´ë˜ì‹œìŠ¤","KRX"],["466100","í´ë¡œë´‡","KRX"],["237880","í´ë¦¬ì˜¤","KRX"],["139670","í‚¤ë„¤ë§ˆìŠ¤í„°","KRX"],["020120","í‚¤ë‹¤ë¦¬ìŠ¤íŠœë””ì˜¤","KRX"],["475430","í‚¤ìŠ¤íŠ¸ë¡ ","KRX"],["487720","í‚¤ì›€ì œ10í˜¸ìŠ¤íŒ©","KRX"],["489480","í‚¤ì›€ì œ11í˜¸ìŠ¤íŒ©","KRX"],["039490","í‚¤ì›€ì¦ê¶Œ","KRX"],["466690","í‚¤ì›€íˆì–´ë¡œì œ1í˜¸ìŠ¤íŒ©","KRX"],["054780","í‚¤ì´ìŠ¤íŠ¸","KRX"],["256940","í‚µìŠ¤íŒŒë§ˆ","KRX"],["336040","íƒ€ìŠ¤ì»´","KRX"],["219130","íƒ€ì´ê±°ì¼ë ‰","KRX"],["346010","íƒ€ì´ë“œ","KRX"],["318660","íƒ€ì„ê¸°ìˆ ","KRX"],["476710","íƒ€ì¡°ì´ì—”í„°í…Œì¸ë¨¼íŠ¸","KRX"],["434190","íƒˆë¡œìŠ¤","KRX"],["336680","íƒ‘ëŸ°í† íƒˆì†”ë£¨ì…˜","KRX"],["360070","íƒ‘ë¨¸í‹°ë¦¬ì–¼","KRX"],["180060","íƒ‘ì„ ","KRX"],["065130","íƒ‘ì—”ì§€ë‹ˆì–´ë§","KRX"],["134580","íƒ‘ì½”ë¯¸ë””ì–´","KRX"],["014580","íƒœê²½ë¹„ì¼€ì´","KRX"],["015890","íƒœê²½ì‚°ì—…","KRX"],["006890","íƒœê²½ì¼€ë¯¸ì»¬","KRX"],["023160","íƒœê´‘","KRX"],["003240","íƒœê´‘ì‚°ì—…","KRX"],["011280","íƒœë¦¼í¬ì¥","KRX"],["323280","íƒœì„±","KRX"],["053620","íƒœì–‘","KRX"],["052960","íƒœì–‘3C","KRX"],["004105","íƒœì–‘ê¸ˆì†ìš°","KRX"],["004100","íƒœì–‘ê¸ˆì†","KRX"],["116100","íƒœì–‘ê¸°ê³„","KRX"],["009410","íƒœì˜ê±´ì„¤","KRX"],["009415","íƒœì˜ê±´ì„¤ìš°","KRX"],["044490","íƒœì›…","KRX"],["124560","íƒœì›…ë¡œì§ìŠ¤","KRX"],["001420","íƒœì›ë¬¼ì‚°","KRX"],["191420","í…Œê³ ì‚¬ì´ì–¸ìŠ¤","KRX"],["950250","í…Œë¼ë·°","KRX"],["073640","í…Œë¼ì‚¬ì´ì–¸ìŠ¤","KRX"],["066700","í…Œë¼ì  ì´í…ìŠ¤","KRX"],["095610","í…ŒìŠ¤","KRX"],["055490","í…Œì´íŒ©ìŠ¤","KRX"],["064520","í…Œí¬ì—˜","KRX"],["089030","í…Œí¬ìœ™","KRX"],["258050","í…Œí¬íŠ¸ëœìŠ¤","KRX"],["054450","í…”ë ˆì¹©ìŠ¤","KRX"],["078000","í…”ì½”ì›¨ì–´","KRX"],["200230","í…”ì½˜RFì œì•½","KRX"],["214420","í† ë‹ˆëª¨ë¦¬","KRX"],["393210","í† ë§ˆí† ì‹œìŠ¤í…œ","KRX"],["475960","í† ëª¨íë¸Œ","KRX"],["215480","í† ë°•ìŠ¤ì½”ë¦¬ì•„","KRX"],["051360","í† ë¹„ìŠ¤","KRX"],["045340","í† íƒˆì†Œí”„íŠ¸","KRX"],["108230","í†±í…","KRX"],["079970","íˆ¬ë¹„ì†Œí”„íŠ¸","KRX"],["199800","íˆ´ì  ","KRX"],["417790","íŠ¸ë£¨ì—”","KRX"],["290090","íŠ¸ìœ”","KRX"],["026150","íŠ¹ìˆ˜ê±´ì„¤","KRX"],["464280","í‹°ë””ì—ìŠ¤íŒœ","KRX"],["117730","í‹°ë¡œë³´í‹±ìŠ¤","KRX"],["033830","í‹°ë¹„ì”¨","KRX"],["057680","í‹°ì‚¬ì´ì–¸í‹°í”½","KRX"],["204610","í‹°ì“°ë¦¬","KRX"],["125020","í‹°ì”¨ë¨¸í‹°ë¦¬ì–¼ì¦ˆ","KRX"],["064760","í‹°ì”¨ì¼€ì´","KRX"],["246710","í‹°ì•¤ì•Œë°”ì´ì˜¤íŒ¹","KRX"],["340570","í‹°ì•¤ì—˜","KRX"],["043220","í‹°ì—ìŠ¤ë„¥ìŠ¤ì  ","KRX"],["277880","í‹°ì—ìŠ¤ì•„ì´","KRX"],["131290","í‹°ì—ìŠ¤ì´","KRX"],["246690","TSì¸ë² ìŠ¤íŠ¸ë¨¼íŠ¸","KRX"],["317240","TSíŠ¸ë¦´ë¦¬ì˜¨","KRX"],["019180","í‹°ì—ì´ì¹˜ì—”","KRX"],["425420","í‹°ì—í”„ì´","KRX"],["484810","í‹°ì—‘ìŠ¤ì•Œë¡œë³´í‹±ìŠ¤","KRX"],["131100","í‹°ì—”ì—”í„°í…Œì¸ë¨¼íŠ¸","KRX"],["356860","í‹°ì—˜ë¹„","KRX"],["413300","í‹°ì—˜ì—”ì§€ë‹ˆì–´ë§","KRX"],["217590","í‹°ì— ì”¨","KRX"],["002900","TYM","KRX"],["36328K","í‹°ì™€ì´í™€ë”©ìŠ¤ìš°","KRX"],["363280","í‹°ì™€ì´í™€ë”©ìŠ¤","KRX"],["321550","í‹°ì›€ë°”ì´ì˜¤","KRX"],["091810","í‹°ì›¨ì´í•­ê³µ","KRX"],["004870","í‹°ì›¨ì´í™€ë”©ìŠ¤","KRX"],["425040","í‹°ì´ì— ì”¨","KRX"],["241790","í‹°ì´ì— ì”¨ì”¨ì—”ì—ìŠ¤","KRX"],["032540","TJë¯¸ë””ì–´","KRX"],["022220","í‹°ì¼€ì´ì§€ì• ê°•","KRX"],["069260","TKGíœ´ì¼ìŠ¤","KRX"],["104480","í‹°ì¼€ì´ì¼€ë¯¸ì¹¼","KRX"],["081150","í‹°í”Œë™ìŠ¤","KRX"],["007980","TP","KRX"],["130740","í‹°í”¼ì”¨ê¸€ë¡œë²Œ","KRX"],["048770","TPC","KRX"],["217880","í‹¸ë¡ ","KRX"],["084730","íŒ…í¬ì›¨ì–´","KRX"],["440110","íŒŒë‘","KRX"],["034230","íŒŒë¼ë‹¤ì´ìŠ¤","KRX"],["288330","íŒŒë¼íƒì‹œìŠ¤ì½”ë¦¬ì•„","KRX"],["290560","íŒŒë¼íƒì‹œìŠ¤ì´ë”ë¦¬ì›€","KRX"],["033540","íŒŒë¼í…","KRX"],["388870","íŒŒë¡œìŠ¤ì•„ì´ë°”ì´ì˜¤","KRX"],["043200","íŒŒë£¨","KRX"],["214450","íŒŒë§ˆë¦¬ì„œì¹˜","KRX"],["217950","íŒŒë§ˆë¦¬ì„œì¹˜ë°”ì´ì˜¤","KRX"],["005690","íŒŒë¯¸ì…€","KRX"],["177830","íŒŒë²„ë‚˜ì¸","KRX"],["037070","íŒŒì„¸ì½”","KRX"],["150900","íŒŒìˆ˜","KRX"],["037030","íŒŒì›Œë„·","KRX"],["047310","íŒŒì›Œë¡œì§ìŠ¤","KRX"],["368770","íŒŒì´ë²„í”„ë¡œ","KRX"],["170790","íŒŒì´ì˜¤ë§í¬","KRX"],["049120","íŒŒì¸ë””ì•¤ì”¨","KRX"],["038950","íŒŒì¸ë””ì§€í„¸","KRX"],["387570","íŒŒì¸ë©”ë”•ìŠ¤","KRX"],["441270","íŒŒì¸ì— í…","KRX"],["106240","íŒŒì¸í…Œí¬ë‹‰ìŠ¤","KRX"],["131760","íŒŒì¸í…","KRX"],["065690","íŒŒì»¤ìŠ¤","KRX"],["140860","íŒŒí¬ì‹œìŠ¤í…œìŠ¤","KRX"],["091700","íŒŒíŠ¸ë¡ ","KRX"],["202960","íŒë„ë¼í‹°ë¹„","KRX"],["032800","íŒíƒ€ì§€ì˜¤","KRX"],["318010","íŒœìŠ¤ë¹Œ","KRX"],["036580","íŒœìŠ¤ì½”","KRX"],["027710","íŒœìŠ¤í† ë¦¬","KRX"],["004720","íŒœì  ì‚¬ì´ì–¸ìŠ¤","KRX"],["266350","íŒ¡ìŠ¤ì¹´ì´","KRX"],["225590","íŒ¨ì…˜í”Œë«í¼","KRX"],["054300","íŒ¬ìŠ¤íƒ€ì—”í„°í”„ë¼ì´ì¦ˆ","KRX"],["068050","íŒ¬ì—”í„°í…Œì¸ë¨¼íŠ¸","KRX"],["028670","íŒ¬ì˜¤ì…˜","KRX"],["222110","íŒ¬ì  ","KRX"],["271830","íŒ¸í…","KRX"],["010820","í¼ìŠ¤í…","KRX"],["016800","í¼ì‹œìŠ¤","KRX"],["263750","í„ì–´ë¹„ìŠ¤","KRX"],["251970","íŒí…ì½”ë¦¬ì•„","KRX"],["0015S0","í˜ìŠ¤ì¹´ë¡œ","KRX"],["001020","í˜ì´í¼ì½”ë¦¬ì•„","KRX"],["327610","í¨í† ë°”ì´ì˜¤ë©”ë“œ","KRX"],["168360","í¨íŠ¸ë¡ ","KRX"],["087010","í©íŠ¸ë¡ ","KRX"],["090080","í‰í™”ì‚°ì—…","KRX"],["010770","í‰í™”í™€ë”©ìŠ¤","KRX"],["064800","í¬ë‹ˆë§í¬","KRX"],["119500","í¬ë©”íƒˆ","KRX"],["389140","í¬ë°”ì´í¬","KRX"],["105760","í¬ìŠ¤ë±…í¬","KRX"],["022100","í¬ìŠ¤ì½”DX","KRX"],["058430","í¬ìŠ¤ì½”ìŠ¤í‹¸ë¦¬ì˜¨","KRX"],["047050","í¬ìŠ¤ì½”ì¸í„°ë‚´ì…”ë„","KRX"],["003670","í¬ìŠ¤ì½”í“¨ì²˜ì— ","KRX"],["005490","POSCOí™€ë”©ìŠ¤","KRX"],["189690","í¬ì‹œì—ìŠ¤","KRX"],["318020","í¬ì¸íŠ¸ëª¨ë°”ì¼","KRX"],["256630","í¬ì¸íŠ¸ì—”ì§€ë‹ˆì–´ë§","KRX"],["331380","í¬ì»¤ìŠ¤ì—ì´ì•„ì´","KRX"],["208710","í¬í†¤","KRX"],["472850","í°ë“œê·¸ë£¹","KRX"],["234100","í´ë¼ë¦¬ìŠ¤ì„¸ì›","KRX"],["039980","í´ë¼ë¦¬ìŠ¤AI","KRX"],["041910","í´ë¼ë¦¬ìŠ¤AIíŒŒë§ˆ","KRX"],["041020","í´ë¼ë¦¬ìŠ¤ì˜¤í”¼ìŠ¤","KRX"],["114630","í´ë¼ë¦¬ìŠ¤ìš°ë…¸","KRX"],["290720","í‘¸ë“œë‚˜ë¬´","KRX"],["005670","í‘¸ë“œì›°","KRX"],["094940","í‘¸ë¥¸ê¸°ìˆ ","KRX"],["007330","í‘¸ë¥¸ì €ì¶•ì€í–‰","KRX"],["017810","í’€ë¬´ì›","KRX"],["093380","í’ê°•","KRX"],["023900","í’êµ­ì£¼ì •","KRX"],["103140","í’ì‚°","KRX"],["005810","í’ì‚°í™€ë”©ìŠ¤","KRX"],["371950","í’ì›ì •ë°€","KRX"],["370090","í“¨ëŸ°í‹°ì–´","KRX"],["445180","í“¨ë¦¿","KRX"],["341170","í“¨ì³ë©”ë””ì‹ ","KRX"],["220100","í“¨ì³ì¼","KRX"],["035200","í”„ëŸ¼íŒŒìŠ¤íŠ¸","KRX"],["334970","í”„ë ˆìŠ¤í‹°ì§€ë°”ì´ì˜¤ë¡œì§ìŠ¤","KRX"],["950210","í”„ë ˆìŠ¤í‹°ì§€ë°”ì´ì˜¤íŒŒë§ˆ","KRX"],["227100","í”„ë¡œë¸Œì‡","KRX"],["321260","í”„ë¡œì´ì²œ","KRX"],["296160","í”„ë¡œì  ","KRX"],["053610","í”„ë¡œí…","KRX"],["468530","í”„ë¡œí‹°ë‚˜","KRX"],["303360","í”„ë¡œí‹°ì•„","KRX"],["377220","í”„ë¡¬ë°”ì´ì˜¤","KRX"],["335810","í”„ë¦¬ì‹œì ¼ë°”ì´ì˜¤","KRX"],["053160","í”„ë¦¬ì— ìŠ¤","KRX"],["405000","í”Œë¼ì¦ˆë§µ","KRX"],["041590","í”Œë˜ìŠ¤í¬","KRX"],["367000","í”Œë˜í‹°ì–´","KRX"],["075130","í”Œëœí‹°ë„·","KRX"],["222670","í”ŒëŸ¼ë¼ì¸ìƒëª…ê³¼í•™","KRX"],["009810","í”Œë ˆì´ê·¸ë¨","KRX"],["237820","í”Œë ˆì´ë””","KRX"],["023770","í”Œë ˆì´ìœ„ë“œ","KRX"],["019570","í”Œë£¨í† ìŠ¤","KRX"],["300080","í”Œë¦¬í† ","KRX"],["033790","í”¼ë…¸","KRX"],["032580","í”¼ë¸ë¦­ìŠ¤","KRX"],["051380","í”¼ì”¨ë””ë ‰íŠ¸","KRX"],["241820","í”¼ì”¨ì—˜","KRX"],["452450","í”¼ì•„ì´ì´","KRX"],["178920","PIì²¨ë‹¨ì†Œì¬","KRX"],["237750","í”¼ì•¤ì”¨í…Œí¬","KRX"],["460940","í”¼ì•¤ì—ìŠ¤ë¡œë³´í‹±ìŠ¤","KRX"],["332570","PSì¼ë ‰íŠ¸ë¡œë‹‰ìŠ¤","KRX"],["319660","í”¼ì—ìŠ¤ì¼€ì´","KRX"],["031980","í”¼ì—ìŠ¤ì¼€ì´í™€ë”©ìŠ¤","KRX"],["002230","í”¼ì—ìŠ¤í…","KRX"],["043370","í”¼ì—ì´ì¹˜ì—ì´","KRX"],["239890","í”¼ì—”ì—ì´ì¹˜í…Œí¬","KRX"],["347740","í”¼ì—”ì¼€ì´í”¼ë¶€ì„ìƒì—°êµ¬ì„¼íƒ€","KRX"],["137400","í”¼ì—”í‹°","KRX"],["257370","í”¼ì—”í‹°ì— ì—ìŠ¤","KRX"],["024940","PNí’ë…„","KRX"],["147760","í”¼ì— í‹°","KRX"],["128660","í”¼ì œì´ë©”íƒˆ","KRX"],["006140","í”¼ì œì´ì „ì","KRX"],["001340","PKC","KRX"],["376180","í”¼ì½”ê·¸ë¨","KRX"],["304840","í”¼í”Œë°”ì´ì˜¤","KRX"],["087600","í”½ì…€í”ŒëŸ¬ìŠ¤","KRX"],["291810","í•€í…”","KRX"],["378340","í•„ì—ë„ˆì§€","KRX"],["161580","í•„ì˜µí‹±ìŠ¤","KRX"],["347770","í•ŒìŠ¤","KRX"],["163730","í•‘ê±°","KRX"],["417180","í•‘ê±°ìŠ¤í† ë¦¬","KRX"],["469880","í•˜ë‚˜30í˜¸ìŠ¤íŒ©","KRX"],["469900","í•˜ë‚˜31í˜¸ìŠ¤íŒ©","KRX"],["475240","í•˜ë‚˜32í˜¸ìŠ¤íŒ©","KRX"],["475250","í•˜ë‚˜33í˜¸ìŠ¤íŒ©","KRX"],["484130","í•˜ë‚˜34í˜¸ìŠ¤íŒ©","KRX"],["0041L0","í•˜ë‚˜35í˜¸ìŠ¤íŒ©","KRX"],["0101C0","í•˜ë‚˜36í˜¸ìŠ¤íŒ©","KRX"],["086790","í•˜ë‚˜ê¸ˆìœµì§€ì£¼","KRX"],["299030","í•˜ë‚˜ê¸°ìˆ ","KRX"],["067310","í•˜ë‚˜ë§ˆì´í¬ë¡ ","KRX"],["166090","í•˜ë‚˜ë¨¸í‹°ë¦¬ì–¼ì¦ˆ","KRX"],["293480","í•˜ë‚˜ì œì•½","KRX"],["039130","í•˜ë‚˜íˆ¬ì–´","KRX"],["136480","í•˜ë¦¼","KRX"],["003380","í•˜ë¦¼ì§€ì£¼","KRX"],["450330","í•˜ìŠ¤","KRX"],["101670","í•˜ì´ë“œë¡œë¦¬íŠ¬","KRX"],["365590","í•˜ì´ë”¥","KRX"],["149980","í•˜ì´ë¡œë‹‰","KRX"],["013030","í•˜ì´ë¡ì½”ë¦¬ì•„","KRX"],["352820","í•˜ì´ë¸Œ","KRX"],["126700","í•˜ì´ë¹„ì ¼ì‹œìŠ¤í…œ","KRX"],["071090","í•˜ì´ìŠ¤í‹¸","KRX"],["160190","í•˜ì´ì  ì•Œì•¤ì— ","KRX"],["221840","í•˜ì´ì¦ˆí•­ê³µ","KRX"],["106190","í•˜ì´í…íŒœ","KRX"],["000087","í•˜ì´íŠ¸ì§„ë¡œ2ìš°B","KRX"],["000080","í•˜ì´íŠ¸ì§„ë¡œ","KRX"],["000145","í•˜ì´íŠ¸ì§„ë¡œí™€ë”©ìŠ¤ìš°","KRX"],["000140","í•˜ì´íŠ¸ì§„ë¡œí™€ë”©ìŠ¤","KRX"],["065650","í•˜ì´í¼ì½”í¼ë ˆì´ì…˜","KRX"],["066130","í•˜ì¸ ","KRX"],["004590","í•œêµ­ê°€êµ¬","KRX"],["036460","í•œêµ­ê°€ìŠ¤ê³µì‚¬","KRX"],["039340","í•œêµ­ê²½ì œTV","KRX"],["005430","í•œêµ­ê³µí•­","KRX"],["034950","í•œêµ­ê¸°ì—…í‰ê°€","KRX"],["010040","í•œêµ­ë‚´í™”","KRX"],["025540","í•œêµ­ë‹¨ì","KRX"],["222980","í•œêµ­ë§¥ë„í‹°","KRX"],["010100","í•œêµ­ë¬´ë¸Œë„¥ìŠ¤","KRX"],["331660","í•œêµ­ë¯¸ë¼í´í”¼í”Œì‚¬","KRX"],["256840","í•œêµ­ë¹„ì—”ì”¨","KRX"],["219750","í•œêµ­ë¹„í‹°ë¹„","KRX"],["004090","í•œêµ­ì„ìœ ","KRX"],["025550","í•œêµ­ì„ ì¬","KRX"],["002200","í•œêµ­ìˆ˜ì¶œí¬ì¥","KRX"],["002960","í•œêµ­ì‰˜ì„ìœ ","KRX"],["017890","í•œêµ­ì•Œì½œ","KRX"],["000240","í•œêµ­ì•¤ì»´í¼ë‹ˆ","KRX"],["033270","ìœ ë‚˜ì´í‹°ë“œì œì•½","KRX"],["080720","í•œêµ­ìœ ë‹ˆì˜¨ì œì•½","KRX"],["123890","í•œêµ­ìì‚°ì‹ íƒ","KRX"],["015760","í•œêµ­ì „ë ¥","KRX"],["052690","í•œì „ê¸°ìˆ ","KRX"],["041460","í•œêµ­ì „ìì¸ì¦","KRX"],["006200","í•œêµ­ì „ìí™€ë”©ìŠ¤","KRX"],["101680","í•œêµ­ì •ë°€ê¸°ê³„","KRX"],["039740","í•œêµ­ì •ë³´ê³µí•™","KRX"],["053300","í•œêµ­ì •ë³´ì¸ì¦","KRX"],["025770","í•œêµ­ì •ë³´í†µì‹ ","KRX"],["458610","í•œêµ­ì œ12í˜¸ìŠ¤íŒ©","KRX"],["464440","í•œêµ­ì œ13í˜¸ìŠ¤íŒ©","KRX"],["479880","í•œêµ­ì œ15í˜¸ìŠ¤íŒ©","KRX"],["027970","í•œêµ­ì œì§€","KRX"],["023350","í•œêµ­ì¢…í•©ê¸°ìˆ ","KRX"],["025890","í•œêµ­ì£¼ê°•","KRX"],["000970","í•œêµ­ì£¼ì² ê´€","KRX"],["104700","í•œêµ­ì² ê°•","KRX"],["062970","í•œêµ­ì²¨ë‹¨ì†Œì¬","KRX"],["017960","í•œêµ­ì¹´ë³¸","KRX"],["023760","í•œêµ­ìºí”¼íƒˆ","KRX"],["054040","í•œêµ­ì»´í“¨í„°","KRX"],["161890","í•œêµ­ì½œë§ˆ","KRX"],["021650","í•œêµ­íë¹…","KRX"],["161390","í•œêµ­íƒ€ì´ì–´ì•¤í…Œí¬ë†€ë¡œì§€","KRX"],["034830","í•œêµ­í† ì§€ì‹ íƒ","KRX"],["152550","í•œêµ­ANKORìœ ì „","KRX"],["071055","í•œêµ­ê¸ˆìœµì§€ì£¼ìš°","KRX"],["071050","í•œêµ­ê¸ˆìœµì§€ì£¼","KRX"],["007280","í•œêµ­íŠ¹ê°•","KRX"],["032300","í•œêµ­íŒŒë§ˆ","KRX"],["037230","í•œêµ­íŒ©í‚¤ì§€","KRX"],["448900","í•œêµ­í”¼ì•„ì´ì— ","KRX"],["047810","í•œêµ­í•­ê³µìš°ì£¼","KRX"],["123690","í•œêµ­í™”ì¥í’ˆ","KRX"],["003350","í•œêµ­í™”ì¥í’ˆì œì¡°","KRX"],["030520","í•œê¸€ê³¼ì»´í“¨í„°","KRX"],["052600","í•œë„¤íŠ¸","KRX"],["011500","í•œë†í™”ì„±","KRX"],["002390","í•œë…","KRX"],["256150","í•œë…í¬ë¦°í…","KRX"],["092460","í•œë¼IMS","KRX"],["125490","í•œë¼ìºìŠ¤íŠ¸","KRX"],["053690","í•œë¯¸ê¸€ë¡œë²Œ","KRX"],["042700","í•œë¯¸ë°˜ë„ì²´","KRX"],["008930","í•œë¯¸ì‚¬ì´ì–¸ìŠ¤","KRX"],["128940","í•œë¯¸ì•½í’ˆ","KRX"],["452190","í•œë¹›ë ˆì´ì €","KRX"],["047080","í•œë¹›ì†Œí”„íŠ¸","KRX"],["009240","í•œìƒ˜","KRX"],["452280","í•œì„ ì—”ì§€ë‹ˆì–´ë§","KRX"],["020000","í•œì„¬","KRX"],["003680","í•œì„±ê¸°ì—…","KRX"],["066980","í•œì„±í¬ë¦°í…","KRX"],["105630","í•œì„¸ì‹¤ì—…","KRX"],["069640","í•œì„¸ì— ì¼€ì´","KRX"],["016450","í•œì„¸ì˜ˆìŠ¤24í™€ë”©ìŠ¤","KRX"],["009180","í•œì†”ë¡œì§€ìŠ¤í‹±ìŠ¤","KRX"],["114810","í•œì†”ì•„ì´ì›ìŠ¤","KRX"],["070590","í•œì†”ì¸í‹°íë¸Œ","KRX"],["213500","í•œì†”ì œì§€","KRX"],["014680","í•œì†”ì¼€ë¯¸ì¹¼","KRX"],["004710","í•œì†”í…Œí¬ë‹‰ìŠ¤","KRX"],["004150","í•œì†”í™€ë”©ìŠ¤","KRX"],["025750","í•œì†”í™ˆë°ì½”","KRX"],["042520","í•œìŠ¤ë°”ì´ì˜¤ë©”ë“œ","KRX"],["004960","í•œì‹ ê³µì˜","KRX"],["011700","í•œì‹ ê¸°ê³„","KRX"],["430690","í•œì‹¹","KRX"],["078350","í•œì–‘ë””ì§€í…","KRX"],["045100","í•œì–‘ì´ì—”ì§€","KRX"],["001755","í•œì–‘ì¦ê¶Œìš°","KRX"],["001750","í•œì–‘ì¦ê¶Œ","KRX"],["018880","í•œì˜¨ì‹œìŠ¤í…œ","KRX"],["009420","í•œì˜¬ë°”ì´ì˜¤íŒŒë§ˆ","KRX"],["320000","í•œìš¸ë°˜ë„ì²´","KRX"],["091440","í•œìš¸ì†Œì¬ê³¼í•™","KRX"],["276730","í•œìš¸ì•¤ì œì£¼","KRX"],["014130","í•œìµìŠ¤í”„ë ˆìŠ¤","KRX"],["024740","í•œì¼ë‹¨ì¡°","KRX"],["005860","í•œì¼ì‚¬ë£Œ","KRX"],["300720","í•œì¼ì‹œë©˜íŠ¸","KRX"],["002220","í•œì¼ì² ê°•","KRX"],["003300","í•œì¼í™€ë”©ìŠ¤","KRX"],["007770","í•œì¼í™”í•™","KRX"],["051600","í•œì „KPS","KRX"],["130660","í•œì „ì‚°ì—…","KRX"],["198940","í•œì£¼ë¼ì´íŠ¸ë©”íƒˆ","KRX"],["058450","í•œì£¼ì—ì´ì•Œí‹°","KRX"],["107640","í•œì¤‘ì—”ì‹œì—ìŠ¤","KRX"],["002320","í•œì§„","KRX"],["003480","í•œì§„ì¤‘ê³µì—…í™€ë”©ìŠ¤","KRX"],["18064K","í•œì§„ì¹¼ìš°","KRX"],["180640","í•œì§„ì¹¼","KRX"],["005110","í•œì°½","KRX"],["079170","í•œì°½ì‚°ì—…","KRX"],["009460","í•œì°½ì œì§€","KRX"],["372910","í•œì»´ë¼ì´í”„ì¼€ì–´","KRX"],["054920","í•œì»´ìœ„ë“œ","KRX"],["457370","í•œì¼","KRX"],["002680","í•œíƒ‘","KRX"],["098070","í•œí…","KRX"],["00088K","í•œí™”3ìš°B","KRX"],["45226K","í•œí™”ê°¤ëŸ¬ë¦¬ì•„ìš°","KRX"],["452260","í•œí™”ê°¤ëŸ¬ë¦¬ì•„","KRX"],["451800","í•œí™”ë¦¬ì¸ ","KRX"],["000880","í•œí™”","KRX"],["489790","í•œí™”ë¹„ì „","KRX"],["088350","í•œí™”ìƒëª…","KRX"],["000370","í•œí™”ì†í•´ë³´í—˜","KRX"],["009835","í•œí™”ì†”ë£¨ì…˜ìš°","KRX"],["009830","í•œí™”ì†”ë£¨ì…˜","KRX"],["272210","í•œí™”ì‹œìŠ¤í…œ","KRX"],["012450","í•œí™”ì—ì–´ë¡œìŠ¤í˜ì´ìŠ¤","KRX"],["082740","í•œí™”ì—”ì§„","KRX"],["042660","í•œí™”ì˜¤ì…˜","KRX"],["003535","í•œí™”íˆ¬ìì¦ê¶Œìš°","KRX"],["003530","í•œí™”íˆ¬ìì¦ê¶Œ","KRX"],["455310","í•œí™”í”ŒëŸ¬ìŠ¤ì œ4í˜¸ìŠ¤íŒ©","KRX"],["498390","í•œí™”í”ŒëŸ¬ìŠ¤ì œ5í˜¸ìŠ¤íŒ©","KRX"],["195870","í•´ì„±ë””ì—ìŠ¤","KRX"],["034810","í•´ì„±ì‚°ì—…","KRX"],["03481K","í•´ì„±ì‚°ì—…1ìš°","KRX"],["059270","í•´ì„±ì—ì–´ë¡œë³´í‹±ìŠ¤","KRX"],["076610","í•´ì„±ì˜µí‹±ìŠ¤","KRX"],["101530","í•´íƒœì œê³¼ì‹í’ˆ","KRX"],["220180","í•¸ë””ì†Œí”„íŠ¸","KRX"],["143210","í•¸ì¦ˆì½”í¼ë ˆì´ì…˜","KRX"],["900270","í—ì…©ê·¸ë£¹","KRX"],["214180","í—¥í† ì´ë…¸ë² ì´ì…˜","KRX"],["234340","í—¥í† íŒŒì´ë‚¸ì…œ","KRX"],["084990","í—¬ë¦­ìŠ¤ë¯¸ìŠ¤","KRX"],["000725","í˜„ëŒ€ê±´ì„¤ìš°","KRX"],["000720","í˜„ëŒ€ê±´ì„¤","KRX"],["170030","í˜„ëŒ€ê³µì—…","KRX"],["453340","í˜„ëŒ€ê·¸ë¦°í‘¸ë“œ","KRX"],["086280","í˜„ëŒ€ê¸€ë¡œë¹„ìŠ¤","KRX"],["064350","í˜„ëŒ€ë¡œí…œ","KRX"],["079430","í˜„ëŒ€ë¦¬ë°”íŠ¸","KRX"],["012330","í˜„ëŒ€ëª¨ë¹„ìŠ¤","KRX"],["319400","í˜„ëŒ€ë¬´ë²¡ìŠ¤","KRX"],["052260","í˜„ëŒ€ë°”ì´ì˜¤ëœë“œ","KRX"],["048410","í˜„ëŒ€ë°”ì´ì˜¤","KRX"],["069960","í˜„ëŒ€ë°±í™”ì ","KRX"],["004560","í˜„ëŒ€ë¹„ì•¤ì§€ìŠ¤í‹¸","KRX"],["016790","í˜„ëŒ€ì‚¬ë£Œ","KRX"],["004310","í˜„ëŒ€ì•½í’ˆ","KRX"],["041440","í˜„ëŒ€ì—ë²„ë‹¤ì„","KRX"],["187660","í˜„ëŒ€ADM","KRX"],["039010","í˜„ëŒ€ì—ì´ì¹˜í‹°","KRX"],["017800","í˜„ëŒ€ì—˜ë¦¬ë² ì´í„°","KRX"],["307950","í˜„ëŒ€ì˜¤í† ì—ë²„","KRX"],["011210","í˜„ëŒ€ìœ„ì•„","KRX"],["090850","í˜„ëŒ€ì´ì§€ì›°","KRX"],["005385","í˜„ëŒ€ì°¨ìš°","KRX"],["005387","í˜„ëŒ€ì°¨2ìš°B","KRX"],["005389","í˜„ëŒ€ì°¨3ìš°B","KRX"],["005380","í˜„ëŒ€ì°¨","KRX"],["004020","í˜„ëŒ€ì œì² ","KRX"],["005440","í˜„ëŒ€ì§€ì—í”„í™€ë”©ìŠ¤","KRX"],["001500","í˜„ëŒ€ì°¨ì¦ê¶Œ","KRX"],["011760","í˜„ëŒ€ì½”í¼ë ˆì´ì…˜","KRX"],["227840","í˜„ëŒ€ì½”í¼ë ˆì´ì…˜í™€ë”©ìŠ¤","KRX"],["126560","í˜„ëŒ€í“¨ì²˜ë„·","KRX"],["001450","í˜„ëŒ€í•´ìƒ","KRX"],["057050","í˜„ëŒ€í™ˆì‡¼í•‘","KRX"],["460930","í˜„ëŒ€í˜ìŠ¤","KRX"],["092300","í˜„ìš°ì‚°ì—…","KRX"],["308100","í˜•ì§€ê¸€ë¡œë²Œ","KRX"],["011080","í˜•ì§€I&C","KRX"],["093240","í˜•ì§€ì—˜ë¦¬íŠ¸","KRX"],["003010","í˜œì¸","KRX"],["111110","í˜¸ì „ì‹¤ì—…","KRX"],["008775","í˜¸í…”ì‹ ë¼ìš°","KRX"],["008770","í˜¸í…”ì‹ ë¼","KRX"],["064240","í™ˆìºìŠ¤íŠ¸","KRX"],["039610","í™”ì„±ë°¸ë¸Œ","KRX"],["378850","í™”ìŠ¹ì•Œì•¤ì—ì´","KRX"],["241590","í™”ìŠ¹ì—”í„°í”„ë¼ì´ì¦ˆ","KRX"],["006060","í™”ìŠ¹ì¸ë”","KRX"],["013520","í™”ìŠ¹ì½”í¼ë ˆì´ì…˜","KRX"],["010690","í™”ì‹ ","KRX"],["126640","í™”ì‹ ì •ê³µ","KRX"],["133820","í™”ì¸ë² ìŠ¤í‹¸","KRX"],["127980","í™”ì¸ì¨í‚¤íŠ¸","KRX"],["061250","í™”ì¼ì•½í’ˆ","KRX"],["010660","í™”ì²œê¸°ê³„","KRX"],["000850","í™”ì²œê¸°ê³µ","KRX"],["016580","í™˜ì¸ì œì•½","KRX"],["032560","í™©ê¸ˆì—ìŠ¤í‹°","KRX"],["004800","íš¨ì„±","KRX"],["094280","íš¨ì„±ITX","KRX"],["097870","íš¨ì„±ì˜¤ì•¤ë¹„","KRX"],["298040","íš¨ì„±ì¤‘ê³µì—…","KRX"],["298020","íš¨ì„±í‹°ì•¤ì”¨","KRX"],["298000","íš¨ì„±í™”í•™","KRX"],["093370","í›„ì„±","KRX"],["290270","íœ´ë„¤ì‹œì˜¨","KRX"],["005870","íœ´ë‹ˆë“œ","KRX"],["353190","íœ´ëŸ¼","KRX"],["090710","íœ´ë¦¼ë¡œë´‡","KRX"],["078590","íœ´ë¦¼ì—ì´í…","KRX"],["205470","íœ´ë§ˆì‹œìŠ¤","KRX"],["115160","íœ´ë§¥ìŠ¤","KRX"],["028080","íœ´ë§¥ìŠ¤í™€ë”©ìŠ¤","KRX"],["175140","íœ´ë¨¼í…Œí¬ë†€ë¡œì§€","KRX"],["200670","íœ´ë©”ë”•ìŠ¤","KRX"],["079980","íœ´ë¹„ìŠ¤","KRX"],["065510","íœ´ë¹„ì¸ ","KRX"],["005010","íœ´ìŠ¤í‹¸","KRX"],["263920","íœ´ì— ì•¤ì”¨","KRX"],["243070","íœ´ì˜¨ìŠ¤","KRX"],["084110","íœ´ì˜¨ìŠ¤ê¸€ë¡œë²Œ","KRX"],["145020","íœ´ì ¤","KRX"],["024060","í¥êµ¬ì„ìœ ","KRX"],["010240","í¥êµ­","KRX"],["189980","í¥êµ­ì—í”„ì—”ë¹„","KRX"],["000545","í¥êµ­í™”ì¬ìš°","KRX"],["000540","í¥êµ­í™”ì¬","KRX"],["003280","í¥ì•„í•´ìš´","KRX"],["037440","í¬ë¦¼","KRX"],["238490","í˜ìŠ¤","KRX"],["AAPL","Apple","US"],["MSFT","Microsoft","US"],["GOOGL","Alphabet A","US"],["GOOG","Alphabet C","US"],["AMZN","Amazon","US"],["NVDA","NVIDIA","US"],["META","Meta Platforms","US"],["TSLA","Tesla","US"],["NFLX","Netflix","US"],["ORCL","Oracle","US"],["CRM","Salesforce","US"],["ADBE","Adobe","US"],["INTC","Intel","US"],["AMD","AMD","US"],["QCOM","Qualcomm","US"],["AVGO","Broadcom","US"],["TXN","Texas Instruments","US"],["MU","Micron","US"],["AMAT","Applied Materials","US"],["LRCX","Lam Research","US"],["KLAC","KLA Corp","US"],["MRVL","Marvell Tech","US"],["ASML","ASML","US"],["TSM","TSMC","US"],["ARM","ARM Holdings","US"],["SMCI","Super Micro","US"],["JPM","JPMorgan","US"],["BAC","Bank of America","US"],["WFC","Wells Fargo","US"],["GS","Goldman Sachs","US"],["MS","Morgan Stanley","US"],["BRK.B","Berkshire Hathaway B","US"],["BRK.A","Berkshire Hathaway A","US"],["V","Visa","US"],["MA","Mastercard","US"],["PYPL","PayPal","US"],["AXP","American Express","US"],["C","Citigroup","US"],["USB","U.S. Bancorp","US"],["BK","Bank of NY Mellon","US"],["SCHW","Charles Schwab","US"],["COF","Capital One","US"],["DFS","Discover Financial","US"],["JNJ","Johnson & Johnson","US"],["UNH","UnitedHealth","US"],["PFE","Pfizer","US"],["ABBV","AbbVie","US"],["MRK","Merck","US"],["LLY","Eli Lilly","US"],["BMY","Bristol-Myers Squibb","US"],["AMGN","Amgen","US"],["GILD","Gilead","US"],["ISRG","Intuitive Surgical","US"],["REGN","Regeneron","US"],["VRTX","Vertex Pharma","US"],["MRNA","Moderna","US"],["BIIB","Biogen","US"],["ZTS","Zoetis","US"],["CVS","CVS Health","US"],["CI","Cigna","US"],["HUM","Humana","US"],["WMT","Walmart","US"],["TGT","Target","US"],["COST","Costco","US"],["HD","Home Depot","US"],["LOW","Lowe's","US"],["MCD","McDonald's","US"],["SBUX","Starbucks","US"],["NKE","Nike","US"],["PG","Procter & Gamble","US"],["KO","Coca-Cola","US"],["PEP","PepsiCo","US"],["PM","Philip Morris","US"],["MO","Altria","US"],["EL","Estee Lauder","US"],["CL","Colgate-Palmolive","US"],["GIS","General Mills","US"],["K","Kellogg","US"],["HSY","Hershey","US"],["YUM","Yum Brands","US"],["CMG","Chipotle","US"],["DPZ","Domino's","US"],["XOM","ExxonMobil","US"],["CVX","Chevron","US"],["COP","ConocoPhillips","US"],["EOG","EOG Resources","US"],["SLB","Schlumberger","US"],["MPC","Marathon Petroleum","US"],["VLO","Valero Energy","US"],["PSX","Phillips 66","US"],["OXY","Occidental","US"],["CAT","Caterpillar","US"],["BA","Boeing","US"],["GE","GE Aerospace","US"],["MMM","3M","US"],["HON","Honeywell","US"],["RTX","RTX Corp","US"],["LMT","Lockheed Martin","US"],["NOC","Northrop Grumman","US"],["GD","General Dynamics","US"],["DE","John Deere","US"],["EMR","Emerson Electric","US"],["ETN","Eaton","US"],["ITW","Illinois Tool Works","US"],["PH","Parker Hannifin","US"],["T","AT&T","US"],["VZ","Verizon","US"],["TMUS","T-Mobile","US"],["CMCSA","Comcast","US"],["CHTR","Charter Comm","US"],["DIS","Disney","US"],["PARA","Paramount","US"],["WBD","Warner Bros Discovery","US"],["AMT","American Tower","US"],["PLD","Prologis","US"],["CCI","Crown Castle","US"],["EQIX","Equinix","US"],["PSA","Public Storage","US"],["SPG","Simon Property","US"],["O","Realty Income","US"],["UBER","Uber","US"],["LYFT","Lyft","US"],["ABNB","Airbnb","US"],["DASH","DoorDash","US"],["SNAP","Snap","US"],["COIN","Coinbase","US"],["HOOD","Robinhood","US"],["SQ","Block","US"],["SHOP","Shopify","US"],["SPOT","Spotify","US"],["RBLX","Roblox","US"],["U","Unity","US"],["PLTR","Palantir","US"],["RIVN","Rivian","US"],["LCID","Lucid Motors","US"],["NIO","NIO","US"],["XPEV","XPeng","US"],["LI","Li Auto","US"],["BIDU","Baidu","US"],["BABA","Alibaba","US"],["JD","JD.com","US"],["PDD","PDD Holdings","US"],["SE","Sea Limited","US"],["GRAB","Grab","US"],["SOFI","SoFi","US"],["AFRM","Affirm","US"],["UPST","Upstart","US"],["OPEN","Opendoor","US"],["Z","Zillow","US"],["CPNG","Coupang","US"],["DKNG","DraftKings","US"],["PENN","Penn Entertainment","US"],["TWLO","Twilio","US"],["ZM","Zoom","US"],["DOCU","DocuSign","US"],["SNOW","Snowflake","US"],["DDOG","Datadog","US"],["NET","Cloudflare","US"],["MDB","MongoDB","US"],["CRWD","CrowdStrike","US"],["PANW","Palo Alto","US"],["ZS","Zscaler","US"],["OKTA","Okta","US"],["HCP","HashiCorp","US"],["NOW","ServiceNow","US"],["WDAY","Workday","US"],["TEAM","Atlassian","US"],["HUBS","HubSpot","US"],["VEEV","Veeva","US"],["ANSS","Ansys","US"],["CDNS","Cadence Design","US"],["SNPS","Synopsys","US"],["SPY","SPDR S&P500 ETF","US"],["QQQ","Invesco Nasdaq100","US"],["IWM","iShares Russell2000","US"],["VTI","Vanguard Total Market","US"],["VOO","Vanguard S&P500","US"],["VEA","Vanguard Developed","US"],["VWO","Vanguard Emerging","US"],["GLD","SPDR Gold","US"],["SLV","iShares Silver","US"],["TLT","iShares 20Y Treasury","US"],["HYG","iShares High Yield","US"],["LQD","iShares Corp Bond","US"],["ARKK","ARK Innovation","US"],["ARKQ","ARK Autonomous","US"],["SOXL","Direxion Semi 3x","US"],["TQQQ","ProShares Nasdaq 3x","US"],["SPXL","Direxion S&P 3x","US"],["UVXY","ProShares VIX","US"],["SQQQ","ProShares Nasdaq -3x","US"],["SPXS","Direxion S&P -3x","US"],["JEPI","JPMorgan Income ETF","US"],["SCHD","Schwab Dividend ETF","US"],["VIG","Vanguard Dividend","US"],["VYM","Vanguard High Div","US"],["XLK","Tech Select SPDR","US"],["XLF","Finance Select SPDR","US"],["XLE","Energy Select SPDR","US"],["XLV","Health Select SPDR","US"],["XLI","Industrial Select SPDR","US"]];

let _acDropdown = null;
let _acActiveIdx = -1;

function stockSearch(query) {
  if (!query || query.length < 1) return [];
  const q = query.toLowerCase().replace(/\s/g,'');
  const results = [];
  for (const [code, name, mkt] of STOCK_DB) {
    const codeL = code.toLowerCase();
    const nameL = name.toLowerCase().replace(/\s/g,'');
    if (codeL.startsWith(q) || nameL.includes(q)) {
      results.push({ code, name, mkt });
      if (results.length >= 10) break;
    }
  }
  return results;
}

function showStockDropdown(inputEl, onSelect) {
  closeStockDropdown();
  const results = stockSearch(inputEl.value);
  if (!results.length) return;

  _acActiveIdx = -1;
  const dd = document.createElement('div');
  dd.className = 'stock-dropdown';
  dd.id = 'stock-ac-dd';

  results.forEach((s, i) => {
    const item = document.createElement('div');
    item.className = 'stock-item';
    item.innerHTML = `<span class="code">${s.code}</span><span class="name">${s.name}</span><span class="mkt">${s.mkt}</span>`;
    item.addEventListener('mousedown', e => {
      e.preventDefault();
      onSelect(s);
      closeStockDropdown();
    });
    dd.appendChild(item);
  });

  // ìœ„ì¹˜ ê³„ì‚°
  const rect = inputEl.getBoundingClientRect();
  dd.style.cssText = `position:fixed;top:${rect.bottom+2}px;left:${rect.left}px;width:${Math.max(rect.width,280)}px`;
  document.body.appendChild(dd);
  _acDropdown = dd;

  // í‚¤ë³´ë“œ ë‚´ë¹„ê²Œì´ì…˜
  inputEl._acKeyHandler = e => {
    const items = dd.querySelectorAll('.stock-item');
    if (e.key === 'ArrowDown') {
      e.preventDefault();
      _acActiveIdx = Math.min(_acActiveIdx+1, items.length-1);
      items.forEach((el,i) => el.classList.toggle('active', i===_acActiveIdx));
    } else if (e.key === 'ArrowUp') {
      e.preventDefault();
      _acActiveIdx = Math.max(_acActiveIdx-1, -1);
      items.forEach((el,i) => el.classList.toggle('active', i===_acActiveIdx));
    } else if (e.key === 'Enter' && _acActiveIdx >= 0) {
      e.preventDefault();
      onSelect(results[_acActiveIdx]);
      closeStockDropdown();
    } else if (e.key === 'Escape') {
      closeStockDropdown();
    }
  };
  inputEl.addEventListener('keydown', inputEl._acKeyHandler);
}

function closeStockDropdown() {
  if (_acDropdown) { _acDropdown.remove(); _acDropdown = null; }
}

// ì™¸ë¶€ í´ë¦­ ì‹œ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
document.addEventListener('mousedown', e => {
  if (_acDropdown && !_acDropdown.contains(e.target)) closeStockDropdown();
});

// í¬ì§€ì…˜ ì¶”ê°€ ëª¨ë‹¬ â€” ì¢…ëª©ëª… ì…ë ¥ì— ìë™ì™„ì„± ì ìš©
function bindNewPosAutocomplete() {
  const nameEl = document.getElementById('np-name');
  const tickerEl = document.getElementById('np-ticker');
  const mktEl = document.getElementById('np-market');
  if (!nameEl) return;

  nameEl.addEventListener('input', () => {
    showStockDropdown(nameEl, s => {
      nameEl.value = s.name;
      if (tickerEl) tickerEl.value = s.code;
      if (mktEl) {
        if (s.mkt === 'US') mktEl.value = 'US';
        else mktEl.value = 'KRX';
        mktEl.dispatchEvent(new Event('change'));
      }
    });
  });
  nameEl.addEventListener('blur', () => setTimeout(closeStockDropdown, 150));
}

// ì¼ê´„ì…ë ¥ ëª¨ë‹¬ â€” ê° í–‰ ticker ì…ë ¥ì— ìë™ì™„ì„±
function bindBulkTickerAutocomplete() {
  document.querySelectorAll('[id^="btk-"]').forEach(inp => {
    inp.removeEventListener('input', inp._acHandler);
    inp._acHandler = () => {
      showStockDropdown(inp, s => {
        inp.value = s.code;
        // ì˜†ì— ì¢…ëª©ëª… íŒíŠ¸ í‘œì‹œ
        const hint = inp.closest('div')?.querySelector('.btk-name-hint');
        if (hint) hint.textContent = s.name;
      });
    };
    inp.addEventListener('input', inp._acHandler);
    inp.addEventListener('blur', () => setTimeout(closeStockDropdown, 150));
  });
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• í™ˆ ëŒ€ì‹œë³´ë“œ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderHome() {
  const el = document.getElementById('home-dashboard');
  if (!el) return;

  const holding = positions.filter(p => p.status === 'holding');
  const closed  = positions.filter(p => p.status === 'closed');
  const today   = td();
  const thisYearStart = today.slice(0,4) + '-01-01';

  // ìºì‹œ
  const cpCache = new Map();
  const cp = p => { if(!cpCache.has(p.id)) cpCache.set(p.id, calcPos(p)); return cpCache.get(p.id); };

  // ì§€í‘œ
  const totalInv     = holding.reduce((s,p) => s + cp(p).invested, 0);
  const totalUnreal  = holding.reduce((s,p) => s + (p.currency!=='USD'?cp(p).unrealPnL:0), 0);
  const totalReal    = closed.reduce((s,p)  => s + (p.currency!=='USD'?cp(p).realPnL:0), 0);
  const yearClosed   = closed.filter(p => cp(p).last >= thisYearStart);
  const yearPnL      = yearClosed.reduce((s,p) => s + (p.currency!=='USD'?cp(p).realPnL:0), 0);
  const wr           = closed.length ? closed.filter(p=>cp(p).realPnL>0).length/closed.length*100 : 0;
  const avgR         = totalInv > 0 ? totalUnreal/totalInv*100 : 0;

  // ì˜¤ëŠ˜ ê±°ë˜
  const todayTrades = [];
  positions.forEach(pos => pos.trades.forEach(t => { if(t.date===today) todayTrades.push({t,pos}); }));
  const todaySells  = todayTrades.filter(x=>x.t.type==='sell');
  const todayPnL    = positions.filter(p=>p.status==='closed'&&cp(p).last===today)
                       .reduce((s,p)=>s+(p.currency!=='USD'?cp(p).realPnL:0),0);

  // ëª©í‘œ ë‹¬ì„±ë¥ 
  const activeGoals = goals.filter(g=>!g.done);
  const ROAD_TARGET = [5e7,1e8,2e8,5e8,2e9,8e9];
  const ROAD_LABEL  = ['5ì²œë§Œ','1ì–µ','2ì–µ','5ì–µ','20ì–µ','80ì–µ'];
  const nowYear = new Date().getFullYear();
  const roadIdx = [2025,2026,2027,2028,2029,2030].indexOf(nowYear);
  const roadTarget = roadIdx>=0 ? ROAD_TARGET[roadIdx] : 0;
  const roadPct    = roadTarget ? Math.min(100,(totalReal+totalUnreal)/roadTarget*100) : 0;

  // ìµœê·¼ ì²­ì‚° 5ê°œ
  const recentClosed = [...closed].sort((a,b)=>cp(b).last.localeCompare(cp(a).last)).slice(0,5);

  // ëª©í‘œê°€/ì†ì ˆê°€ ë„ë‹¬ ì¢…ëª©
  const tgtHit = holding.filter(p=>p.targetPrice && cp(p).cur>=p.targetPrice);
  const stpHit = holding.filter(p=>p.stopPrice   && cp(p).cur<=p.stopPrice);

  el.innerHTML = `
  <!-- ì˜¤ëŠ˜ ìš”ì•½ ë°°ë„ˆ -->
  <div style="background:linear-gradient(135deg,#0f2d6e,#1d6ff2);border-radius:14px;padding:20px 24px;margin-bottom:16px;color:#fff">
    <div style="font-size:11px;opacity:.6;letter-spacing:1.5px;text-transform:uppercase;margin-bottom:8px">TODAY Â· ${today}</div>
    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:12px">
      <div>
        <div style="font-size:13px;opacity:.7;margin-bottom:4px">ì˜¤ëŠ˜ ì‹¤í˜„ì†ìµ</div>
        <div style="font-size:28px;font-weight:800;font-family:'Roboto Mono',monospace;color:${todayPnL>=0?'#ff6b6b':'#74b9ff'}">${todayPnL>=0?'+':''}â‚©${Math.round(todayPnL).toLocaleString()}</div>
        <div style="font-size:12px;opacity:.6;margin-top:3px">ê±°ë˜ ${todayTrades.length}ê±´ Â· ë§¤ë„ ${todaySells.length}ê±´</div>
      </div>
      <div style="text-align:right">
        <div style="font-size:13px;opacity:.7;margin-bottom:4px">ì˜¬í•´ ëˆ„ì </div>
        <div style="font-size:22px;font-weight:700;font-family:'Roboto Mono',monospace;color:${yearPnL>=0?'#ff6b6b':'#74b9ff'}">${yearPnL>=0?'+':''}â‚©${Math.round(yearPnL).toLocaleString()}</div>
      </div>
    </div>
    ${roadTarget ? `
    <div style="margin-top:14px;padding-top:14px;border-top:1px solid rgba(255,255,255,.15)">
      <div style="display:flex;justify-content:space-between;font-size:11px;opacity:.7;margin-bottom:5px">
        <span>ğŸš€ ${nowYear}ë…„ ëª©í‘œ ${ROAD_LABEL[roadIdx]} ë‹¬ì„±ë¥ </span>
        <span>${roadPct.toFixed(1)}%</span>
      </div>
      <div style="background:rgba(255,255,255,.15);border-radius:4px;height:6px;overflow:hidden">
        <div style="background:var(--accent);height:100%;width:${roadPct}%;border-radius:4px;transition:width .6s"></div>
      </div>
    </div>` : ''}
  </div>

  <!-- KPI 6ê°œ -->
  <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:14px">
    ${[
      ['ë³´ìœ  í¬ì§€ì…˜', holding.length+'ê°œ', 'var(--text)'],
      ['ì´ íˆ¬ìê¸ˆ (KRW)', 'â‚©'+Math.round(totalInv).toLocaleString(), 'var(--accent)'],
      ['í‰ê°€ ì†ìµ', (totalUnreal>=0?'+':'')+'â‚©'+Math.round(totalUnreal).toLocaleString(), totalUnreal>=0?'var(--profit)':'var(--loss)'],
      ['í‰ê°€ ìˆ˜ìµë¥ ', (avgR>=0?'+':'')+avgR.toFixed(2)+'%', avgR>=0?'var(--profit)':'var(--loss)'],
      ['ëˆ„ì  ì‹¤í˜„ì†ìµ', (totalReal>=0?'+':'')+'â‚©'+Math.round(totalReal).toLocaleString(), totalReal>=0?'var(--profit)':'var(--loss)'],
      ['ì „ì²´ ìŠ¹ë¥ ', wr.toFixed(1)+'%', wr>=50?'var(--profit)':'var(--loss)'],
    ].map(([l,v,c])=>`
      <div style="background:var(--surface);border:1.5px solid var(--border);border-radius:10px;padding:13px 15px;position:relative;overflow:hidden">
        <div style="position:absolute;top:0;left:0;right:0;height:3px;background:${c};opacity:.6"></div>
        <div style="font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:.7px;margin-bottom:6px">${l}</div>
        <div style="font-family:'Roboto Mono',monospace;font-size:15px;font-weight:700;color:${c}">${v}</div>
      </div>`).join('')}
  </div>

  <!-- ì•Œë¦¼ ë°°ë„ˆ -->
  ${tgtHit.length||stpHit.length ? `
  <div style="display:flex;flex-direction:column;gap:6px;margin-bottom:14px">
    ${tgtHit.map(p=>`<div style="background:rgba(224,49,49,.08);border:1.5px solid rgba(224,49,49,.25);border-radius:9px;padding:10px 14px;display:flex;justify-content:space-between;align-items:center">
      <span style="font-size:13px;font-weight:700">ğŸ¯ ${p.name} â€” ëª©í‘œê°€ ë„ë‹¬!</span>
      <button class="btn btn-primary btn-xs" onclick="openAddTrade('${p.id}','sell')">ë§¤ë„í•˜ê¸°</button>
    </div>`).join('')}
    ${stpHit.map(p=>`<div style="background:rgba(29,111,242,.08);border:1.5px solid rgba(29,111,242,.25);border-radius:9px;padding:10px 14px;display:flex;justify-content:space-between;align-items:center">
      <span style="font-size:13px;font-weight:700">ğŸ›‘ ${p.name} â€” ì†ì ˆê°€ ë„ë‹¬!</span>
      <button class="btn btn-danger btn-xs" onclick="openAddTrade('${p.id}','sell')">ì†ì ˆí•˜ê¸°</button>
    </div>`).join('')}
  </div>` : ''}

  <div class="two-col">
    <!-- ë³´ìœ  í¬ì§€ì…˜ ìš”ì•½ -->
    <div class="section">
      <div class="sec-hdr">
        <span class="sec-title">ğŸ“Š ë³´ìœ  í¬ì§€ì…˜</span>
        <button class="btn btn-outline btn-xs" onclick="switchTab('holding')">ì „ì²´ë³´ê¸°</button>
      </div>
      <div style="padding:0 16px">
        ${holding.length ? [...holding].sort((a,b)=>Math.abs(cp(b).unrealPnL)-Math.abs(cp(a).unrealPnL)).slice(0,6).map(p=>{
          const c=cp(p); const col=c.unrealPnL>=0?'var(--profit)':'var(--loss)';
          return `<div style="display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid var(--border)">
            <div>
              <div style="font-size:13px;font-weight:600">${p.name}</div>
              <div style="font-size:11px;color:var(--muted)">í‰ê·  â‚©${Math.round(c.avgB).toLocaleString()} Â· ${c.remQ}ì£¼</div>
            </div>
            <div style="text-align:right">
              <div style="font-family:'Roboto Mono',monospace;font-size:13px;font-weight:700;color:${col}">${c.unrealPnL>=0?'+':''}â‚©${Math.round(c.unrealPnL).toLocaleString()}</div>
              <div style="font-size:11px;color:${col}">${c.unrealRate>=0?'+':''}${c.unrealRate.toFixed(2)}%</div>
            </div>
          </div>`;}).join('') + (holding.length>6?`<div style="padding:8px 0;font-size:12px;color:var(--muted);text-align:center">+${holding.length-6}ê°œ ë” ìˆìŒ</div>`:'')
        : '<div style="padding:20px 0;text-align:center;color:var(--muted);font-size:13px">ë³´ìœ  í¬ì§€ì…˜ ì—†ìŒ</div>'}
      </div>
    </div>

    <div>
      <!-- ìµœê·¼ ì²­ì‚° -->
      <div class="section" style="margin-bottom:12px">
        <div class="sec-hdr">
          <span class="sec-title">âœ… ìµœê·¼ ì²­ì‚°</span>
          <button class="btn btn-outline btn-xs" onclick="switchTab('closed')">ì „ì²´ë³´ê¸°</button>
        </div>
        <div style="padding:0 16px">
          ${recentClosed.length ? recentClosed.map(p=>{
            const c=cp(p); const col=c.realPnL>=0?'var(--profit)':'var(--loss)';
            return `<div style="display:flex;justify-content:space-between;align-items:center;padding:9px 0;border-bottom:1px solid var(--border)">
              <div>
                <div style="font-size:13px;font-weight:600">${p.name}</div>
                <div style="font-size:11px;color:var(--muted)">${c.last} Â· ${dBetween(c.first,c.last)}ì¼</div>
              </div>
              <div style="text-align:right">
                <div style="font-family:'Roboto Mono',monospace;font-size:13px;font-weight:700;color:${col}">${c.realPnL>=0?'+':''}â‚©${Math.round(c.realPnL).toLocaleString()}</div>
                <div style="font-size:11px;color:${col}">${c.realRate>=0?'+':''}${c.realRate.toFixed(2)}%</div>
              </div>
            </div>`;}).join('')
          : '<div style="padding:20px 0;text-align:center;color:var(--muted);font-size:13px">ì²­ì‚° ê¸°ë¡ ì—†ìŒ</div>'}
        </div>
      </div>

      <!-- ì§„í–‰ ì¤‘ ëª©í‘œ ìš”ì•½ -->
      ${activeGoals.length ? `
      <div class="section">
        <div class="sec-hdr">
          <span class="sec-title">ğŸ¯ ëª©í‘œ í˜„í™©</span>
          <button class="btn btn-outline btn-xs" onclick="switchTab('goals')">ì „ì²´ë³´ê¸°</button>
        </div>
        <div style="padding:12px 16px;display:flex;flex-direction:column;gap:8px">
          ${activeGoals.slice(0,3).map(g=>{
            const prog=getGoalProgress(g);
            const pct=Math.min(100,Math.max(0,prog.current/g.value*100));
            const col=pct>=100?'var(--profit)':pct>60?'var(--accent)':'var(--muted)';
            return `<div>
              <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px">
                <span style="font-weight:600;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:180px">${g.name}</span>
                <span style="font-family:'Roboto Mono',monospace;color:${col};flex-shrink:0;margin-left:8px">${pct.toFixed(0)}%</span>
              </div>
              <div style="background:var(--border);border-radius:3px;height:5px;overflow:hidden">
                <div style="background:${col};height:100%;width:${pct}%;border-radius:3px;transition:width .5s"></div>
              </div>
            </div>`;}).join('')}
        </div>
      </div>` : ''}

      <!-- ğŸ”” ë‹¤ê°€ì˜¤ëŠ” ì´ë²¤íŠ¸ ìœ„ì ¯ -->
      ${renderUpcomingEventsWidget()}
    </div>
  </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• íƒ€ì„ë¼ì¸ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• íŠ¸ë ˆì´ë”© ì €ë„ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let journals = [];   // { id, date, mood, sentiment, strategies[], title, reason, review, plan, tags[], ruleChecks{} }
const JOURNAL_KEY = 'tl-journals';
function loadJournals() { try { journals = JSON.parse(localStorage.getItem(JOURNAL_KEY)||'[]'); } catch(e){ journals=[]; } }
function saveJournals()  { localStorage.setItem(JOURNAL_KEY, JSON.stringify(journals)); }

// â”€â”€ ì›” ë„¤ë¹„ â”€â”€
function jnlPrevMonth() {
  const el = document.getElementById('jnl-month');
  if (!el.value) { el.value = td().slice(0,7); }
  const [y,m] = el.value.split('-').map(Number);
  const prev = m === 1 ? `${y-1}-12` : `${y}-${String(m-1).padStart(2,'0')}`;
  el.value = prev; renderJournal();
}
function jnlNextMonth() {
  const el = document.getElementById('jnl-month');
  if (!el.value) { el.value = td().slice(0,7); }
  const [y,m] = el.value.split('-').map(Number);
  const next = m === 12 ? `${y+1}-01` : `${y}-${String(m+1).padStart(2,'0')}`;
  el.value = next; renderJournal();
}

// â”€â”€ ì €ë„ ë Œë” â”€â”€
function renderJournal() {
  const el = document.getElementById('jnl-month');
  if (!el.value) el.value = td().slice(0,7);
  const month = el.value;

  // ì´ë‹¬ ë§¤ë§¤ ë°ì´í„°
  const [y, m] = month.split('-').map(Number);
  const monthStart = `${month}-01`;
  const monthEnd   = `${month}-${String(new Date(y,m,0).getDate()).padStart(2,'0')}`;

  const monthClosed = positions.filter(p => {
    if (p.status !== 'closed') return false;
    const c = calcPos(p);
    return c.last >= monthStart && c.last <= monthEnd;
  });
  const monthPnL  = monthClosed.reduce((s,p) => s + (p.currency!=='USD' ? calcPos(p).realPnL : 0), 0);
  const monthWins = monthClosed.filter(p => calcPos(p).realPnL > 0).length;
  const monthWR   = monthClosed.length ? monthWins / monthClosed.length * 100 : 0;

  // ì´ë‹¬ ëª¨ë“  ê±°ë˜ì¼ (ë§¤ìˆ˜/ë§¤ë„ ë‚ ì§œ)
  const tradeDates = new Set();
  positions.forEach(p => p.trades.forEach(t => {
    if (t.date >= monthStart && t.date <= monthEnd) tradeDates.add(t.date);
  }));

  // ì´ë‹¬ ì¼ì§€
  const monthJournals = journals.filter(j => j.date.startsWith(month));
  const journalDates  = new Set(monthJournals.map(j => j.date));

  // ìŠ¤íŠ¸ë¦­ ê³„ì‚° (ì˜¤ëŠ˜ ê¸°ì¤€ ì—°ì† ì‘ì„±ì¼)
  let streak = 0;
  let checkDate = new Date(td());
  while (true) {
    const ds = checkDate.toISOString().slice(0,10);
    if (journals.some(j => j.date === ds)) { streak++; checkDate.setDate(checkDate.getDate()-1); }
    else break;
    if (streak > 365) break;
  }

  // ìŠ¤íŠ¸ë¦­ ë±ƒì§€
  const streakEl = document.getElementById('jnl-streak-badge');
  if (streakEl) {
    streakEl.textContent = streak >= 2 ? `ğŸ”¥ ${streak}ì¼ ì—°ì† ì‘ì„±` : '';
  }

  // KPI ì¹´ë“œ
  const kpiEl = document.getElementById('jnl-month-kpi');
  if (kpiEl) {
    const avgPnL = monthClosed.length ? monthPnL / monthClosed.length : 0;
    kpiEl.innerHTML = [
      { label:'ì´ë‹¬ ì‹¤í˜„ì†ìµ', val: (monthPnL>=0?'+':'')+'â‚©'+Math.round(monthPnL).toLocaleString(), col: monthPnL>=0?'var(--profit)':'var(--loss)' },
      { label:'ìŠ¹/íŒ¨', val: `<span style="color:var(--profit)">${monthWins}ìŠ¹</span> / <span style="color:var(--loss)">${monthClosed.length - monthWins}íŒ¨</span>`, col:'' },
      { label:'ìŠ¹ë¥ ', val: monthClosed.length ? monthWR.toFixed(1)+'%' : '-', col: monthWR>=50?'var(--profit)':'var(--loss)' },
      { label:'ì¼ì§€ ì‘ì„±', val: journalDates.size+'ì¼', col:'var(--accent)' },
      { label:'ì—°ì† ì‘ì„±', val: streak ? streak+'ì¼ ğŸ”¥' : '-', col: streak>=5?'var(--profit)':'var(--text)' },
    ].map(k => `<div class="stat-card">
      <div class="stat-label">${k.label}</div>
      <div class="stat-value" style="color:${k.col||'var(--text)'};font-size:15px">${k.val}</div>
    </div>`).join('');
  }

  // ë‚ ì§œë³„ ê·¸ë£¹í•‘ (ì¼ì§€ + ê±°ë˜ í•©ì‚°)
  const allDates = new Set([...journalDates, ...tradeDates]);
  const sortedDates = [...allDates].sort((a,b) => b.localeCompare(a));

  const listEl = document.getElementById('journal-list');
  if (!sortedDates.length) {
    listEl.innerHTML = `<div style="background:var(--surface);border:1.5px solid var(--border);border-radius:12px;padding:40px;text-align:center;color:var(--muted)">
      <div style="font-size:36px;margin-bottom:10px">ğŸ““</div>
      <div style="font-size:14px;margin-bottom:14px">${month} ê¸°ë¡ì´ ì—†ì–´ìš”</div>
      <button class="btn btn-primary btn-sm" onclick="openJournalWrite()">âœï¸ ì˜¤ëŠ˜ ì¼ì§€ ì“°ê¸°</button>
    </div>`;
    return;
  }

  const DOW = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
  const MOOD_LABEL = { 'ğŸ˜°':'ë¶ˆì•ˆ', 'ğŸ˜':'í‰ì •', 'ğŸ˜Œ':'ì¹¨ì°©', 'ğŸ”¥':'ìì‹ ê°', 'ğŸ¤‘':'ê³¼ìš•', 'ğŸ˜¤':'ì–µìš¸' };
  const SENT_COL   = { 'ê°•ì„¸':'var(--profit)','ì•½ì„¸':'var(--loss)','í˜¼ì¡°':'var(--warn)','ê´€ë§':'var(--muted)','ê¸‰ë“±':'var(--profit)','ê¸‰ë½':'var(--loss)' };

  listEl.innerHTML = sortedDates.map(date => {
    const dow  = DOW[new Date(date).getDay()];
    const j    = monthJournals.find(x => x.date === date);

    // ê·¸ë‚  ê±°ë˜ë“¤
    const dayTrades = [];
    positions.forEach(p => {
      p.trades.filter(t => t.date === date).forEach(t => {
        dayTrades.push({ name: p.name, ticker: p.ticker, type: t.type, price: t.price, qty: t.qty, currency: p.currency });
      });
    });

    // ê·¸ë‚  ì‹¤í˜„ P&L
    const dayPnL = positions
      .filter(p => p.status === 'closed' && p.currency !== 'USD')
      .reduce((s,p) => {
        const c = calcPos(p);
        if (c.last !== date) return s;
        return s + c.realPnL;
      }, 0);

    const hasPnL    = dayPnL !== 0;
    const cardClass = hasPnL ? (dayPnL>=0 ? 'journal-day-card has-profit' : 'journal-day-card has-loss') : 'journal-day-card';
    const pnlHTML   = hasPnL
      ? `<span class="jcard-pnl" style="color:${dayPnL>=0?'var(--profit)':'var(--loss)'}">${dayPnL>=0?'+':''}â‚©${Math.round(dayPnL).toLocaleString()}</span>`
      : '';

    // ê±°ë˜ ëª©ë¡ HTML
    const tradesHTML = dayTrades.length ? `
      <div class="jcard-section">
        <div class="jcard-sec-label">ë§¤ë§¤ ë‚´ì—­</div>
        ${dayTrades.map(t => `
          <div class="jcard-trade-row">
            <span style="font-size:10px;padding:2px 7px;border-radius:3px;font-weight:700;${t.type==='buy'?'background:rgba(248,81,73,.12);color:var(--loss)':'background:rgba(29,111,242,.12);color:var(--accent)'}">${t.type==='buy'?'ë§¤ìˆ˜':'ë§¤ë„'}</span>
            <span style="font-size:12px;font-weight:600;flex:1">${t.name}${t.ticker?` <span style="font-size:10px;color:var(--muted)">${t.ticker}</span>`:''}</span>
            <span style="font-family:'Roboto Mono',monospace;font-size:11px;color:var(--muted)">${t.currency==='USD'?'$'+t.price.toFixed(2):'â‚©'+Math.round(t.price).toLocaleString()} Ã— ${t.qty}ì£¼</span>
          </div>`).join('')}
      </div>` : '';

    if (!j) {
      // ê±°ë˜ëŠ” ìˆì§€ë§Œ ì¼ì§€ ì—†ëŠ” ë‚ 
      return `<div class="${cardClass}">
        <div class="jcard-header" onclick="openJournalWrite(null,'${date}')">
          <div class="jcard-date">${date.slice(5).replace('-','/')} (${dow})</div>
          ${pnlHTML}
          <div style="flex:1"></div>
          <button class="btn btn-outline btn-xs" style="font-size:11px" onclick="event.stopPropagation();openJournalWrite(null,'${date}')">âœï¸ ì¼ì§€ ì‘ì„±</button>
        </div>
        ${dayTrades.length ? `<div class="jcard-body">${tradesHTML}</div>` : ''}
      </div>`;
    }

    // ì¼ì§€ ìˆëŠ” ë‚ 
    const strategies = (j.strategies||[]).map(s => `<span class="jcard-strat">${s}</span>`).join('');
    const tags = (j.tags||[]).map(t => `<span class="jcard-tag">${t}</span>`).join('');

    // ê·œì¹™ ì¤€ìˆ˜ ì²´í¬ ìš”ì•½
    const checks = j.ruleChecks || {};
    const checkKeys = Object.keys(checks);
    const passCount = checkKeys.filter(k => checks[k] === 'pass').length;
    const failCount = checkKeys.filter(k => checks[k] === 'fail').length;
    const ruleHTML = checkKeys.length
      ? `<div class="jcard-section">
          <div class="jcard-sec-label">ê·œì¹™ ì¤€ìˆ˜</div>
          <div style="display:flex;gap:6px;flex-wrap:wrap">
            ${checkKeys.map(k => `<span style="font-size:11px;padding:2px 8px;border-radius:4px;${checks[k]==='pass'?'background:rgba(52,211,153,.1);color:var(--profit);border:1px solid rgba(52,211,153,.2)':'background:rgba(248,113,113,.1);color:var(--loss);border:1px solid rgba(248,113,113,.2)'}">${checks[k]==='pass'?'âœ…':'âŒ'} ${k}</span>`).join('')}
          </div>
        </div>` : '';

    return `<div class="${cardClass}">
      <div class="jcard-header" onclick="openJournalWrite('${j.id}')">
        <div class="jcard-date">${date.slice(5).replace('-','/')} (${dow})</div>
        ${j.mood ? `<span class="jcard-mood" title="${MOOD_LABEL[j.mood]||''}">${j.mood}</span>` : ''}
        ${j.sentiment ? `<span style="font-size:11px;font-weight:600;color:${SENT_COL[j.sentiment]||'var(--muted)'}">${j.sentiment}</span>` : ''}
        ${pnlHTML}
        <div class="jcard-title">${j.title||'(ì œëª© ì—†ìŒ)'}</div>
        <span style="font-size:10px;color:var(--muted)">ìˆ˜ì • â€º</span>
      </div>
      <div class="jcard-body">
        ${strategies ? `<div class="jcard-section"><div class="jcard-tags">${strategies}</div></div>` : ''}
        ${j.reason ? `<div class="jcard-section"><div class="jcard-sec-label">ë§¤ë§¤ ê·¼ê±°</div><div class="jcard-text">${j.reason}</div></div>` : ''}
        ${j.review ? `<div class="jcard-section"><div class="jcard-sec-label">ë°˜ì„± / ë³µê¸°</div><div class="jcard-text">${j.review}</div></div>` : ''}
        ${j.plan   ? `<div class="jcard-section"><div class="jcard-sec-label">ë‚´ì¼ ê³„íš</div><div class="jcard-text">${j.plan}</div></div>` : ''}
        ${tradesHTML}
        ${ruleHTML}
        ${tags ? `<div class="jcard-section"><div class="jcard-tags">${tags}</div></div>` : ''}
      </div>
    </div>`;
  }).join('');
}

// â”€â”€ ëª¨ë‹¬ ì—´ê¸° â”€â”€
function openJournalWrite(id, prefillDate) {
  const date = prefillDate || td();
  document.getElementById('jnl-date').value = date;
  document.getElementById('jnl-date-display').textContent = date;
  document.getElementById('jnl-edit-id').value = id || '';
  document.getElementById('jnl-modal-title').textContent = id ? 'ğŸ““ ì €ë„ ìˆ˜ì •' : 'ğŸ““ íŠ¸ë ˆì´ë”© ì €ë„';
  document.getElementById('jnl-del-btn').style.display = id ? 'inline-flex' : 'none';

  // í•„ë“œ ì´ˆê¸°í™”
  ['jnl-title','jnl-reason','jnl-review','jnl-plan','jnl-tags-input'].forEach(i => {
    const el = document.getElementById(i); if(el) el.value = '';
  });
  document.querySelectorAll('.mood-pick').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.sent-pick').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.strat-pick').forEach(b => b.classList.remove('active'));

  // ê¸°ì¡´ ë°ì´í„° ë¡œë“œ
  const j = id ? journals.find(x => x.id === id) : null;
  if (j) {
    if(j.title) document.getElementById('jnl-title').value = j.title;
    if(j.reason) document.getElementById('jnl-reason').value = j.reason;
    if(j.review) document.getElementById('jnl-review').value = j.review;
    if(j.plan)   document.getElementById('jnl-plan').value   = j.plan;
    if(j.tags)   document.getElementById('jnl-tags-input').value = j.tags.join(', ');
    if(j.mood) { const b = document.querySelector(`.mood-pick[data-mood="${j.mood}"]`); if(b) b.classList.add('active'); }
    if(j.sentiment) { const b = document.querySelector(`.sent-pick[data-sent="${j.sentiment}"]`); if(b) b.classList.add('active'); }
    (j.strategies||[]).forEach(s => { const b = document.querySelector(`.strat-pick[data-strat="${s}"]`); if(b) b.classList.add('active'); });
  }

  // ë‹¹ì¼ ê±°ë˜ ìë™ í‘œì‹œ
  const tradesListEl = document.getElementById('jnl-trades-list');
  const dayTrades = [];
  positions.forEach(p => p.trades.filter(t => t.date === date).forEach(t => dayTrades.push({...t, name: p.name, currency: p.currency})));
  if (tradesListEl) {
    if (!dayTrades.length) {
      tradesListEl.innerHTML = '<span style="font-size:12px;color:var(--muted)">ì´ ë‚  ê±°ë˜ ì—†ìŒ</span>';
    } else {
      tradesListEl.innerHTML = dayTrades.map(t => `
        <div style="display:flex;align-items:center;gap:8px;padding:5px 0;border-bottom:1px solid var(--border)">
          <span style="font-size:10px;padding:2px 7px;border-radius:3px;font-weight:700;${t.type==='buy'?'background:rgba(248,81,73,.12);color:var(--loss)':'background:rgba(29,111,242,.12);color:var(--accent)'}">${t.type==='buy'?'ë§¤ìˆ˜':'ë§¤ë„'}</span>
          <span style="font-size:12px;font-weight:600;flex:1">${t.name}</span>
          <span style="font-family:'Roboto Mono',monospace;font-size:11px;color:var(--muted)">${t.currency==='USD'?'$'+t.price.toFixed(2):'â‚©'+Math.round(t.price).toLocaleString()} Ã— ${t.qty}ì£¼</span>
        </div>`).join('');
    }
  }

  // ê·œì¹™ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒì„±
  const rulesEl = document.getElementById('jnl-rules-checklist');
  if (rulesEl) {
    const ruleChecks = j?.ruleChecks || {};
    const ruleTexts = rules.length
      ? rules.map(r => r.text || r).filter(Boolean)
      : ['ì†ì ˆê°€ ì„¤ì • í›„ ì§„ì…', 'í¬ì§€ì…˜ ì‚¬ì´ì¦ˆ ì¤€ìˆ˜', 'ê³„íš ì—†ì´ ì¶”ê°€ë§¤ìˆ˜ ê¸ˆì§€', 'ê°ì •ì  ë§¤ë§¤ ê¸ˆì§€'];
    rulesEl.innerHTML = ruleTexts.slice(0,8).map(text => {
      const state = ruleChecks[text] || 'none';
      const cls = state === 'pass' ? 'rule-check-item checked' : state === 'fail' ? 'rule-check-item failed' : 'rule-check-item';
      const icon = state === 'pass' ? 'âœ…' : state === 'fail' ? 'âŒ' : 'â¬œ';
      return `<div class="${cls}" onclick="toggleRuleCheck(this,'${text.replace(/'/g,"\\'")}')">
        <span class="rule-check-icon">${icon}</span>
        <span class="rule-check-text">${text}</span>
      </div>`;
    }).join('');
  }

  om('m-journal');
}

function toggleRuleCheck(el, text) {
  const cur = el.classList.contains('checked') ? 'pass' : el.classList.contains('failed') ? 'fail' : 'none';
  el.classList.remove('rule-check-item','checked','failed');
  if (cur === 'none')  { el.classList.add('rule-check-item','checked'); el.querySelector('.rule-check-icon').textContent='âœ…'; }
  else if (cur==='pass') { el.classList.add('rule-check-item','failed'); el.querySelector('.rule-check-icon').textContent='âŒ'; }
  else                   { el.classList.add('rule-check-item'); el.querySelector('.rule-check-icon').textContent='â¬œ'; }
}

function pickMood(el) {
  document.querySelectorAll('.mood-pick').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
}
function pickSent(el) {
  document.querySelectorAll('.sent-pick').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
}
function toggleStrat(el) {
  el.classList.toggle('active');
}

// â”€â”€ ì €ì¥ â”€â”€
function saveJournal() {
  const date   = document.getElementById('jnl-date').value || td();
  const editId = document.getElementById('jnl-edit-id').value;
  const title  = document.getElementById('jnl-title').value.trim();
  const reason = document.getElementById('jnl-reason').value.trim();
  const review = document.getElementById('jnl-review').value.trim();
  const plan   = document.getElementById('jnl-plan').value.trim();
  const tagsRaw= document.getElementById('jnl-tags-input').value;
  const tags   = tagsRaw.split(',').map(t=>t.trim()).filter(Boolean);

  const mood      = document.querySelector('.mood-pick.active')?.dataset.mood || '';
  const sentiment = document.querySelector('.sent-pick.active')?.dataset.sent || '';
  const strategies= [...document.querySelectorAll('.strat-pick.active')].map(b=>b.dataset.strat);

  // ê·œì¹™ ì²´í¬ ìˆ˜ì§‘
  const ruleChecks = {};
  document.querySelectorAll('#jnl-rules-checklist .rule-check-item').forEach(el => {
    const text = el.querySelector('.rule-check-text')?.textContent;
    if (!text) return;
    if (el.classList.contains('checked')) ruleChecks[text] = 'pass';
    else if (el.classList.contains('failed')) ruleChecks[text] = 'fail';
  });

  const entry = { id: editId || uid(), date, mood, sentiment, strategies, title, reason, review, plan, tags, ruleChecks };

  if (editId) {
    const idx = journals.findIndex(j => j.id === editId);
    if (idx >= 0) journals[idx] = entry;
    else journals.push(entry);
  } else {
    // ê°™ì€ ë‚  ê¸°ì¡´ ì¼ì§€ê°€ ìˆìœ¼ë©´ ë³‘í•©
    const existing = journals.findIndex(j => j.date === date);
    if (existing >= 0) journals[existing] = { ...journals[existing], ...entry, id: journals[existing].id };
    else journals.push(entry);
  }

  saveJournals();
  cm('m-journal');
  renderJournal();
}

// â”€â”€ ì‚­ì œ â”€â”€
function deleteJournal() {
  const id = document.getElementById('jnl-edit-id').value;
  if (!id) return;
  if (!confirm('ì´ ì¼ì§€ë¥¼ ì‚­ì œí• ê¹Œìš”?')) return;
  journals = journals.filter(j => j.id !== id);
  saveJournals();
  cm('m-journal');
  renderJournal();
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ëŒ€ì‹œë³´ë“œ í™ˆ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderDashboard() {
  const held    = positions.filter(p => p.status === 'holding');
  const closed  = positions.filter(p => p.status === 'closed');
  const today   = td();
  const thisYM  = today.slice(0,7);

  const cpCache = new Map();
  const cp = p => { if(!cpCache.has(p.id)) cpCache.set(p.id, calcPos(p)); return cpCache.get(p.id); };

  const totalUnreal  = held.reduce((s,p)  => s + (p.currency!=='USD'?cp(p).unrealPnL:0), 0);
  const totalReal    = closed.reduce((s,p) => s + (p.currency!=='USD'?cp(p).realPnL:0), 0);
  const totalInv     = held.reduce((s,p)  => s + (p.currency!=='USD'?cp(p).invested:0), 0);
  const wr           = closed.length ? closed.filter(p=>cp(p).realPnL>0).length/closed.length*100 : 0;

  const monthClosed  = closed.filter(p => { const c=cp(p); return c.last&&c.last.startsWith(thisYM); });
  const monthPnL     = monthClosed.reduce((s,p) => s+(p.currency!=='USD'?cp(p).realPnL:0), 0);

  // ì˜¤ëŠ˜ ê±°ë˜
  const todayTrades  = [];
  positions.forEach(pos => pos.trades.forEach(t => { if(t.date===today) todayTrades.push({t,pos}); }));

  // KPI
  document.getElementById('dashboard-kpi').innerHTML = [
    ['ğŸ“Š ë³´ìœ  í¬ì§€ì…˜', held.length+'ê°œ', 'var(--text)'],
    ['ğŸ’° íˆ¬ìê¸ˆ (KRW)', 'â‚©'+Math.round(totalInv).toLocaleString(), 'var(--text)'],
    ['ğŸ“ˆ í‰ê°€ ì†ìµ', (totalUnreal>=0?'+':'')+'â‚©'+Math.round(totalUnreal).toLocaleString(), totalUnreal>=0?'var(--profit)':'var(--loss)'],
    ['ğŸ† ëˆ„ì  ì‹¤í˜„ì†ìµ', (totalReal>=0?'+':'')+'â‚©'+Math.round(totalReal).toLocaleString(), totalReal>=0?'var(--profit)':'var(--loss)'],
    ['ğŸ¯ ì „ì²´ ìŠ¹ë¥ ', wr.toFixed(1)+'%', wr>=50?'var(--profit)':'var(--loss)'],
    ['ğŸ“… ì´ë‹¬ ì†ìµ', (monthPnL>=0?'+':'')+'â‚©'+Math.round(monthPnL).toLocaleString(), monthPnL>=0?'var(--profit)':'var(--loss)'],
    ['âœ… ì²­ì‚° ì™„ë£Œ', closed.length+'ê°œ', 'var(--muted)'],
    ['ğŸ”„ ì˜¤ëŠ˜ ê±°ë˜', todayTrades.length+'ê±´', todayTrades.length?'var(--accent)':'var(--muted)'],
  ].map(([l,v,c]) => `
    <div class="stat-card" style="cursor:default">
      <div class="stat-label">${l}</div>
      <div class="stat-value" style="color:${c};font-size:16px">${v}</div>
    </div>`).join('');

  // ë³´ìœ  í¬ì§€ì…˜ ìš”ì•½
  const heldSorted = [...held].sort((a,b) => cp(b).unrealPnL - cp(a).unrealPnL);
  document.getElementById('dashboard-holding-summary').innerHTML = `
    <div class="section">
      <div class="sec-hdr"><span class="sec-title">ğŸ“Š ë³´ìœ  í¬ì§€ì…˜ í˜„í™©</span><button class="btn btn-outline btn-xs" onclick="switchTab('holding')">ì „ì²´ ë³´ê¸°</button></div>
      <div style="padding:0 0 6px">
        ${!heldSorted.length ? '<div style="padding:16px 18px;color:var(--muted);font-size:13px">ë³´ìœ ì¤‘ì¸ í¬ì§€ì…˜ì´ ì—†ìŠµë‹ˆë‹¤</div>' :
        heldSorted.map(p => {
          const c = cp(p);
          const col = c.unrealPnL>=0?'var(--profit)':'var(--loss)';
          const barW = Math.min(100, Math.abs(c.unrealRate)*2.5);
          return `<div style="padding:10px 18px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px">
            <div style="flex:1;min-width:0">
              <div style="display:flex;align-items:center;gap:7px;margin-bottom:4px">
                <span style="font-weight:700;font-size:13px">${p.name}</span>
                ${mTag(p.market)}
                ${p.ticker?`<span style="font-size:10px;color:var(--muted)">${p.ticker}</span>`:''}
              </div>
              <div style="background:var(--s2);border-radius:3px;height:5px;overflow:hidden">
                <div style="background:${col};height:100%;width:${barW}%;border-radius:3px"></div>
              </div>
            </div>
            <div style="text-align:right;flex-shrink:0">
              <div style="font-family:'Roboto Mono',monospace;font-size:13px;font-weight:700;color:${col}">${c.unrealPnL>=0?'+':''}â‚©${Math.round(c.unrealPnL).toLocaleString()}</div>
              <div style="font-size:11px;color:${col}">${c.unrealRate>=0?'+':''}${c.unrealRate.toFixed(2)}%</div>
            </div>
          </div>`;
        }).join('')}
      </div>
    </div>`;

  // ì˜¤ë¥¸ìª½: ìµœê·¼ ì²­ì‚° + ì˜¤ëŠ˜ ê±°ë˜
  const recentClosed = [...closed].sort((a,b) => cp(b).last.localeCompare(cp(a).last)).slice(0,5);
  document.getElementById('dashboard-right').innerHTML = `
    <div class="section" style="margin-bottom:12px">
      <div class="sec-hdr"><span class="sec-title">âœ… ìµœê·¼ ì²­ì‚°</span><button class="btn btn-outline btn-xs" onclick="switchTab('closed')">ì „ì²´ ë³´ê¸°</button></div>
      <div style="padding:0 0 6px">
        ${!recentClosed.length ? '<div style="padding:14px 18px;color:var(--muted);font-size:13px">ì²­ì‚° ë‚´ì—­ ì—†ìŒ</div>' :
        recentClosed.map(p => {
          const c = cp(p);
          const col = c.realPnL>=0?'var(--profit)':'var(--loss)';
          return `<div style="padding:9px 18px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center">
            <div>
              <div style="font-size:13px;font-weight:600">${p.name}</div>
              <div style="font-size:11px;color:var(--muted)">${c.last}</div>
            </div>
            <div style="text-align:right">
              <div style="font-family:'Roboto Mono',monospace;font-size:13px;font-weight:700;color:${col}">${c.realPnL>=0?'+':''}â‚©${Math.round(c.realPnL).toLocaleString()}</div>
              <div style="font-size:11px;color:${col}">${c.realRate>=0?'+':''}${c.realRate.toFixed(1)}%</div>
            </div>
          </div>`;
        }).join('')}
      </div>
    </div>
    <div class="section">
      <div class="sec-hdr"><span class="sec-title">ğŸ”„ ì˜¤ëŠ˜ì˜ ê±°ë˜</span></div>
      <div style="padding:0 0 6px">
        ${!todayTrades.length ? '<div style="padding:14px 18px;color:var(--muted);font-size:13px">ì˜¤ëŠ˜ ê±°ë˜ ì—†ìŒ</div>' :
        todayTrades.map(({t,pos}) => `
          <div style="padding:9px 18px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center">
            <div>
              <div style="font-size:13px;font-weight:600">${pos.name}</div>
              <div style="display:flex;gap:5px;align-items:center;margin-top:2px">
                <span class="tag ${t.type==='buy'?'tag-buy':'tag-sell'}">${t.type==='buy'?'ë§¤ìˆ˜':'ë§¤ë„'}</span>
                <span style="font-size:11px;color:var(--muted)">${t.qty.toLocaleString()}ì£¼</span>
              </div>
            </div>
            <div style="text-align:right;font-family:'Roboto Mono',monospace;font-size:13px">â‚©${Math.round(t.price).toLocaleString()}</div>
          </div>`).join('')}
      </div>
    </div>`;

  // í•˜ë‹¨: ì´ë‹¬ ì¼ì§€ ë¯¸ë¦¬ë³´ê¸° + ëª©í‘œ ì§„í–‰ë¥ 
  const monthJournals = journals.filter(j => j.date.startsWith(thisYM)).slice(0,3);
  const activeGoals = goals.filter(g => !g.done).slice(0,4);

  document.getElementById('dashboard-bottom').innerHTML = `
    <div class="section">
      <div class="sec-hdr"><span class="sec-title">ğŸ““ ìµœê·¼ ì¼ì§€</span><button class="btn btn-outline btn-xs" onclick="switchTab('journal')">ì „ì²´ ë³´ê¸°</button></div>
      <div style="padding:12px 18px;display:flex;flex-direction:column;gap:8px">
        ${!monthJournals.length ? '<div style="color:var(--muted);font-size:13px">ì´ë‹¬ ì¼ì§€ ì—†ìŒ</div>' :
        monthJournals.map(j => `<div style="background:var(--s2);border-radius:8px;padding:10px 12px;border:1.5px solid var(--border);cursor:pointer" onclick="switchTab('journal')">
          <div style="font-size:11px;color:var(--muted);margin-bottom:3px">${j.date}</div>
          <div style="font-size:13px;font-weight:600">${j.title}</div>
          ${j.body?`<div style="font-size:11px;color:var(--muted);margin-top:3px">${j.body.slice(0,60)}â€¦</div>`:''}
        </div>`).join('')}
      </div>
    </div>
    <div class="section">
      <div class="sec-hdr"><span class="sec-title">ğŸ¯ ëª©í‘œ ì§„í–‰ë¥ </span><button class="btn btn-outline btn-xs" onclick="switchTab('goals')">ì „ì²´ ë³´ê¸°</button></div>
      <div style="padding:14px 18px;display:flex;flex-direction:column;gap:10px">
        ${!activeGoals.length ? '<div style="color:var(--muted);font-size:13px">ì§„í–‰ ì¤‘ì¸ ëª©í‘œ ì—†ìŒ</div>' :
        activeGoals.map(g => {
          const prog = getGoalProgress(g);
          const pct = Math.min(100, prog.current/g.value*100);
          const col = pct>=100?'var(--profit)':pct>60?'var(--accent)':'var(--warn)';
          return `<div>
            <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px">
              <span style="font-weight:600">${g.name}</span>
              <span style="color:${col};font-weight:700">${pct.toFixed(0)}%</span>
            </div>
            <div style="background:var(--border);border-radius:4px;height:7px;overflow:hidden">
              <div style="background:${col};height:100%;width:${pct}%;border-radius:4px;transition:width .5s"></div>
            </div>
          </div>`;
        }).join('')}
      </div>
    </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• íƒ€ì„ë¼ì¸ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderTimeline() {
  const filter  = document.getElementById('tl-filter')?.value || 'all';
  const q       = (document.getElementById('tl-search')?.value||'').toLowerCase();
  const grouped = document.getElementById('tl-group')?.checked !== false;
  const body    = document.getElementById('timeline-body');

  // ëª¨ë“  ê±°ë˜ ìˆ˜ì§‘
  let entries = [];
  positions.forEach(pos => {
    if(q && !pos.name.toLowerCase().includes(q) && !(pos.ticker||'').toLowerCase().includes(q)) return;
    pos.trades.forEach(t => {
      if(filter==='buy'    && t.type!=='buy')   return;
      if(filter==='sell'   && t.type!=='sell')  return;
      if(filter==='closed' && pos.status!=='closed') return;
      entries.push({ t, pos, c: calcPos(pos) });
    });
  });
  entries.sort((a,b) => b.t.date.localeCompare(a.t.date) || b.t.id?.localeCompare(a.t.id||''));

  if(!entries.length) {
    body.innerHTML = '<div style="text-align:center;padding:40px;color:var(--muted)"><div style="font-size:32px;margin-bottom:8px">ğŸ“­</div><div>ê±°ë˜ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</div></div>';
    return;
  }

  if(!grouped) {
    body.innerHTML = '<div style="display:flex;flex-direction:column;gap:0;border-left:2px solid var(--border);margin-left:20px;padding-left:0">'
      + entries.map(e => tlCard(e)).join('') + '</div>';
    return;
  }

  // ë‚ ì§œë³„ ê·¸ë£¹
  const byDate = {};
  entries.forEach(e => {
    const d = e.t.date;
    if(!byDate[d]) byDate[d] = [];
    byDate[d].push(e);
  });

  body.innerHTML = Object.entries(byDate).sort((a,b)=>b[0].localeCompare(a[0])).map(([date, list]) => {
    const dayPnL = list.filter(e=>e.t.type==='sell').reduce((s,e)=>s+(e.pos.currency!=='USD'?e.t.price*e.t.qty-(e.c.avgB*e.t.qty):0),0);
    const dow = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][new Date(date).getDay()];
    return `<div style="margin-bottom:20px">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px">
        <div style="background:var(--accent);color:#fff;border-radius:20px;padding:4px 14px;font-size:12px;font-weight:700">${date} (${dow})</div>
        <div style="flex:1;height:1px;background:var(--border)"></div>
        ${dayPnL?`<div style="font-size:12px;font-family:'Roboto Mono',monospace;color:${dayPnL>=0?'var(--profit)':'var(--loss)'};font-weight:700">${dayPnL>=0?'+':''}â‚©${Math.round(dayPnL).toLocaleString()}</div>`:''}
        <div style="font-size:11px;color:var(--muted)">${list.length}ê±´</div>
      </div>
      <div style="display:flex;flex-direction:column;gap:6px;padding-left:16px;border-left:2px solid var(--border)">
        ${list.map(e => tlCard(e)).join('')}
      </div>
    </div>`;
  }).join('');
}

function tlCard({t, pos, c}) {
  const isBuy = t.type === 'buy';
  const col   = isBuy ? 'var(--profit)' : 'var(--loss)';
  const amt   = t.price * t.qty;
  const pnlStr = !isBuy && c
    ? (() => { const p = (t.price - c.avgB)*t.qty; return `<span style="font-size:11px;color:${p>=0?'var(--profit)':'var(--loss)'};font-weight:700;margin-left:8px">${p>=0?'+':''}â‚©${Math.round(p).toLocaleString()}</span>`; })()
    : '';
  return `<div style="background:var(--surface);border:1.5px solid var(--border);border-radius:9px;padding:10px 14px;display:flex;align-items:center;gap:12px;cursor:pointer;transition:border-color .15s"
    onmouseenter="this.style.borderColor='var(--accent)'" onmouseleave="this.style.borderColor='var(--border)'"
    onclick="openDetail('${pos.id}')">
    <div style="width:36px;height:36px;border-radius:50%;background:${isBuy?'rgba(224,49,49,.12)':'rgba(29,111,242,.12)'};display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0">${isBuy?'ğŸ“ˆ':'ğŸ“‰'}</div>
    <div style="flex:1;min-width:0">
      <div style="display:flex;align-items:center;gap:7px;flex-wrap:wrap">
        <span style="font-weight:700;font-size:13px">${pos.name}</span>
        <span class="tag ${isBuy?'tag-buy':'tag-sell'}" style="font-size:10px">${isBuy?'ë§¤ìˆ˜':'ë§¤ë„'}</span>
        ${mTag(pos.market)}
        ${pnlStr}
      </div>
      <div style="font-size:11px;color:var(--muted);margin-top:3px">
        ${t.qty.toLocaleString()}ì£¼ Ã— â‚©${Math.round(t.price).toLocaleString()}
        ${t.fee?` Â· ìˆ˜ìˆ˜ë£Œ â‚©${Math.round(t.fee).toLocaleString()}`:''}
        ${t.fundType&&t.fundType!=='cash'?` Â· ${t.fundType==='credit'?'ì‹ ìš©':'ë¯¸ìˆ˜'}`:''}
        ${t.note?` Â· ${t.note}`:''}
      </div>
    </div>
    <div style="text-align:right;flex-shrink:0">
      <div style="font-family:'Roboto Mono',monospace;font-size:13px;font-weight:700">â‚©${Math.round(amt).toLocaleString()}</div>
      <div style="font-size:10px;color:var(--muted);margin-top:2px">${pos.status==='closed'?'âœ…ì²­ì‚°':'ğŸ“Šë³´ìœ '}</div>
    </div>
  </div>`;
}


function completeGoal(id) {
  const g = goals.find(g => g.id===id);
  if (!g) return;
  g.done = true; g.doneDate = td();
  saveGoalsStore(); renderGoals();
  showToast('ğŸ† ëª©í‘œ ë‹¬ì„±! ì¶•í•˜í•©ë‹ˆë‹¤!');
}
function deleteGoal(id) {
  if (!confirm('ì´ ëª©í‘œë¥¼ ì‚­ì œí• ê¹Œìš”?')) return;
  goals = goals.filter(g => g.id!==id);
  saveGoalsStore(); renderGoals();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• íŒŒì¼ì— ì €ì¥ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function saveToFile() {
  const btn = document.getElementById('save-btn');
  btn.textContent = 'ğŸ’¾ ì €ì¥ ì¤‘...';

  // ëª¨ë“  ë°ì´í„° í†µí•©
  const dataJson = JSON.stringify({ positions, templates, rules, violations, checkState, goals, events, journals, accounts, txList, interestList });
  let html = document.documentElement.outerHTML;

  // íƒœê·¸ëª…ì„ ë³€ìˆ˜ë¡œ ì¡°í•©í•´ì„œ íŒŒì„œ ì˜¤ì¸ ë°©ì§€
  const S = 'script';
  const openTag  = ['<', S, ' id="__data__" type="application/json">'].join('');
  const closeTag = ['</', S, '>'].join('');
  const dataBlock = openTag + dataJson + closeTag;

  // ê¸°ì¡´ __data__ ë¸”ë¡ êµì²´ or </body> ì•ì— ì‚½ì…
  const marker = '__data__';
  if (html.includes(marker)) {
    const start = html.indexOf(openTag.slice(0, 20));
    const end   = html.indexOf(closeTag, start) + closeTag.length;
    if (start > -1 && end > closeTag.length) {
      html = html.slice(0, start) + dataBlock + html.slice(end);
    }
  } else {
    const bodyClose = ['</', 'body', '>'].join('');
    html = html.replace(bodyClose, dataBlock + '\n' + bodyClose);
  }

  const blob = new Blob([html], { type: 'text/html;charset=utf-8' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'TradeLog_' + new Date().toISOString().slice(0, 10) + '.html';
  a.click();
  URL.revokeObjectURL(a.href);

  setTimeout(() => {
    btn.textContent = 'ğŸ’¾ ì €ì¥';
    btn.classList.add('saved');
    setTimeout(() => btn.classList.remove('saved'), 1500);
  }, 500);
  showToast('ğŸ’¾ ì €ì¥ ì™„ë£Œ! ë‹¤ìš´ë¡œë“œëœ íŒŒì¼ì„ ì—´ë©´ ë°ì´í„°ê°€ ê·¸ëŒ€ë¡œ ìˆì–´ìš”.');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HELPERS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function fmtN(n, cur='KRW') {
  const abs=Math.abs(n), s=n<0?'-':'+', sym=cur==='USD'?'$':'â‚©';
  if(cur==='KRW') return s+sym+Math.round(abs).toLocaleString();
  return s+sym+abs.toFixed(2);
}
function fmtP(n, cur='KRW') {
  if(n===null||n===undefined||isNaN(n)) return '-';
  const sym = cur==='USD'?'$':'â‚©';
  return cur==='KRW' ? sym+Math.round(n).toLocaleString() : sym+n.toFixed(2);
}
function td() { return new Date().toISOString().slice(0,10); }
function dBetween(d1, d2) { return Math.max(0, Math.round((new Date(d2)-new Date(d1))/86400000)); }
function mTag(m) { return `<span class="tag tag-${m}">${m}</span>`; }
function showToast(msg, dur=2800) {
  const t=document.getElementById('toast');
  t.textContent=msg; t.classList.add('show');
  clearTimeout(t._timer);
  t._timer = setTimeout(()=>t.classList.remove('show'), dur);
}
function om(id) { document.getElementById(id).classList.add('show'); }
function cm(id) { document.getElementById(id).classList.remove('show'); }

function calcPos(pos) {
  const buys = pos.trades.filter(t=>t.type==='buy');
  const sells = pos.trades.filter(t=>t.type==='sell');
  const tbq = buys.reduce((s,t)=>s+t.qty,0);
  const tsq = sells.reduce((s,t)=>s+t.qty,0);
  const remQ = tbq - tsq;
  const tba = buys.reduce((s,t)=>s+t.price*t.qty,0);
  const avgB = tbq>0 ? tba/tbq : 0;
  const tsa = sells.reduce((s,t)=>s+t.price*t.qty,0);
  const avgS = tsq>0 ? tsa/tsq : 0;
  const fees = pos.trades.reduce((s,t)=>s+(t.fee||0),0);
  const realPnL = sells.reduce((s,t)=>s+(t.price-avgB)*t.qty,0) - fees;
  const cur = pos.currentPrice || avgB;
  const unrealPnL = remQ>0 ? (cur-avgB)*remQ : 0;
  const unrealRate = avgB>0 ? (cur-avgB)/avgB*100 : 0;
  const invested = avgB * remQ;
  // ì‹¤í˜„ ìˆ˜ìµë¥ : ì‹¤ì œ íˆ¬ìê¸ˆ(ë§¤ë„í•œ ìˆ˜ëŸ‰ ê¸°ì¤€) ëŒ€ë¹„ ì‹¤ì†ìµ
  const soldCost = avgB * tsq; // ë§¤ë„í•œ ìˆ˜ëŸ‰ì˜ ë§¤ìˆ˜ ì›ê°€
  const realRate = soldCost>0 ? realPnL/soldCost*100 : 0;
  // ë¦¬í¬íŠ¸ìš© ë³„ì¹­
  const realPnLRate = realRate;
  const sorted = [...pos.trades].sort((a,b)=>a.date.localeCompare(b.date));
  const first = sorted.length ? sorted[0].date : td();
  const last = sorted.length ? sorted[sorted.length-1].date : td();
  return {tbq,tsq,remQ,avgB,avgS,fees,realPnL,realPnLRate,unrealPnL,unrealRate,invested,realRate,cur,first,last};
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TABS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// íƒ­ ê·¸ë£¹ ë§¤í•‘
const TAB_GROUP = {
  home:'trade', holding:'trade', closed:'trade', funds:'trade', calendar:'trade',
  analytics:'analysis', report:'analysis', 'review-report':'analysis', journal:'analysis',
  timeline:'analysis', compare:'analysis',
  risk:'tools', rules:'tools', goals:'tools', events:'tools',
};
let currentGroup = 'trade';

function switchGroup(group) {
  currentGroup = group;
  ['trade','analysis','tools'].forEach(g => {
    document.getElementById('tg-'+g)?.classList.toggle('active', g===group);
    const sub = document.getElementById('subtabs-'+g);
    if (sub) sub.style.display = g===group ? 'flex' : 'none';
  });
  // ê·¸ë£¹ ì²« ë²ˆì§¸ íƒ­ìœ¼ë¡œ ìë™ ì´ë™
  const firstTab = {trade:'dashboard', analysis:'analytics', tools:'risk'}[group];
  switchTab(firstTab);
}

function switchTab(tab) {
  currentTab = tab;
  // ê·¸ë£¹ ìë™ ì „í™˜ (íƒ­ì´ ë‹¤ë¥¸ ê·¸ë£¹ì— ì†í•˜ë©´)
  const g = TAB_GROUP[tab];
  if (g && g !== currentGroup) {
    currentGroup = g;
    ['trade','analysis','tools'].forEach(grp => {
      document.getElementById('tg-'+grp)?.classList.toggle('active', grp===g);
      const sub = document.getElementById('subtabs-'+grp);
      if (sub) sub.style.display = grp===g ? 'flex' : 'none';
    });
  }
  // ë·° ì „í™˜
  ['home','holding','closed','analytics','calendar','report','review-report','funds','risk','rules','goals','events','journal','timeline','compare'].forEach(t => {
    const v=document.getElementById('view-'+t); if(v) v.style.display=t===tab?'':'none';
    const tb=document.getElementById('tab-'+t); if(tb) tb.classList.toggle('active',t===tab);
    const nb=document.getElementById('bnav-'+t); if(nb) nb.classList.toggle('active',t===tab);
  });
  // íƒ­ë³„ ë Œë”
  if(tab==='holding') renderHolding();
  else if(tab==='closed') renderClosed();
  else if(tab==='analytics') renderAnalytics();
  else if(tab==='calendar') renderCalendar();
  else if(tab==='report') setReportPeriod('daily');
  else if(tab==='review-report') genReviewReport('all');
  else if(tab==='funds') renderFunds();
  else if(tab==='risk') renderRisk();
  else if(tab==='rules') renderRules();
  else if(tab==='goals') renderGoals();
  else if(tab==='events') renderEvents();
  else if(tab==='journal') renderJournal();
    else if(tab==='compare') renderCompare();
  else if(tab==='home') renderHome();
  else if(tab==='timeline') renderTimeline();
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ì¢…ëª©ì½”ë“œ ì¼ê´„ì…ë ¥ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openBulkTicker() {
  const noTicker = positions.filter(p => !p.ticker);
  const list = document.getElementById('bulk-ticker-list');
  const msg  = document.getElementById('bulk-ticker-done-msg');

  if (!noTicker.length) {
    list.innerHTML = '<div style="text-align:center;padding:24px;color:var(--muted)">ğŸ‰ ëª¨ë“  í¬ì§€ì…˜ì— ì¢…ëª©ì½”ë“œê°€ ìˆì–´ìš”!</div>';
    msg.style.display = 'none';
  } else {
    list.innerHTML = noTicker.map(pos => {
      const isUS = pos.market === 'US';
      const badge = isUS
        ? `<span class="tag tag-US" style="font-size:10px">US</span>`
        : `<span class="tag tag-KRX" style="font-size:10px">KRX</span>`;
      const ph = isUS ? 'AAPL' : '005930';
      const statusDot = pos.status === 'holding'
        ? `<span style="font-size:9px;color:var(--profit);margin-left:4px">â— ë³´ìœ ì¤‘</span>`
        : `<span style="font-size:9px;color:var(--muted);margin-left:4px">â— ì²­ì‚°</span>`;
      return `<div style="display:flex;align-items:center;gap:10px;padding:9px 12px;background:var(--s2);border-radius:8px;border:1.5px solid var(--border)">
        <div style="flex:1;min-width:0">
          <div style="font-weight:600;font-size:13px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${pos.name} ${badge} ${statusDot}</div>
        </div>
        <input class="fi" id="btk-${pos.id}" value="${pos.ticker||''}" placeholder="${ph}"
          style="width:110px;padding:6px 9px;font-size:13px;font-family:'Roboto Mono',monospace;text-transform:uppercase"
          oninput="this.value=this.value.toUpperCase()"
          onkeydown="if(event.key==='Enter'){const inputs=document.querySelectorAll('[id^=btk-]');const idx=Array.from(inputs).indexOf(this);if(inputs[idx+1])inputs[idx+1].focus();}">
      </div>`;
    }).join('');
    msg.textContent = `ì¢…ëª©ì½”ë“œ ì—†ëŠ” í¬ì§€ì…˜ ${noTicker.length}ê°œ`;
    msg.style.display = 'block';
  }
  om('m-bulk-ticker');
  setTimeout(bindBulkTickerAutocomplete, 100);
}

function saveBulkTicker() {
  let changed = 0;
  positions.forEach(pos => {
    const inp = document.getElementById('btk-' + pos.id);
    if (!inp) return;
    const val = inp.value.trim().toUpperCase();
    if (val && val !== pos.ticker) {
      pos.ticker = val;
      changed++;
    } else if (!val && pos.ticker) {
      pos.ticker = '';
      changed++;
    }
  });
  if (changed) {
    savePos();
    renderAll();
    showToast(`âœ… ${changed}ê°œ ì¢…ëª©ì½”ë“œ ì €ì¥ ì™„ë£Œ`);
  } else {
    showToast('ë³€ê²½ì‚¬í•­ ì—†ìŒ');
  }
  cm('m-bulk-ticker');
}

function renderAll() {
  updateCounts();
  if(currentTab==='holding') renderHolding();
  else if(currentTab==='home') renderHome();
  else if(currentTab==='closed') renderClosed();
  else if(currentTab==='analytics') renderAnalytics();
  else if(currentTab==='calendar') renderCalendar();
  else if(currentTab==='stats') renderStats();
  else if(currentTab==='report') genFullReport();
  else if(currentTab==='funds') renderFunds();
  else if(currentTab==='risk') renderRisk();
  else if(currentTab==='rules') renderRules();
  else if(currentTab==='goals') renderGoals();
  else if(currentTab==='events') renderEvents();
}

function backdropClose(backdrop, e) {
  // ëª¨ë‹¬ ë‚´ë¶€ í´ë¦­ì´ë©´ ë‹«ì§€ ì•ŠìŒ
  if(e.target===backdrop) {
    const id=backdrop.id;
    // ìƒˆ í¬ì§€ì…˜/ê±°ë˜ ì¶”ê°€ ì¤‘ì—” ì‹¤ìˆ˜ ë°©ì§€ë¡œ í™•ì¸
    if((id==='m-newpos'||id==='m-trade')&&positions.length>0) {
      if(!confirm('ì…ë ¥ ì¤‘ì¸ ë‚´ìš©ì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤. ë‹«ì„ê¹Œìš”?')) return;
    }
    cm(id);
  }
}
function toggleMoreMenu() {
  const menu = document.getElementById('more-menu');
  const btn  = document.querySelector('#more-menu-wrap button');
  if (menu.style.display !== 'none') {
    menu.style.display = 'none';
    return;
  }
  // ë²„íŠ¼ ìœ„ì¹˜ ê¸°ì¤€ìœ¼ë¡œ ë©”ë‰´ ìœ„ì¹˜ ê³„ì‚°
  if (btn) {
    const rect = btn.getBoundingClientRect();
    menu.style.top  = (rect.bottom + 6) + 'px';
    menu.style.right = (window.innerWidth - rect.right) + 'px';
  }
  menu.style.display = 'block';
}
// ë°”ê¹¥ í´ë¦­ ì‹œ ë”ë³´ê¸° ë‹«ê¸°
document.addEventListener('click', e => {
  if (!document.getElementById('more-menu-wrap')?.contains(e.target)) {
    const menu = document.getElementById('more-menu');
    if (menu) menu.style.display = 'none';
  }
});
function updateCounts() {
  const h=positions.filter(p=>p.status==='holding').length;
  const c=positions.filter(p=>p.status==='closed').length;
  document.getElementById('cnt-h').textContent = h?`(${h})`:'';
  document.getElementById('cnt-c').textContent = c?`(${c})`:'';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HOLDING â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderHolding() {
  const held = positions.filter(p => p.status === 'holding');
  const q    = (document.getElementById('h-search')?.value || '').toLowerCase();
  const sort = document.getElementById('h-sort')?.value || 'date';
  const flt  = document.getElementById('h-filter')?.value || '';

  const cache = new Map();
  const cp = p => { if (!cache.has(p.id)) cache.set(p.id, calcPos(p)); return cache.get(p.id); };

  // â”€â”€ fundTypeë³„ë¡œ ê°€ìƒ í–‰ ìƒì„± â”€â”€
  // ê° í¬ì§€ì…˜ Ã— fundType ì¡°í•©ì„ ë…ë¦½ í–‰ìœ¼ë¡œ í¼ì¹˜ê¸°
  const FT_LABEL = { cash: 'í˜„ê¸ˆ', credit: 'ì‹ ìš©', margin: 'ë¯¸ìˆ˜' };
  const FT_COL   = { cash: 'var(--profit)', credit: 'var(--warn)', margin: 'var(--loss)' };

  const rows = [];
  held.forEach(pos => {
    const c = cp(pos);
    const fs = getFundSummary(pos);
    const ftTypes = Object.keys(fs.map).filter(k => fs.map[k] > 0);
    const multiType = ftTypes.length > 1;

    ftTypes.forEach(ft => {
      // í•´ë‹¹ ìê¸ˆìœ í˜• ë§¤ìˆ˜ ê±°ë˜ë§Œ
      const ftBuys  = pos.trades.filter(t => t.type === 'buy' && (t.fundType || 'cash') === ft);
      const ftBuyQ  = ftBuys.reduce((s, t) => s + t.qty, 0);
      const ftBuyA  = ftBuys.reduce((s, t) => s + t.price * t.qty, 0);
      const ftAvg   = ftBuyQ > 0 ? ftBuyA / ftBuyQ : 0;
      const ftInv   = fs.map[ft];
      const ftRatio = fs.total > 0 ? ftInv / fs.total : 0;

      // ë§¤ë„ ìˆ˜ëŸ‰ë„ ë¹„ë¡€ ì•ˆë¶„ (ê·¼ì‚¬)
      const ftRemQ  = Math.round(c.remQ * ftRatio);
      const ftUnr   = c.unrealPnL * ftRatio;
      const ftRate  = ftAvg > 0 ? (c.cur - ftAvg) / ftAvg * 100 : 0;

      // ì´ì ì •ë³´
      const rateInfo = ft !== 'cash'
        ? (() => {
            const r = ftBuys.find(t => t.fundRate)?.fundRate;
            const due = ft === 'margin' ? ftBuys.find(t => t.marginDue)?.marginDue : null;
            return r ? ` Â· ${r}%/ë…„${due ? ' D' + due : ''}` : '';
          })()
        : '';

      // í‘œì‹œëª…: ìê¸ˆìœ í˜• í˜¼í•©ì´ë©´ "(í˜„ê¸ˆ)" ë“± ë¶™ì´ê¸°
      const displayName = multiType
        ? `${pos.name}<span style="font-size:11px;color:${FT_COL[ft]};margin-left:5px">(${FT_LABEL[ft]}${rateInfo})</span>`
        : pos.name;

      rows.push({ pos, ft, displayName, ftAvg, ftRemQ, ftInv, ftUnr, ftRate, c, multiType });
    });
  });

  // í•„í„°
  let filt = rows.filter(r => {
    const pos = r.pos;
    if (q && !pos.name.toLowerCase().includes(q) && !((pos.ticker||'').toLowerCase().includes(q))) return false;
    if (flt === 'profit' && r.ftUnr <= 0) return false;
    if (flt === 'loss'   && r.ftUnr >= 0) return false;
    if (flt === 'target' && !(pos.targetPrice && r.c.cur >= pos.targetPrice)) return false;
    if (flt === 'stop'   && !(pos.stopPrice   && r.c.cur <= pos.stopPrice))   return false;
    return true;
  });

  // ì •ë ¬
  filt.sort((a, b) => {
    if (sort === 'pnl')  return b.ftUnr  - a.ftUnr;
    if (sort === 'rate') return b.ftRate - a.ftRate;
    if (sort === 'days') return dBetween(cp(b.pos).first, td()) - dBetween(cp(a.pos).first, td());
    return cp(a.pos).first > cp(b.pos).first ? -1 : 1;
  });

  document.getElementById('holding-empty').style.display = held.length ? 'none' : 'block';

  let totInv = 0, totUnr = 0, tgtHit = 0, stpHit = 0;

  const tableRows = filt.map(r => {
    const { pos, ft, displayName, ftAvg, ftRemQ, ftInv, ftUnr, ftRate, c } = r;
    totInv += ftInv;
    totUnr += ftUnr;

    const days   = dBetween(c.first, td());
    const pnlCol = ftUnr >= 0 ? 'var(--profit)' : 'var(--loss)';
    const tgt = pos.targetPrice, stp = pos.stopPrice, cur = c.cur;
    const tHit = tgt && cur >= tgt;
    const sHit = stp && cur <= stp;
    if (tHit) tgtHit++;
    if (sHit) stpHit++;

    const expInterest = ft !== 'cash' ? (() => {
      const ftBuys = pos.trades.filter(t => t.type === 'buy' && (t.fundType || 'cash') === ft);
      const today = new Date(td());
      return ftBuys.reduce((s, t) => {
        if (!t.fundRate) return s;
        const d = Math.max(0, Math.round((today - new Date(t.date)) / 86400000));
        return s + t.price * t.qty * (t.fundRate / 100) * (d / 365);
      }, 0);
    })() : 0;

    const tags = [];
    if (tHit) tags.push(`<span class="badge badge-profit">ğŸ¯ ëª©í‘œë„ë‹¬</span>`);
    if (sHit) tags.push(`<span class="badge badge-loss">ğŸ›‘ ì†ì ˆë„ë‹¬</span>`);
    if (days > 30) tags.push(`<span class="badge badge-warn">â° ${days}ì¼</span>`);
    if (expInterest > 0) tags.push(`<span class="badge badge-loss">ì´ì -${Math.round(expInterest).toLocaleString()}</span>`);

    // ì§„í–‰ë°”
    let progHTML = '';
    if (tgt || stp) {
      const lo = stp || c.avgB * 0.85, hi = tgt || c.avgB * 1.15;
      const pct = hi > lo ? Math.max(0, Math.min(100, (cur - lo) / (hi - lo) * 100)) : 50;
      progHTML = `<div class="prog-track" style="width:70px;display:inline-block;vertical-align:middle;margin-left:5px"><div class="prog-fill" style="width:${pct}%;background:${tHit ? 'var(--profit)' : sHit ? 'var(--loss)' : 'var(--a2)'}"></div></div>`;
    }

    const rowBg = tHit ? 'rgba(224,49,49,.04)' : sHit ? 'rgba(29,111,242,.04)' : '';

    return `<tr style="background:${rowBg}">
      <td style="padding:10px 12px">
        <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
          <div>
            <div style="font-weight:700;font-size:13px;cursor:pointer" onclick="openDetail('${pos.id}')">${displayName}</div>
            <div style="font-size:11px;color:var(--muted);margin-top:2px">${mTag(pos.market)} ${pos.ticker ? `<span style="font-family:'Roboto Mono',monospace">${pos.ticker}</span>` : ''} Â· ${c.first}</div>
          </div>
          ${tags.length ? `<div style="display:flex;gap:3px;flex-wrap:wrap">${tags.join('')}</div>` : ''}
        </div>
      </td>
      <td class="mono" style="text-align:right;padding:10px 8px">
        <div>${fmtP(ftAvg, pos.currency)}</div>
        <div style="font-size:11px;color:var(--muted)">${ftRemQ}ì£¼</div>
      </td>
      <td class="mono" style="text-align:right;padding:10px 8px">
        <div style="font-size:13px">${fmtP(cur, pos.currency)}</div>
        ${progHTML}
      </td>
      <td class="mono" style="text-align:right;padding:10px 8px">
        <div style="font-family:'Roboto Mono',monospace;font-size:13px;color:var(--muted)">â‚©${Math.round(ftInv).toLocaleString()}</div>
      </td>
      <td class="mono" style="text-align:right;padding:10px 8px">
        <div style="font-weight:700;font-size:14px;color:${pnlCol}">${ftUnr >= 0 ? '+' : ''}â‚©${Math.round(ftUnr).toLocaleString()}</div>
        <div style="font-size:11px;color:${pnlCol}">${ftRate >= 0 ? '+' : ''}${ftRate.toFixed(2)}%</div>
      </td>
      <td style="text-align:right;padding:10px 8px;color:var(--muted);font-size:12px">${days}ì¼</td>
      <td style="text-align:center;padding:10px 8px">
        <div style="display:flex;gap:3px;justify-content:center">
          <button class="btn btn-outline btn-xs" onclick="openAddTrade('${pos.id}','buy')" title="ì¶”ê°€ë§¤ìˆ˜">+ë§¤ìˆ˜</button>
          <button class="btn btn-primary btn-xs" onclick="openAddTrade('${pos.id}','sell')" title="ë§¤ë„">ë§¤ë„</button>
          <button class="btn btn-outline btn-xs" onclick="openEditPos('${pos.id}')">âœï¸</button>
          <button class="btn btn-outline btn-xs" onclick="openDetail('${pos.id}')">ğŸ“‹</button>
        </div>
      </td>
    </tr>`;
  });

  const thead = `<thead><tr style="border-bottom:1.5px solid var(--border)">
    <th style="padding:10px 12px;font-size:11px;color:var(--muted);font-weight:600;text-align:left">ì¢…ëª©</th>
    <th style="padding:10px 8px;font-size:11px;color:var(--muted);font-weight:600;text-align:right">í‰ë‹¨ / ìˆ˜ëŸ‰</th>
    <th style="padding:10px 8px;font-size:11px;color:var(--muted);font-weight:600;text-align:right">í˜„ì¬ê°€</th>
    <th style="padding:10px 8px;font-size:11px;color:var(--muted);font-weight:600;text-align:right">íˆ¬ìê¸ˆì•¡</th>
    <th style="padding:10px 8px;font-size:11px;color:var(--muted);font-weight:600;text-align:right">í‰ê°€ì†ìµ</th>
    <th style="padding:10px 8px;font-size:11px;color:var(--muted);font-weight:600;text-align:right">ë³´ìœ ì¼</th>
    <th style="padding:10px 8px;font-size:11px;color:var(--muted);font-weight:600;text-align:center">ì•¡ì…˜</th>
  </tr></thead>`;

  document.getElementById('holding-grid').innerHTML = filt.length
    ? `<table style="width:100%;border-collapse:collapse">${thead}<tbody>${tableRows.join('')}</tbody></table>`
    : '';

  // ìš”ì•½ ì¹´ë“œ
  const sc = document.getElementById('holding-summary');
  if (sc) {
    sc.innerHTML = `
      <div class="stat-card"><div class="sc-l">ë³´ìœ  í¬ì§€ì…˜</div><div class="sc-v">${filt.length}<span class="sc-u">ê°œ</span></div></div>
      <div class="stat-card"><div class="sc-l">ì´ ë§¤ìˆ˜ì•¡</div><div class="sc-v mono">${fmtN(Math.round(totInv),'KRW')}</div></div>
      <div class="stat-card"><div class="sc-l">ë¯¸ì‹¤í˜„ ì†ìµ</div><div class="sc-v mono ${totUnr>=0?'pc':'lc'}">${totUnr>=0?'+':''}${fmtN(Math.round(totUnr),'KRW')}</div></div>
      <div class="stat-card"><div class="sc-l">í‰ê°€ ìˆ˜ìµë¥ </div><div class="sc-v ${totUnr>=0?'pc':'lc'}">${totInv>0?(totUnr/totInv*100).toFixed(2):0}%</div></div>
      <div class="stat-card"><div class="sc-l">ëª©í‘œ ë„ë‹¬</div><div class="sc-v pc">${tgtHit}<span class="sc-u">ê°œ</span></div></div>
      <div class="stat-card"><div class="sc-l">ì†ì ˆ ë„ë‹¬</div><div class="sc-v lc">${stpHit}<span class="sc-u">ê°œ</span></div></div>`;
  }
}

function renderClosed() {
  const q    = (document.getElementById('c-search')?.value||'').toLowerCase();
  const f    = document.getElementById('c-filter')?.value||'';
  const sort = document.getElementById('c-sort')?.value||'date';
  const all  = positions.filter(p=>p.status==='closed');

  // calcPos ìºì‹œ
  const cache = new Map();
  const cp = p => { if(!cache.has(p.id)) cache.set(p.id, calcPos(p)); return cache.get(p.id); };

  // í•„í„°
  let filt = all.filter(p=>{
    if(q && !p.name.toLowerCase().includes(q) && !((p.ticker||'').toLowerCase().includes(q))) return false;
    const c=cp(p);
    if(f==='profit' && c.realPnL<=0) return false;
    if(f==='loss'   && c.realPnL>=0) return false;
    return true;
  });

  // ì •ë ¬
  filt.sort((a,b)=>{
    const ca=cp(a), cb=cp(b);
    if(sort==='pnl')  return cb.realPnL  - ca.realPnL;
    if(sort==='rate') return cb.realRate  - ca.realRate;
    if(sort==='days') return dBetween(cb.first,cb.last) - dBetween(ca.first,ca.last);
    return cb.last.localeCompare(ca.last); // date: ìµœê·¼ ì²­ì‚°ìˆœ
  });

  // ìš”ì•½ í†µê³„ (KRW ê¸°ì¤€ë§Œ, USD ë³„ë„)
  const krwAll = all.filter(p=>p.currency!=='USD');
  const usdAll = all.filter(p=>p.currency==='USD');
  const wins = all.filter(p=>cp(p).realPnL>0);
  const wr   = all.length ? wins.length/all.length*100 : 0;
  const avg  = all.length ? all.reduce((s,p)=>s+cp(p).realRate,0)/all.length : 0;
  const rates= all.map(p=>cp(p).realRate);
  const krwPnl = krwAll.reduce((s,p)=>s+cp(p).realPnL,0);
  const usdPnl = usdAll.reduce((s,p)=>s+cp(p).realPnL,0);
  const pnlText = 'â‚©'+Math.round(krwPnl).toLocaleString() + (usdPnl!==0 ? ` ${usdPnl>=0?'+':'-'}$${Math.abs(usdPnl).toFixed(0)}`:'');

  document.getElementById('c-cnt').textContent = all.length;
  const pe=document.getElementById('c-pnl'); pe.textContent=pnlText; pe.className='stat-value '+(krwPnl+usdPnl>=0?'profit':'loss');
  const we=document.getElementById('c-wr'); we.textContent=wr.toFixed(1)+'%'; we.className='stat-value '+(wr>=50?'profit':'loss');
  const ae=document.getElementById('c-avg'); ae.textContent=(avg>=0?'+':'')+avg.toFixed(2)+'%'; ae.className='stat-value '+(avg>=0?'profit':'loss');
  document.getElementById('c-mxl').textContent = rates.length ? Math.min(...rates).toFixed(2)+'%' : '0%';
  document.getElementById('c-mxw').textContent = rates.length ? '+'+Math.max(...rates).toFixed(2)+'%' : '0%';

  const tbody=document.getElementById('closed-tbody'), empty=document.getElementById('closed-empty');
  if(!filt.length){tbody.innerHTML='';empty.style.display='block';return;}
  empty.style.display='none';
  tbody.innerHTML = filt.map(pos=>{
    const c=cp(pos);
    const buyDate  = pos.trades.filter(t=>t.type==='buy').map(t=>t.date).sort()[0] || c.first;
    const sellDate = pos.trades.filter(t=>t.type==='sell').map(t=>t.date).sort().pop() || c.last;
    const invested = c.avgB * c.tsq; // íˆ¬ìê¸ˆì•¡ (ë§¤ë„í•œ ìˆ˜ëŸ‰ ê¸°ì¤€ ì›ê°€)
    const pnlCol   = c.realPnL>=0 ? 'var(--profit)' : 'var(--loss)';
    const holdDays = dBetween(buyDate, sellDate);
    return `<tr>
      <td style="font-weight:600;max-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer" title="${pos.name} â€” í´ë¦­í•˜ë©´ ë¹ ë¥¸ ë©”ëª¨" onclick="openQuickMemo('${pos.id}')">${pos.name} <span style="font-size:9px;color:var(--muted)">âœ</span></td>
      <td style="text-align:center">${mTag(pos.market)}</td>
      <td class="mono" style="text-align:right;color:var(--muted);font-size:12px">${buyDate}</td>
      <td class="mono" style="text-align:right;color:var(--muted);font-size:12px">${sellDate}</td>
      <td class="mono" style="text-align:right">${fmtP(c.avgB,pos.currency)}</td>
      <td class="mono" style="text-align:right">${fmtP(c.avgS,pos.currency)}</td>
      <td class="mono" style="text-align:right;color:var(--muted)">${pos.currency==='USD'?'$'+invested.toFixed(0):'â‚©'+Math.round(invested).toLocaleString()}</td>
      <td class="mono" style="text-align:right;color:${pnlCol};font-weight:700">${c.realPnL>=0?'+':''}${fmtN(c.realPnL,pos.currency)}</td>
      <td class="mono" style="text-align:right;color:${pnlCol};font-weight:600">${c.realRate>=0?'+':''}${c.realRate.toFixed(2)}%</td>
      <td class="mono" style="text-align:right;color:var(--muted)">${holdDays}ì¼</td>
      <td style="text-align:center">
        ${pos.tradeScore !== null && pos.tradeScore !== undefined
          ? `<div style="font-size:11px;font-weight:800;color:${pos.tradeScore>=80?'var(--profit)':pos.tradeScore>=50?'var(--warn)':'var(--loss)'};margin-bottom:3px">${pos.tradeScore}ì </div>`
          : ''}
        <div style="display:flex;gap:4px;justify-content:center;flex-wrap:wrap">
          <button class="btn btn-xs" style="background:rgba(79,156,249,.15);color:var(--accent)" onclick="openReview('${pos.id}')">ğŸ“Š ë³µê¸°</button>
          <button class="btn btn-outline btn-xs" onclick="openEditPos('${pos.id}')">âœï¸</button>
          <button class="btn btn-outline btn-xs" onclick="openDetail('${pos.id}')">ğŸ“‹</button>
          <button class="btn btn-danger btn-xs" onclick="delPos('${pos.id}')">ğŸ—‘</button>
        </div>
      </td>
    </tr>`;
  }).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ANALYTICS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function drawScatter(closed) {
  const canvas = document.getElementById('cv-scatter'); if(!canvas) return;
  const ctx = canvas.getContext('2d');
  const krw = closed.filter(p=>p.currency!=='USD');

  const DPR = window.devicePixelRatio||1;
  const W = getCanvasW('cv-scatter'), H = 320;
  canvas.width  = W*DPR; canvas.height = H*DPR;
  canvas.style.width = W+'px'; canvas.style.height = H+'px';
  ctx.scale(DPR, DPR);
  ctx.clearRect(0,0,W,H);

  if(krw.length < 2){
    ctx.fillStyle='rgba(148,163,184,.4)'; ctx.font='14px sans-serif'; ctx.textAlign='center';
    ctx.fillText('ì²­ì‚° ê¸°ë¡ì´ 2ê°œ ì´ìƒ í•„ìš”í•´ìš”',W/2,H/2); return;
  }

  const PROFIT='#f03e3e', LOSS='#1d7ed6';
  const data = krw.map(p=>{
    const c=calcPos(p);
    const days = Math.max(1, Math.round((new Date(c.last)-new Date(p.trades[0].date))/(86400000)));
    const retPct = c.invested>0 ? c.realPnL/c.invested*100 : 0;
    return { days, retPct, pnl:c.realPnL, invested:c.invested, name:p.name };
  });

  const maxD  = Math.max(...data.map(d=>d.days), 1);
  const maxAR = Math.max(...data.map(d=>Math.abs(d.retPct)), 1);
  const maxI  = Math.max(...data.map(d=>d.invested), 1);

  const pd = {t:32, r:28, b:52, l:72};
  const gW=W-pd.l-pd.r, gH=H-pd.t-pd.b;
  const toX = d => pd.l + (d/maxD)*gW;
  const toY = r => pd.t + gH/2 - (r/maxAR)*(gH/2-10);

  // â”€â”€ ë°°ê²½ â”€â”€
  ctx.strokeStyle='rgba(255,255,255,.028)'; ctx.lineWidth=1;
  for(let r=0;r<=6;r++){
    const y=pd.t+gH*r/6;
    ctx.beginPath(); ctx.moveTo(pd.l,y); ctx.lineTo(W-pd.r,y); ctx.stroke();
  }
  for(let c2=0;c2<=8;c2++){
    const x=pd.l+gW*c2/8;
    ctx.beginPath(); ctx.moveTo(x,pd.t); ctx.lineTo(x,H-pd.b); ctx.stroke();
  }

  // â”€â”€ 0% ê¸°ì¤€ì„  â”€â”€
  const y0=pd.t+gH/2;
  ctx.save();
  ctx.strokeStyle='rgba(255,255,255,.18)'; ctx.lineWidth=1.5;
  ctx.setLineDash([6,5]);
  ctx.beginPath(); ctx.moveTo(pd.l,y0); ctx.lineTo(W-pd.r,y0); ctx.stroke();
  ctx.restore();

  // â”€â”€ ìˆ˜ìµ/ì†ì‹¤ ì˜ì—­ ë°°ê²½ â”€â”€
  ctx.save();
  ctx.fillStyle='rgba(240,62,62,.025)';
  ctx.fillRect(pd.l, pd.t, gW, gH/2);
  ctx.fillStyle='rgba(29,126,214,.025)';
  ctx.fillRect(pd.l, y0, gW, gH/2);
  ctx.restore();

  // â”€â”€ ì‚°ì ë„ â”€â”€
  data.forEach(d=>{
    const x=toX(d.days), y=toY(d.retPct);
    const isP = d.retPct >= 0;
    const col = isP ? PROFIT : LOSS;
    // ì› í¬ê¸°: íˆ¬ìê¸ˆ ë¹„ë¡€ (min 7, max 26)
    const r = Math.max(7, Math.min(26, Math.sqrt(d.invested/maxI)*26));

    // ì™¸ê³½ ë§ (í—¤ì¼ë¡œ)
    ctx.save();
    ctx.beginPath(); ctx.arc(x, y, r+6, 0, Math.PI*2);
    ctx.fillStyle = col + '10'; ctx.fill();
    ctx.restore();

    // ë°˜íˆ¬ëª… ì±„ìš°ê¸°
    ctx.save();
    ctx.shadowColor = col; ctx.shadowBlur = isP ? 20 : 16;
    ctx.beginPath(); ctx.arc(x, y, r, 0, Math.PI*2);
    ctx.fillStyle = col + '35'; ctx.fill();
    ctx.restore();

    // í…Œë‘ë¦¬
    ctx.save();
    ctx.shadowColor = col; ctx.shadowBlur = 8;
    ctx.beginPath(); ctx.arc(x, y, r, 0, Math.PI*2);
    ctx.strokeStyle = col + 'cc'; ctx.lineWidth = 2; ctx.stroke();
    ctx.restore();

    // ì¤‘ì‹¬ ì±„ì›€
    ctx.save();
    ctx.shadowColor = col; ctx.shadowBlur = 12;
    ctx.beginPath(); ctx.arc(x, y, r*0.45, 0, Math.PI*2);
    ctx.fillStyle = col; ctx.fill();
    ctx.restore();

    // ì¢…ëª©ëª… ë ˆì´ë¸” (í° ì›ë§Œ)
    if(r > 14){
      ctx.save();
      ctx.font = '10px "Pretendard",sans-serif'; ctx.textAlign='center';
      const label = d.name.length > 6 ? d.name.slice(0,6)+'â€¦' : d.name;
      const lw = ctx.measureText(label).width + 10;
      const lx = Math.max(pd.l+lw/2, Math.min(W-pd.r-lw/2, x));
      const ly = y - r - 8;

      ctx.fillStyle = col+'22';
      ctx.beginPath();
      if(typeof ctx.roundRect === 'function') ctx.roundRect(lx-lw/2, ly-12, lw, 16, 3);
      else ctx.rect(lx-lw/2, ly-12, lw, 16);
      ctx.fill();
      ctx.fillStyle = col+'ee'; ctx.fillText(label, lx, ly);
      ctx.restore();
    }

    // ìˆ˜ìµë¥  ìˆ«ì (ì› ì•ˆì—)
    if(r > 10){
      ctx.save();
      ctx.font = `bold ${r>16?10:9}px "Roboto Mono",monospace`;
      ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
      ctx.fillStyle = '#ffffff';
      ctx.fillText((isP?'+':'')+d.retPct.toFixed(1)+'%', x, y);
      ctx.restore();
    }
  });
  ctx.textBaseline = 'alphabetic';

  // â”€â”€ ìƒê´€ê´€ê³„ ì¶”ì„¸ì„  â”€â”€
  if(data.length >= 4){
    const n=data.length;
    const sx=data.reduce((s,d)=>s+d.days,0);
    const sy=data.reduce((s,d)=>s+d.retPct,0);
    const sx2=data.reduce((s,d)=>s+d.days*d.days,0);
    const sxy=data.reduce((s,d)=>s+d.days*d.retPct,0);
    const m=(n*sxy-sx*sy)/(n*sx2-sx*sx||1);
    const b2=(sy-m*sx)/n;
    ctx.save();
    ctx.setLineDash([5,6]);
    ctx.strokeStyle='rgba(250,204,21,.5)'; ctx.lineWidth=2;
    ctx.beginPath();
    ctx.moveTo(pd.l, toY(m*0+b2));
    ctx.lineTo(W-pd.r, toY(m*maxD+b2));
    ctx.stroke();
    // ì¶”ì„¸ì„  ë ˆì´ë¸”
    ctx.font='10px sans-serif'; ctx.textAlign='right'; ctx.fillStyle='rgba(250,204,21,.7)';
    ctx.setLineDash([]);
    ctx.fillText(m>0?'ì¥ê¸°ë³´ìœ  â†’ ìˆ˜ìµ ê²½í–¥':'ë‹¨ê¸°ë§¤ë§¤ ì„ í˜¸', W-pd.r-4, toY(m*maxD+b2)-6);
    ctx.restore();
  }

  // â”€â”€ ì¶• ë ˆì´ë¸” â”€â”€
  ctx.fillStyle='rgba(148,163,184,.6)'; ctx.font='10px "Roboto Mono",monospace';
  ctx.textAlign='center';
  [0,.25,.5,.75,1].forEach(t=>{
    ctx.fillText(Math.round(maxD*t)+'ì¼', pd.l+gW*t, H-pd.b+18);
  });
  ctx.textAlign='right';
  [
    ['+'+maxAR.toFixed(0)+'%', pd.t+10, 'rgba(240,62,62,.7)'],
    ['0%', y0+4, 'rgba(148,163,184,.45)'],
    ['-'+maxAR.toFixed(0)+'%', H-pd.b-4, 'rgba(29,126,214,.7)'],
  ].forEach(([lbl,yy,col])=>{
    ctx.fillStyle=col; ctx.fillText(lbl, pd.l-8, yy);
  });

  // â”€â”€ ì¶• ì œëª© â”€â”€
  ctx.fillStyle='rgba(148,163,184,.4)'; ctx.font='10px sans-serif';
  ctx.textAlign='center';
  ctx.fillText('ë³´ìœ ê¸°ê°„ (ì¼)', pd.l+gW/2, H-6);
  ctx.save(); ctx.translate(14, pd.t+gH/2);
  ctx.rotate(-Math.PI/2); ctx.fillText('ìˆ˜ìµë¥  (%)', 0, 0); ctx.restore();
}


function drawFreqChart(closed) {
  const el = document.getElementById('freq-body'); if(!el) return;
  const freq = {};
  closed.forEach(p=>{ freq[p.name]=(freq[p.name]||0)+1; });
  const sorted = Object.entries(freq).sort((a,b)=>b[1]-a[1]).slice(0,8);
  const maxF = sorted[0]?.[1]||1;
  if(!sorted.length){ el.innerHTML='<div style="color:var(--muted);font-size:13px">ë°ì´í„° ì—†ìŒ</div>'; return; }
  el.innerHTML = sorted.map(([name,cnt])=>`
    <div style="display:flex;align-items:center;gap:8px;margin-bottom:7px">
      <div style="font-size:11px;color:var(--text);min-width:90px;max-width:90px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${name}</div>
      <div style="flex:1;background:var(--s2);border-radius:4px;height:10px;overflow:hidden">
        <div style="height:100%;width:${cnt/maxF*100}%;background:linear-gradient(90deg,#f59e0b,#f03e3e);border-radius:4px;transition:width .4s"></div>
      </div>
      <div style="font-size:11px;font-family:'Roboto Mono',monospace;color:var(--muted);min-width:24px;text-align:right">${cnt}íšŒ</div>
    </div>`).join('');
}

function drawPnlTrail() {
  const canvas = document.getElementById('cv-pnl-trail'); if(!canvas) return;
  const ctx = canvas.getContext('2d');
  const filter = document.getElementById('pnl-trail-filter')?.value||'all';
  const closed = positions.filter(p=>p.status==='closed');
  const filtered = filter==='all' ? closed : closed.filter(p=>p.currency===(filter==='KRW'?'KRW':'USD') || (filter!=='USD'&&p.currency!=='USD'));
  const sorted = [...filtered].sort((a,b)=>calcPos(a).last.localeCompare(calcPos(b).last));

  let cum=0;
  const pts=[{v:0,name:'',pnl:0}];
  sorted.forEach(p=>{ const c=calcPos(p); cum+=p.currency!=='USD'?c.realPnL:0; pts.push({v:cum,name:p.name,pnl:c.realPnL}); });

  const W=getCanvasW('cv-pnl-trail'), H=200;
  canvas.width=W; canvas.height=H;
  ctx.clearRect(0,0,W,H);
  if(pts.length<2){ ctx.fillStyle='rgba(148,163,184,.5)'; ctx.font='12px sans-serif'; ctx.textAlign='center'; ctx.fillText('ë°ì´í„° ì—†ìŒ',W/2,H/2); return; }

  const vals=pts.map(p=>p.v);
  const mn=Math.min(...vals,0), mx=Math.max(...vals,0), range=mx-mn||1;
  const pd={t:20,r:16,b:28,l:72};
  const gW=W-pd.l-pd.r, gH=H-pd.t-pd.b;
  const xS=gW/(pts.length-1);
  const toY=v=>pd.t+gH-((v-mn)/range)*gH;
  const y0=toY(0);
  const coords=pts.map((p,i)=>({x:pd.l+i*xS,y:toY(p.v)}));
  const PROFIT='#f03e3e',LOSS='#1c7ed6';
  const isPos=vals[vals.length-1]>=0;
  const col=isPos?PROFIT:LOSS;

  ctx.strokeStyle='rgba(255,255,255,.04)'; ctx.lineWidth=1;
  [0,.33,.67,1].forEach(r=>{ ctx.beginPath(); ctx.moveTo(pd.l,pd.t+gH*r); ctx.lineTo(W-pd.r,pd.t+gH*r); ctx.stroke(); });

  if(mn<0&&mx>0){ ctx.save(); ctx.strokeStyle='rgba(255,255,255,.1)'; ctx.setLineDash([3,4]); ctx.lineWidth=1; ctx.beginPath(); ctx.moveTo(pd.l,y0); ctx.lineTo(W-pd.r,y0); ctx.stroke(); ctx.restore(); }

  const fillG=ctx.createLinearGradient(0,pd.t,0,H-pd.b);
  if(isPos){ fillG.addColorStop(0,col+'22'); fillG.addColorStop(1,col+'04'); }
  else      { fillG.addColorStop(0,col+'04'); fillG.addColorStop(1,col+'22'); }
  ctx.save();
  ctx.beginPath(); ctx.moveTo(coords[0].x,coords[0].y);
  coords.forEach((c,i)=>{ if(i>0) ctx.lineTo(c.x,c.y); });
  ctx.lineTo(coords[coords.length-1].x,Math.min(y0,H-pd.b));
  ctx.lineTo(coords[0].x,Math.min(y0,H-pd.b));
  ctx.closePath(); ctx.fillStyle=fillG; ctx.fill(); ctx.restore();

  // ì„ 
  ctx.save(); ctx.shadowColor=col; ctx.shadowBlur=8;
  ctx.beginPath(); ctx.moveTo(coords[0].x,coords[0].y);
  coords.forEach((c,i)=>{ if(i>0) ctx.lineTo(c.x,c.y); });
  ctx.strokeStyle=col; ctx.lineWidth=2; ctx.stroke(); ctx.restore();

  ctx.fillStyle='rgba(148,163,184,.7)'; ctx.font='9px "Roboto Mono",monospace'; ctx.textAlign='right';
  ctx.fillText(fmtN(mx,'KRW'),pd.l-5,pd.t+10);
  ctx.fillText(fmtN(vals[vals.length-1],'KRW'),pd.l-5,H-pd.b);
}

function drawHeatmap(closed) {
  const DOW=['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
  const byDow={};
  DOW.forEach(d=>{ byDow[d]={sum:0,cnt:0}; });
  closed.filter(p=>p.currency!=='USD').forEach(p=>{
    const c=calcPos(p); const dow=DOW[new Date(c.last).getDay()];
    byDow[dow].sum+=c.realPnL; byDow[dow].cnt++;
  });

  const labEl=document.getElementById('hm-labels');
  const gridEl=document.getElementById('hm-grid');
  const legEl=document.getElementById('hm-legend');
  if(!labEl||!gridEl) return;

  const vals=DOW.map(d=>byDow[d].sum);
  const mx=Math.max(...vals.map(Math.abs),1);
  const PROFIT='#f03e3e', LOSS='#1c7ed6';

  labEl.innerHTML=DOW.map(d=>`<div class="hm-lbl">${d}</div>`).join('');
  gridEl.innerHTML=DOW.map(d=>{
    const {sum,cnt}=byDow[d];
    const t=sum/mx;
    const col=sum>=0?PROFIT:LOSS;
    const alpha=Math.abs(t)*0.85+0.08;
    return `<div title="${d}ìš”ì¼: ${cnt}íšŒ ${fmtN(sum,'KRW')}"
      style="height:38px;border-radius:6px;background:${col};opacity:${alpha.toFixed(2)};
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      border:1px solid ${col}44;cursor:default;transition:opacity .2s">
      <div style="font-size:10px;font-weight:700;color:#fff">${cnt?fmtN(sum,'KRW'):'-'}</div>
      <div style="font-size:9px;color:rgba(255,255,255,.7)">${cnt}íšŒ</div>
    </div>`;
  }).join('');

  if(legEl){
    legEl.innerHTML=[...Array(7)].map((_,i)=>{
      const t=i/6; const v=t-0.5;
      const col=v>=0?PROFIT:LOSS; const alpha=Math.abs(v)*1.6+0.1;
      return `<div style="width:16px;height:10px;border-radius:2px;background:${col};opacity:${alpha.toFixed(2)}"></div>`;
    }).join('');
  }
}

function renderAnalytics() {
  const closed = positions.filter(p=>p.status==='closed');
  drawKPI(closed);
  drawCurve(closed);
  drawHeatmap(closed);
  drawStrategy();
  drawEmotion();
  drawMonthly(closed);
  drawSymbols(closed);
  drawPiChart();
  drawPnlTrail();
  drawFreqChart(closed);
  drawScatter(closed);
  drawHoldAlert();
}

function getCanvasW(id) {
  const el=document.getElementById(id); if(!el) return 400;
  return el.parentElement.clientWidth || 400;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ë¹ ì§„ ì°¨íŠ¸ í•¨ìˆ˜ë“¤
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â”€â”€ í•µì‹¬ ì§€í‘œ KPI â”€â”€
function drawKPI(closed) {
  const el = document.getElementById('kpi-grid');
  if (!el) return;

  if (!closed.length) {
    el.innerHTML = '<div style="grid-column:1/-1;text-align:center;padding:20px;color:var(--muted);font-size:12px">ì²­ì‚° ë°ì´í„° ì—†ìŒ</div>';
    return;
  }

  const calcs = closed.map(p => calcPos(p));
  const wins   = calcs.filter(c => c.realPnL > 0);
  const losses = calcs.filter(c => c.realPnL <= 0);
  const total  = calcs.length;

  const winRate   = total ? wins.length / total * 100 : 0;
  const avgWin    = wins.length   ? wins.reduce((s,c)=>s+c.realRate,0)/wins.length : 0;
  const avgLoss   = losses.length ? Math.abs(losses.reduce((s,c)=>s+c.realRate,0)/losses.length) : 0;
  const profitFactor = losses.length && avgLoss ? avgWin / avgLoss : avgWin > 0 ? 99 : 0;
  // ê¸°ëŒ€ê°’ EV = ìŠ¹ë¥ Ã—í‰ê· ìˆ˜ìµë¥  - íŒ¨ìœ¨Ã—í‰ê· ì†ì‹¤ë¥ 
  const ev = (winRate/100 * avgWin) - ((1-winRate/100) * avgLoss);
  const totalPnL = calcs.reduce((s,c)=>s+c.realPnL,0);
  const avgHold  = calcs.reduce((s,c)=>s+dBetween(c.first,c.last),0)/total;

  // MDD â€” ëˆ„ì  ì†ìµ ê¸°ì¤€
  let peak=0, cum=0, mdd=0;
  calcs.sort((a,b)=>a.last.localeCompare(b.last)).forEach(c=>{
    cum += c.realPnL;
    if(cum > peak) peak = cum;
    const dd = peak > 0 ? (peak-cum)/peak*100 : 0;
    if(dd > mdd) mdd = dd;
  });

  // ìµœëŒ€ ì—°ì† ì†ì‹¤
  let streak=0, maxStreak=0, cur=0;
  calcs.forEach(c => {
    if(c.realPnL<=0){ cur++; if(cur>maxStreak) maxStreak=cur; } else cur=0;
  });

  const kpis = [
    { label:'ì´ ë§¤ë§¤',     val: total+'ê±´',                     color:'var(--text)' },
    { label:'ìŠ¹ë¥ ',        val: winRate.toFixed(1)+'%',         color: winRate>=50?'var(--profit)':'var(--loss)' },
    { label:'ì†ìµë¹„',      val: profitFactor.toFixed(2),        color: profitFactor>=1.5?'var(--profit)':'var(--warn)' },
    { label:'ê¸°ëŒ€ê°’ (EV)', val: (ev>=0?'+':'')+ev.toFixed(2)+'%', color: ev>=0?'var(--profit)':'var(--loss)' },
    { label:'í‰ê·  ìˆ˜ìµë¥ ', val: '+'+avgWin.toFixed(2)+'%',      color:'var(--profit)' },
    { label:'í‰ê·  ì†ì‹¤ë¥ ', val: '-'+avgLoss.toFixed(2)+'%',     color:'var(--loss)' },
    { label:'ì´ ì‹¤í˜„ì†ìµ', val: (totalPnL>=0?'+':'')+fmtN(Math.round(totalPnL),'KRW'), color: totalPnL>=0?'var(--profit)':'var(--loss)' },
    { label:'ìµœëŒ€ ë‚™í­(MDD)', val: mdd.toFixed(1)+'%',         color: mdd>20?'var(--loss)':'var(--warn)' },
    { label:'í‰ê·  ë³´ìœ ì¼', val: avgHold.toFixed(1)+'ì¼',        color:'var(--text)' },
    { label:'ìµœëŒ€ ì—°ì† ì†ì‹¤', val: maxStreak+'ì—°íŒ¨',            color: maxStreak>=3?'var(--loss)':'var(--text)' },
  ];

  el.innerHTML = kpis.map(k => `
    <div style="background:var(--s2);border:1.5px solid var(--border);border-radius:10px;padding:12px 14px">
      <div style="font-size:10px;color:var(--muted);margin-bottom:4px;letter-spacing:.3px">${k.label}</div>
      <div style="font-size:16px;font-weight:800;font-family:'Roboto Mono',monospace;color:${k.color}">${k.val}</div>
    </div>`).join('');
}

// â”€â”€ ì¥ê¸° ë³´ìœ  ì ê²€ â”€â”€
function drawHoldAlert() {
  const el = document.getElementById('hold-alert-list');
  if (!el) return;
  const today = td();
  const alerts = positions
    .filter(p => p.status === 'holding')
    .map(p => {
      const c = calcPos(p);
      const days = dBetween(c.first, today);
      return { p, c, days };
    })
    .filter(x => x.days >= 30)
    .sort((a,b) => b.days - a.days);

  if (!alerts.length) {
    el.innerHTML = '<div style="color:var(--muted);font-size:13px;padding:4px 0">ì¥ê¸° ë³´ìœ  í¬ì§€ì…˜ ì—†ìŒ âœ…</div>';
    return;
  }
  el.innerHTML = alerts.map(({p, c, days}) => {
    const col = c.unrealPnL >= 0 ? 'var(--profit)' : 'var(--loss)';
    const sign = c.unrealPnL >= 0 ? '+' : '';
    return `
    <div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--border)">
      <div>
        <span style="font-size:13px;font-weight:600">${p.name}</span>
        <span style="font-size:11px;color:var(--warn);margin-left:8px">â° ${days}ì¼ ë³´ìœ ì¤‘</span>
      </div>
      <span style="font-size:13px;font-family:'Roboto Mono',monospace;font-weight:700;color:${col}">${sign}${fmtN(Math.round(c.unrealPnL),'KRW')}</span>
    </div>`;
  }).join('');
}


// â”€â”€ ì „ëµë³„ ì„±ê³¼ â”€â”€
function drawStrategy() {
  const el = document.getElementById('strategy-body');
  if (!el) return;
  const closed = positions.filter(p => p.status === 'closed');
  const map = {};
  closed.forEach(p => {
    const s = p.strategy || 'ë¯¸ë¶„ë¥˜';
    const c = calcPos(p);
    if (!map[s]) map[s] = { cnt:0, pnl:0, wins:0 };
    map[s].cnt++;
    map[s].pnl += c.realPnL;
    if (c.realPnL > 0) map[s].wins++;
  });
  const entries = Object.entries(map).sort((a,b) => b[1].pnl - a[1].pnl);
  if (!entries.length) { el.innerHTML = '<div style="text-align:center;padding:28px;color:var(--muted);font-size:12px">ì²­ì‚° ë°ì´í„° ì—†ìŒ</div>'; return; }

  const maxAbs = Math.max(...entries.map(([,d]) => Math.abs(d.pnl)), 1);
  el.innerHTML = entries.map(([s, d]) => {
    const wr  = d.cnt ? (d.wins / d.cnt * 100).toFixed(0) : 0;
    const col = d.pnl >= 0 ? 'var(--profit)' : 'var(--loss)';
    const barW = Math.abs(d.pnl) / maxAbs * 100;
    const sign = d.pnl >= 0 ? '+' : '';
    return `
    <div style="margin-bottom:10px">
      <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:3px">
        <span style="font-weight:600">${s}</span>
        <span style="color:var(--muted)">${d.cnt}ê±´ Â· ìŠ¹ë¥  ${wr}%
          <span style="font-family:'Roboto Mono',monospace;color:${col};font-weight:700;margin-left:8px">${sign}${fmtN(Math.round(d.pnl),'KRW')}</span>
        </span>
      </div>
      <div style="height:7px;background:var(--s2);border-radius:4px;overflow:hidden">
        <div style="height:100%;width:${barW}%;background:${col};border-radius:4px;transition:width .5s"></div>
      </div>
    </div>`;
  }).join('');
}

// â”€â”€ ê°ì •ë³„ ìˆ˜ìµë¥  â”€â”€
function drawEmotion() {
  const el = document.getElementById('emotion-body');
  if (!el) return;
  const map = {};
  positions.filter(p => p.status === 'closed').forEach(p => {
    const c = calcPos(p);
    p.trades.filter(t => t.type === 'buy' && t.emotion).forEach(t => {
      const e = t.emotion;
      if (!map[e]) map[e] = { cnt:0, pnl:0, rates:[] };
      map[e].cnt++;
      map[e].pnl += c.realPnL;
      map[e].rates.push(c.realRate);
    });
  });
  const entries = Object.entries(map).sort((a,b) => {
    const avgA = a[1].rates.reduce((s,r)=>s+r,0)/a[1].rates.length;
    const avgB = b[1].rates.reduce((s,r)=>s+r,0)/b[1].rates.length;
    return avgB - avgA;
  });
  if (!entries.length) { el.innerHTML = '<div style="text-align:center;padding:28px;color:var(--muted);font-size:12px">ë°ì´í„° ì—†ìŒ</div>'; return; }

  const maxRate = Math.max(...entries.map(([,d]) => Math.abs(d.rates.reduce((s,r)=>s+r,0)/d.rates.length)), 1);
  el.innerHTML = entries.map(([e, d]) => {
    const avg = d.rates.reduce((s,r)=>s+r,0)/d.rates.length;
    const col = avg >= 0 ? 'var(--profit)' : 'var(--loss)';
    const barW = Math.abs(avg) / maxRate * 100;
    const sign = avg >= 0 ? '+' : '';
    return `
    <div style="margin-bottom:10px">
      <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:3px">
        <span style="font-weight:600">${e}</span>
        <span style="color:var(--muted)">${d.cnt}ê±´
          <span style="font-family:'Roboto Mono',monospace;color:${col};font-weight:700;margin-left:8px">${sign}${avg.toFixed(2)}%</span>
        </span>
      </div>
      <div style="height:7px;background:var(--s2);border-radius:4px;overflow:hidden">
        <div style="height:100%;width:${barW}%;background:${col};border-radius:4px;transition:width .5s"></div>
      </div>
    </div>`;
  }).join('');
}

// â”€â”€ ì¢…ëª©ë³„ ëˆ„ì  ìˆ˜ìµ â”€â”€
function drawSymbols(closed) {
  const el = document.getElementById('symbol-body');
  if (!el) return;
  if (!closed || !closed.length) {
    el.innerHTML = '<div style="text-align:center;padding:28px;color:var(--muted);font-size:12px">ì²­ì‚° ë°ì´í„° ì—†ìŒ</div>';
    return;
  }
  // ê°™ì€ ì¢…ëª© ë¬¶ê¸°
  const map = {};
  closed.forEach(p => {
    const key = p.name;
    const c = calcPos(p);
    if (!map[key]) map[key] = { pnl:0, cnt:0, market: p.market };
    map[key].pnl += c.realPnL;
    map[key].cnt++;
  });
  const entries = Object.entries(map).sort((a,b) => b[1].pnl - a[1].pnl);
  const maxAbs = Math.max(...entries.map(([,d]) => Math.abs(d.pnl)), 1);

  el.innerHTML = entries.map(([name, d]) => {
    const col = d.pnl >= 0 ? 'var(--profit)' : 'var(--loss)';
    const barW = Math.abs(d.pnl) / maxAbs * 100;
    const sign = d.pnl >= 0 ? '+' : '';
    return `
    <div style="margin-bottom:10px">
      <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:3px">
        <span style="font-weight:600">${mTag(d.market)} ${name}</span>
        <span style="font-family:'Roboto Mono',monospace;color:${col};font-weight:700">${sign}${fmtN(Math.round(d.pnl),'KRW')}</span>
      </div>
      <div style="height:7px;background:var(--s2);border-radius:4px;overflow:hidden">
        <div style="height:100%;width:${barW}%;background:${col};border-radius:4px;transition:width .5s"></div>
      </div>
    </div>`;
  }).join('');
}

// â”€â”€ ë³´ìœ  ì¢…ëª© íˆ¬ìë¹„ì¤‘ íŒŒì´ì°¨íŠ¸ â”€â”€
function drawPiChart() {
  const canvas = document.getElementById('cv-pie2');
  const legendEl = document.getElementById('pie-legend');
  const wrapEl = document.getElementById('pie-wrap');
  if (!canvas) return;

  const holding = positions.filter(p => p.status === 'holding');
  if (!holding.length) {
    if (legendEl) legendEl.innerHTML = '<div style="color:var(--muted);font-size:12px">ë³´ìœ  í¬ì§€ì…˜ ì—†ìŒ</div>';
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    return;
  }

  const data = holding.map(p => {
    const c = calcPos(p);
    return { name: p.name, val: c.invested, market: p.market };
  }).filter(d => d.val > 0);

  const total = data.reduce((s,d) => s + d.val, 0);
  if (!total) return;

  const COLORS = ['#1d6ff2','#f03e3e','#f59f00','#0ca678','#7950f2','#e67700','#2f9e44','#c92a2a','#1864ab','#862e9c'];
  const ctx = canvas.getContext('2d');
  const W = canvas.width, H = canvas.height;
  ctx.clearRect(0, 0, W, H);

  let start = -Math.PI / 2;
  data.forEach((d, i) => {
    const slice = (d.val / total) * Math.PI * 2;
    ctx.beginPath();
    ctx.moveTo(W/2, H/2);
    ctx.arc(W/2, H/2, W/2 - 4, start, start + slice);
    ctx.closePath();
    ctx.fillStyle = COLORS[i % COLORS.length];
    ctx.fill();
    start += slice;
  });

  // ë„ë„› êµ¬ë©
  ctx.beginPath();
  ctx.arc(W/2, H/2, W/2 - 4 - 28, 0, Math.PI*2);
  ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--surface').trim() || '#1a2332';
  ctx.fill();

  if (legendEl) {
    legendEl.innerHTML = data.map((d, i) => {
      const pct = (d.val / total * 100).toFixed(1);
      return `<div style="display:flex;align-items:center;gap:6px;margin-bottom:3px">
        <span style="width:9px;height:9px;border-radius:2px;background:${COLORS[i%COLORS.length]};flex-shrink:0;display:inline-block"></span>
        <span style="font-size:11px;color:var(--muted)">${d.name}</span>
        <span style="font-size:11px;font-weight:700;margin-left:auto;font-family:'Roboto Mono',monospace">${pct}%</span>
      </div>`;
    }).join('');
  }
}

function drawCurve(closed) {
  const canvas = document.getElementById('cv-curve'); if(!canvas) return;
  const ctx = canvas.getContext('2d');
  const krwClosed = closed.filter(p=>p.currency!=='USD');
  const sorted = [...krwClosed].sort((a,b)=>calcPos(a).last.localeCompare(calcPos(b).last));

  let cum = 0;
  const pts = [{d:'ì‹œì‘', v:0, pnl:0}];
  sorted.forEach(p=>{ const c=calcPos(p); cum+=c.realPnL; pts.push({d:c.last.slice(5), v:cum, pnl:c.realPnL, name:p.name}); });

  const W = getCanvasW('cv-curve'), H = 300;
  canvas.width = W * (window.devicePixelRatio||1);
  canvas.height = H * (window.devicePixelRatio||1);
  canvas.style.width = W + 'px';
  canvas.style.height = H + 'px';
  ctx.scale(window.devicePixelRatio||1, window.devicePixelRatio||1);
  ctx.clearRect(0,0,W,H);

  if(pts.length < 2){
    ctx.fillStyle='rgba(148,163,184,.4)'; ctx.font='14px sans-serif'; ctx.textAlign='center';
    ctx.fillText('ì²­ì‚° ê¸°ë¡ ì—†ìŒ',W/2,H/2); return;
  }

  const PROFIT='#f03e3e', LOSS='#1d7ed6';
  const vals = pts.map(p=>p.v);
  const mn = Math.min(...vals, 0), mx = Math.max(...vals, 0);
  const range = mx - mn || 1;
  const pd = {t:40, r:24, b:44, l:90};
  const gW = W-pd.l-pd.r, gH = H-pd.t-pd.b;
  const xS = gW/(pts.length-1);
  const toY = v => pd.t + gH - ((v-mn)/range)*gH;
  const y0  = toY(0);
  const coords = pts.map((p,i)=>({x:pd.l+i*xS, y:toY(p.v)}));
  const finalVal = vals[vals.length-1];
  const isPos = finalVal >= 0;
  const mainCol = isPos ? PROFIT : LOSS;

  // Catmull-Rom ìŠ¤í”Œë¼ì¸
  function catmull(pts){
    if(pts.length<2) return;
    ctx.moveTo(pts[0].x, pts[0].y);
    for(let i=0;i<pts.length-1;i++){
      const p0=pts[Math.max(0,i-1)], p1=pts[i], p2=pts[i+1], p3=pts[Math.min(pts.length-1,i+2)];
      const cp1x=p1.x+(p2.x-p0.x)/6, cp1y=p1.y+(p2.y-p0.y)/6;
      const cp2x=p2.x-(p3.x-p1.x)/6, cp2y=p2.y-(p3.y-p1.y)/6;
      ctx.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,p2.x,p2.y);
    }
  }

  // â”€â”€ ë°°ê²½: ë¯¸ì„¸ ê²©ì â”€â”€
  ctx.strokeStyle='rgba(255,255,255,.028)'; ctx.lineWidth=1;
  for(let r=0;r<=5;r++){
    const y=pd.t+gH*r/5;
    ctx.beginPath(); ctx.moveTo(pd.l,y); ctx.lineTo(W-pd.r,y); ctx.stroke();
  }
  for(let c2=0;c2<=8;c2++){
    const x=pd.l+gW*c2/8;
    ctx.beginPath(); ctx.moveTo(x,pd.t); ctx.lineTo(x,H-pd.b); ctx.stroke();
  }

  // â”€â”€ 0ì„  â”€â”€
  if(mn<0 && mx>0){
    ctx.save();
    ctx.strokeStyle='rgba(255,255,255,.12)'; ctx.lineWidth=1.5;
    ctx.setLineDash([6,5]);
    ctx.beginPath(); ctx.moveTo(pd.l,y0); ctx.lineTo(W-pd.r,y0); ctx.stroke();
    ctx.restore();
    ctx.fillStyle='rgba(148,163,184,.4)'; ctx.font='10px "Roboto Mono",monospace'; ctx.textAlign='right';
    ctx.fillText('â‚©0', pd.l-8, y0+4);
  }

  // â”€â”€ ì˜ì—­ ì±„ìš°ê¸°: ìˆ˜ìµ/ì†ì‹¤ êµ¬ê°„ ë¶„ë¦¬ â”€â”€
  // ìˆ˜ìµ ì˜ì—­ (ì–‘ìˆ˜ êµ¬ê°„)
  const fillGradP = ctx.createLinearGradient(0, pd.t, 0, y0);
  fillGradP.addColorStop(0, 'rgba(240,62,62,.35)');
  fillGradP.addColorStop(0.6, 'rgba(240,62,62,.12)');
  fillGradP.addColorStop(1, 'rgba(240,62,62,.0)');
  // ì†ì‹¤ ì˜ì—­ (ìŒìˆ˜ êµ¬ê°„)
  const fillGradL = ctx.createLinearGradient(0, y0, 0, H-pd.b);
  fillGradL.addColorStop(0, 'rgba(29,126,214,.0)');
  fillGradL.addColorStop(0.4, 'rgba(29,126,214,.10)');
  fillGradL.addColorStop(1, 'rgba(29,126,214,.30)');

  ctx.save();
  ctx.beginPath(); catmull(coords);
  ctx.lineTo(coords[coords.length-1].x, Math.min(y0, H-pd.b));
  ctx.lineTo(coords[0].x, Math.min(y0, H-pd.b));
  ctx.closePath();
  ctx.fillStyle = isPos ? fillGradP : fillGradL; ctx.fill();
  ctx.restore();

  // â”€â”€ ë³´ì¡°ì„ : ìµœê³ ì Â·ìµœì €ì  í‘œì‹œ â”€â”€
  const maxVal = Math.max(...vals), minVal = Math.min(...vals);
  const maxIdx = vals.indexOf(maxVal), minIdx = vals.indexOf(minVal);
  if(maxVal !== 0){
    const mx2 = coords[maxIdx];
    ctx.save();
    ctx.strokeStyle='rgba(240,62,62,.25)'; ctx.lineWidth=1; ctx.setLineDash([3,4]);
    ctx.beginPath(); ctx.moveTo(mx2.x, mx2.y); ctx.lineTo(mx2.x, H-pd.b); ctx.stroke();
    ctx.restore();
  }
  if(minVal !== 0 && minVal < 0){
    const mi2 = coords[minIdx];
    ctx.save();
    ctx.strokeStyle='rgba(29,126,214,.25)'; ctx.lineWidth=1; ctx.setLineDash([3,4]);
    ctx.beginPath(); ctx.moveTo(mi2.x, mi2.y); ctx.lineTo(mi2.x, H-pd.b); ctx.stroke();
    ctx.restore();
  }

  // â”€â”€ ë©”ì¸ ê³¡ì„  â”€â”€
  ctx.save();
  ctx.shadowColor = mainCol; ctx.shadowBlur = 18;
  const lineGrad = ctx.createLinearGradient(pd.l, 0, W-pd.r, 0);
  lineGrad.addColorStop(0, mainCol+'88');
  lineGrad.addColorStop(0.4, mainCol+'ff');
  lineGrad.addColorStop(1, mainCol+'cc');
  ctx.beginPath(); catmull(coords);
  ctx.strokeStyle = lineGrad; ctx.lineWidth = 3; ctx.lineJoin='round'; ctx.stroke();
  ctx.restore();

  // â”€â”€ ë°ì´í„° í¬ì¸íŠ¸ (ì‘ê²Œ) â”€â”€
  coords.forEach(({x,y},i)=>{
    if(i===0) return;
    const col = pts[i].pnl>=0 ? PROFIT : LOSS;
    ctx.save(); ctx.shadowColor=col; ctx.shadowBlur=5;
    ctx.beginPath(); ctx.arc(x,y,2.5,0,Math.PI*2);
    ctx.fillStyle=col+'cc'; ctx.fill(); ctx.restore();
  });

  // â”€â”€ ìµœê³ ì /ìµœì €ì  ê°•ì¡° â”€â”€
  [[maxIdx, PROFIT, '+'+fmtN(maxVal,'KRW'), -1],
   ...(minVal<0 ? [[minIdx, LOSS, fmtN(minVal,'KRW'), 1]] : [])
  ].forEach(([idx, col, label, dir])=>{
    if(idx<1) return;
    const {x,y} = coords[idx];
    ctx.save();
    ctx.shadowColor=col; ctx.shadowBlur=20;
    ctx.beginPath(); ctx.arc(x,y,6,0,Math.PI*2); ctx.fillStyle=col; ctx.fill();
    ctx.beginPath(); ctx.arc(x,y,10,0,Math.PI*2); ctx.strokeStyle=col+'44'; ctx.lineWidth=2; ctx.stroke();
    ctx.restore();
    // ë ˆì´ë¸” ë§í’ì„ 
    ctx.save();
    ctx.font='bold 10px "Roboto Mono",monospace'; ctx.textAlign='center';
    const lw = ctx.measureText(label).width + 16;
    const lx = Math.max(pd.l+lw/2, Math.min(W-pd.r-lw/2, x));
    const ly = dir < 0 ? y-18 : y+28;
    ctx.fillStyle=col+'22';
    ctx.beginPath();
    ctx.roundRect(lx-lw/2, ly-13, lw, 18, 4);
    ctx.fill();
    ctx.strokeStyle=col+'55'; ctx.lineWidth=1; ctx.stroke();
    ctx.fillStyle=col; ctx.fillText(label, lx, ly);
    ctx.restore();
  });

  // â”€â”€ ë§ˆì§€ë§‰ í¬ì¸íŠ¸ pulse â”€â”€
  const lx2=coords[coords.length-1].x, ly2=coords[coords.length-1].y;
  ctx.save(); ctx.shadowColor=mainCol; ctx.shadowBlur=24;
  ctx.beginPath(); ctx.arc(lx2,ly2,7,0,Math.PI*2); ctx.fillStyle=mainCol; ctx.fill(); ctx.restore();
  ctx.beginPath(); ctx.arc(lx2,ly2,12,0,Math.PI*2); ctx.strokeStyle=mainCol+'44'; ctx.lineWidth=2; ctx.stroke();
  ctx.beginPath(); ctx.arc(lx2,ly2,18,0,Math.PI*2); ctx.strokeStyle=mainCol+'18'; ctx.lineWidth=2; ctx.stroke();

  // â”€â”€ yì¶• ë ˆì´ë¸” â”€â”€
  ctx.fillStyle='rgba(148,163,184,.75)'; ctx.font='10px "Roboto Mono",monospace'; ctx.textAlign='right';
  const yTicks = [mx, mx/2, 0, mn/2, mn].filter((v,i,a)=>a.indexOf(v)===i && Math.abs(v)>range*0.05);
  yTicks.forEach(v=>{
    const yy = toY(v);
    if(yy < pd.t+8 || yy > H-pd.b-8) return;
    ctx.fillStyle = v>0?'rgba(240,62,62,.7)':v<0?'rgba(29,126,214,.7)':'rgba(148,163,184,.5)';
    ctx.fillText(fmtN(v,'KRW'), pd.l-8, yy+4);
  });

  // â”€â”€ xì¶• ë ˆì´ë¸” â”€â”€
  ctx.textAlign='center'; ctx.fillStyle='rgba(148,163,184,.5)'; ctx.font='9px "Roboto Mono",monospace';
  const step=Math.max(1,Math.floor(pts.length/10));
  pts.forEach((p,i)=>{ if(i%step===0||i===pts.length-1) ctx.fillText(p.d, coords[i].x, H-10); });

  // â”€â”€ KPI ì—…ë°ì´íŠ¸ â”€â”€
  const kpiEl = document.getElementById('curve-info');
  if(kpiEl){ kpiEl.textContent=(finalVal>=0?'+':'')+fmtN(finalVal,'KRW'); kpiEl.style.color=mainCol; }
}


function drawMonthly(closed) {
  const canvas = document.getElementById('cv-monthly'); if(!canvas) return;
  const ctx = canvas.getContext('2d');
  const krwClosed = closed.filter(p=>p.currency!=='USD');
  const monthly = {};
  krwClosed.forEach(pos=>{
    const c=calcPos(pos); const ym=c.last.slice(0,7);
    monthly[ym]=(monthly[ym]||0)+c.realPnL;
  });
  const keys = Object.keys(monthly).sort().slice(-18);
  const vals = keys.map(k=>monthly[k]);

  const DPR = window.devicePixelRatio||1;
  const W = getCanvasW('cv-monthly'), H = 300;
  canvas.width = W*DPR; canvas.height = H*DPR;
  canvas.style.width = W+'px'; canvas.style.height = H+'px';
  ctx.scale(DPR, DPR);
  ctx.clearRect(0,0,W,H);

  if(!keys.length){
    ctx.fillStyle='rgba(148,163,184,.4)'; ctx.font='14px sans-serif'; ctx.textAlign='center';
    ctx.fillText('ì²­ì‚° ê¸°ë¡ ì—†ìŒ',W/2,H/2); return;
  }

  const PROFIT='#f03e3e', LOSS='#1d7ed6';
  const maxAbs = Math.max(...vals.map(Math.abs), 1);
  const pd = {t:48, r:20, b:40, l:88};
  const gW = W-pd.l-pd.r, gH = H-pd.t-pd.b;

  const bW   = Math.max(14, Math.floor(gW/keys.length*0.58));
  const bGap = (gW - bW*keys.length) / (keys.length+1);
  const y0   = pd.t + gH/2;

  // â”€â”€ ë°°ê²½ ê²©ì â”€â”€
  ctx.strokeStyle='rgba(255,255,255,.028)'; ctx.lineWidth=1;
  [0,.25,.5,.75,1].forEach(r=>{
    ctx.beginPath(); ctx.moveTo(pd.l, pd.t+gH*r); ctx.lineTo(W-pd.r, pd.t+gH*r); ctx.stroke();
  });

  // â”€â”€ 0 ê¸°ì¤€ì„  â”€â”€
  ctx.save();
  ctx.strokeStyle='rgba(255,255,255,.14)'; ctx.lineWidth=1.5;
  ctx.setLineDash([5,4]);
  ctx.beginPath(); ctx.moveTo(pd.l,y0); ctx.lineTo(W-pd.r,y0); ctx.stroke();
  ctx.restore();

  // â”€â”€ yì¶• ë ˆì´ë¸” â”€â”€
  ctx.font='10px "Roboto Mono",monospace'; ctx.textAlign='right';
  [
    [maxAbs, pd.t+12, 'rgba(240,62,62,.7)'],
    [maxAbs/2, pd.t+gH/4+4, 'rgba(240,62,62,.4)'],
    [0, y0+4, 'rgba(148,163,184,.4)'],
    [-maxAbs/2, pd.t+gH*3/4+4, 'rgba(29,126,214,.4)'],
    [-maxAbs, H-pd.b-2, 'rgba(29,126,214,.7)'],
  ].forEach(([v,yy,col])=>{
    ctx.fillStyle=col; ctx.fillText(fmtN(v,'KRW'), pd.l-8, yy);
  });

  // â”€â”€ ë§‰ëŒ€ â”€â”€
  keys.forEach((k,i)=>{
    const v = vals[i];
    const isP = v>=0;
    const pct = Math.abs(v)/maxAbs;
    const barH = Math.max(4, pct*(gH/2-8));
    const x  = pd.l + bGap + i*(bW+bGap);
    const by = isP ? y0-barH : y0;

    const br = Math.min(5, bW/3);

    // ê·¸ë¼ë””ì–¸íŠ¸
    const g = ctx.createLinearGradient(0, isP?by:y0, 0, isP?y0:by+barH);
    if(isP){
      g.addColorStop(0, PROFIT+'ff');
      g.addColorStop(0.7, PROFIT+'bb');
      g.addColorStop(1, PROFIT+'44');
    } else {
      g.addColorStop(0, LOSS+'44');
      g.addColorStop(0.3, LOSS+'bb');
      g.addColorStop(1, LOSS+'ff');
    }

    // ê¸€ë¡œìš° + ë§‰ëŒ€
    ctx.save();
    ctx.shadowColor = isP?PROFIT:LOSS;
    ctx.shadowBlur = pct > 0.7 ? 18 : pct > 0.3 ? 10 : 5;
    ctx.beginPath();
    if(isP){
      ctx.moveTo(x+br, by);
      ctx.lineTo(x+bW-br, by);
      ctx.arcTo(x+bW, by, x+bW, by+br, br);
      ctx.lineTo(x+bW, by+barH);
      ctx.lineTo(x, by+barH);
      ctx.arcTo(x, by, x+br, by, br);
    } else {
      ctx.moveTo(x, by);
      ctx.lineTo(x+bW, by);
      ctx.lineTo(x+bW, by+barH-br);
      ctx.arcTo(x+bW, by+barH, x+bW-br, by+barH, br);
      ctx.lineTo(x+br, by+barH);
      ctx.arcTo(x, by+barH, x, by+barH-br, br);
    }
    ctx.closePath();
    ctx.fillStyle=g; ctx.fill();
    ctx.restore();

    // ë§‰ëŒ€ í…Œë‘ë¦¬ (ìƒë‹¨ í•˜ì´ë¼ì´íŠ¸)
    ctx.save();
    ctx.strokeStyle = (isP?PROFIT:LOSS)+'55';
    ctx.lineWidth = 1;
    ctx.beginPath();
    if(isP){ ctx.moveTo(x+br,by); ctx.lineTo(x+bW-br,by); }
    else    { ctx.moveTo(x+br,by+barH); ctx.lineTo(x+bW-br,by+barH); }
    ctx.stroke(); ctx.restore();

    // â”€â”€ ê¸ˆì•¡ ë ˆì´ë¸” â”€â”€
    const amt = Math.round(v);
    const amtStr = (amt>=0?'+':'')+fmtN(amt,'KRW');
    ctx.save();
    ctx.font = `bold ${bW>30?11:9}px "Roboto Mono",monospace`;
    ctx.textAlign='center';

    // ë§í’ì„  ë°°ê²½
    const tw = ctx.measureText(amtStr).width + 10;
    const tx = Math.max(pd.l+tw/2, Math.min(W-pd.r-tw/2, x+bW/2));
    const ty = isP ? by-14 : by+barH+14;

    ctx.fillStyle = (isP?PROFIT:LOSS)+'20';
    ctx.beginPath();
    if(typeof ctx.roundRect === 'function')
      ctx.roundRect(tx-tw/2, ty-11, tw, 14, 3);
    else {
      ctx.rect(tx-tw/2, ty-11, tw, 14);
    }
    ctx.fill();
    ctx.fillStyle = isP?PROFIT:LOSS;
    ctx.fillText(amtStr, tx, ty);
    ctx.restore();

    // xì¶• ì›” ë ˆì´ë¸”
    ctx.fillStyle='rgba(148,163,184,.55)'; ctx.font='9px "Roboto Mono",monospace'; ctx.textAlign='center';
    ctx.fillText(k.slice(2), x+bW/2, H-10);
  });

  // â”€â”€ ì¶”ì„¸ì„  â”€â”€
  if(vals.length >= 3){
    const trendPts = keys.map((k,i)=>({
      x: pd.l + bGap + i*(bW+bGap) + bW/2,
      y: y0 - (vals[i]/maxAbs*(gH/2-8))
    }));
    ctx.save();
    ctx.setLineDash([4,5]);
    ctx.strokeStyle='rgba(250,204,21,.45)'; ctx.lineWidth=1.8;
    ctx.beginPath();
    trendPts.forEach((p,i)=> i===0 ? ctx.moveTo(p.x,p.y) : ctx.lineTo(p.x,p.y));
    ctx.stroke(); ctx.restore();
  }

  // â”€â”€ í•©ê³„ KPI â”€â”€
  const total = vals.reduce((s,v)=>s+v,0);
  const infoEl = document.getElementById('monthly-info');
  if(infoEl){ infoEl.textContent=(total>=0?'+':'')+fmtN(total,'KRW'); infoEl.style.color=total>=0?PROFIT:LOSS; }
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ë³µì›ëœ í•µì‹¬ í•¨ìˆ˜ë“¤
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â”€â”€ ìœ í‹¸ â”€â”€
function uid() {
  return Date.now().toString(36) + Math.random().toString(36).slice(2,6);
}

function getFundSummary(pos) {
  const map = {};
  pos.trades.filter(t=>t.type==='buy').forEach(t=>{
    const ft = t.fundType || 'cash';
    map[ft] = (map[ft]||0) + t.price * t.qty;
  });
  const total = Object.values(map).reduce((s,v)=>s+v,0);
  return { map, total };
}

function calcPosInterest(pos) {
  let interest = 0;
  const today = new Date(td());
  pos.trades.filter(t=>t.type==='buy' && (t.fundType==='credit'||t.fundType==='margin') && t.fundRate>0).forEach(t=>{
    const start = new Date(t.date);
    const days = Math.max(0, Math.round((today-start)/86400000));
    interest += t.price * t.qty * (t.fundRate/100) * (days/365);
  });
  return interest;
}

function delPos(id) {
  if (!confirm('í¬ì§€ì…˜ì„ ì‚­ì œí•˜ì‹œê² ì–´ìš”? ë³µêµ¬í•  ìˆ˜ ì—†ì–´ìš”.')) return;
  positions = positions.filter(p=>p.id!==id);
  savePos(); renderHolding(); renderClosed();
}

// â”€â”€ ìê¸ˆ ìœ í˜• ì„ íƒ â”€â”€
function setFundType(prefix, type) {
  ['cash','credit','margin'].forEach(t=>{
    const btn = document.getElementById(`${prefix}-ft-${t}`);
    if(!btn) return;
    btn.dataset.selected = (t===type) ? '1' : '0';
    if(t===type){
      btn.style.background = type==='cash'?'rgba(52,211,153,.15)':type==='credit'?'rgba(251,191,36,.15)':'rgba(239,68,68,.15)';
      btn.style.color = type==='cash'?'var(--profit)':type==='credit'?'var(--warn)':'var(--loss)';
      btn.style.border = type==='cash'?'1px solid rgba(52,211,153,.3)':type==='credit'?'1px solid rgba(251,191,36,.3)':'1px solid rgba(239,68,68,.3)';
    } else {
      btn.style.background='transparent'; btn.style.color='var(--muted)'; btn.style.border='1px solid var(--border)';
    }
  });
  const detail = document.getElementById(`${prefix}-fund-detail`);
  const dueWrap = document.getElementById(`${prefix}-margin-due-wrap`);
  const rateLbl = document.getElementById(`${prefix}-rate-lbl`);
  if(detail) detail.style.display = type==='cash' ? 'none' : 'block';
  if(dueWrap) dueWrap.style.display = type==='margin' ? 'block' : 'none';
  if(rateLbl) rateLbl.textContent = type==='credit' ? 'ì‹ ìš©ì´ììœ¨ (%/ë…„)' : 'ë¯¸ìˆ˜ì´ììœ¨ (%/ë…„)';
}

// â”€â”€ ë§¤ìˆ˜/ë§¤ë„ íƒ­ ì „í™˜ â”€â”€
function setTT(type) {
  const bBuy  = document.getElementById('tt-buy');
  const bSell = document.getElementById('tt-sell');
  activeTradeType = type;
  if(bBuy)  { bBuy.className  = 'btn btn-sm' + (type==='buy'  ? '' : ' btn-outline'); }
  if(bSell) { bSell.className = 'btn btn-sm' + (type==='sell' ? '' : ' btn-outline'); }
  const fw = document.getElementById('t-fund-wrap');
  if(fw) fw.style.display = type==='buy' ? 'block' : 'none';
}

// â”€â”€ ì‹œì¥ ë³€ê²½ ì‹œ í‹°ì»¤ ë ˆì´ë¸” ë³€ê²½ â”€â”€
function onMktChg() {
  const mkt = document.getElementById('np-market')?.value;
  const lbl = document.getElementById('tkr-lbl');
  const hint = document.getElementById('tkr-hint');
  if(!lbl) return;
  if(mkt==='KRX') {
    lbl.textContent = 'ì¢…ëª©ì½”ë“œ (êµ­ë‚´ ì‹œì„¸ ìë™ì¡°íšŒ)';
    if(hint) hint.innerHTML = '6ìë¦¬ ì½”ë“œ (ì˜ˆ: 005930 ì‚¼ì„±ì „ì) â€” <a href="https://finance.naver.com" target="_blank">ë„¤ì´ë²„ ê¸ˆìœµ</a>';
  } else if(mkt==='US') {
    lbl.textContent = 'í‹°ì»¤ (ë¯¸êµ­ ì£¼ì‹)';
    if(hint) hint.textContent = 'ì˜ˆ: AAPL, TSLA, NVDA';
  } else {
    lbl.textContent = 'ì¢…ëª©ì½”ë“œ/í‹°ì»¤';
    if(hint) hint.textContent = '';
  }
}

function onEpMktChg() {
  // í¸ì§‘ ëª¨ë‹¬ì—ì„œëŠ” ë³„ë„ ì²˜ë¦¬ ë¶ˆí•„ìš” (ë‹¨ìˆœ ë³€í™˜)
}

// â”€â”€ ë¯¸ë¦¬ë³´ê¸° (ëª©í‘œ/ì†ì ˆ ì†ìµë¹„) â”€â”€
function _calcPreview(price, target, stop) {
  price = parseFloat(price)||0; target = parseFloat(target)||0; stop = parseFloat(stop)||0;
  if(!price) return '';
  let txt = '';
  if(target) {
    const tPct = ((target-price)/price*100).toFixed(2);
    txt += `ğŸ¯ ëª©í‘œ +${tPct}%`;
  }
  if(stop) {
    const sPct = ((stop-price)/price*100).toFixed(2);
    txt += (txt?' Â· ':'')+`ğŸ›‘ ì†ì ˆ ${sPct}%`;
  }
  if(target && stop && stop < price) {
    const rr = Math.abs((target-price)/(price-stop));
    txt += ` Â· ì†ìµë¹„ ${rr.toFixed(2)}:1`;
  }
  return txt;
}

function npPreview() {
  const el = document.getElementById('np-preview'); if(!el) return;
  el.textContent = _calcPreview(
    document.getElementById('np-price')?.value,
    document.getElementById('np-target')?.value,
    document.getElementById('np-stop')?.value
  );
}

function epPreview() {
  const el = document.getElementById('ep-preview'); if(!el) return;
  const pos = positions.find(p=>p.id===document.getElementById('ep-id')?.value);
  if(!pos) return;
  const avgB = calcPos(pos).avgB;
  el.textContent = _calcPreview(
    avgB,
    document.getElementById('ep-target')?.value,
    document.getElementById('ep-stop')?.value
  );
}

// â”€â”€ ì´ë¯¸ì§€ ì²˜ë¦¬ â”€â”€
function handleImg(event, prefix) {
  const files = event.target.files;
  const container = document.getElementById(`${prefix}-imgs`);
  if(!container) return;
  [...files].forEach(file=>{
    const reader = new FileReader();
    reader.onload = e=>{
      const img = document.createElement('div');
      img.className='img-thumb';
      img.innerHTML=`<img src="${e.target.result}" onclick="openImgModal('${e.target.result}')"><button class="img-del" onclick="this.parentElement.remove()">Ã—</button>`;
      container.insertBefore(img, container.querySelector('.img-add')?.parentElement || null);
    };
    reader.readAsDataURL(file);
  });
}

function handleImgDrop(event, prefix) {
  event.preventDefault();
  const container = document.getElementById(`${prefix}-imgs`);
  if(!container) return;
  container.classList.remove('img-drag-over');
  [...event.dataTransfer.files].filter(f=>f.type.startsWith('image/')).forEach(file=>{
    const reader = new FileReader();
    reader.onload = e=>{
      const img = document.createElement('div');
      img.className='img-thumb';
      img.innerHTML=`<img src="${e.target.result}" onclick="openImgModal('${e.target.result}')"><button class="img-del" onclick="this.parentElement.remove()">Ã—</button>`;
      container.insertBefore(img, container.querySelector('label.img-add'));
    };
    reader.readAsDataURL(file);
  });
}

function _getImgs(prefix) {
  const thumbs = document.querySelectorAll(`#${prefix}-imgs .img-thumb img`);
  return [...thumbs].map(i=>i.src);
}

function openImgModal(src) {
  const img = document.getElementById('img-viewer');
  if(img) img.src = src;
  om('m-img');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ìƒˆ í¬ì§€ì…˜ ìƒì„±
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openNewPos() {
  // í¼ ì´ˆê¸°í™”
  ['np-name','np-ticker','np-price','np-qty','np-fee','np-target','np-stop','np-note'].forEach(id=>{
    const el=document.getElementById(id); if(el) el.value='';
  });
  document.getElementById('np-date').value = td();
  document.getElementById('np-market').value = 'KRX';
  document.getElementById('np-currency').value = 'KRW';
  document.getElementById('np-strategy').value = '';
  document.getElementById('np-emotion').value = '';
  document.getElementById('np-preview').textContent = '';
  const imgs = document.getElementById('np-imgs');
  if(imgs) imgs.querySelectorAll('.img-thumb').forEach(el=>el.remove());
  setFundType('np','cash');
  document.getElementById('np-fund-detail').style.display='none';
  ['np-split-plan','np-rr-plan','np-entry-basis'].forEach(id=>{const el=document.getElementById(id);if(el)el.value='';});
  const sr=document.getElementById('np-stop-reason');if(sr)sr.value='';
  onMktChg();
  om('m-newpos');
  setTimeout(bindNewPosAutocomplete, 50);
}

function saveNewPos() {
  const name  = document.getElementById('np-name').value.trim();
  const price = parseFloat(document.getElementById('np-price').value);
  const qty   = parseFloat(document.getElementById('np-qty').value);
  const date  = document.getElementById('np-date').value;
  if(!name)  { alert('ì¢…ëª©ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”'); return; }
  if(!price) { alert('ë§¤ìˆ˜ê°€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'); return; }
  if(!qty)   { alert('ìˆ˜ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”'); return; }
  if(!date)  { alert('ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'); return; }

  const ft   = ['cash','credit','margin'].find(t=>{ const b=document.getElementById(`np-ft-${t}`); return b && b.dataset.selected==='1'; }) || 'cash';
  const rate = parseFloat(document.getElementById('np-fund-rate')?.value)||0;
  const due  = document.getElementById('np-margin-due')?.value||'';

  const trade = {
    id: uid(), type:'buy', date, price, qty,
    fee: parseFloat(document.getElementById('np-fee').value)||0,
    emotion: document.getElementById('np-emotion').value||'',
    note: '',
    fundType: ft,
    ...(ft!=='cash' && rate ? {fundRate:rate} : {}),
    ...(ft==='margin' && due ? {marginDue:due} : {}),
    imgs: _getImgs('np'),
  };

  const pos = {
    id: uid(),
    name,
    market: document.getElementById('np-market').value,
    ticker: document.getElementById('np-ticker').value.trim(),
    currency: document.getElementById('np-currency').value,
    strategy: document.getElementById('np-strategy').value,
    targetPrice: parseFloat(document.getElementById('np-target').value)||null,
    stopPrice: parseFloat(document.getElementById('np-stop').value)||null,
    note: document.getElementById('np-note').value.trim(),
    status: 'holding',
    trades: [trade],
    currentPrice: null,
    // ì‚¬ì „ ê³„íš
    plan: {
      splitPlan:   document.getElementById('np-split-plan')?.value || '',
      rrPlan:      document.getElementById('np-rr-plan')?.value || '',
      entryBasis:  document.getElementById('np-entry-basis')?.value || '',
      stopReason:  document.getElementById('np-stop-reason')?.value.trim() || '',
    },
    // ì²­ì‚° í›„ ê°€ê²© ì¶”ì 
    closePriceTrack: {},
    // ë§¤ë§¤ ì²´í¬ë¦¬ìŠ¤íŠ¸ & ì ìˆ˜
    reviewChecklist: null,
    tradeScore: null,
  };

  positions.push(pos);
  savePos();
  cm('m-newpos');
  renderHolding();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ê±°ë˜ ì¶”ê°€ (ë§¤ìˆ˜/ë§¤ë„)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openAddTrade(posId, type) {
  activePosId = posId;
  const pos = positions.find(p=>p.id===posId); if(!pos) return;
  setTT(type);
  document.getElementById('t-date').value = td();
  ['t-price','t-qty','t-fee','t-note'].forEach(id=>{ const el=document.getElementById(id); if(el) el.value=''; });
  document.getElementById('t-emotion').value='';
  const imgs = document.getElementById('t-imgs');
  if(imgs) imgs.querySelectorAll('.img-thumb').forEach(el=>el.remove());
  document.getElementById('trade-title').textContent = (type==='buy'?'ğŸ“ˆ ì¶”ê°€ ë§¤ìˆ˜':'ğŸ“‰ ë§¤ë„') + ' â€” '+pos.name;
  setFundType('t','cash');
  om('m-trade');
}

function saveTrade() {
  const pos   = positions.find(p=>p.id===activePosId); if(!pos) return;
  const price = parseFloat(document.getElementById('t-price').value);
  const qty   = parseFloat(document.getElementById('t-qty').value);
  const date  = document.getElementById('t-date').value;
  if(!price||isNaN(price)) { alert('ê°€ê²©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”'); return; }
  if(!qty  ||isNaN(qty))   { alert('ìˆ˜ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”'); return; }
  if(!date)                { alert('ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'); return; }

  // ë§¤ë„ ì‹œ í•´ë‹¹ ë‚ ì§œ ê¸°ì¤€ ë³´ìœ ìˆ˜ëŸ‰ ì²´í¬
  if(activeTradeType==='sell') {
    // í•´ë‹¹ ë‚ ì§œ ì´ì „ ë§¤ìˆ˜/ë§¤ë„ ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°
    const prevTrades = pos.trades.filter(t => t.date <= date);
    const prevBuyQ  = prevTrades.filter(t=>t.type==='buy').reduce((s,t)=>s+t.qty,0);
    const prevSellQ = prevTrades.filter(t=>t.type==='sell').reduce((s,t)=>s+t.qty,0);
    const availQ = prevBuyQ - prevSellQ;
    if(qty > availQ) {
      alert(`${date} ê¸°ì¤€ ë³´ìœ ìˆ˜ëŸ‰(${availQ}ì£¼)ë³´ë‹¤ ë§ì´ ë§¤ë„í•  ìˆ˜ ì—†ì–´ìš”`);
      return;
    }
  }

  // fundType ì½ê¸° â€” data-selected ì‚¬ìš©
  const ftBtn = ['cash','credit','margin'].find(t=>{
    const b = document.getElementById(`t-ft-${t}`);
    return b && b.dataset.selected === '1';
  });
  const ft   = ftBtn || 'cash';
  const rate = parseFloat(document.getElementById('t-fund-rate')?.value)||0;
  const due  = document.getElementById('t-margin-due')?.value||'';

  const newTrade = {
    id: uid(), type: activeTradeType, date, price, qty,
    fee:     parseFloat(document.getElementById('t-fee').value)||0,
    emotion: document.getElementById('t-emotion').value||'',
    note:    document.getElementById('t-note').value.trim(),
    fundType: activeTradeType==='buy' ? ft : undefined,
    ...(activeTradeType==='buy' && ft!=='cash' && rate ? {fundRate:rate} : {}),
    ...(activeTradeType==='buy' && ft==='margin' && due ? {marginDue:due} : {}),
    imgs: _getImgs('t'),
  };
  if(newTrade.fundType === undefined) delete newTrade.fundType;

  pos.trades.push(newTrade);

  // ë‚ ì§œ ìˆœ ì •ë ¬ (ì¤‘ê°„ ë‚ ì§œ ì‚½ì… ì§€ì›)
  pos.trades.sort((a,b) => a.date.localeCompare(b.date));

  // status ìë™ ê´€ë¦¬
  const c = calcPos(pos);
  if(c.remQ <= 0) {
    pos.status = 'closed';
  } else {
    pos.status = 'holding'; // ì¬ë§¤ìˆ˜ ì‹œ holding ë³µê·€
  }

  savePos();
  cm('m-trade');
  renderHolding();
  renderClosed();

  if(c.remQ <= 0 && activeTradeType === 'sell') {
    // ì²­ì‚° ì™„ë£Œ â†’ ë³µê¸° ìœ ë„
    const closedPosId = pos.id;
    showToast('ğŸ‰ ' + pos.name + ' ì²­ì‚° ì™„ë£Œ!');
    setTimeout(() => {
      if(confirm('ğŸ“Š "' + pos.name + '" ë§¤ë§¤ ë³µê¸°ë¥¼ ì‘ì„±í• ê¹Œìš”?\n(ë‚˜ì¤‘ì— ì²­ì‚°ì™„ë£Œ íƒ­ì—ì„œë„ ê°€ëŠ¥í•´ìš”)')) {
        openReview(closedPosId);
      }
    }, 400);
  } else {
    showToast((activeTradeType==='buy'?'ğŸ“ˆ ë§¤ìˆ˜':'ğŸ“‰ ë§¤ë„') + ' ì¶”ê°€ ì™„ë£Œ â€” ' + pos.name);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  í¬ì§€ì…˜ ìˆ˜ì •
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openEditPos(posId) {
  const pos = positions.find(p=>p.id===posId); if(!pos) return;
  document.getElementById('ep-id').value     = posId;
  document.getElementById('ep-name').value   = pos.name;
  document.getElementById('ep-market').value = pos.market||'KRX';
  document.getElementById('ep-ticker').value = pos.ticker||'';
  document.getElementById('ep-currency').value = pos.currency||'KRW';
  document.getElementById('ep-strategy').value = pos.strategy||'';
  document.getElementById('ep-target').value = pos.targetPrice||'';
  document.getElementById('ep-stop').value   = pos.stopPrice||'';
  document.getElementById('ep-note').value   = pos.note||'';
  epPreview();

  // ê±°ë˜ ë‚´ì—­ ë¦¬ìŠ¤íŠ¸
  const c = calcPos(pos);
  const listEl = document.getElementById('ep-trades-list');
  if(listEl) {
    listEl.innerHTML = pos.trades.length ? `
      <div style="font-size:12px;font-weight:700;color:var(--muted);margin-bottom:7px">ê±°ë˜ ë‚´ì—­</div>
      ${pos.trades.sort((a,b)=>a.date.localeCompare(b.date)).map(t=>`
        <div style="display:flex;justify-content:space-between;align-items:center;padding:7px 10px;background:var(--s2);border-radius:7px;border:1px solid var(--border);margin-bottom:5px;font-size:12px">
          <span style="color:${t.type==='buy'?'var(--profit)':'var(--loss)'}">${t.type==='buy'?'ë§¤ìˆ˜':'ë§¤ë„'}</span>
          <span style="color:var(--muted)">${t.date}</span>
          <span class="mono">${fmtP(t.price,pos.currency)} Ã— ${t.qty}ì£¼</span>
          <div style="display:flex;gap:4px">
            <button class="btn btn-outline btn-xs" onclick="openEditTrade('${posId}','${t.id}')">âœï¸</button>
            <button class="btn btn-danger btn-xs" onclick="delTrade('${posId}','${t.id}')">ğŸ—‘</button>
          </div>
        </div>`).join('')}` : '<div style="font-size:12px;color:var(--muted)">ê±°ë˜ ë‚´ì—­ ì—†ìŒ</div>';
  }
  om('m-editpos');
  setTimeout(() => {
    const nameEl = document.getElementById('ep-name');
    const tickerEl = document.getElementById('ep-ticker');
    const mktEl = document.getElementById('ep-market');
    if(nameEl) {
      nameEl.addEventListener('input', () => {
        showStockDropdown(nameEl, s => {
          nameEl.value = s.name;
          if(tickerEl) tickerEl.value = s.code;
          if(mktEl) { mktEl.value = s.mkt==='US'?'US':'KRX'; mktEl.dispatchEvent(new Event('change')); }
        });
      });
      nameEl.addEventListener('blur', () => setTimeout(closeStockDropdown, 150));
    }
  }, 50);
}

function saveEditPos() {
  const id = document.getElementById('ep-id').value;
  const pos = positions.find(p=>p.id===id); if(!pos) return;
  pos.name     = document.getElementById('ep-name').value.trim() || pos.name;
  pos.market   = document.getElementById('ep-market').value;
  pos.ticker   = document.getElementById('ep-ticker').value.trim();
  pos.currency = document.getElementById('ep-currency').value;
  pos.strategy = document.getElementById('ep-strategy').value;
  pos.targetPrice = parseFloat(document.getElementById('ep-target').value)||null;
  pos.stopPrice   = parseFloat(document.getElementById('ep-stop').value)||null;
  pos.note     = document.getElementById('ep-note').value.trim();
  savePos(); cm('m-editpos'); renderHolding(); renderClosed();
}

// â”€â”€ ê±°ë˜ ìˆ˜ì •/ì‚­ì œ â”€â”€
function openEditTrade(posId, tradeId) {
  const pos = positions.find(p=>p.id===posId); if(!pos) return;
  const trade = pos.trades.find(t=>t.id===tradeId); if(!trade) return;
  activePosId = posId;
  document.getElementById('et-posid').value   = posId;
  document.getElementById('et-tradeid').value = tradeId;
  document.getElementById('et-date').value    = trade.date;
  document.getElementById('et-price').value   = trade.price;
  document.getElementById('et-qty').value     = trade.qty;
  document.getElementById('et-fee').value     = trade.fee||'';
  document.getElementById('et-emotion').value = trade.emotion||'';
  document.getElementById('et-note').value    = trade.note||'';
  const ft = trade.fundType||'cash';
  setFundType('et', ft);
  if(ft!=='cash') {
    document.getElementById('et-fund-rate').value = trade.fundRate||'';
    if(ft==='margin') document.getElementById('et-margin-due').value = trade.marginDue||'';
  }
  document.getElementById('edittrade-title').textContent = (trade.type==='buy'?'ğŸ“ˆ ë§¤ìˆ˜':'ğŸ“‰ ë§¤ë„')+' ìˆ˜ì •';
  om('m-edittrade');
}

function saveEditTrade() {
  const posId   = document.getElementById('et-posid').value;
  const tradeId = document.getElementById('et-tradeid').value;
  const pos = positions.find(p=>p.id===posId); if(!pos) return;
  const trade = pos.trades.find(t=>t.id===tradeId); if(!trade) return;
  trade.date  = document.getElementById('et-date').value;
  trade.price = parseFloat(document.getElementById('et-price').value)||trade.price;
  trade.qty   = parseFloat(document.getElementById('et-qty').value)||trade.qty;
  trade.fee   = parseFloat(document.getElementById('et-fee').value)||0;
  trade.emotion = document.getElementById('et-emotion').value||'';
  trade.note  = document.getElementById('et-note').value.trim();
  const ft = ['cash','credit','margin'].find(t=>{ const b=document.getElementById(`et-ft-${t}`); return b && b.dataset.selected==='1'; }) || 'cash';
  trade.fundType = ft;
  if(ft!=='cash') { trade.fundRate = parseFloat(document.getElementById('et-fund-rate')?.value)||0; }
  else { delete trade.fundRate; }
  if(ft==='margin') { trade.marginDue = document.getElementById('et-margin-due')?.value||''; }
  else { delete trade.marginDue; }
  // ë‚ ì§œ ìˆœ ì •ë ¬
  pos.trades.sort((a,b) => a.date.localeCompare(b.date));
  // ìƒíƒœ ì¬ê³„ì‚°
  const c = calcPos(pos);
  pos.status = c.remQ > 0 ? 'holding' : 'closed';
  savePos(); cm('m-edittrade');
  // í¸ì§‘ ëª¨ë‹¬ì´ ì—´ë ¤ìˆìœ¼ë©´ ê±°ë˜ ëª©ë¡ ê°±ì‹ 
  if(document.getElementById('m-editpos').classList.contains('show'))
    openEditPos(posId);
  renderHolding(); renderClosed();
}

function delTrade(posId, tradeId) {
  if(!confirm('ì´ ê±°ë˜ë¥¼ ì‚­ì œí•˜ì‹œê² ì–´ìš”?')) return;
  const pos = positions.find(p=>p.id===posId); if(!pos) return;
  pos.trades = pos.trades.filter(t=>t.id!==tradeId);
  if(!pos.trades.length) { positions = positions.filter(p=>p.id!==posId); savePos(); cm('m-editpos'); renderHolding(); renderClosed(); return; }
  const c = calcPos(pos);
  pos.status = c.remQ > 0 ? 'holding' : 'closed';
  savePos();
  openEditPos(posId); // ëª©ë¡ ê°±ì‹ 
  renderHolding(); renderClosed();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  í¬ì§€ì…˜ ìƒì„¸ ë³´ê¸°
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openDetail(posId) {
  const pos = positions.find(p=>p.id===posId); if(!pos) return;
  const c = calcPos(pos);
  document.getElementById('detail-title').textContent = pos.name + ' ìƒì„¸';
  const isHolding = pos.status==='holding';
  const pnlCol = isHolding ? (c.unrealPnL>=0?'var(--profit)':'var(--loss)') : (c.realPnL>=0?'var(--profit)':'var(--loss)');
  const pnl    = isHolding ? c.unrealPnL : c.realPnL;
  const pnlPct = isHolding ? c.unrealRate : c.realRate;

  document.getElementById('detail-body').innerHTML = `
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:14px">
      ${[
        ['í‰ê·  ë§¤ìˆ˜ê°€', fmtP(c.avgB,pos.currency), 'var(--text)'],
        isHolding ? ['í˜„ì¬ê°€', fmtP(c.cur,pos.currency), 'var(--text)'] : ['í‰ê·  ë§¤ë„ê°€', fmtP(c.avgS,pos.currency), 'var(--text)'],
        [isHolding?'í‰ê°€ ì†ìµ':'ì‹¤í˜„ ì†ìµ', (pnl>=0?'+':'')+fmtN(pnl,pos.currency), pnlCol],
        [isHolding?'ìˆ˜ìµë¥ ':'ì‹¤í˜„ ìˆ˜ìµë¥ ', (pnlPct>=0?'+':'')+pnlPct.toFixed(2)+'%', pnlCol],
        ['ë³´ìœ /ë§¤ë„ ìˆ˜ëŸ‰', (isHolding?c.remQ:c.tsq)+'ì£¼', 'var(--text)'],
        ['ì´ ìˆ˜ìˆ˜ë£Œ', fmtN(c.fees,pos.currency), 'var(--muted)'],
      ].map(([l,v,col])=>`
        <div style="background:var(--s2);border:1px solid var(--border);border-radius:8px;padding:10px 12px">
          <div style="font-size:10px;color:var(--muted);margin-bottom:3px">${l}</div>
          <div style="font-family:'Roboto Mono',monospace;font-size:13px;font-weight:700;color:${col}">${v}</div>
        </div>`).join('')}
    </div>
    ${(pos.targetPrice||pos.stopPrice)?`
    <div style="display:flex;gap:8px;margin-bottom:14px">
      ${pos.targetPrice?`<div style="flex:1;background:rgba(52,211,153,.07);border:1px solid rgba(52,211,153,.2);border-radius:8px;padding:9px 12px;font-size:12px"><span style="color:var(--muted)">ğŸ¯ ëª©í‘œê°€</span><br><b style="color:var(--profit)">${fmtP(pos.targetPrice,pos.currency)}</b></div>`:''}
      ${pos.stopPrice ?`<div style="flex:1;background:rgba(248,113,113,.07);border:1px solid rgba(248,113,113,.2);border-radius:8px;padding:9px 12px;font-size:12px"><span style="color:var(--muted)">ğŸ›‘ ì†ì ˆê°€</span><br><b style="color:var(--loss)">${fmtP(pos.stopPrice,pos.currency)}</b></div>`:''}
    </div>`:''}
    <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:8px">ê±°ë˜ ë‚´ì—­</div>
    <div style="display:flex;flex-direction:column;gap:5px;max-height:300px;overflow-y:auto">
      ${pos.trades.sort((a,b)=>a.date.localeCompare(b.date)).map(t=>`
        <div style="display:grid;grid-template-columns:auto auto 1fr 1fr auto;gap:8px;align-items:center;padding:8px 11px;background:var(--s2);border-radius:7px;border:1px solid var(--border)">
          <span style="font-size:11px;font-weight:700;color:${t.type==='buy'?'var(--profit)':'var(--loss)'}">${t.type==='buy'?'ë§¤ìˆ˜':'ë§¤ë„'}</span>
          <span style="font-size:11px;color:var(--muted)">${t.date}</span>
          <span style="font-family:'Roboto Mono',monospace;font-size:12px;text-align:right">${fmtP(t.price,pos.currency)}</span>
          <span style="font-family:'Roboto Mono',monospace;font-size:12px;text-align:right;color:var(--muted)">${t.qty}ì£¼</span>
          <span style="font-size:11px;color:var(--muted)">${
            t.type==='buy'
              ? ({'cash':'ğŸ’µí˜„ê¸ˆ','credit':'ğŸ’³ì‹ ìš©','margin':'âš¡ë¯¸ìˆ˜'})[t.fundType||'cash']
              : ''
          } ${t.emotion||''}</span>
        </div>
        ${t.note?`<div style="font-size:11px;color:var(--muted);padding:2px 11px 5px">${t.note}</div>`:''}
        ${t.imgs&&t.imgs.length?`<div style="display:flex;gap:4px;flex-wrap:wrap;padding:2px 11px 5px">${t.imgs.map(s=>`<img src="${s}" style="width:60px;height:40px;object-fit:cover;border-radius:4px;cursor:pointer" onclick="openImgModal('${s}')">`).join('')}</div>`:''}
      `).join('')}
    </div>
    ${pos.note?`<div style="margin-top:12px;padding:10px 12px;background:var(--s2);border-radius:8px;border:1px solid var(--border);font-size:12px;color:var(--muted)">${pos.note}</div>`:''}
    <div style="display:flex;gap:8px;margin-top:14px">
      <button class="btn btn-outline" style="flex:1" onclick="cm('m-detail')">ë‹«ê¸°</button>
      ${isHolding?`<button class="btn btn-primary" style="flex:1" onclick="cm('m-detail');openAddTrade('${posId}','sell')">ğŸ“‰ ë§¤ë„</button>`:''}
      <button class="btn btn-outline" style="flex:1" onclick="cm('m-detail');openEditPos('${posId}')">âœï¸ ìˆ˜ì •</button>
    </div>`;
  om('m-detail');
}

// â”€â”€ ë¹ ë¥¸ ë©”ëª¨ â”€â”€
function openQuickMemo(posId) {
  const pos = positions.find(p=>p.id===posId); if(!pos) return;
  const memo = prompt(`ğŸ“ ${pos.name} ë©”ëª¨ ìˆ˜ì •`, pos.note||'');
  if(memo===null) return;
  pos.note = memo;
  savePos(); renderHolding();
}

function closeQuickMemo() { cm('m-quickmemo'); }
function saveQuickMemo()  { cm('m-quickmemo'); }

// â”€â”€ í˜„ì¬ê°€ ìˆ˜ë™ ì…ë ¥ â”€â”€
function saveManualPrice() {
  const id = pricePosId;
  const price = parseFloat(document.getElementById('manual-price')?.value);
  if(!id||!price) { cm('m-price'); return; }
  const pos = positions.find(p=>p.id===id);
  if(pos) { pos.currentPrice=price; savePos(); }
  cm('m-price'); renderHolding();
}

// â”€â”€ ì•Œë¦¼ ì„¤ì • â”€â”€
function saveAlerts() { cm('m-alert'); }
function clearAlerts() {
  if(!confirm('ëª¨ë“  ì•Œë¦¼ì„ ì‚­ì œí•˜ì‹œê² ì–´ìš”?')) return;
  const pos = positions.find(p=>p.id===alertPosId);
  if(pos) { pos.targetPrice=null; pos.stopPrice=null; savePos(); }
  cm('m-alert'); renderHolding();
}
function updateAlertPreview() {}

// â”€â”€ ê²€ìƒ‰ â”€â”€
function openSearch() { om('m-search'); document.getElementById('search-q')?.focus(); }
function runSearch() {
  const q = (document.getElementById('search-q')?.value||'').toLowerCase();
  const res = document.getElementById('search-results');
  if(!res) return;
  if(!q) { res.innerHTML=''; return; }
  const found = positions.filter(p=>p.name.toLowerCase().includes(q)||(p.ticker||'').toLowerCase().includes(q));
  res.innerHTML = found.length
    ? found.map(p=>`<div style="padding:8px 10px;cursor:pointer;border-radius:6px;hover:background:var(--s2)" onclick="cm('m-search');openDetail('${p.id}')">${mTag(p.market)} <b>${p.name}</b> <span style="font-size:11px;color:var(--muted)">${p.ticker||''}</span></div>`).join('')
    : '<div style="font-size:13px;color:var(--muted);padding:8px">ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ</div>';
}

// â”€â”€ ìƒ˜í”Œ ë°ì´í„° â”€â”€
function showSample() {
  if(!confirm('ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ì‹œê² ì–´ìš”?')) return;
  const samples = [
    { name:'ì‚¼ì„±ì „ì', market:'KRX', ticker:'005930', currency:'KRW', strategy:'ì´ë™í‰ê· ì„ ',
      targetPrice:85000, stopPrice:68000, status:'holding', note:'ë°˜ë„ì²´ ì‚¬ì´í´ íšŒë³µ ê¸°ëŒ€',
      trades:[{id:uid(),type:'buy',date:'2024-10-15',price:72000,qty:100,fee:5000,emotion:'ğŸ’ª í™•ì‹ ',note:'20ì¼ì„  ì§€ì§€ í™•ì¸',fundType:'cash'}] },
    { name:'SKí•˜ì´ë‹‰ìŠ¤', market:'KRX', ticker:'000660', currency:'KRW', strategy:'ë‰´ìŠ¤/ê³µì‹œ',
      status:'closed', note:'HBM ìˆ˜ìš” ì¦ê°€',
      trades:[
        {id:uid(),type:'buy',date:'2024-08-20',price:180000,qty:20,fee:2000,emotion:'ğŸ˜ ëƒ‰ì •',note:'',fundType:'cash'},
        {id:uid(),type:'sell',date:'2024-11-10',price:210000,qty:20,fee:2000,emotion:'ğŸ’ª í™•ì‹ ',note:'ëª©í‘œ ë„ë‹¬',fundType:'cash'}
      ]},
  ];
  samples.forEach(s=>{ s.id=uid(); positions.push(s); });
  savePos(); renderHolding(); renderClosed();
  alert('ìƒ˜í”Œ ë°ì´í„°ê°€ ì¶”ê°€ëì–´ìš”!');
}

// â”€â”€ ë‚´ë³´ë‚´ê¸°/ê°€ì ¸ì˜¤ê¸° â”€â”€
function exportCSV() {
  const rows = [['ì¢…ëª©','ì‹œì¥','í†µí™”','ìƒíƒœ','í‰ê· ë§¤ìˆ˜ê°€','í‰ê· ë§¤ë„ê°€','ìˆ˜ëŸ‰','ì‹¤í˜„ì†ìµ','ìˆ˜ìµë¥ ']];
  positions.forEach(pos=>{
    const c=calcPos(pos);
    rows.push([pos.name,pos.market,pos.currency,pos.status,c.avgB.toFixed(0),c.avgS.toFixed(0),c.tsq||c.remQ,c.realPnL.toFixed(0),c.realRate.toFixed(2)+'%']);
  });
  const csv = rows.map(r=>r.join(',')).join('\n');
  const a=document.createElement('a'); a.href='data:text/csv;charset=utf-8,\uFEFF'+encodeURIComponent(csv); a.download='tradelog.csv'; a.click();
}


// â”€â”€ JSON ë³µì› â”€â”€
function handleRestoreDrop(e) {
  e.preventDefault();
  document.getElementById('restore-drop-zone').style.borderColor = 'var(--border)';
  const file = e.dataTransfer.files[0];
  if(file) processRestoreFile(file);
}
function handleRestoreFile(e) {
  const file = e.target.files[0];
  if(file) processRestoreFile(file);
}
function processRestoreFile(file) {
  if(!file.name.endsWith('.json')) {
    showToast('JSON íŒŒì¼ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤', true); return;
  }
  const reader = new FileReader();
  reader.onload = e => {
    try {
      const data = JSON.parse(e.target.result);
      if(!data.positions) throw new Error('ì˜¬ë°”ë¥¸ ë°±ì—… íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤');
      const infoEl = document.getElementById('restore-info');
      const posCount = data.positions.length;
      const tradeCount = data.positions.reduce((s,p)=>s+(p.trades?.length||0),0);
      infoEl.innerHTML = `
        <div style="font-weight:700;margin-bottom:6px">ğŸ“‹ ë³µì› ë¯¸ë¦¬ë³´ê¸°</div>
        <div>í¬ì§€ì…˜: <b>${posCount}ê°œ</b></div>
        <div>ê±°ë˜ë‚´ì—­: <b>${tradeCount}ê±´</b></div>
        <div>íŒŒì¼ëª…: <b>${file.name}</b></div>
        <div style="margin-top:8px;color:var(--warn);font-size:11px">âš ï¸ í˜„ì¬ ë°ì´í„°ê°€ ëª¨ë‘ êµì²´ë©ë‹ˆë‹¤</div>`;
      document.getElementById('restore-preview').style.display = 'block';
      document.getElementById('restore-preview')._data = data;
    } catch(err) {
      showToast('íŒŒì¼ ì˜¤ë¥˜: ' + err.message, true);
    }
  };
  reader.readAsText(file);
}
function doRestore() {
  const data = document.getElementById('restore-preview')._data;
  if(!data) return;
  if(!confirm('ì •ë§ ë³µì›í• ê¹Œìš”? í˜„ì¬ ë°ì´í„°ê°€ ëª¨ë‘ êµì²´ë©ë‹ˆë‹¤.')) return;
  positions = data.positions || [];
  templates = data.templates || [];
  journals  = data.journals  || [];
  goals     = data.goals     || [];
  rules     = data.rules     || [];
  events    = data.events    || [];
  savePos(); saveTmplStore(); saveGoalsStore(); saveRules(); saveEvents(); saveJournals();
  cm('m-json-restore');
  renderAll();
  showToast('âœ… ë³µì› ì™„ë£Œ! ' + positions.length + 'ê°œ í¬ì§€ì…˜');
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ğŸ“Š ë§¤ë§¤ ë³µê¸° ì‹œìŠ¤í…œ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let activeReviewPosId = null;

// ì²´í¬ë¦¬ìŠ¤íŠ¸ ì •ì˜
const BUY_CHECKS = [
  { id:'split',    label:'ë¶„í• ë§¤ìˆ˜ ê³„íšëŒ€ë¡œ ì§„í–‰í–ˆë‹¤ (ìµœì†Œ 2íšŒ ì´ìƒ)',         score:20, icon:'ğŸ“Š', tip:'ë“œëŸ¬ì¼„ë°€ëŸ¬: ì²« ë§¤ìˆ˜ëŠ” ì‘ê²Œ, í™•ì‹ ì´ ë†’ì•„ì§ˆìˆ˜ë¡ í¬ê²Œ' },
  { id:'basis',    label:'ê°/FOMOê°€ ì•„ë‹Œ ëª…í™•í•œ ê·¼ê±°ë¡œ ë§¤ìˆ˜í–ˆë‹¤',             score:25, icon:'ğŸ¯', tip:'í´íŠœë”ì¡´ìŠ¤: ê·¼ê±° ì—†ëŠ” ë§¤ìˆ˜ëŠ” ë„ë°•ì´ë‹¤' },
  { id:'stoploss', label:'ë§¤ìˆ˜ ì „ ì†ì ˆê°€ë¥¼ ë¯¸ë¦¬ ì •í–ˆë‹¤',                       score:25, icon:'ğŸ›‘', tip:'ì†ì ˆê°€ ì—†ì´ ì§„ì…í•˜ë©´ ì†ì‹¤ì´ ë¬´í•œì • ì»¤ì§ˆ ìˆ˜ ìˆë‹¤' },
  { id:'rr',       label:'ì†ìµë¹„ê°€ 1:2 ì´ìƒì´ì—ˆë‹¤ (ìœ„í—˜ ëŒ€ë¹„ 2ë°° ì´ìƒ ìˆ˜ìµ)',  score:15, icon:'âš–ï¸', tip:'ê¸°ëŒ€ê°’ì´ ì–‘ìˆ˜ì—¬ì•¼ ì¥ê¸°ì ìœ¼ë¡œ ìˆ˜ìµì„ ë‚¼ ìˆ˜ ìˆë‹¤' },
  { id:'timing',   label:'ì´ë¯¸ ë§ì´ ì˜¤ë¥¸ ê³³ì´ ì•„ë‹Œ ì¢‹ì€ íƒ€ì´ë°ì— ë§¤ìˆ˜í–ˆë‹¤',   score:15, icon:'â°', tip:'ìœŒë¦¬ì—„ ì˜¤ë‹: 52ì£¼ ì‹ ê³ ê°€ ëŒíŒŒ+ê±°ë˜ëŸ‰ ê¸‰ì¦ì´ ìµœì  íƒ€ì´ë°' },
];

const SELL_CHECKS = [
  { id:'basis_out',  label:'ê°ì •ì´ ì•„ë‹Œ ë§¤ìˆ˜ ê·¼ê±° ì†Œë©¸ ì‹œ íŒ”ì•˜ë‹¤',              score:30, icon:'ğŸ¯', tip:'í”¼í„° ë¦°ì¹˜: íŒ” ì´ìœ ëŠ” ì‚´ ì´ìœ ê°€ í‹€ë ¸ì„ ë•Œë¿ì´ë‹¤' },
  { id:'not_early',  label:'ìˆ˜ìµì´ ì¡°ê¸ˆ ë‚¬ë‹¤ê³  ë„ˆë¬´ ì¼ì° íŒ”ì§€ ì•Šì•˜ë‹¤',          score:20, icon:'â±', tip:'ìˆ˜ìµì€ ê¸¸ê²Œ, ì†ì‹¤ì€ ì§§ê²Œ â€” ì—­ë°©í–¥ì´ ë˜ë©´ ì•ˆëœë‹¤' },
  { id:'not_late',   label:'ìµœê³ ê°€ ëŒ€ë¹„ 15% ì´ìƒ ë¹ ì§„ í›„ì— íŒ”ì§€ ì•Šì•˜ë‹¤ (ì˜¤ë¥¸ìª½ì–´ê¹¨ íšŒí”¼)', score:20, icon:'ğŸ“‰', tip:'ìµœê³ ì  ì§€ë‚˜ì„œ íŒŒëŠ” ê±´ ê¸°íšŒë¹„ìš©ê³¼ ì‹¤ì†ìµ ëª¨ë‘ ì†í•´' },
  { id:'split_sell', label:'ë¶„í• ë§¤ë„ë¡œ ìˆ˜ìµì„ ê·¹ëŒ€í™”í–ˆë‹¤',                      score:15, icon:'âœ‚ï¸', tip:'ëª©í‘œê°€ì—ì„œ 1/3ì”© ë‚˜ëˆ  íŒ”ë©´ í›„íšŒë¥¼ ì¤„ì¼ ìˆ˜ ìˆë‹¤' },
  { id:'plan_sell',  label:'ë§¤ë„ê°€ ì‚¬ì „ì— ì„¸ìš´ ê³„íš ë‚´ì— ìˆì—ˆë‹¤',               score:15, icon:'ğŸ“‹', tip:'ì¶©ë™ì  ë§¤ë„ëŠ” ì¢‹ì€ ê²°ê³¼ë¥¼ ë‚´ë„ ë‚˜ìœ ìŠµê´€ì´ë‹¤' },
]

// ë³µê¸° íƒ­ ì „í™˜
function switchReviewTab(tab) {
  ['report','check','score','track'].forEach(t => {
    document.getElementById('rtab-' + t)?.classList.toggle('active', t === tab);
    const p = document.getElementById('rpanel-' + t);
    if(p) p.style.display = t === tab ? 'block' : 'none';
  });
  if(tab === 'score') renderScorePanel();
}

// ì²­ì‚° ì‹œ ìë™ìœ¼ë¡œ ë³µê¸° ëª¨ë‹¬ ì—´ê¸°
function openReview(posId, auto) {
  activeReviewPosId = posId;
  const pos = positions.find(p => p.id === posId);
  if(!pos) return;
  document.getElementById('review-title').textContent = 'ğŸ“Š ë³µê¸° â€” ' + pos.name;
  renderReviewReport(pos);
  renderReviewChecklist(pos);
  renderTrackPanel(pos);
  switchReviewTab('report');
  om('m-review');
}

// â”€â”€ ë³µê¸° ë¦¬í¬íŠ¸ â”€â”€
function renderReviewReport(pos) {
  const c    = calcPos(pos);
  const el   = document.getElementById('review-report-body');
  const plan = pos.plan || {};
  const sells = pos.trades.filter(t => t.type === 'sell').sort((a,b)=>a.date.localeCompare(b.date));
  const buys  = pos.trades.filter(t => t.type === 'buy').sort((a,b)=>a.date.localeCompare(b.date));
  const avgB  = c.avgB, avgS = c.avgS;
  const maxSell = sells.length ? Math.max(...sells.map(t=>t.price)) : avgS;
  const minBuy  = buys.length  ? Math.min(...buys.map(t=>t.price))  : avgB;
  const missedPct = maxSell > 0 ? (maxSell - avgS) / maxSell * 100 : 0;
  const actualSplits = buys.length;
  const plannedSplits = parseInt(plan.splitPlan) || 0;
  const actualRR = c.realPnL !== 0 && pos.stopPrice
    ? Math.abs(c.realPnL / ((avgB - pos.stopPrice) * c.tsq || 1)).toFixed(2) : null;
  const pnlCol  = c.realPnL >= 0 ? 'var(--profit)' : 'var(--loss)';
  const holdDays = dBetween(c.first, c.last);

  // â”€â”€ ë§¤ë„ íƒ€ì´ë° íŒì • â”€â”€
  const getTimingLabel = (sellPrice) => {
    const fromAvgB = avgB > 0 ? (sellPrice - avgB) / avgB * 100 : 0;
    const fromMax  = maxSell > 0 ? (sellPrice - maxSell) / maxSell * 100 : 0;
    if(fromAvgB < 0)        return { label:'ğŸ”´ ì†ì‹¤ ë§¤ë„',   col:'var(--loss)',   tip:'í‰ë‹¨ ì•„ë˜ì„œ ë§¤ë„ â€” ì†ì ˆ ì‹¤í–‰ ì—¬ë¶€ í™•ì¸' };
    if(fromAvgB < 3)        return { label:'ğŸŸ¡ ê·¹ì´ˆê¸° ìµì ˆ', col:'var(--warn)',   tip:'ìˆ˜ìµì´ ê±°ì˜ ì—†ì„ ë•Œ íŒ”ì•˜ì–´ìš” (ì™¼ìª½ì–´ê¹¨ ì˜ì‹¬)' };
    if(fromMax < -15)       return { label:'ğŸ”´ ì˜¤ë¥¸ìª½ì–´ê¹¨',  col:'var(--loss)',   tip:`ìµœê³ ê°€ ëŒ€ë¹„ ${Math.abs(fromMax).toFixed(1)}% í•˜ë½ í›„ ë§¤ë„ â€” ë„ˆë¬´ ëŠ¦ì—ˆì–´ìš”` };
    if(fromMax < -5)        return { label:'ğŸŸ¡ ê³ ì  ì§€ë‚œ í›„',col:'var(--warn)',   tip:`ìµœê³ ê°€ ëŒ€ë¹„ ${Math.abs(fromMax).toFixed(1)}% ì•„ë˜ì„œ ë§¤ë„` };
    if(pos.targetPrice && sellPrice >= pos.targetPrice)
                            return { label:'ğŸŸ¢ ëª©í‘œê°€ ë‹¬ì„±', col:'var(--profit)', tip:'ê³„íší•œ ëª©í‘œê°€ì—ì„œ ë§¤ë„í–ˆì–´ìš”' };
    return                         { label:'ğŸŸ¢ ì ì ˆí•œ ë§¤ë„', col:'var(--profit)', tip:'í‰ë‹¨ ëŒ€ë¹„ ì¶©ë¶„í•œ ìˆ˜ìµì—ì„œ ë§¤ë„' };
  };

  el.innerHTML = `
    <!-- â‘  í•µì‹¬ ê²°ê³¼ 3ê°œ -->
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:16px">
      <div class="stat-card" style="text-align:center">
        <div class="sc-l">ì‹¤í˜„ ì†ìµ</div>
        <div class="sc-v mono" style="color:${pnlCol}">${c.realPnL>=0?'+':''}${fmtN(Math.round(c.realPnL),pos.currency)}</div>
      </div>
      <div class="stat-card" style="text-align:center">
        <div class="sc-l">ìˆ˜ìµë¥ </div>
        <div class="sc-v" style="color:${pnlCol}">${c.realRate>=0?'+':''}${c.realRate.toFixed(2)}%</div>
      </div>
      <div class="stat-card" style="text-align:center">
        <div class="sc-l">ë³´ìœ ê¸°ê°„</div>
        <div class="sc-v">${holdDays}<span class="sc-u">ì¼</span></div>
      </div>
    </div>

    <!-- â‘¡ ì‚¬ì „ê³„íš vs ì‹¤ì œ ë¹„êµ -->
    <div style="font-size:12px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.6px;margin-bottom:8px">ğŸ“‹ ì‚¬ì „ê³„íš vs ì‹¤ì œ</div>
    <div style="background:var(--s2);border-radius:10px;overflow:hidden;margin-bottom:16px">
      <table style="width:100%;border-collapse:collapse;font-size:12px">
        <thead>
          <tr style="background:rgba(255,255,255,.03)">
            <th style="padding:8px 12px;text-align:left;color:var(--muted);font-weight:600">í•­ëª©</th>
            <th style="padding:8px 12px;text-align:center;color:var(--muted);font-weight:600">ì‚¬ì „ ê³„íš</th>
            <th style="padding:8px 12px;text-align:center;color:var(--muted);font-weight:600">ì‹¤ì œ ê²°ê³¼</th>
            <th style="padding:8px 12px;text-align:center;color:var(--muted);font-weight:600">í‰ê°€</th>
          </tr>
        </thead>
        <tbody>
          ${[
            {
              label: 'ë¶„í• ë§¤ìˆ˜',
              plan_:  plannedSplits ? plannedSplits + 'íšŒ' : 'ë¯¸ê¸°ë¡',
              actual: actualSplits + 'íšŒ',
              ok: plannedSplits ? actualSplits >= plannedSplits : null,
              tip: actualSplits === 1 ? '1íšŒ ì¼ê´„ë§¤ìˆ˜ â€” ë¶„í• ì´ ë” ì•ˆì „í•´ìš”' : null
            },
            {
              label: 'ë§¤ìˆ˜ ê·¼ê±°',
              plan_: ({ tech:'ê¸°ìˆ ë¶„ì„', fund:'í€ë”ë©˜í„¸', news:'ë‰´ìŠ¤/ê³µì‹œ', momentum:'ëª¨ë©˜í…€', gut:'ê°/ì§ê´€', fomo:'FOMO' })[plan.entryBasis] || 'ë¯¸ê¸°ë¡',
              actual: '',
              ok: plan.entryBasis && plan.entryBasis !== 'fomo' && plan.entryBasis !== 'gut' ? true : plan.entryBasis === 'fomo' ? false : null,
              tip: plan.entryBasis === 'fomo' ? 'âš ï¸ FOMO ë§¤ìˆ˜ëŠ” ì›ì¹™ ìœ„ë°˜ì´ì—ìš”' : null
            },
            {
              label: 'ì†ì ˆê°€',
              plan_: pos.stopPrice ? fmtP(pos.stopPrice, pos.currency) : 'âŒ ë¯¸ì„¤ì •',
              actual: '',
              ok: !!pos.stopPrice,
              tip: !pos.stopPrice ? 'ì†ì ˆê°€ ì—†ì´ ì§„ì…í•˜ë©´ ì†ì‹¤ì´ ì»¤ì§ˆ ìˆ˜ ìˆì–´ìš”' : null
            },
            {
              label: 'ëª©í‘œê°€',
              plan_: pos.targetPrice ? fmtP(pos.targetPrice, pos.currency) : 'âŒ ë¯¸ì„¤ì •',
              actual: avgS ? 'ì‹¤ì œ ë§¤ë„ ' + fmtP(avgS, pos.currency) : '',
              ok: pos.targetPrice ? (avgS >= pos.targetPrice) : null,
              tip: pos.targetPrice && avgS < pos.targetPrice ? `ëª©í‘œê°€(${fmtP(pos.targetPrice,pos.currency)}) ì „ì— ë§¤ë„í–ˆì–´ìš”` : null
            },
            actualRR ? {
              label: 'ì†ìµë¹„',
              plan_: plan.rrPlan ? '1:' + plan.rrPlan + ' ëª©í‘œ' : 'ë¯¸ì„¤ì •',
              actual: 'ì‹¤ì œ 1:' + actualRR,
              ok: plan.rrPlan ? parseFloat(actualRR) >= parseFloat(plan.rrPlan) : parseFloat(actualRR) >= 2,
              tip: parseFloat(actualRR) < 1 ? 'ì†ìµë¹„ 1 ë¯¸ë§Œ â€” ì†ì‹¤ì´ ìˆ˜ìµë³´ë‹¤ ì»¤ìš”' : null
            } : null,
          ].filter(Boolean).map(row => `
            <tr style="border-top:1px solid var(--border)">
              <td style="padding:8px 12px;font-weight:600">${row.label}</td>
              <td style="padding:8px 12px;text-align:center;color:var(--muted)">${row.plan_}</td>
              <td style="padding:8px 12px;text-align:center">${row.actual}</td>
              <td style="padding:8px 12px;text-align:center">
                ${row.ok === true ? '<span style="color:var(--profit)">âœ…</span>' : row.ok === false ? '<span style="color:var(--loss)">âŒ</span>' : '<span style="color:var(--muted)">â€”</span>'}
                ${row.tip ? `<div style="font-size:10px;color:var(--warn);margin-top:2px">${row.tip}</div>` : ''}
              </td>
            </tr>`).join('')}
        </tbody>
      </table>
    </div>

    <!-- â‘¢ ë§¤ë„ íƒ€ì´ë° ë¶„ì„ -->
    <div style="font-size:12px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.6px;margin-bottom:8px">â± ë§¤ë„ íƒ€ì´ë° ë¶„ì„</div>
    <div style="background:var(--s2);border-radius:10px;padding:12px 14px;margin-bottom:16px">
      <div style="display:flex;gap:16px;font-size:11px;color:var(--muted);margin-bottom:10px;flex-wrap:wrap">
        <span>ìµœì € ë§¤ìˆ˜ê°€ <b style="color:var(--text)">${fmtP(minBuy,pos.currency)}</b></span>
        <span>í‰ë‹¨ <b style="color:var(--text)">${fmtP(avgB,pos.currency)}</b></span>
        <span>ìµœê³  ë§¤ë„ê°€ <b style="color:var(--text)">${fmtP(maxSell,pos.currency)}</b></span>
        ${missedPct > 3 ? `<span style="color:var(--warn)">âš ï¸ ìµœê³ ê°€ ëŒ€ë¹„ ${missedPct.toFixed(1)}% ë‚®ê²Œ ë§¤ë„</span>` : ''}
      </div>
      ${sells.map((t, i) => {
        const timing = getTimingLabel(t.price);
        const fromAvgB = avgB > 0 ? (t.price - avgB) / avgB * 100 : 0;
        return `<div style="padding:8px 0;border-top:1px solid var(--border)">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:8px">
            <div>
              <span style="font-size:12px;font-weight:600">${i+1}ì°¨ ë§¤ë„</span>
              <span style="font-size:11px;color:var(--muted);margin-left:8px">${t.date} Â· ${fmtP(t.price,pos.currency)} Ã— ${t.qty}ì£¼</span>
            </div>
            <div style="text-align:right;flex-shrink:0">
              <div style="font-size:12px;font-weight:700;color:${timing.col}">${timing.label}</div>
              <div style="font-size:10px;color:${fromAvgB>=0?'var(--profit)':'var(--loss)'}">${fromAvgB>=0?'+':''}${fromAvgB.toFixed(1)}% vs í‰ë‹¨</div>
            </div>
          </div>
          ${timing.tip ? `<div style="font-size:11px;color:var(--muted);margin-top:3px">ğŸ’¡ ${timing.tip}</div>` : ''}
        </div>`;
      }).join('')}
    </div>

    <!-- â‘£ ë³µê¸° ë©”ëª¨ -->
    <div class="fg">
      <label class="flbl" style="display:flex;justify-content:space-between">
        <span>ğŸ“ ë³µê¸° ë©”ëª¨</span>
        <span style="font-size:11px;color:var(--muted);font-weight:400">ì´ë²ˆ ë§¤ë§¤ì—ì„œ ë°°ìš´ ì , ë‹¤ìŒì— ê°œì„ í•  ê²ƒ</span>
      </label>
      <textarea class="fi" id="review-memo" style="min-height:72px" placeholder="ì˜ˆ) ì˜¤ë¥¸ìª½ì–´ê¹¨ì—ì„œ íŒ”ì•˜ë‹¤. ë‹¤ìŒì—” ì¶”ì„¸ê°€ êº¾ì´ëŠ” ì‹ í˜¸(ê±°ë˜ëŸ‰ ê¸‰ê°+ì¥ëŒ€ìŒë´‰) í™•ì¸ í›„ ë¶„í• ë§¤ë„í•˜ì">${pos.reviewMemo||''}</textarea>
    </div>
    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
      <button class="btn btn-outline btn-sm" onclick="switchReviewTab('check')">âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸ â†’</button>
      <button class="btn btn-primary btn-sm" onclick="saveReview()">ğŸ’¾ ì €ì¥</button>
    </div>
  `;
}


// â”€â”€ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë Œë” â”€â”€
function renderReviewChecklist(pos) {
  const saved = pos.reviewChecklist || {};

  const renderGroup = (el_id, checks) => {
    const el = document.getElementById(el_id); if(!el) return;
    el.innerHTML = checks.map(chk => {
      const val = saved[chk.id];
      const statClass = val===true ? ' checked' : val===false ? ' checked-no' : '';
      return `<div class="check-item${statClass}" id="chk-${chk.id}"
        onclick="toggleReviewCheck('${chk.id}','${el_id}')"
        style="cursor:pointer;display:flex;flex-direction:column;gap:2px">
        <div style="display:flex;align-items:center;gap:8px">
          <span class="check-icon" style="font-size:16px;flex-shrink:0">${val===true?'âœ…':val===false?'âŒ':'â¬œ'}</span>
          <span style="font-size:13px;flex:1">${chk.icon} ${chk.label}</span>
          <span style="font-size:10px;color:var(--muted);flex-shrink:0">+${chk.score}ì </span>
        </div>
        ${chk.tip ? `<div style="font-size:10px;color:var(--muted);padding-left:28px;font-style:italic">"${chk.tip}"</div>` : ''}
      </div>`;
    }).join('');
  };

  renderGroup('checklist-buy',  BUY_CHECKS);
  renderGroup('checklist-sell', SELL_CHECKS);

  // í•˜ë‹¨ ì ìˆ˜ ë¯¸ë¦¬ë³´ê¸° ë™ê¸°í™”
  const live = calcTradeScore(pos);
  const liveEl = document.getElementById('score-live-preview');
  const liveEl2 = document.getElementById('score-live-preview-bottom');
  if(live !== null) {
    const col = live>=80?'var(--profit)':live>=50?'var(--warn)':'var(--loss)';
    const txt = `ì˜ˆìƒ ì ìˆ˜ <b style="color:${col};font-size:14px">${live}ì </b>`;
    if(liveEl) liveEl.innerHTML = txt;
    if(liveEl2) liveEl2.innerHTML = txt;
  }
}

function toggleReviewCheck(chkId, groupEl) {
  const pos = positions.find(p => p.id === activeReviewPosId); if(!pos) return;
  if(!pos.reviewChecklist) pos.reviewChecklist = {};
  const cur = pos.reviewChecklist[chkId];
  pos.reviewChecklist[chkId] = cur === undefined ? true : cur === true ? false : undefined;
  savePos(); // â† ì¦‰ì‹œ ì €ì¥
  renderReviewChecklist(pos);
  // ì‹¤ì‹œê°„ ì ìˆ˜ ë¯¸ë¦¬ë³´ê¸°
  const live = calcTradeScore(pos);
  const liveEl = document.getElementById('score-live-preview');
  if(liveEl && live !== null) {
    const col = live>=80?'var(--profit)':live>=50?'var(--warn)':'var(--loss)';
    liveEl.innerHTML = `ì˜ˆìƒ ì ìˆ˜ <b style="color:${col}">${live}ì </b>`;
  }
}

function saveReview() {
  const pos = positions.find(p => p.id === activeReviewPosId); if(!pos) return;
  pos.reviewMemo = document.getElementById('review-memo')?.value.trim() || '';
  // ì ìˆ˜ ê³„ì‚°
  pos.tradeScore = calcTradeScore(pos);
  savePos();
  renderScorePanel();
  switchReviewTab('score');
  showToast('âœ… ë³µê¸° ì €ì¥ ì™„ë£Œ! ì ìˆ˜: ' + pos.tradeScore + 'ì ');
  renderClosed();
}

// â”€â”€ ì ìˆ˜ ê³„ì‚° â”€â”€
function calcTradeScore(pos) {
  const chk = pos.reviewChecklist || {};
  const allChecks = [...BUY_CHECKS, ...SELL_CHECKS];
  let score = 0, possible = 0;
  allChecks.forEach(c => {
    if(chk[c.id] === true)  { score += c.score; possible += c.score; }
    else if(chk[c.id] === false) { possible += c.score; }
    // undefined = ë¯¸ì‘ë‹µ, ê°€ëŠ¥ì ìˆ˜ì—ì„œ ì œì™¸
  });
  if(possible === 0) return null;
  return Math.round(score / possible * 100);
}

function renderScorePanel() {
  const pos = positions.find(p => p.id === activeReviewPosId); if(!pos) return;
  const score = pos.tradeScore;
  const el = document.getElementById('review-score-body');
  if(score === null || score === undefined) {
    el.innerHTML = '<div style="text-align:center;padding:30px;color:var(--muted)">ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ë¨¼ì € ì‘ì„±í•´ì£¼ì„¸ìš”</div>';
    return;
  }
  const col  = score >= 80 ? 'var(--profit)' : score >= 50 ? 'var(--warn)' : 'var(--loss)';
  const grade = score >= 90 ? 'A+ ì™„ë²½í•œ ë§¤ë§¤' : score >= 80 ? 'A ì¢‹ì€ ë§¤ë§¤' :
                score >= 70 ? 'B í‰ê·  ì´ìƒ'    : score >= 50 ? 'C ê°œì„  í•„ìš”' : 'D ì›ì¹™ ìœ„ë°˜';
  const chk = pos.reviewChecklist || {};
  const fails = [...BUY_CHECKS, ...SELL_CHECKS].filter(c => chk[c.id] === false);

  el.innerHTML = `
    <div style="text-align:center;padding:20px 0 10px">
      <div class="score-ring" style="border-color:${col};color:${col}">${score}</div>
      <div style="font-size:18px;font-weight:800;color:${col};margin-bottom:4px">${grade}</div>
      <div style="font-size:12px;color:var(--muted)">${pos.name}</div>
    </div>

    ${fails.length ? `
    <div style="background:rgba(239,68,68,.07);border:1px solid rgba(239,68,68,.2);border-radius:10px;padding:12px 14px;margin-bottom:12px">
      <div style="font-size:12px;font-weight:700;color:var(--loss);margin-bottom:8px">âš ï¸ ê°œì„  í•„ìš” í•­ëª©</div>
      ${fails.map(c => `<div style="font-size:12px;padding:4px 0;color:var(--muted)">${c.icon} ${c.label}</div>`).join('')}
    </div>` : '<div style="text-align:center;color:var(--profit);padding:10px">ğŸ‰ ëª¨ë“  í•­ëª© í†µê³¼!</div>'}

    <div style="font-size:11px;color:var(--muted);text-align:center;margin-top:8px">
      ë‹¤ìŒ ë§¤ë§¤ì—ì„œ ê°œì„ í•˜ë©´ ì‹¤ë ¥ì´ ë¹ ë¥´ê²Œ ëŠ˜ì–´ìš”
    </div>
  `;
}

// â”€â”€ ì‚¬í›„ ì¶”ì  íŒ¨ë„ â”€â”€
function renderTrackPanel(pos) {
  const el = document.getElementById('review-track-body'); if(!el) return;
  const track = pos.closePriceTrack || {};
  const c = calcPos(pos);
  const avgS = c.avgS;

  const periods = [
    { key:'w1', label:'1ì£¼ì¼ í›„',  days:7  },
    { key:'w2', label:'2ì£¼ì¼ í›„',  days:14 },
    { key:'m1', label:'1ê°œì›” í›„',  days:30 },
    { key:'m3', label:'3ê°œì›” í›„',  days:90 },
  ];

  el.innerHTML = `
    <div style="background:rgba(0,153,255,.06);border:1px solid rgba(0,153,255,.15);border-radius:9px;padding:11px 14px;margin-bottom:14px;font-size:12px">
      ğŸ“Œ ë§¤ë„ í‰ê· ê°€ <b style="font-family:'Roboto Mono',monospace">${fmtP(avgS, pos.currency)}</b> ê¸°ì¤€ â€” ë§¤ë„ í›„ ê°€ê²©ì„ ê¸°ë¡í•˜ë©´ <b>"íŒ”ê¸¸ ì˜í–ˆë‚˜"</b>ë¥¼ ì•Œ ìˆ˜ ìˆì–´ìš”
    </div>

    <div style="display:flex;flex-direction:column;gap:10px;margin-bottom:16px">
    ${periods.map(p => {
      const saved = track[p.key];
      const diff  = saved && avgS ? ((saved - avgS) / avgS * 100) : null;
      const col   = diff === null ? 'var(--muted)' : diff >= 0 ? 'var(--loss)' : 'var(--profit)';
      const verdict = diff === null ? '' : diff >= 10 ? 'ğŸ˜¢ ë§ì´ ë” ì˜¬ëì–´ìš”' : diff >= 3 ? 'ğŸ˜… ì¡°ê¸ˆ ë” ì˜¬ëì–´ìš”' : diff >= -3 ? 'ğŸ˜ ë¹„ìŠ·í•´ìš”' : diff >= -10 ? 'ğŸ˜Š íŒ”ê¸¸ ì˜í–ˆì–´ìš”' : 'ğŸ‰ íƒì›”í•œ ë§¤ë„ íƒ€ì´ë°!';
      return `<div style="display:grid;grid-template-columns:90px 1fr auto auto;gap:8px;align-items:center;background:var(--s2);border-radius:8px;padding:10px 12px">
        <span style="font-size:12px;color:var(--muted);font-weight:600">${p.label}</span>
        <input type="number" class="fi" id="track-${p.key}" value="${saved||''}"
          placeholder="ê°€ê²© ì…ë ¥" style="padding:5px 8px;font-size:12px;max-width:160px"
          oninput="previewTrack('${p.key}', ${avgS})">
        <span id="track-diff-${p.key}" style="font-size:12px;font-weight:700;color:${col};min-width:70px;text-align:right">
          ${diff !== null ? (diff>=0?'+':'')+diff.toFixed(1)+'%' : ''}
        </span>
        <span id="track-verdict-${p.key}" style="font-size:11px;color:var(--muted);min-width:130px">
          ${verdict}
        </span>
      </div>`;
    }).join('')}
    </div>

    <div style="display:flex;gap:8px;justify-content:flex-end">
      <button class="btn btn-primary btn-sm" onclick="saveTrackPrices()">ğŸ’¾ ê°€ê²© ì €ì¥</button>
    </div>

    <!-- ì‹œê°í™” ì°¨íŠ¸ -->
    ${Object.keys(track).length > 0 ? `
    <div style="margin-top:16px;font-size:12px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.6px;margin-bottom:8px">ğŸ“Š ë§¤ë„ í›„ ê°€ê²© ì¶”ì´</div>
    <canvas id="track-chart" height="120"></canvas>
    ` : ''}
  `;

  // ì°¨íŠ¸ ê·¸ë¦¬ê¸°
  if(Object.keys(track).length > 0) {
    setTimeout(() => drawTrackChart(pos, avgS, track, periods), 100);
  }
}

function previewTrack(key, avgS) {
  const val = parseFloat(document.getElementById('track-' + key)?.value);
  if(isNaN(val) || !avgS) return;
  const diff = (val - avgS) / avgS * 100;
  const col = diff >= 0 ? 'var(--loss)' : 'var(--profit)';
  const verdict = diff >= 10 ? 'ğŸ˜¢ ë§ì´ ë” ì˜¬ëì–´ìš”' : diff >= 3 ? 'ğŸ˜… ì¡°ê¸ˆ ë” ì˜¬ëì–´ìš”' : diff >= -3 ? 'ğŸ˜ ë¹„ìŠ·í•´ìš”' : diff >= -10 ? 'ğŸ˜Š íŒ”ê¸¸ ì˜í–ˆì–´ìš”' : 'ğŸ‰ íƒì›”í•œ ë§¤ë„ íƒ€ì´ë°!';
  const diffEl = document.getElementById('track-diff-' + key);
  const vEl = document.getElementById('track-verdict-' + key);
  if(diffEl) { diffEl.style.color=col; diffEl.textContent=(diff>=0?'+':'')+diff.toFixed(1)+'%'; }
  if(vEl) vEl.textContent = verdict;
}

function drawTrackChart(pos, avgS, track, periods) {
  const canvas = document.getElementById('track-chart');
  if(!canvas || !avgS) return;
  const ctx = canvas.getContext('2d');
  const W = canvas.offsetWidth || 480;
  canvas.width = W; canvas.height = 120;
  const pts = [{ label:'ë§¤ë„ì‹œ', price: avgS }];
  periods.forEach(p => { if(track[p.key]) pts.push({ label:p.label, price:track[p.key] }); });
  if(pts.length < 2) return;
  const prices = pts.map(p=>p.price);
  const minP = Math.min(...prices)*0.99, maxP = Math.max(...prices)*1.01;
  const pad = { l:40, r:20, t:16, b:30 };
  const xStep = (W - pad.l - pad.r) / (pts.length-1);
  const yScale = p => pad.t + (1-(p-minP)/(maxP-minP)) * (120-pad.t-pad.b);
  ctx.clearRect(0,0,W,120);
  // ë§¤ë„ê°€ ê¸°ì¤€ì„ 
  ctx.strokeStyle='rgba(255,255,255,.15)'; ctx.setLineDash([4,4]); ctx.lineWidth=1;
  ctx.beginPath(); ctx.moveTo(pad.l, yScale(avgS)); ctx.lineTo(W-pad.r, yScale(avgS)); ctx.stroke();
  ctx.setLineDash([]);
  // ì„ 
  ctx.strokeStyle='var(--a2)'; ctx.lineWidth=2;
  ctx.beginPath();
  pts.forEach((p,i) => {
    const x = pad.l + i*xStep, y = yScale(p.price);
    i===0 ? ctx.moveTo(x,y) : ctx.lineTo(x,y);
  });
  ctx.stroke();
  // ì  + ë¼ë²¨
  pts.forEach((p,i) => {
    const x = pad.l+i*xStep, y = yScale(p.price);
    const col = p.price >= avgS ? '#f03e3e' : '#1d7ed6';
    ctx.fillStyle=col; ctx.beginPath(); ctx.arc(x,y,4,0,Math.PI*2); ctx.fill();
    ctx.fillStyle='rgba(255,255,255,.7)'; ctx.font='9px sans-serif';
    ctx.textAlign='center'; ctx.fillText(p.label, x, 120-pad.b+12);
    ctx.fillStyle=col; ctx.font='bold 10px sans-serif';
    ctx.fillText(Math.round(p.price).toLocaleString(), x, y-8);
  });
}


function saveTrackPrices() {
  const pos = positions.find(p => p.id === activeReviewPosId); if(!pos) return;
  if(!pos.closePriceTrack) pos.closePriceTrack = {};
  ['w1','w2','m1','m3'].forEach(key => {
    const val = parseFloat(document.getElementById('track-' + key)?.value);
    if(!isNaN(val) && val > 0) pos.closePriceTrack[key] = val;
  });
  savePos();
  renderTrackPanel(pos);
  showToast('âœ… ì‚¬í›„ ê°€ê²© ì €ì¥ ì™„ë£Œ');
}

// â”€â”€ ì²­ì‚° ì‹œ ìë™ ë³µê¸° ìœ ë„ â”€â”€
function promptReview(posId) {
  const pos = positions.find(p => p.id === posId); if(!pos) return;
  // í† ìŠ¤íŠ¸ì— ë³µê¸° ë²„íŠ¼ ì¶”ê°€
  const toastEl = document.querySelector('.al-pop');
  showToast(`ğŸ‰ ${pos.name} ì²­ì‚° ì™„ë£Œ!`);
  setTimeout(() => {
    if(confirm(`ğŸ“Š "${pos.name}" ë§¤ë§¤ ë³µê¸°ë¥¼ ì‘ì„±í• ê¹Œìš”?
(ë‚˜ì¤‘ì— ì²­ì‚°ì™„ë£Œ íƒ­ì—ì„œë„ ê°€ëŠ¥í•´ìš”)`)) {
      openReview(posId);
    }
  }, 300);
}

function backupJSON() { saveToFile(); }

function openImport() { openTradeImport(); }
function openTradeImport() {
  resetImport();
  om('m-trade-import');
}
function openJsonRestore() {
  document.getElementById('restore-preview').style.display = 'none';
  om('m-json-restore');
}
function handleImportFile(e) {
  const file = e.target.files[0]; if(!file) return;
  const reader = new FileReader();
  reader.onload = ev=>{
    try {
      const data = JSON.parse(ev.target.result);
      const preview = document.getElementById('import-preview');
      if(preview) preview.textContent = `í¬ì§€ì…˜ ${(data.positions||[]).length}ê°œ, ì €ë„ ${(data.journals||[]).length}ê°œ ê°ì§€ë¨`;
      document.getElementById('import-data').value = ev.target.result;
    } catch(err) { alert('íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•Šì•„ìš”'); }
  };
  reader.readAsText(file);
}

function doImport() {
  const raw = document.getElementById('import-data')?.value;
  if(!raw) { alert('íŒŒì¼ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”'); return; }
  try {
    const data = JSON.parse(raw);
    if(!confirm(`í¬ì§€ì…˜ ${(data.positions||[]).length}ê°œë¥¼ ê°€ì ¸ì˜¤ì‹œê² ì–´ìš”? ê¸°ì¡´ ë°ì´í„°ì— í•©ì³ì ¸ìš”.`)) return;
    if(data.positions) data.positions.forEach(p=>{ if(!positions.find(x=>x.id===p.id)) positions.push(p); });
    if(data.journals)  data.journals.forEach(j=>{ if(!journals.find(x=>x.id===j.id)) journals.push(j); });
    savePos(); saveJournals();
    cm('m-trade-import'); refreshAll();
    alert('ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ!');
  } catch(err) { alert('ì˜¤ë¥˜: '+err.message); }
}

function resetImport() { document.getElementById('import-data').value=''; const p=document.getElementById('import-preview'); if(p) p.textContent=''; }
function downloadTemplate() {
  const tmpl = {positions:[{id:'sample',name:'ì‚¼ì„±ì „ì',market:'KRX',ticker:'005930',currency:'KRW',strategy:'',status:'holding',note:'',targetPrice:null,stopPrice:null,trades:[{id:'t1',type:'buy',date:'2024-01-02',price:70000,qty:10,fee:500,emotion:'',note:'',fundType:'cash'}]}],journals:[],goals:[]};
  const a=document.createElement('a'); a.href='data:application/json;charset=utf-8,'+encodeURIComponent(JSON.stringify(tmpl,null,2)); a.download='tradelog_template.json'; a.click();
}

// â”€â”€ ë„ì›€ë§ â”€â”€
function openHelp() { om('m-help'); }
function helpNav(section) {
  document.querySelectorAll('.help-section').forEach(el=>el.style.display='none');
  const el=document.getElementById('help-'+section);
  if(el) el.style.display='block';
}

// â”€â”€ ì „ì²´ ìƒˆë¡œê³ ì¹¨ â”€â”€
function refreshAll() {
  renderHolding(); renderClosed(); renderCalendar();
  if(currentTab==='analytics') renderAnalytics();
  if(currentTab==='stats') renderStats();
  if(currentTab==='journal') renderJournal();
  if(currentTab==='goals') renderGoals();
  if(currentTab==='risk') renderRisk();
  if(currentTab==='rules') renderRules();
}

// â”€â”€ í…œí”Œë¦¿ â”€â”€
function renderTmpl() {
  const el = document.getElementById('tmpl-list');
  if (!el) return;
  if (!templates.length) {
    el.innerHTML = '<div style="color:var(--muted);font-size:12px;text-align:center;padding:12px 0">ì €ì¥ëœ í…œí”Œë¦¿ ì—†ìŒ</div>';
    return;
  }
  el.innerHTML = templates.map((t, i) => `
    <div style="display:flex;justify-content:space-between;align-items:center;padding:8px 10px;background:var(--s2);border-radius:8px;margin-bottom:6px">
      <div>
        <div style="font-size:13px;font-weight:600">${t.name}</div>
        <div style="font-size:11px;color:var(--muted)">${t.strategy||'ì „ëµì—†ìŒ'}${t.note?` Â· ${t.note.slice(0,30)}...`:''}</div>
      </div>
      <div style="display:flex;gap:6px">
        <button class="btn btn-outline btn-xs" onclick="applyTmpl(${i})">ì ìš©</button>
        <button class="btn btn-xs" style="background:rgba(240,62,62,.15);color:var(--loss)" onclick="delTmpl(${i})">ì‚­ì œ</button>
      </div>
    </div>`).join('');
}

function applyTmpl(i) {
  const t = templates[i]; if(!t) return;
  const s = document.getElementById('np-strategy');
  const n = document.getElementById('np-note');
  if(s) s.value = t.strategy||'';
  if(n) n.value = t.note||'';
  cm('m-tmpl');
  om('m-newpos');
  showToast('í…œí”Œë¦¿ ì ìš©ë¨: ' + t.name);
}

function delTmpl(i) {
  if(!confirm('í…œí”Œë¦¿ì„ ì‚­ì œí• ê¹Œìš”?')) return;
  templates.splice(i,1);
  saveTmplStore();
  renderTmpl();
}

function openTmpl() { renderTmpl(); om('m-tmpl'); }
function saveTmpl() {
  const name = document.getElementById('tmpl-name')?.value.trim();
  if(!name) { alert('í…œí”Œë¦¿ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”'); return; }
  const tmpl = {
    id: uid(),
    name,
    strategy: document.getElementById('tmpl-strategy')?.value || '',
    note:     document.getElementById('tmpl-note')?.value || '',
  };
  templates.push(tmpl);
  saveTmplStore();
  document.getElementById('tmpl-name').value = '';
  document.getElementById('tmpl-note').value = '';
  renderTmpl();
  showToast('í…œí”Œë¦¿ ì €ì¥ë¨: ' + name);
}

// â”€â”€ ëª©í‘œ â”€â”€
function openAddGoal() { om('m-add-goal'); }

// â”€â”€ ê·œì¹™ â”€â”€
function openAddRule() {
  const text = prompt('ìƒˆ ê·œì¹™ì„ ì…ë ¥í•˜ì„¸ìš”');
  if(!text?.trim()) return;
  if(!rules) window.rules=[];
  rules.push({id:uid(), text:text.trim(), type:'entry', active:true});
  saveRules(); renderRules();
}

// â”€â”€ Bulk í‹°ì»¤ â”€â”€

// â”€â”€ ê³„ì¢Œ/ê±°ë˜ë‚´ì—­ â”€â”€
function openAddAccount() { om('m-account'); }
function saveAccount() { cm('m-account'); }
function openAddTx() { om('m-tx'); }
function onTxTypeChg() {}
function saveTx() { cm('m-tx'); }
function openAddInterest() { om('m-interest'); }
function saveInterest() { cm('m-interest'); }

// â”€â”€ AI ë¶„ì„ â”€â”€
function runAI() { alert('AI ë¶„ì„ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì´ì—ìš”'); }

// â”€â”€ ë¦¬í¬íŠ¸ â”€â”€
function setReportPeriod(period) {
  // ë²„íŠ¼ í™œì„±í™”
  ['daily','weekly','monthly','custom'].forEach(p => {
    const b = document.getElementById('rpt-btn-'+p);
    if(b) { b.className = p===period ? 'btn btn-sm' : 'btn btn-outline btn-sm';
             if(p===period) b.style.background='var(--accent)',b.style.color='#0d1117',b.style.fontWeight='700';
             else b.style.background='',b.style.color='',b.style.fontWeight=''; }
  });
  const customRange = document.getElementById('rpt-custom-range');
  if(customRange) customRange.style.display = period==='custom' ? 'flex' : 'none';
  if(period !== 'custom') genFullReport(period);
}

function genFullReport(period) {
  const today = new Date(td());
  let from, to;
  if(!period || period==='daily') {
    from = to = td();
  } else if(period==='weekly') {
    const day = today.getDay();
    const mon = new Date(today); mon.setDate(today.getDate() - (day===0?6:day-1));
    from = mon.toISOString().slice(0,10); to = td();
  } else if(period==='monthly') {
    from = td().slice(0,7)+'-01'; to = td();
  } else if(period==='custom') {
    from = document.getElementById('rpt-from')?.value;
    to   = document.getElementById('rpt-to')?.value;
    if(!from||!to) { alert('ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”'); return; }
  }

  const PROFIT='#f03e3e', LOSS='#1d7ed6';
  const closed = positions.filter(p => p.status==='closed');
  const inRange = closed.filter(p => {
    const c = calcPos(p);
    return c.last >= from && c.last <= to;
  });
  const holding = positions.filter(p => p.status==='holding');

  // í†µê³„ ê³„ì‚°
  const wins  = inRange.filter(p => calcPos(p).realPnL > 0);
  const loses = inRange.filter(p => calcPos(p).realPnL <= 0);
  const totalPnL = inRange.reduce((s,p) => s + calcPos(p).realPnL, 0);
  const winRate  = inRange.length ? (wins.length/inRange.length*100) : 0;
  const avgPnL   = inRange.length ? totalPnL/inRange.length : 0;
  const maxWin   = wins.length  ? Math.max(...wins.map(p=>calcPos(p).realPnL)) : 0;
  const maxLoss  = loses.length ? Math.min(...loses.map(p=>calcPos(p).realPnL)) : 0;

  // ì „ëµë³„ ì§‘ê³„
  const stratMap = {};
  inRange.forEach(p => {
    const s = p.strategy||'ë¯¸ë¶„ë¥˜'; const c = calcPos(p);
    if(!stratMap[s]) stratMap[s] = {cnt:0, pnl:0, wins:0};
    stratMap[s].cnt++; stratMap[s].pnl += c.realPnL;
    if(c.realPnL>0) stratMap[s].wins++;
  });

  // ê°ì •ë³„ ì§‘ê³„
  const emoMap = {};
  inRange.forEach(p => {
    p.trades.filter(t=>t.type==='buy'&&t.emotion).forEach(t => {
      const e = t.emotion;
      if(!emoMap[e]) emoMap[e] = {cnt:0, pnl:0};
      const c = calcPos(p);
      emoMap[e].cnt++; emoMap[e].pnl += c.realPnL;
    });
  });

  // ê¸°ê°„ í‘œì‹œ
  const periodLabel = from===to ? from : from+' ~ '+to;
  const pnlCol = totalPnL>=0 ? PROFIT : LOSS;

  // ë³µê¸° ìš”ì•½ HTML ë¯¸ë¦¬ ìƒì„±
  const reviewedList = inRange.filter(p => p.tradeScore !== null && p.tradeScore !== undefined);
  let reviewSectionHTML = '';
  if (reviewedList.length) {
    const avgScore = reviewedList.reduce((s,p) => s + p.tradeScore, 0) / reviewedList.length;
    const scCol = s => s >= 80 ? '#2f9e44' : s >= 50 ? '#f08c00' : '#e03131';
    let rows = '';
    reviewedList.sort((a,b) => (b.tradeScore||0) - (a.tradeScore||0)).forEach(p => {
      const c = calcPos(p);
      const col = c.realPnL >= 0 ? PROFIT : LOSS;
      const chk = p.reviewChecklist || {};
      const checkedCount = Object.values(chk).filter(v => v === true).length;
      const totalChk = Object.keys(chk).length;
      rows += '<div style="background:var(--s2);border-radius:10px;padding:12px 14px;margin-bottom:8px">'
        + '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">'
        + '<div style="display:flex;align-items:center;gap:8px">'
        + '<span style="font-size:13px;font-weight:700">' + mTag(p.market) + ' ' + p.name + '</span>'
        + (p.strategy ? '<span style="font-size:10px;background:rgba(79,156,249,.15);color:var(--accent);padding:2px 7px;border-radius:20px">' + p.strategy + '</span>' : '')
        + '</div>'
        + '<div style="display:flex;align-items:center;gap:10px">'
        + '<span style="font-size:11px;font-family:monospace;color:' + col + ';font-weight:700">' + (c.realPnL>=0?'+':'') + fmtN(c.realPnL,p.currency) + ' (' + (c.realRate>=0?'+':'') + c.realRate.toFixed(2) + '%)</span>'
        + '<span style="font-size:15px;font-weight:900;font-family:monospace;color:' + scCol(p.tradeScore) + '">' + p.tradeScore + 'ì </span>'
        + '</div></div>'
        + (totalChk > 0 ? '<div style="font-size:11px;color:var(--muted);margin-bottom:4px">ì²´í¬ë¦¬ìŠ¤íŠ¸ ì¤€ìˆ˜ ' + checkedCount + '/' + totalChk + '</div>' : '')
        + (p.reviewMemo ? '<div style="font-size:12px;color:var(--muted);line-height:1.6;border-left:2px solid var(--accent);padding-left:10px">' + p.reviewMemo + '</div>' : '')
        + '</div>';
    });
    reviewSectionHTML = '<div style="background:var(--surface);border:1.5px solid var(--border);border-radius:14px;overflow:hidden;margin-bottom:14px">'
      + '<div style="padding:12px 18px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center">'
      + '<span style="font-weight:700;font-size:13px">ğŸ“‹ ë³µê¸° ìš”ì•½ (' + reviewedList.length + 'ê±´)</span>'
      + '<span style="font-size:12px;color:var(--muted)">í‰ê·  ì ìˆ˜ <b style="color:' + scCol(avgScore) + '">' + avgScore.toFixed(0) + 'ì </b></span>'
      + '</div>'
      + '<div style="padding:12px 14px">' + rows + '</div>'
      + '</div>';
  }

  const el = document.getElementById('report-output');
  if(!el) return;

  el.innerHTML = `
  <div style="font-family:'Pretendard',sans-serif;padding:0">

    <!-- í—¤ë” -->
    <div style="background:linear-gradient(135deg,var(--s2),var(--surface));border:1.5px solid var(--border);border-radius:16px;padding:20px 24px;margin-bottom:14px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-size:18px;font-weight:800;color:var(--text)">ğŸ“„ ë§¤ë§¤ ë¦¬í¬íŠ¸</div>
        <div style="font-size:12px;color:var(--muted);margin-top:3px">${periodLabel}</div>
      </div>
      <div style="text-align:right">
        <div style="font-size:26px;font-weight:900;font-family:'Roboto Mono',monospace;color:${pnlCol}">${totalPnL>=0?'+':''}${fmtN(totalPnL,'KRW')}</div>
        <div style="font-size:11px;color:var(--muted)">ê¸°ê°„ ì‹¤í˜„ ì†ìµ</div>
      </div>
    </div>

    <!-- KPI ì¹´ë“œ -->
    <div style="display:grid;grid-template-columns:repeat(5,1fr);gap:10px;margin-bottom:14px">
      ${[
        ['ë§¤ë§¤ íšŸìˆ˜', inRange.length+'ê±´', 'var(--text)'],
        ['ìŠ¹ë¥ ', winRate.toFixed(1)+'%', winRate>=50?PROFIT:LOSS],
        ['í‰ê·  ì†ìµ', (avgPnL>=0?'+':'')+fmtN(Math.round(avgPnL),'KRW'), avgPnL>=0?PROFIT:LOSS],
        ['ìµœëŒ€ ìˆ˜ìµ', '+'+fmtN(Math.round(maxWin),'KRW'), PROFIT],
        ['ìµœëŒ€ ì†ì‹¤', fmtN(Math.round(maxLoss),'KRW'), LOSS],
      ].map(([l,v,c])=>`
        <div style="background:var(--s2);border:1.5px solid var(--border);border-radius:12px;padding:14px 12px;text-align:center">
          <div style="font-size:10px;color:var(--muted);margin-bottom:5px;text-transform:uppercase;letter-spacing:.5px">${l}</div>
          <div style="font-size:15px;font-weight:800;font-family:'Roboto Mono',monospace;color:${c}">${v}</div>
        </div>`).join('')}
    </div>

    <!-- ì²­ì‚° ë‚´ì—­ -->
    ${inRange.length ? `
    <div style="background:var(--surface);border:1.5px solid var(--border);border-radius:14px;overflow:hidden;margin-bottom:14px">
      <div style="padding:12px 18px;border-bottom:1px solid var(--border);font-weight:700;font-size:13px;background:linear-gradient(90deg,rgba(29,111,242,.05),transparent)">
        ğŸ ì²­ì‚° ë‚´ì—­ <span style="font-size:11px;font-weight:400;color:var(--muted)">(${inRange.length}ê±´)</span>
      </div>
      <table style="width:100%;border-collapse:collapse;font-size:12px">
        <thead><tr style="border-bottom:1px solid var(--border);color:var(--muted)">
          <th style="padding:8px 14px;text-align:left;font-weight:600">ì¢…ëª©</th>
          <th style="padding:8px 10px;text-align:right;font-weight:600">ë§¤ìˆ˜ê°€</th>
          <th style="padding:8px 10px;text-align:right;font-weight:600">ë§¤ë„ê°€</th>
          <th style="padding:8px 10px;text-align:right;font-weight:600">ì†ìµ</th>
          <th style="padding:8px 10px;text-align:right;font-weight:600">ìˆ˜ìµë¥ </th>
          <th style="padding:8px 10px;text-align:right;font-weight:600">ì²­ì‚°ì¼</th>
        </tr></thead>
        <tbody>
          ${inRange.sort((a,b)=>calcPos(b).realPnL-calcPos(a).realPnL).map(p=>{
            const c=calcPos(p); const col=c.realPnL>=0?PROFIT:LOSS;
            return `<tr style="border-bottom:1px solid rgba(255,255,255,.04)">
              <td style="padding:9px 14px;font-weight:600">${mTag(p.market)} ${p.name}</td>
              <td style="padding:9px 10px;text-align:right;font-family:'Roboto Mono',monospace">${fmtP(c.avgB,p.currency)}</td>
              <td style="padding:9px 10px;text-align:right;font-family:'Roboto Mono',monospace">${fmtP(c.avgS,p.currency)}</td>
              <td style="padding:9px 10px;text-align:right;font-family:'Roboto Mono',monospace;font-weight:700;color:${col}">${c.realPnL>=0?'+':''}${fmtN(c.realPnL,p.currency)}</td>
              <td style="padding:9px 10px;text-align:right;font-family:'Roboto Mono',monospace;color:${col}">${c.realRate>=0?'+':''}${c.realRate.toFixed(2)}%</td>
              <td style="padding:9px 10px;text-align:right;color:var(--muted)">${c.last}</td>
            </tr>`;
          }).join('')}
        </tbody>
      </table>
    </div>` : `<div style="text-align:center;padding:32px;color:var(--muted);font-size:13px">ì´ ê¸°ê°„ì— ì²­ì‚°ëœ í¬ì§€ì…˜ì´ ì—†ì–´ìš”</div>`}

    <!-- ì „ëµë³„ ì„±ê³¼ + ê°ì • ë¶„ì„ -->
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px">

      ${Object.keys(stratMap).length ? `
      <div style="background:var(--surface);border:1.5px solid var(--border);border-radius:14px;overflow:hidden">
        <div style="padding:12px 18px;border-bottom:1px solid var(--border);font-weight:700;font-size:13px">ğŸ¯ ì „ëµë³„ ì„±ê³¼</div>
        <div style="padding:12px 14px;display:flex;flex-direction:column;gap:7px">
          ${Object.entries(stratMap).sort((a,b)=>b[1].pnl-a[1].pnl).map(([s,d])=>{
            const wr = d.cnt ? d.wins/d.cnt*100 : 0;
            const col = d.pnl>=0?PROFIT:LOSS;
            return `<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 10px;background:var(--s2);border-radius:8px">
              <span style="font-size:12px;font-weight:600">${s}</span>
              <div style="display:flex;gap:10px;align-items:center">
                <span style="font-size:11px;color:var(--muted)">${d.cnt}ê±´ Â· ${wr.toFixed(0)}%ìŠ¹</span>
                <span style="font-family:'Roboto Mono',monospace;font-size:12px;font-weight:700;color:${col}">${d.pnl>=0?'+':''}${fmtN(Math.round(d.pnl),'KRW')}</span>
              </div>
            </div>`;
          }).join('')}
        </div>
      </div>` : '<div></div>'}

      ${Object.keys(emoMap).length ? `
      <div style="background:var(--surface);border:1.5px solid var(--border);border-radius:14px;overflow:hidden">
        <div style="padding:12px 18px;border-bottom:1px solid var(--border);font-weight:700;font-size:13px">ğŸ˜¶ ê°ì •ë³„ ê²°ê³¼</div>
        <div style="padding:12px 14px;display:flex;flex-direction:column;gap:7px">
          ${Object.entries(emoMap).sort((a,b)=>b[1].pnl-a[1].pnl).map(([e,d])=>{
            const col = d.pnl>=0?PROFIT:LOSS;
            return `<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 10px;background:var(--s2);border-radius:8px">
              <span style="font-size:12px">${e}</span>
              <div style="display:flex;gap:10px;align-items:center">
                <span style="font-size:11px;color:var(--muted)">${d.cnt}ê±´</span>
                <span style="font-family:'Roboto Mono',monospace;font-size:12px;font-weight:700;color:${col}">${d.pnl>=0?'+':''}${fmtN(Math.round(d.pnl),'KRW')}</span>
              </div>
            </div>`;
          }).join('')}
        </div>
      </div>` : '<div></div>'}
    </div>

    <!-- ë³µê¸° ìš”ì•½ -->
    ${reviewSectionHTML}

    <!-- í˜„ì¬ ë³´ìœ  í¬ì§€ì…˜ ìš”ì•½ -->
    ${holding.length ? `
    <div style="background:var(--surface);border:1.5px solid var(--border);border-radius:14px;overflow:hidden">
      <div style="padding:12px 18px;border-bottom:1px solid var(--border);font-weight:700;font-size:13px">ğŸ“Š í˜„ì¬ ë³´ìœ  (${holding.length}ì¢…ëª©)</div>
      <div style="padding:12px 14px;display:flex;flex-direction:column;gap:6px">
        ${holding.map(p=>{
          const c=calcPos(p); const col=c.unrealPnL>=0?PROFIT:LOSS;
          return `<div style="display:flex;justify-content:space-between;align-items:center;padding:7px 10px;background:var(--s2);border-radius:7px">
            <span style="font-size:12px;font-weight:600">${mTag(p.market)} ${p.name}</span>
            <div style="display:flex;gap:12px;align-items:center">
              <span style="font-size:11px;color:var(--muted)">${fmtP(c.avgB,p.currency)} Ã— ${c.remQ}ì£¼</span>
              <span style="font-family:'Roboto Mono',monospace;font-size:12px;font-weight:700;color:${col}">${c.unrealPnL>=0?'+':''}${fmtN(Math.round(c.unrealPnL),p.currency)} (${c.unrealRate>=0?'+':''}${c.unrealRate.toFixed(2)}%)</span>
            </div>
          </div>`;
        }).join('')}
      </div>
    </div>` : ''}

  </div>`;
}

function genReviewReport(period) {
  // ê¸°ê°„ ë²„íŠ¼ í™œì„±í™” í‘œì‹œ
  ['all','weekly','monthly'].forEach(p => {
    const btn = document.getElementById('rvr-btn-' + p);
    if (!btn) return;
    btn.className = p === (period||'all') ? 'btn btn-sm' : 'btn btn-outline btn-sm';
    if (p === (period||'all')) { btn.style.background='var(--accent)'; btn.style.color='#0d1117'; btn.style.fontWeight='700'; }
    else { btn.style.background=''; btn.style.color=''; btn.style.fontWeight=''; }
  });

  const today = new Date(td());
  let from = null, to = null;
  if (period === 'weekly') {
    const day = today.getDay();
    const mon = new Date(today); mon.setDate(today.getDate() - (day===0?6:day-1));
    from = mon.toISOString().slice(0,10); to = td();
  } else if (period === 'monthly') {
    from = td().slice(0,7)+'-01'; to = td();
  }

  const PROFIT='#f03e3e', LOSS='#1d7ed6';
  const reviewed = positions.filter(p => p.status==='closed' && p.tradeScore !== null && p.tradeScore !== undefined);
  const filtered = from ? reviewed.filter(p => { const c=calcPos(p); return c.last >= from && c.last <= to; }) : reviewed;

  const el = document.getElementById('review-report-output');
  if (!el) return;

  if (!filtered.length) {
    el.innerHTML = '<div style="text-align:center;padding:52px;color:var(--muted)"><div style="font-size:32px;margin-bottom:10px;opacity:.4">ğŸ“‹</div><div style="font-size:13px">ì´ ê¸°ê°„ì— ë³µê¸°ëœ ë§¤ë§¤ê°€ ì—†ì–´ìš”.<br>ì²­ì‚°ì™„ë£Œ íƒ­ì—ì„œ ğŸ“Š ë³µê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ ë³µê¸°ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”!</div></div>';
    return;
  }

  const avgScore = filtered.reduce((s,p) => s + p.tradeScore, 0) / filtered.length;
  const scCol = s => s >= 80 ? '#2f9e44' : s >= 50 ? '#f08c00' : '#e03131';
  const totalPnL = filtered.reduce((s,p) => s + calcPos(p).realPnL, 0);
  const wins = filtered.filter(p => calcPos(p).realPnL > 0);
  const winRate = filtered.length ? wins.length/filtered.length*100 : 0;

  // ì ìˆ˜ëŒ€ë³„ ë¶„ë¥˜
  const gradeA = filtered.filter(p => p.tradeScore >= 80);
  const gradeB = filtered.filter(p => p.tradeScore >= 50 && p.tradeScore < 80);
  const gradeC = filtered.filter(p => p.tradeScore < 50);

  // ì¹´ë“œ HTML ìƒì„±
  function makeCard(p) {
    const c = calcPos(p);
    const col = c.realPnL >= 0 ? PROFIT : LOSS;
    const chk = p.reviewChecklist || {};
    const checkedCount = Object.values(chk).filter(v => v === true).length;
    const totalChk = Object.keys(chk).length;

    // ì‚¬í›„ ì¶”ì 
    const track = p.closePriceTrack || {};
    const avgS = c.avgS;
    const trackPeriods = [{key:'w1',label:'1ì£¼'},{key:'w2',label:'2ì£¼'},{key:'m1',label:'1ê°œì›”'},{key:'m3',label:'3ê°œì›”'}];
    const trackItems = trackPeriods.filter(tp => track[tp.key]);
    let trackHTML = '';
    if (trackItems.length && avgS) {
      const verdict = diff => diff >= 10 ? 'ğŸ˜¢ ë§ì´ ì˜¬ëì–´ìš”' : diff >= 3 ? 'ğŸ˜… ì¡°ê¸ˆ ì˜¬ëì–´ìš”' : diff >= -3 ? 'ğŸ˜ ë¹„ìŠ·í•´ìš”' : diff >= -10 ? 'ğŸ˜Š ì˜ íŒ”ì•˜ì–´ìš”' : 'ğŸ‰ íƒì›”í•œ íƒ€ì´ë°!';
      trackHTML = '<div style="margin-top:10px;padding-top:10px;border-top:1px solid rgba(255,255,255,.07)">'
        + '<div style="font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:.6px;margin-bottom:7px">ğŸ“… ì‚¬í›„ ì¶”ì  <span style="font-size:10px;font-weight:400">(ë§¤ë„ê°€ ' + fmtP(avgS, p.currency) + ' ê¸°ì¤€)</span></div>'
        + '<div style="display:flex;gap:6px;flex-wrap:wrap">'
        + trackItems.map(tp => {
            const diff = (track[tp.key] - avgS) / avgS * 100;
            const tcol = diff >= 0 ? LOSS : PROFIT;
            return '<div style="background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:4px 8px;display:flex;align-items:center;gap:8px">'
              + '<span style="font-size:10px;color:var(--muted);white-space:nowrap">' + tp.label + '</span>'
              + '<span style="font-family:monospace;font-size:12px;font-weight:700;color:' + tcol + '">' + (diff>=0?'+':'') + diff.toFixed(1) + '%</span>'
              + '<span style="font-size:10px;color:var(--muted)">' + verdict(diff) + '</span>'
              + '</div>';
          }).join('')
        + '</div></div>';
    }

    return '<div style="background:var(--s2);border-radius:10px;padding:14px;margin-bottom:10px;border:1.5px solid var(--border)">'
      + '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">'
      + '<div style="display:flex;align-items:center;gap:8px">'
      + '<span style="font-size:14px;font-weight:700">' + mTag(p.market) + ' ' + p.name + '</span>'
      + (p.strategy ? '<span style="font-size:10px;background:rgba(79,156,249,.15);color:var(--accent);padding:2px 8px;border-radius:20px">' + p.strategy + '</span>' : '')
      + '</div>'
      + '<span style="font-size:20px;font-weight:900;font-family:monospace;color:' + scCol(p.tradeScore) + '">' + p.tradeScore + 'ì </span>'
      + '</div>'
      + '<div style="display:flex;gap:16px;font-size:11px;color:var(--muted);margin-bottom:' + (p.reviewMemo||trackItems.length?'8px':'0') + '">'
      + '<span>ì†ìµ <b style="color:' + col + ';font-family:monospace">' + (c.realPnL>=0?'+':'') + fmtN(c.realPnL,p.currency) + ' (' + (c.realRate>=0?'+':'') + c.realRate.toFixed(2) + '%)</b></span>'
      + '<span>ì²­ì‚°ì¼ <b>' + c.last + '</b></span>'
      + (totalChk > 0 ? '<span>ì²´í¬ë¦¬ìŠ¤íŠ¸ <b>' + checkedCount + '/' + totalChk + '</b></span>' : '')
      + '</div>'
      + (p.reviewMemo ? '<div style="font-size:12px;color:var(--muted);line-height:1.6;border-left:2px solid var(--accent);padding-left:10px;margin-bottom:' + (trackItems.length?'0':'0') + '">' + p.reviewMemo + '</div>' : '')
      + trackHTML
      + '</div>';
  }

  function makeGradeSection(title, color, list) {
    if (!list.length) return '';
    return '<div style="background:var(--surface);border:1.5px solid var(--border);border-radius:14px;overflow:hidden;margin-bottom:14px">'
      + '<div style="padding:12px 18px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:8px">'
      + '<span style="font-size:15px;font-weight:800;color:' + color + '">' + title + '</span>'
      + '<span style="font-size:11px;color:var(--muted)">' + list.length + 'ê±´</span>'
      + '</div>'
      + '<div style="padding:12px 14px">' + list.map(makeCard).join('') + '</div>'
      + '</div>';
  }

  const periodLabel = from ? (from + ' ~ ' + to) : 'ì „ì²´ ê¸°ê°„';

  el.innerHTML = ''
    // í—¤ë”
    + '<div style="background:linear-gradient(135deg,var(--s2),var(--surface));border:1.5px solid var(--border);border-radius:16px;padding:20px 24px;margin-bottom:14px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px">'
    + '<div><div style="font-size:18px;font-weight:800;color:var(--text)">ğŸ“‹ ë³µê¸° ë¦¬í¬íŠ¸</div>'
    + '<div style="font-size:12px;color:var(--muted);margin-top:3px">' + periodLabel + '</div></div>'
    + '<div style="text-align:right">'
    + '<div style="font-size:26px;font-weight:900;font-family:monospace;color:' + scCol(avgScore) + '">' + avgScore.toFixed(0) + 'ì </div>'
    + '<div style="font-size:11px;color:var(--muted)">í‰ê·  ë³µê¸° ì ìˆ˜</div>'
    + '</div></div>'
    // KPI
    + '<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:14px">'
    + [['ë³µê¸° ê±´ìˆ˜', filtered.length+'ê±´', 'var(--text)'], ['ìŠ¹ë¥ ', winRate.toFixed(1)+'%', winRate>=50?PROFIT:LOSS],
       ['ì´ ì†ìµ', (totalPnL>=0?'+':'')+fmtN(Math.round(totalPnL),'KRW'), totalPnL>=0?PROFIT:LOSS],
       ['ê³ ë“ì (80â†‘)', gradeA.length+'ê±´', '#2f9e44']]
      .map(([l,v,c]) => '<div style="background:var(--s2);border:1.5px solid var(--border);border-radius:12px;padding:14px 12px;text-align:center">'
        + '<div style="font-size:10px;color:var(--muted);margin-bottom:5px;text-transform:uppercase;letter-spacing:.5px">' + l + '</div>'
        + '<div style="font-size:15px;font-weight:800;font-family:monospace;color:' + c + '">' + v + '</div>'
        + '</div>').join('')
    + '</div>'
    // ë“±ê¸‰ë³„ ì„¹ì…˜
    + makeGradeSection('ğŸŸ¢ Aë“±ê¸‰ Â· 80ì  ì´ìƒ', '#2f9e44', gradeA.sort((a,b)=>b.tradeScore-a.tradeScore))
    + makeGradeSection('ğŸŸ¡ Bë“±ê¸‰ Â· 50~79ì ', '#f08c00', gradeB.sort((a,b)=>b.tradeScore-a.tradeScore))
    + makeGradeSection('ğŸ”´ Cë“±ê¸‰ Â· 50ì  ë¯¸ë§Œ', '#e03131', gradeC.sort((a,b)=>b.tradeScore-a.tradeScore));
}

function exportReportPDF() {
  window.print();
}
function exportXLSX() {}

// â”€â”€ íŒíŠ¸ ë‹«ê¸° â”€â”€
function closeHint(id) {
  const el = document.getElementById('hint-'+id); if(el) el.style.display='none';
}

// â”€â”€ ìº˜ë¦°ë” ì´ë™ â”€â”€
function calMove(dir) {
  calYear  += dir===0 ? 0 : 0;
  calMonth += dir;
  if(calMonth>11){calMonth=0;calYear++;}
  if(calMonth<0){calMonth=11;calYear--;}
  renderCalendar();
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ì•± ì‹œì‘ â€” DOM ì¤€ë¹„ë˜ë©´ ë°ì´í„° ë¡œë“œ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('DOMContentLoaded', function() {
  loadData();
});
</script>
<script id="__data__" type="application/json">{"positions": [{"id": "50382a6d", "name": "ì‚¼ì„±ì „ì", "market": "KRX", "ticker": "005930", "currency": "KRW", "strategy": "ì´ë™í‰ê· ì„ ", "targetPrice": 90000, "stopPrice": 66000, "status": "holding", "note": "HBM ì‚¬ì´í´ íšŒë³µ, ë°˜ë„ì²´ ì—…í„´ ê¸°ëŒ€", "currentPrice": 75400, "trades": [{"id": "83f1535f", "type": "buy", "date": "2025-01-08", "price": 68000, "qty": 100, "fee": 3800, "emotion": "ğŸ’ª í™•ì‹ ", "note": "52ì£¼ ì‹ ì €ê°€ ë¶€ê·¼ ì§€ì§€ í™•ì¸", "fundType": "cash"}, {"id": "0f826a89", "type": "buy", "date": "2025-02-14", "price": 71200, "qty": 50, "fee": 2000, "emotion": "ğŸ˜ ëƒ‰ì •", "note": "20ì¼ì„  ëŒíŒŒ ì¶”ê°€ ë§¤ìˆ˜", "fundType": "cash"}]}, {"id": "c3d8abf7", "name": "SKí•˜ì´ë‹‰ìŠ¤", "market": "KRX", "ticker": "000660", "currency": "KRW", "strategy": "ë‰´ìŠ¤/ê³µì‹œ", "targetPrice": 260000, "stopPrice": 170000, "status": "holding", "note": "HBM3E ë…ì  ê³µê¸‰ ìˆ˜í˜œ", "currentPrice": 198000, "trades": [{"id": "0b8854ad", "type": "buy", "date": "2025-03-05", "price": 182000, "qty": 20, "fee": 2100, "emotion": "ğŸ’ª í™•ì‹ ", "note": "HBM ìˆ˜ìš” ê¸°ì‚¬ í™•ì¸ í›„ ì§„ì…", "fundType": "cash"}]}, {"id": "be3f1ecc", "name": "NVIDIA", "market": "US", "ticker": "NVDA", "currency": "USD", "strategy": "ì„±ì¥ì£¼", "targetPrice": 180, "stopPrice": 105, "status": "holding", "note": "AI ì¸í”„ë¼ ìˆ˜ìš” ì§€ì†", "currentPrice": 138, "trades": [{"id": "10515276", "type": "buy", "date": "2025-01-20", "price": 112, "qty": 10, "fee": 0, "emotion": "ğŸ’ª í™•ì‹ ", "note": "ì‹¤ì  ì„œí”„ë¼ì´ì¦ˆ í›„ ëˆŒë¦¼ëª© ì§„ì…", "fundType": "cash"}, {"id": "df2184f4", "type": "buy", "date": "2025-03-10", "price": 118, "qty": 5, "fee": 0, "emotion": "ğŸ˜ ëƒ‰ì •", "note": "í”¼ë¼ë¯¸ë”© ì¶”ê°€ ë§¤ìˆ˜", "fundType": "cash"}]}, {"id": "6e8b5be2", "name": "ì¹´ì¹´ì˜¤", "market": "KRX", "ticker": "035720", "currency": "KRW", "strategy": "ê°€ì¹˜íˆ¬ì", "status": "closed", "note": "í”Œë«í¼ ê·œì œ ë¦¬ìŠ¤í¬ í•´ì†Œ ê¸°ëŒ€", "trades": [{"id": "a77cca9b", "type": "buy", "date": "2024-10-15", "price": 38500, "qty": 80, "fee": 1800, "emotion": "ğŸ’ª í™•ì‹ ", "note": "PBR 0.8 ì—­ëŒ€ ì €ì  ë¶„í•  ë§¤ìˆ˜", "fundType": "cash"}, {"id": "3685708f", "type": "sell", "date": "2025-01-22", "price": 46200, "qty": 80, "fee": 2100, "emotion": "ğŸ˜ ëƒ‰ì •", "note": "ëª©í‘œê°€ ë„ë‹¬ ì²­ì‚°", "fundType": "cash"}]}, {"id": "e749c2ec", "name": "LGì—ë„ˆì§€ì†”ë£¨ì…˜", "market": "KRX", "ticker": "373220", "currency": "KRW", "strategy": "ì´ë™í‰ê· ì„ ", "status": "closed", "note": "ì „ê¸°ì°¨ ë°°í„°ë¦¬ ìˆ˜ì£¼ ëª¨ë©˜í…€", "trades": [{"id": "531a93a1", "type": "buy", "date": "2024-11-04", "price": 285000, "qty": 5, "fee": 800, "emotion": "ğŸ˜ ëƒ‰ì •", "note": "200ì¼ì„  ì§€ì§€ í™•ì¸", "fundType": "cash"}, {"id": "82f69617", "type": "sell", "date": "2025-02-17", "price": 268000, "qty": 5, "fee": 750, "emotion": "ğŸ˜° ë¶ˆì•ˆ", "note": "ì‹œì¥ ì•½ì„¸ ì†ì ˆ", "fundType": "cash"}]}, {"id": "0b29849c", "name": "Tesla", "market": "US", "ticker": "TSLA", "currency": "USD", "strategy": "ëª¨ë©˜í…€", "status": "closed", "note": "ì‹ ì°¨ ì¶œì‹œ ê¸°ëŒ€ ëª¨ë©˜í…€ ë§¤ë§¤", "trades": [{"id": "af7da95e", "type": "buy", "date": "2024-12-03", "price": 248, "qty": 8, "fee": 0, "emotion": "ğŸ˜¤ í¥ë¶„", "note": "55ì¼ ì‹ ê³ ê°€ ëŒíŒŒ ë§¤ìˆ˜", "fundType": "cash"}, {"id": "4787fe8a", "type": "sell", "date": "2025-02-28", "price": 312, "qty": 8, "fee": 0, "emotion": "ğŸ’ª í™•ì‹ ", "note": "+25% ëª©í‘œ ë„ë‹¬ ì²­ì‚°", "fundType": "cash"}]}], "templates": [], "rules": [], "violations": [], "checkState": {"entry": {}, "exit": {}}, "goals": [], "accounts": [], "txList": [], "interestList": []}</script>
<div id="more-menu" style="display:none;position:fixed;right:16px;top:0;background:var(--surface);border:1.5px solid var(--border);border-radius:10px;padding:6px;min-width:160px;z-index:9999;box-shadow:0 8px 32px rgba(0,0,0,.5)">
        <button class="more-item" onclick="openTmpl();toggleMoreMenu()">ğŸ“‹ í…œí”Œë¦¿</button>
        <button class="more-item" onclick="openTradeImport();toggleMoreMenu()">ğŸ“¤ ë§¤ë§¤ë‚´ì—­ ê°€ì ¸ì˜¤ê¸°</button>
        <button class="more-item" onclick="openJsonRestore();toggleMoreMenu()">ğŸ”„ JSON ë³µì›</button>
        <button class="more-item" onclick="openBulkTicker();toggleMoreMenu()">ğŸ· ì¢…ëª©ì½”ë“œ ì¼ê´„ì…ë ¥</button>
        <button class="more-item" onclick="exportCSV();toggleMoreMenu()">ğŸ“¥ CSV ë‚´ë³´ë‚´ê¸°</button>
        <button class="more-item" onclick="exportXLSX();toggleMoreMenu()">ğŸ“Š ì—‘ì…€ ë‚´ë³´ë‚´ê¸°</button>
        <button class="more-item" onclick="backupJSON();toggleMoreMenu()">ğŸ’¾ JSON ë°±ì—…</button>
        <button class="more-item" onclick="openHelp();toggleMoreMenu()">â“ ë„ì›€ë§</button>
      </div>
<!-- â•â•â•â•â•â•â•â•â•â• ğŸ“Š ë§¤ë„ ë³µê¸° + ì²´í¬ë¦¬ìŠ¤íŠ¸ + ì±„ì  ëª¨ë‹¬ â•â•â•â•â•â•â•â•â•â• -->
<div class="backdrop" id="m-review" onclick="backdropClose(this,event)">
<div class="modal" style="max-width:620px;max-height:90vh;overflow-y:auto">
  <div class="modal-hdr">
    <span class="modal-title" id="review-title">ğŸ“Š ë§¤ë§¤ ë³µê¸°</span>
    <button class="xbtn" onclick="cm('m-review')">Ã—</button>
  </div>
  <div class="modal-body" style="padding:0">

    <!-- íƒ­ -->
    <div style="display:flex;border-bottom:1px solid var(--border)">
      <button class="review-tab active" id="rtab-report" onclick="switchReviewTab('report')">ğŸ“ˆ ë³µê¸° ë¦¬í¬íŠ¸</button>
      <button class="review-tab" id="rtab-check"  onclick="switchReviewTab('check')">âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸</button>
      <button class="review-tab" id="rtab-score"  onclick="switchReviewTab('score')">ğŸ† ì ìˆ˜</button>
      <button class="review-tab" id="rtab-track"  onclick="switchReviewTab('track')">ğŸ“… ì‚¬í›„ ì¶”ì </button>
    </div>

    <!-- ë³µê¸° ë¦¬í¬íŠ¸ -->
    <div id="rpanel-report" class="review-panel" style="padding:16px 18px">
      <div id="review-report-body"></div>
    </div>

    <!-- ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
    <div id="rpanel-check" class="review-panel" style="display:none;padding:16px 18px">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px">
        <div style="font-size:12px;color:var(--muted)">âœ… = ì§€ì¼°ìŒ &nbsp; âŒ = ëª» ì§€í‚´ &nbsp; â¬œ = í•´ë‹¹ì—†ìŒ</div>
        <div id="score-live-preview" style="font-size:12px;color:var(--muted)"></div>
      </div>

      <div style="font-size:12px;font-weight:700;color:var(--accent);margin-bottom:4px;text-transform:uppercase;letter-spacing:.5px">ğŸ“ˆ ë§¤ìˆ˜ ì›ì¹™ ì²´í¬</div>
      <div style="font-size:11px;color:var(--muted);margin-bottom:10px">ì¢‹ì€ ë§¤ìˆ˜ëŠ” ê·¼ê±°Â·ì†ì ˆÂ·ë¶„í• ì´ ê°–ì¶°ì§„ ë§¤ìˆ˜ì˜ˆìš” (ë“œëŸ¬ì¼„ë°€ëŸ¬Â·ì˜¤ë‹Â·í´íŠœë”ì¡´ìŠ¤)</div>
      <div id="checklist-buy" style="display:flex;flex-direction:column;gap:7px;margin-bottom:18px"></div>

      <div style="font-size:12px;font-weight:700;color:var(--loss);margin-bottom:4px;text-transform:uppercase;letter-spacing:.5px">ğŸ“‰ ë§¤ë„ ì›ì¹™ ì²´í¬</div>
      <div style="font-size:11px;color:var(--muted);margin-bottom:10px">ì¢‹ì€ ë§¤ë„ëŠ” ê·¼ê±° ì†Œë©¸ ì‹œ íŒ”ê³ , ì˜¤ë¥¸ìª½ì–´ê¹¨Â·ê³µí¬ ë§¤ë„ë¥¼ í”¼í•˜ëŠ” ê±°ì˜ˆìš” (í”¼í„° ë¦°ì¹˜)</div>
      <div id="checklist-sell" style="display:flex;flex-direction:column;gap:7px;margin-bottom:18px"></div>

      <div style="display:flex;justify-content:space-between;align-items:center">
        <div id="score-live-preview-bottom" style="font-size:12px;"></div>
        <div style="display:flex;gap:8px">
          <button class="btn btn-outline" onclick="cm('m-review')">ë‚˜ì¤‘ì—</button>
          <button class="btn btn-primary" onclick="saveReview()">ğŸ’¾ ë³µê¸° ì €ì¥</button>
        </div>
      </div>
    </div>

    <!-- ì ìˆ˜ -->
    <div id="rpanel-score" class="review-panel" style="display:none;padding:16px 18px">
      <div id="review-score-body"></div>
    </div>

    <!-- ì‚¬í›„ ì¶”ì  -->
    <div id="rpanel-track" class="review-panel" style="display:none;padding:16px 18px">
      <div style="font-size:12px;color:var(--muted);margin-bottom:12px">ì²­ì‚° í›„ ê°€ê²©ì„ ì…ë ¥í•˜ë©´ "ë” ì¼ì°/ëŠ¦ê²Œ íŒ”ì•˜ë‹¤ë©´" ë¹„êµë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”</div>
      <div id="review-track-body"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
        <button class="btn btn-primary" onclick="saveTrackPrices()">ğŸ’¾ ì €ì¥</button>
      </div>
    </div>

  </div>
</div>
</div>


</body>
</html>